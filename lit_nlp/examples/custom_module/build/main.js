!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=146)}([function(t,e,n){"use strict";n.r(e),n.d(e,"defaultConverter",(function(){return y})),n.d(e,"notEqual",(function(){return b})),n.d(e,"UpdatingElement",(function(){return _})),n.d(e,"customElement",(function(){return w})),n.d(e,"property",(function(){return M})),n.d(e,"internalProperty",(function(){return E})),n.d(e,"query",(function(){return T})),n.d(e,"queryAsync",(function(){return A})),n.d(e,"queryAll",(function(){return C})),n.d(e,"eventOptions",(function(){return k})),n.d(e,"queryAssignedNodes",(function(){return L})),n.d(e,"html",(function(){return d.html})),n.d(e,"svg",(function(){return d.svg})),n.d(e,"TemplateResult",(function(){return d.TemplateResult})),n.d(e,"SVGTemplateResult",(function(){return d.SVGTemplateResult})),n.d(e,"supportsAdoptingStyleSheets",(function(){return R})),n.d(e,"CSSResult",(function(){return N})),n.d(e,"unsafeCSS",(function(){return D})),n.d(e,"css",(function(){return z})),n.d(e,"LitElement",(function(){return F}));var r=n(16),i=n(6);function o(t,e){const{element:{content:n},parts:r}=t,i=document.createTreeWalker(n,133,null,!1);let o=s(r),a=r[o],c=-1,l=0;const u=[];let d=null;for(;i.nextNode();){c++;const t=i.currentNode;for(t.previousSibling===d&&(d=null),e.has(t)&&(u.push(t),null===d&&(d=t)),null!==d&&l++;void 0!==a&&a.index===c;)a.index=null!==d?-1:a.index-l,o=s(r,o),a=r[o]}u.forEach(t=>t.parentNode.removeChild(t))}const a=t=>{let e=11===t.nodeType?0:1;const n=document.createTreeWalker(t,133,null,!1);for(;n.nextNode();)e++;return e},s=(t,e=-1)=>{for(let n=e+1;n<t.length;n++){const e=t[n];if(Object(i.d)(e))return n}return-1};var c=n(26),l=n(25),u=n(30),d=n(3);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const h=(t,e)=>`${t}--${e}`;let f=!0;void 0===window.ShadyCSS?f=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),f=!1);const p=t=>e=>{const n=h(e.type,t);let r=l.a.get(n);void 0===r&&(r={stringsArray:new WeakMap,keyString:new Map},l.a.set(n,r));let o=r.stringsArray.get(e.strings);if(void 0!==o)return o;const a=e.strings.join(i.f);if(o=r.keyString.get(a),void 0===o){const n=e.getTemplateElement();f&&window.ShadyCSS.prepareTemplateDom(n,t),o=new i.a(e,n),r.keyString.set(a,o)}return r.stringsArray.set(e.strings,o),o},m=["html","svg"],g=new Set,v=(t,e,n)=>{g.add(t);const r=n?n.element:document.createElement("template"),i=e.querySelectorAll("style"),{length:c}=i;if(0===c)return void window.ShadyCSS.prepareTemplateStyles(r,t);const u=document.createElement("style");for(let t=0;t<c;t++){const e=i[t];e.parentNode.removeChild(e),u.textContent+=e.textContent}(t=>{m.forEach(e=>{const n=l.a.get(h(e,t));void 0!==n&&n.keyString.forEach(t=>{const{element:{content:e}}=t,n=new Set;Array.from(e.querySelectorAll("style")).forEach(t=>{n.add(t)}),o(t,n)})})})(t);const d=r.content;n?function(t,e,n=null){const{element:{content:r},parts:i}=t;if(null==n)return void r.appendChild(e);const o=document.createTreeWalker(r,133,null,!1);let c=s(i),l=0,u=-1;for(;o.nextNode();){u++;for(o.currentNode===n&&(l=a(e),n.parentNode.insertBefore(e,n));-1!==c&&i[c].index===u;){if(l>0){for(;-1!==c;)i[c].index+=l,c=s(i,c);return}c=s(i,c)}}}(n,u,d.firstChild):d.insertBefore(u,d.firstChild),window.ShadyCSS.prepareTemplateStyles(r,t);const f=d.querySelector("style");if(window.ShadyCSS.nativeShadow&&null!==f)e.insertBefore(f.cloneNode(!0),e.firstChild);else if(n){d.insertBefore(u,d.firstChild);const t=new Set;t.add(u),o(n,t)}};window.JSCompiler_renameProperty=(t,e)=>t;const y={toAttribute(t,e){switch(e){case Boolean:return t?"":null;case Object:case Array:return null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){switch(e){case Boolean:return null!==t;case Number:return null===t?null:Number(t);case Object:case Array:return JSON.parse(t)}return t}},b=(t,e)=>e!==t&&(e==e||t==t),x={attribute:!0,type:String,converter:y,reflect:!1,hasChanged:b};class _ extends HTMLElement{constructor(){super(),this._updateState=0,this._instanceProperties=void 0,this._updatePromise=new Promise(t=>this._enableUpdatingResolver=t),this._changedProperties=new Map,this._reflectingProperties=void 0,this.initialize()}static get observedAttributes(){this.finalize();const t=[];return this._classProperties.forEach((e,n)=>{const r=this._attributeNameForProperty(n,e);void 0!==r&&(this._attributeToPropertyMap.set(r,n),t.push(r))}),t}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const t=Object.getPrototypeOf(this)._classProperties;void 0!==t&&t.forEach((t,e)=>this._classProperties.set(e,t))}}static createProperty(t,e=x){if(this._ensureClassProperties(),this._classProperties.set(t,e),e.noAccessor||this.prototype.hasOwnProperty(t))return;const n="symbol"==typeof t?Symbol():"__"+t,r=this.getPropertyDescriptor(t,n,e);void 0!==r&&Object.defineProperty(this.prototype,t,r)}static getPropertyDescriptor(t,e,n){return{get(){return this[e]},set(n){const r=this[t];this[e]=n,this._requestUpdate(t,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this._classProperties&&this._classProperties.get(t)||x}static finalize(){const t=Object.getPrototypeOf(this);if(t.hasOwnProperty("finalized")||t.finalize(),this.finalized=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const t=this.properties,e=[...Object.getOwnPropertyNames(t),..."function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t):[]];for(const n of e)this.createProperty(n,t[n])}}static _attributeNameForProperty(t,e){const n=e.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof t?t.toLowerCase():void 0}static _valueHasChanged(t,e,n=b){return n(t,e)}static _propertyValueFromAttribute(t,e){const n=e.type,r=e.converter||y,i="function"==typeof r?r:r.fromAttribute;return i?i(t,n):t}static _propertyValueToAttribute(t,e){if(void 0===e.reflect)return;const n=e.type,r=e.converter;return(r&&r.toAttribute||y.toAttribute)(t,n)}initialize(){this._saveInstanceProperties(),this._requestUpdate()}_saveInstanceProperties(){this.constructor._classProperties.forEach((t,e)=>{if(this.hasOwnProperty(e)){const t=this[e];delete this[e],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(e,t)}})}_applyInstanceProperties(){this._instanceProperties.forEach((t,e)=>this[e]=t),this._instanceProperties=void 0}connectedCallback(){this.enableUpdating()}enableUpdating(){void 0!==this._enableUpdatingResolver&&(this._enableUpdatingResolver(),this._enableUpdatingResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(t,e,n){e!==n&&this._attributeToProperty(t,n)}_propertyToAttribute(t,e,n=x){const r=this.constructor,i=r._attributeNameForProperty(t,n);if(void 0!==i){const t=r._propertyValueToAttribute(e,n);if(void 0===t)return;this._updateState=8|this._updateState,null==t?this.removeAttribute(i):this.setAttribute(i,t),this._updateState=-9&this._updateState}}_attributeToProperty(t,e){if(8&this._updateState)return;const n=this.constructor,r=n._attributeToPropertyMap.get(t);if(void 0!==r){const t=n.getPropertyOptions(r);this._updateState=16|this._updateState,this[r]=n._propertyValueFromAttribute(e,t),this._updateState=-17&this._updateState}}_requestUpdate(t,e){let n=!0;if(void 0!==t){const r=this.constructor,i=r.getPropertyOptions(t);r._valueHasChanged(this[t],e,i.hasChanged)?(this._changedProperties.has(t)||this._changedProperties.set(t,e),!0!==i.reflect||16&this._updateState||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(t,i))):n=!1}!this._hasRequestedUpdate&&n&&(this._updatePromise=this._enqueueUpdate())}requestUpdate(t,e){return this._requestUpdate(t,e),this.updateComplete}async _enqueueUpdate(){this._updateState=4|this._updateState;try{await this._updatePromise}catch(t){}const t=this.performUpdate();return null!=t&&await t,!this._hasRequestedUpdate}get _hasRequestedUpdate(){return 4&this._updateState}get hasUpdated(){return 1&this._updateState}performUpdate(){this._instanceProperties&&this._applyInstanceProperties();let t=!1;const e=this._changedProperties;try{t=this.shouldUpdate(e),t?this.update(e):this._markUpdated()}catch(e){throw t=!1,this._markUpdated(),e}t&&(1&this._updateState||(this._updateState=1|this._updateState,this.firstUpdated(e)),this.updated(e))}_markUpdated(){this._changedProperties=new Map,this._updateState=-5&this._updateState}get updateComplete(){return this._getUpdateComplete()}_getUpdateComplete(){return this._updatePromise}shouldUpdate(t){return!0}update(t){void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach((t,e)=>this._propertyToAttribute(e,this[e],t)),this._reflectingProperties=void 0),this._markUpdated()}updated(t){}firstUpdated(t){}}_.finalized=!0;
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const w=t=>e=>"function"==typeof e?((t,e)=>(window.customElements.define(t,e),e))(t,e):((t,e)=>{const{kind:n,elements:r}=e;return{kind:n,elements:r,finisher(e){window.customElements.define(t,e)}}})(t,e),S=(t,e)=>"method"===e.kind&&e.descriptor&&!("value"in e.descriptor)?Object.assign(Object.assign({},e),{finisher(n){n.createProperty(e.key,t)}}):{kind:"field",key:Symbol(),placement:"own",descriptor:{},initializer(){"function"==typeof e.initializer&&(this[e.key]=e.initializer.call(this))},finisher(n){n.createProperty(e.key,t)}};function M(t){return(e,n)=>void 0!==n?((t,e,n)=>{e.constructor.createProperty(n,t)})(t,e,n):S(t,e)}function E(t){return M({attribute:!1,hasChanged:null==t?void 0:t.hasChanged})}function T(t){return(e,n)=>{const r={get(){return this.renderRoot.querySelector(t)},enumerable:!0,configurable:!0};return void 0!==n?P(r,e,n):O(r,e)}}function A(t){return(e,n)=>{const r={async get(){return await this.updateComplete,this.renderRoot.querySelector(t)},enumerable:!0,configurable:!0};return void 0!==n?P(r,e,n):O(r,e)}}function C(t){return(e,n)=>{const r={get(){return this.renderRoot.querySelectorAll(t)},enumerable:!0,configurable:!0};return void 0!==n?P(r,e,n):O(r,e)}}const P=(t,e,n)=>{Object.defineProperty(e,n,t)},O=(t,e)=>({kind:"method",placement:"prototype",key:e.key,descriptor:t});function k(t){return(e,n)=>void 0!==n?((t,e,n)=>{Object.assign(e[n],t)})(t,e,n):((t,e)=>Object.assign(Object.assign({},e),{finisher(n){Object.assign(n.prototype[e.key],t)}}))(t,e)}function L(t="",e=!1){return(n,r)=>{const i={get(){const n="slot"+(t?`[name=${t}]`:""),r=this.renderRoot.querySelector(n);return r&&r.assignedNodes({flatten:e})},enumerable:!0,configurable:!0};return void 0!==r?P(i,n,r):O(i,n)}}
/**
@license
Copyright (c) 2019 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/const R="adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,I=Symbol();class N{constructor(t,e){if(e!==I)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t}get styleSheet(){return void 0===this._styleSheet&&(R?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}const D=t=>new N(String(t),I),z=(t,...e)=>{const n=e.reduce((e,n,r)=>e+(t=>{if(t instanceof N)return t.cssText;if("number"==typeof t)return t;throw new Error(`Value passed to 'css' function must be a 'css' function result: ${t}. Use 'unsafeCSS' to pass non-literal values, but\n            take care to ensure page security.`)})(n)+t[r+1],t[0]);return new N(n,I)};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
(window.litElementVersions||(window.litElementVersions=[])).push("2.3.1");const j={};class F extends _{static getStyles(){return this.styles}static _getUniqueStyles(){if(this.hasOwnProperty(JSCompiler_renameProperty("_styles",this)))return;const t=this.getStyles();if(void 0===t)this._styles=[];else if(Array.isArray(t)){const e=(t,n)=>t.reduceRight((t,n)=>Array.isArray(n)?e(n,t):(t.add(n),t),n),n=e(t,new Set),r=[];n.forEach(t=>r.unshift(t)),this._styles=r}else this._styles=[t]}initialize(){super.initialize(),this.constructor._getUniqueStyles(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow({mode:"open"})}adoptStyles(){const t=this.constructor._styles;0!==t.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?R?this.renderRoot.adoptedStyleSheets=t.map(t=>t.styleSheet):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(t.map(t=>t.cssText),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}update(t){const e=this.render();super.update(t),e!==j&&this.constructor.render(e,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach(t=>{const e=document.createElement("style");e.textContent=t.cssText,this.renderRoot.appendChild(e)}))}render(){return j}}F.finalized=!0,F.render=(t,e,n)=>{if(!n||"object"!=typeof n||!n.scopeName)throw new Error("The `scopeName` option is required.");const i=n.scopeName,o=c.a.has(e),a=f&&11===e.nodeType&&!!e.host,s=a&&!g.has(i),l=s?document.createDocumentFragment():e;if(Object(c.b)(t,l,Object.assign({templateFactory:p(i)},n)),s){const t=c.a.get(l);c.a.delete(l);const n=t.value instanceof u.a?t.value.template:void 0;v(i,l,n),Object(r.b)(e,e.firstChild),e.appendChild(l),c.a.set(e,t)}!o&&a&&window.ShadyCSS.styleElement(e.host)}},function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return a}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function a(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}},function(t,e,n){"use strict";n.r(e),n.d(e,"ACESFilmicToneMapping",(function(){return ct})),n.d(e,"AddEquation",(function(){return O})),n.d(e,"AddOperation",(function(){return nt})),n.d(e,"AdditiveBlending",(function(){return T})),n.d(e,"AlphaFormat",(function(){return Ht})),n.d(e,"AlwaysDepth",(function(){return q})),n.d(e,"AlwaysStencilFunc",(function(){return dn})),n.d(e,"AmbientLight",(function(){return Ku})),n.d(e,"AmbientLightProbe",(function(){return bd})),n.d(e,"AnimationClip",(function(){return ru})),n.d(e,"AnimationLoader",(function(){return du})),n.d(e,"AnimationMixer",(function(){return Yd})),n.d(e,"AnimationObjectGroup",(function(){return qd})),n.d(e,"AnimationUtils",(function(){return Gl})),n.d(e,"ArcCurve",(function(){return bu})),n.d(e,"ArrayCamera",(function(){return ps})),n.d(e,"ArrowHelper",(function(){return zh})),n.d(e,"Audio",(function(){return Pd})),n.d(e,"AudioAnalyser",(function(){return Nd})),n.d(e,"AudioContext",(function(){return pd})),n.d(e,"AudioListener",(function(){return Cd})),n.d(e,"AudioLoader",(function(){return md})),n.d(e,"AxesHelper",(function(){return jh})),n.d(e,"AxisHelper",(function(){return Wf})),n.d(e,"BackSide",(function(){return v})),n.d(e,"BasicDepthPacking",(function(){return We})),n.d(e,"BasicShadowMap",(function(){return h})),n.d(e,"BinaryTextureLoader",(function(){return Kf})),n.d(e,"Bone",(function(){return $s})),n.d(e,"BooleanKeyframeTrack",(function(){return Kl})),n.d(e,"BoundingBoxHelper",(function(){return $f})),n.d(e,"Box2",(function(){return ih})),n.d(e,"Box3",(function(){return Mr})),n.d(e,"Box3Helper",(function(){return Lh})),n.d(e,"BoxBufferGeometry",(function(){return eo})),n.d(e,"BoxGeometry",(function(){return to})),n.d(e,"BoxHelper",(function(){return kh})),n.d(e,"BufferAttribute",(function(){return li})),n.d(e,"BufferGeometry",(function(){return Ci})),n.d(e,"BufferGeometryLoader",(function(){return nd})),n.d(e,"ByteType",(function(){return kt})),n.d(e,"Cache",(function(){return ou})),n.d(e,"Camera",(function(){return ao})),n.d(e,"CameraHelper",(function(){return Ch})),n.d(e,"CanvasRenderer",(function(){return Qf})),n.d(e,"CanvasTexture",(function(){return yc})),n.d(e,"CatmullRomCurve3",(function(){return Eu})),n.d(e,"CineonToneMapping",(function(){return st})),n.d(e,"CircleBufferGeometry",(function(){return kl})),n.d(e,"CircleGeometry",(function(){return Ol})),n.d(e,"ClampToEdgeWrapping",(function(){return yt})),n.d(e,"Clock",(function(){return Sd})),n.d(e,"ClosedSplineCurve3",(function(){return Hf})),n.d(e,"Color",(function(){return ti})),n.d(e,"ColorKeyframeTrack",(function(){return Zl})),n.d(e,"CompressedTexture",(function(){return vc})),n.d(e,"CompressedTextureLoader",(function(){return hu})),n.d(e,"ConeBufferGeometry",(function(){return Pl})),n.d(e,"ConeGeometry",(function(){return Cl})),n.d(e,"CubeCamera",(function(){return co})),n.d(e,"CubeGeometry",(function(){return to})),n.d(e,"CubeReflectionMapping",(function(){return ut})),n.d(e,"CubeRefractionMapping",(function(){return dt})),n.d(e,"CubeTexture",(function(){return Ro})),n.d(e,"CubeTextureLoader",(function(){return mu})),n.d(e,"CubeUVReflectionMapping",(function(){return mt})),n.d(e,"CubeUVRefractionMapping",(function(){return gt})),n.d(e,"CubicBezierCurve",(function(){return Pu})),n.d(e,"CubicBezierCurve3",(function(){return Ou})),n.d(e,"CubicInterpolant",(function(){return $l})),n.d(e,"CullFaceBack",(function(){return s})),n.d(e,"CullFaceFront",(function(){return c})),n.d(e,"CullFaceFrontBack",(function(){return l})),n.d(e,"CullFaceNone",(function(){return a})),n.d(e,"Curve",(function(){return vu})),n.d(e,"CurvePath",(function(){return zu})),n.d(e,"CustomBlending",(function(){return P})),n.d(e,"CylinderBufferGeometry",(function(){return Al})),n.d(e,"CylinderGeometry",(function(){return Tl})),n.d(e,"Cylindrical",(function(){return nh})),n.d(e,"DataTexture",(function(){return uo})),n.d(e,"DataTexture2DArray",(function(){return Io})),n.d(e,"DataTexture3D",(function(){return No})),n.d(e,"DataTextureLoader",(function(){return fu})),n.d(e,"DecrementStencilOp",(function(){return Qe})),n.d(e,"DecrementWrapStencilOp",(function(){return en})),n.d(e,"DefaultLoadingManager",(function(){return su})),n.d(e,"DepthFormat",(function(){return Xt})),n.d(e,"DepthStencilFormat",(function(){return Yt})),n.d(e,"DepthTexture",(function(){return bc})),n.d(e,"DirectionalLight",(function(){return Yu})),n.d(e,"DirectionalLightHelper",(function(){return Eh})),n.d(e,"DirectionalLightShadow",(function(){return Xu})),n.d(e,"DiscreteInterpolant",(function(){return Xl})),n.d(e,"DodecahedronBufferGeometry",(function(){return Lc})),n.d(e,"DodecahedronGeometry",(function(){return kc})),n.d(e,"DoubleSide",(function(){return y})),n.d(e,"DstAlphaFactor",(function(){return U})),n.d(e,"DstColorFactor",(function(){return V})),n.d(e,"DynamicBufferAttribute",(function(){return Lf})),n.d(e,"DynamicCopyUsage",(function(){return bn})),n.d(e,"DynamicDrawUsage",(function(){return fn})),n.d(e,"DynamicReadUsage",(function(){return gn})),n.d(e,"EdgesGeometry",(function(){return El})),n.d(e,"EdgesHelper",(function(){return qf})),n.d(e,"EllipseCurve",(function(){return yu})),n.d(e,"EqualDepth",(function(){return K})),n.d(e,"EqualStencilFunc",(function(){return an})),n.d(e,"EquirectangularReflectionMapping",(function(){return ht})),n.d(e,"EquirectangularRefractionMapping",(function(){return ft})),n.d(e,"Euler",(function(){return Xn})),n.d(e,"EventDispatcher",(function(){return _n})),n.d(e,"ExtrudeBufferGeometry",(function(){return dl})),n.d(e,"ExtrudeGeometry",(function(){return ul})),n.d(e,"Face3",(function(){return ii})),n.d(e,"Face4",(function(){return xf})),n.d(e,"FaceColors",(function(){return w})),n.d(e,"FileLoader",(function(){return uu})),n.d(e,"FlatShading",(function(){return b})),n.d(e,"Float32Attribute",(function(){return Bf})),n.d(e,"Float32BufferAttribute",(function(){return vi})),n.d(e,"Float64Attribute",(function(){return Uf})),n.d(e,"Float64BufferAttribute",(function(){return yi})),n.d(e,"FloatType",(function(){return Dt})),n.d(e,"Fog",(function(){return bs})),n.d(e,"FogExp2",(function(){return ys})),n.d(e,"Font",(function(){return dd})),n.d(e,"FontLoader",(function(){return fd})),n.d(e,"FrontFaceDirectionCCW",(function(){return d})),n.d(e,"FrontFaceDirectionCW",(function(){return u})),n.d(e,"FrontSide",(function(){return g})),n.d(e,"Frustum",(function(){return po})),n.d(e,"GammaEncoding",(function(){return Fe})),n.d(e,"Geometry",(function(){return Qi})),n.d(e,"GeometryUtils",(function(){return Jf})),n.d(e,"GreaterDepth",(function(){return J})),n.d(e,"GreaterEqualDepth",(function(){return Z})),n.d(e,"GreaterEqualStencilFunc",(function(){return un})),n.d(e,"GreaterStencilFunc",(function(){return cn})),n.d(e,"GridHelper",(function(){return xh})),n.d(e,"Group",(function(){return ms})),n.d(e,"HalfFloatType",(function(){return zt})),n.d(e,"HemisphereLight",(function(){return Uu})),n.d(e,"HemisphereLightHelper",(function(){return bh})),n.d(e,"HemisphereLightProbe",(function(){return yd})),n.d(e,"IcosahedronBufferGeometry",(function(){return Oc})),n.d(e,"IcosahedronGeometry",(function(){return Pc})),n.d(e,"ImageBitmapLoader",(function(){return ld})),n.d(e,"ImageLoader",(function(){return pu})),n.d(e,"ImageUtils",(function(){return Cn})),n.d(e,"ImmediateRenderObject",(function(){return ch})),n.d(e,"IncrementStencilOp",(function(){return Je})),n.d(e,"IncrementWrapStencilOp",(function(){return tn})),n.d(e,"InstancedBufferAttribute",(function(){return ed})),n.d(e,"InstancedBufferGeometry",(function(){return td})),n.d(e,"InstancedInterleavedBuffer",(function(){return Zd})),n.d(e,"InstancedMesh",(function(){return Zs})),n.d(e,"Int16Attribute",(function(){return Df})),n.d(e,"Int16BufferAttribute",(function(){return fi})),n.d(e,"Int32Attribute",(function(){return jf})),n.d(e,"Int32BufferAttribute",(function(){return mi})),n.d(e,"Int8Attribute",(function(){return Rf})),n.d(e,"Int8BufferAttribute",(function(){return ui})),n.d(e,"IntType",(function(){return It})),n.d(e,"InterleavedBuffer",(function(){return xs})),n.d(e,"InterleavedBufferAttribute",(function(){return Ss})),n.d(e,"Interpolant",(function(){return Wl})),n.d(e,"InterpolateDiscrete",(function(){return Ce})),n.d(e,"InterpolateLinear",(function(){return Pe})),n.d(e,"InterpolateSmooth",(function(){return Oe})),n.d(e,"InvertStencilOp",(function(){return nn})),n.d(e,"JSONLoader",(function(){return tp})),n.d(e,"KeepStencilOp",(function(){return Ke})),n.d(e,"KeyframeTrack",(function(){return Yl})),n.d(e,"LOD",(function(){return Us})),n.d(e,"LatheBufferGeometry",(function(){return _l})),n.d(e,"LatheGeometry",(function(){return xl})),n.d(e,"Layers",(function(){return Yn})),n.d(e,"LensFlare",(function(){return np})),n.d(e,"LessDepth",(function(){return X})),n.d(e,"LessEqualDepth",(function(){return Y})),n.d(e,"LessEqualStencilFunc",(function(){return sn})),n.d(e,"LessStencilFunc",(function(){return on})),n.d(e,"Light",(function(){return Bu})),n.d(e,"LightProbe",(function(){return vd})),n.d(e,"LightShadow",(function(){return Hu})),n.d(e,"Line",(function(){return ic})),n.d(e,"Line3",(function(){return sh})),n.d(e,"LineBasicMaterial",(function(){return Js})),n.d(e,"LineCurve",(function(){return ku})),n.d(e,"LineCurve3",(function(){return Lu})),n.d(e,"LineDashedMaterial",(function(){return Hl})),n.d(e,"LineLoop",(function(){return cc})),n.d(e,"LinePieces",(function(){return wf})),n.d(e,"LineSegments",(function(){return sc})),n.d(e,"LineStrip",(function(){return _f})),n.d(e,"LinearEncoding",(function(){return ze})),n.d(e,"LinearFilter",(function(){return Et})),n.d(e,"LinearInterpolant",(function(){return ql})),n.d(e,"LinearMipMapLinearFilter",(function(){return Pt})),n.d(e,"LinearMipMapNearestFilter",(function(){return At})),n.d(e,"LinearMipmapLinearFilter",(function(){return Ct})),n.d(e,"LinearMipmapNearestFilter",(function(){return Tt})),n.d(e,"LinearToneMapping",(function(){return it})),n.d(e,"Loader",(function(){return cu})),n.d(e,"LoaderUtils",(function(){return Qu})),n.d(e,"LoadingManager",(function(){return au})),n.d(e,"LogLuvEncoding",(function(){return Ue})),n.d(e,"LoopOnce",(function(){return Ee})),n.d(e,"LoopPingPong",(function(){return Ae})),n.d(e,"LoopRepeat",(function(){return Te})),n.d(e,"LuminanceAlphaFormat",(function(){return $t})),n.d(e,"LuminanceFormat",(function(){return Wt})),n.d(e,"MOUSE",(function(){return i})),n.d(e,"Material",(function(){return ai})),n.d(e,"MaterialLoader",(function(){return Ju})),n.d(e,"Math",(function(){return En})),n.d(e,"MathUtils",(function(){return En})),n.d(e,"Matrix3",(function(){return An})),n.d(e,"Matrix4",(function(){return Wn})),n.d(e,"MaxEquation",(function(){return I})),n.d(e,"Mesh",(function(){return $i})),n.d(e,"MeshBasicMaterial",(function(){return si})),n.d(e,"MeshDepthMaterial",(function(){return as})),n.d(e,"MeshDistanceMaterial",(function(){return ss})),n.d(e,"MeshFaceMaterial",(function(){return Sf})),n.d(e,"MeshLambertMaterial",(function(){return Bl})),n.d(e,"MeshMatcapMaterial",(function(){return Ul})),n.d(e,"MeshNormalMaterial",(function(){return Fl})),n.d(e,"MeshPhongMaterial",(function(){return zl})),n.d(e,"MeshPhysicalMaterial",(function(){return Dl})),n.d(e,"MeshStandardMaterial",(function(){return Nl})),n.d(e,"MeshToonMaterial",(function(){return jl})),n.d(e,"MinEquation",(function(){return R})),n.d(e,"MirroredRepeatWrapping",(function(){return bt})),n.d(e,"MixOperation",(function(){return et})),n.d(e,"MultiMaterial",(function(){return Mf})),n.d(e,"MultiplyBlending",(function(){return C})),n.d(e,"MultiplyOperation",(function(){return tt})),n.d(e,"NearestFilter",(function(){return xt})),n.d(e,"NearestMipMapLinearFilter",(function(){return Mt})),n.d(e,"NearestMipMapNearestFilter",(function(){return wt})),n.d(e,"NearestMipmapLinearFilter",(function(){return St})),n.d(e,"NearestMipmapNearestFilter",(function(){return _t})),n.d(e,"NeverDepth",(function(){return $})),n.d(e,"NeverStencilFunc",(function(){return rn})),n.d(e,"NoBlending",(function(){return M})),n.d(e,"NoColors",(function(){return _})),n.d(e,"NoToneMapping",(function(){return rt})),n.d(e,"NormalBlending",(function(){return E})),n.d(e,"NotEqualDepth",(function(){return Q})),n.d(e,"NotEqualStencilFunc",(function(){return ln})),n.d(e,"NumberKeyframeTrack",(function(){return Jl})),n.d(e,"Object3D",(function(){return lr})),n.d(e,"ObjectLoader",(function(){return id})),n.d(e,"ObjectSpaceNormalMap",(function(){return Xe})),n.d(e,"OctahedronBufferGeometry",(function(){return Cc})),n.d(e,"OctahedronGeometry",(function(){return Ac})),n.d(e,"OneFactor",(function(){return D})),n.d(e,"OneMinusDstAlphaFactor",(function(){return H})),n.d(e,"OneMinusDstColorFactor",(function(){return G})),n.d(e,"OneMinusSrcAlphaFactor",(function(){return B})),n.d(e,"OneMinusSrcColorFactor",(function(){return j})),n.d(e,"OrthographicCamera",(function(){return qu})),n.d(e,"PCFShadowMap",(function(){return f})),n.d(e,"PCFSoftShadowMap",(function(){return p})),n.d(e,"PMREMGenerator",(function(){return sf})),n.d(e,"ParametricBufferGeometry",(function(){return wc})),n.d(e,"ParametricGeometry",(function(){return _c})),n.d(e,"Particle",(function(){return Tf})),n.d(e,"ParticleBasicMaterial",(function(){return Pf})),n.d(e,"ParticleSystem",(function(){return Af})),n.d(e,"ParticleSystemMaterial",(function(){return Of})),n.d(e,"Path",(function(){return ju})),n.d(e,"PerspectiveCamera",(function(){return so})),n.d(e,"Plane",(function(){return Fr})),n.d(e,"PlaneBufferGeometry",(function(){return bo})),n.d(e,"PlaneGeometry",(function(){return yo})),n.d(e,"PlaneHelper",(function(){return Rh})),n.d(e,"PointCloud",(function(){return Ef})),n.d(e,"PointCloudMaterial",(function(){return Cf})),n.d(e,"PointLight",(function(){return $u})),n.d(e,"PointLightHelper",(function(){return mh})),n.d(e,"Points",(function(){return pc})),n.d(e,"PointsMaterial",(function(){return lc})),n.d(e,"PolarGridHelper",(function(){return _h})),n.d(e,"PolyhedronBufferGeometry",(function(){return Mc})),n.d(e,"PolyhedronGeometry",(function(){return Sc})),n.d(e,"PositionalAudio",(function(){return Id})),n.d(e,"PropertyBinding",(function(){return $d})),n.d(e,"PropertyMixer",(function(){return Dd})),n.d(e,"QuadraticBezierCurve",(function(){return Ru})),n.d(e,"QuadraticBezierCurve3",(function(){return Iu})),n.d(e,"Quaternion",(function(){return In})),n.d(e,"QuaternionKeyframeTrack",(function(){return tu})),n.d(e,"QuaternionLinearInterpolant",(function(){return Ql})),n.d(e,"REVISION",(function(){return r})),n.d(e,"RGBADepthPacking",(function(){return $e})),n.d(e,"RGBAFormat",(function(){return Gt})),n.d(e,"RGBAIntegerFormat",(function(){return ee})),n.d(e,"RGBA_ASTC_10x10_Format",(function(){return we})),n.d(e,"RGBA_ASTC_10x5_Format",(function(){return be})),n.d(e,"RGBA_ASTC_10x6_Format",(function(){return xe})),n.d(e,"RGBA_ASTC_10x8_Format",(function(){return _e})),n.d(e,"RGBA_ASTC_12x10_Format",(function(){return Se})),n.d(e,"RGBA_ASTC_12x12_Format",(function(){return Me})),n.d(e,"RGBA_ASTC_4x4_Format",(function(){return de})),n.d(e,"RGBA_ASTC_5x4_Format",(function(){return he})),n.d(e,"RGBA_ASTC_5x5_Format",(function(){return fe})),n.d(e,"RGBA_ASTC_6x5_Format",(function(){return pe})),n.d(e,"RGBA_ASTC_6x6_Format",(function(){return me})),n.d(e,"RGBA_ASTC_8x5_Format",(function(){return ge})),n.d(e,"RGBA_ASTC_8x6_Format",(function(){return ve})),n.d(e,"RGBA_ASTC_8x8_Format",(function(){return ye})),n.d(e,"RGBA_PVRTC_2BPPV1_Format",(function(){return le})),n.d(e,"RGBA_PVRTC_4BPPV1_Format",(function(){return ce})),n.d(e,"RGBA_S3TC_DXT1_Format",(function(){return re})),n.d(e,"RGBA_S3TC_DXT3_Format",(function(){return ie})),n.d(e,"RGBA_S3TC_DXT5_Format",(function(){return oe})),n.d(e,"RGBDEncoding",(function(){return Ge})),n.d(e,"RGBEEncoding",(function(){return Be})),n.d(e,"RGBEFormat",(function(){return qt})),n.d(e,"RGBFormat",(function(){return Vt})),n.d(e,"RGBIntegerFormat",(function(){return te})),n.d(e,"RGBM16Encoding",(function(){return Ve})),n.d(e,"RGBM7Encoding",(function(){return He})),n.d(e,"RGB_ETC1_Format",(function(){return ue})),n.d(e,"RGB_PVRTC_2BPPV1_Format",(function(){return se})),n.d(e,"RGB_PVRTC_4BPPV1_Format",(function(){return ae})),n.d(e,"RGB_S3TC_DXT1_Format",(function(){return ne})),n.d(e,"RGFormat",(function(){return Jt})),n.d(e,"RGIntegerFormat",(function(){return Qt})),n.d(e,"RawShaderMaterial",(function(){return Il})),n.d(e,"Ray",(function(){return Nr})),n.d(e,"Raycaster",(function(){return Jd})),n.d(e,"RectAreaLight",(function(){return Zu})),n.d(e,"RedFormat",(function(){return Kt})),n.d(e,"RedIntegerFormat",(function(){return Zt})),n.d(e,"ReinhardToneMapping",(function(){return ot})),n.d(e,"RepeatWrapping",(function(){return vt})),n.d(e,"ReplaceStencilOp",(function(){return Ze})),n.d(e,"ReverseSubtractEquation",(function(){return L})),n.d(e,"RingBufferGeometry",(function(){return bl})),n.d(e,"RingGeometry",(function(){return yl})),n.d(e,"Scene",(function(){return ur})),n.d(e,"SceneUtils",(function(){return ep})),n.d(e,"ShaderChunk",(function(){return xo})),n.d(e,"ShaderLib",(function(){return _o})),n.d(e,"ShaderMaterial",(function(){return oo})),n.d(e,"ShadowMaterial",(function(){return Rl})),n.d(e,"Shape",(function(){return Fu})),n.d(e,"ShapeBufferGeometry",(function(){return Sl})),n.d(e,"ShapeGeometry",(function(){return wl})),n.d(e,"ShapePath",(function(){return ud})),n.d(e,"ShapeUtils",(function(){return sl})),n.d(e,"ShortType",(function(){return Lt})),n.d(e,"Skeleton",(function(){return Ws})),n.d(e,"SkeletonHelper",(function(){return ph})),n.d(e,"SkinnedMesh",(function(){return Hs})),n.d(e,"SmoothShading",(function(){return x})),n.d(e,"Sphere",(function(){return Ar})),n.d(e,"SphereBufferGeometry",(function(){return vl})),n.d(e,"SphereGeometry",(function(){return gl})),n.d(e,"Spherical",(function(){return eh})),n.d(e,"SphericalHarmonics3",(function(){return gd})),n.d(e,"SphericalReflectionMapping",(function(){return pt})),n.d(e,"Spline",(function(){return Gf})),n.d(e,"SplineCurve",(function(){return Nu})),n.d(e,"SplineCurve3",(function(){return Vf})),n.d(e,"SpotLight",(function(){return Gu})),n.d(e,"SpotLightHelper",(function(){return uh})),n.d(e,"SpotLightShadow",(function(){return Vu})),n.d(e,"Sprite",(function(){return zs})),n.d(e,"SpriteMaterial",(function(){return Ms})),n.d(e,"SrcAlphaFactor",(function(){return F})),n.d(e,"SrcAlphaSaturateFactor",(function(){return W})),n.d(e,"SrcColorFactor",(function(){return z})),n.d(e,"StaticCopyUsage",(function(){return yn})),n.d(e,"StaticDrawUsage",(function(){return hn})),n.d(e,"StaticReadUsage",(function(){return mn})),n.d(e,"StereoCamera",(function(){return wd})),n.d(e,"StreamCopyUsage",(function(){return xn})),n.d(e,"StreamDrawUsage",(function(){return pn})),n.d(e,"StreamReadUsage",(function(){return vn})),n.d(e,"StringKeyframeTrack",(function(){return eu})),n.d(e,"SubtractEquation",(function(){return k})),n.d(e,"SubtractiveBlending",(function(){return A})),n.d(e,"TOUCH",(function(){return o})),n.d(e,"TangentSpaceNormalMap",(function(){return qe})),n.d(e,"TetrahedronBufferGeometry",(function(){return Tc})),n.d(e,"TetrahedronGeometry",(function(){return Ec})),n.d(e,"TextBufferGeometry",(function(){return ml})),n.d(e,"TextGeometry",(function(){return pl})),n.d(e,"Texture",(function(){return On})),n.d(e,"TextureLoader",(function(){return gu})),n.d(e,"TorusBufferGeometry",(function(){return jc})),n.d(e,"TorusGeometry",(function(){return zc})),n.d(e,"TorusKnotBufferGeometry",(function(){return Dc})),n.d(e,"TorusKnotGeometry",(function(){return Nc})),n.d(e,"Triangle",(function(){return Kr})),n.d(e,"TriangleFanDrawMode",(function(){return De})),n.d(e,"TriangleStripDrawMode",(function(){return Ne})),n.d(e,"TrianglesDrawMode",(function(){return Ie})),n.d(e,"TubeBufferGeometry",(function(){return Ic})),n.d(e,"TubeGeometry",(function(){return Rc})),n.d(e,"UVMapping",(function(){return lt})),n.d(e,"Uint16Attribute",(function(){return zf})),n.d(e,"Uint16BufferAttribute",(function(){return pi})),n.d(e,"Uint32Attribute",(function(){return Ff})),n.d(e,"Uint32BufferAttribute",(function(){return gi})),n.d(e,"Uint8Attribute",(function(){return If})),n.d(e,"Uint8BufferAttribute",(function(){return di})),n.d(e,"Uint8ClampedAttribute",(function(){return Nf})),n.d(e,"Uint8ClampedBufferAttribute",(function(){return hi})),n.d(e,"Uncharted2ToneMapping",(function(){return at})),n.d(e,"Uniform",(function(){return Kd})),n.d(e,"UniformsLib",(function(){return mo})),n.d(e,"UniformsUtils",(function(){return io})),n.d(e,"UnsignedByteType",(function(){return Ot})),n.d(e,"UnsignedInt248Type",(function(){return Ut})),n.d(e,"UnsignedIntType",(function(){return Nt})),n.d(e,"UnsignedShort4444Type",(function(){return jt})),n.d(e,"UnsignedShort5551Type",(function(){return Ft})),n.d(e,"UnsignedShort565Type",(function(){return Bt})),n.d(e,"UnsignedShortType",(function(){return Rt})),n.d(e,"VSMShadowMap",(function(){return m})),n.d(e,"Vector2",(function(){return Tn})),n.d(e,"Vector3",(function(){return zn})),n.d(e,"Vector4",(function(){return kn})),n.d(e,"VectorKeyframeTrack",(function(){return nu})),n.d(e,"Vertex",(function(){return kf})),n.d(e,"VertexColors",(function(){return S})),n.d(e,"VideoTexture",(function(){return gc})),n.d(e,"WebGLCubeRenderTarget",(function(){return lo})),n.d(e,"WebGLMultisampleRenderTarget",(function(){return Rn})),n.d(e,"WebGLRenderTarget",(function(){return Ln})),n.d(e,"WebGLRenderTargetCube",(function(){return Zf})),n.d(e,"WebGLRenderer",(function(){return vs})),n.d(e,"WebGLUtils",(function(){return ds})),n.d(e,"WireframeGeometry",(function(){return xc})),n.d(e,"WireframeHelper",(function(){return Xf})),n.d(e,"WrapAroundEnding",(function(){return Re})),n.d(e,"XHRLoader",(function(){return Yf})),n.d(e,"ZeroCurvatureEnding",(function(){return ke})),n.d(e,"ZeroFactor",(function(){return N})),n.d(e,"ZeroSlopeEnding",(function(){return Le})),n.d(e,"ZeroStencilOp",(function(){return Ye})),n.d(e,"sRGBEncoding",(function(){return je})),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e});var r="113",i={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},o={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},a=0,s=1,c=2,l=3,u=0,d=1,h=0,f=1,p=2,m=3,g=0,v=1,y=2,b=1,x=2,_=0,w=1,S=2,M=0,E=1,T=2,A=3,C=4,P=5,O=100,k=101,L=102,R=103,I=104,N=200,D=201,z=202,j=203,F=204,B=205,U=206,H=207,V=208,G=209,W=210,$=0,q=1,X=2,Y=3,K=4,Z=5,J=6,Q=7,tt=0,et=1,nt=2,rt=0,it=1,ot=2,at=3,st=4,ct=5,lt=300,ut=301,dt=302,ht=303,ft=304,pt=305,mt=306,gt=307,vt=1e3,yt=1001,bt=1002,xt=1003,_t=1004,wt=1004,St=1005,Mt=1005,Et=1006,Tt=1007,At=1007,Ct=1008,Pt=1008,Ot=1009,kt=1010,Lt=1011,Rt=1012,It=1013,Nt=1014,Dt=1015,zt=1016,jt=1017,Ft=1018,Bt=1019,Ut=1020,Ht=1021,Vt=1022,Gt=1023,Wt=1024,$t=1025,qt=Gt,Xt=1026,Yt=1027,Kt=1028,Zt=1029,Jt=1030,Qt=1031,te=1032,ee=1033,ne=33776,re=33777,ie=33778,oe=33779,ae=35840,se=35841,ce=35842,le=35843,ue=36196,de=37808,he=37809,fe=37810,pe=37811,me=37812,ge=37813,ve=37814,ye=37815,be=37816,xe=37817,_e=37818,we=37819,Se=37820,Me=37821,Ee=2200,Te=2201,Ae=2202,Ce=2300,Pe=2301,Oe=2302,ke=2400,Le=2401,Re=2402,Ie=0,Ne=1,De=2,ze=3e3,je=3001,Fe=3007,Be=3002,Ue=3003,He=3004,Ve=3005,Ge=3006,We=3200,$e=3201,qe=0,Xe=1,Ye=0,Ke=7680,Ze=7681,Je=7682,Qe=7683,tn=34055,en=34056,nn=5386,rn=512,on=513,an=514,sn=515,cn=516,ln=517,un=518,dn=519,hn=35044,fn=35048,pn=35040,mn=35045,gn=35049,vn=35041,yn=35046,bn=35050,xn=35042;function _n(){}Object.assign(_n.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=e.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,t)}}}});for(var wn=[],Sn=0;Sn<256;Sn++)wn[Sn]=(Sn<16?"0":"")+Sn.toString(16);var Mn,En={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(wn[255&t]+wn[t>>8&255]+wn[t>>16&255]+wn[t>>24&255]+"-"+wn[255&e]+wn[e>>8&255]+"-"+wn[e>>16&15|64]+wn[e>>24&255]+"-"+wn[63&n|128]+wn[n>>8&255]+"-"+wn[n>>16&255]+wn[n>>24&255]+wn[255&r]+wn[r>>8&255]+wn[r>>16&255]+wn[r>>24&255]).toUpperCase()},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*En.DEG2RAD},radToDeg:function(t){return t*En.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,r,i){var o=Math.cos,a=Math.sin,s=o(n/2),c=a(n/2),l=o((e+r)/2),u=a((e+r)/2),d=o((e-r)/2),h=a((e-r)/2),f=o((r-e)/2),p=a((r-e)/2);"XYX"===i?t.set(s*u,c*d,c*h,s*l):"YZY"===i?t.set(c*h,s*u,c*d,s*l):"ZXZ"===i?t.set(c*d,c*h,s*u,s*l):"XZX"===i?t.set(s*u,c*p,c*f,s*l):"YXY"===i?t.set(c*f,s*u,c*p,s*l):"ZYZ"===i?t.set(c*p,c*f,s*u,s*l):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};function Tn(t,e){this.x=t||0,this.y=e||0}function An(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(Tn.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(Tn.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,o=this.y-t.y;return this.x=i*n-o*r+t.x,this.y=i*r+o*n+t.y,this}}),Object.assign(An.prototype,{isMatrix3:!0,set:function(t,e,n,r,i,o,a,s,c){var l=this.elements;return l[0]=t,l[1]=r,l[2]=a,l[3]=e,l[4]=i,l[5]=s,l[6]=n,l[7]=o,l[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[3],s=n[6],c=n[1],l=n[4],u=n[7],d=n[2],h=n[5],f=n[8],p=r[0],m=r[3],g=r[6],v=r[1],y=r[4],b=r[7],x=r[2],_=r[5],w=r[8];return i[0]=o*p+a*v+s*x,i[3]=o*m+a*y+s*_,i[6]=o*g+a*b+s*w,i[1]=c*p+l*v+u*x,i[4]=c*m+l*y+u*_,i[7]=c*g+l*b+u*w,i[2]=d*p+h*v+f*x,i[5]=d*m+h*y+f*_,i[8]=d*g+h*b+f*w,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],c=t[7],l=t[8];return e*o*l-e*a*c-n*i*l+n*a*s+r*i*c-r*o*s},getInverse:function(t,e){t&&t.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var n=t.elements,r=this.elements,i=n[0],o=n[1],a=n[2],s=n[3],c=n[4],l=n[5],u=n[6],d=n[7],h=n[8],f=h*c-l*d,p=l*u-h*s,m=d*s-c*u,g=i*f+o*p+a*m;if(0===g){var v="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(v);return console.warn(v),this.identity()}var y=1/g;return r[0]=f*y,r[1]=(a*d-h*o)*y,r[2]=(l*o-a*c)*y,r[3]=p*y,r[4]=(h*i-a*u)*y,r[5]=(a*s-l*i)*y,r[6]=m*y,r[7]=(o*u-d*i)*y,r[8]=(c*i-o*s)*y,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,n,r,i,o,a){var s=Math.cos(i),c=Math.sin(i);this.set(n*s,n*c,-n*(s*o+c*a)+o+t,-r*c,r*s,-r*(-c*o+s*a)+a+e,0,0,1)},scale:function(t,e){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=this.elements,i=r[0],o=r[3],a=r[6],s=r[1],c=r[4],l=r[7];return r[0]=e*i+n*s,r[3]=e*o+n*c,r[6]=e*a+n*l,r[1]=-n*i+e*s,r[4]=-n*o+e*c,r[7]=-n*a+e*l,this},translate:function(t,e){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<9;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}});var Cn={getDataURL:function(t){var e;if("undefined"==typeof HTMLCanvasElement)return t.src;if(t instanceof HTMLCanvasElement)e=t;else{void 0===Mn&&(Mn=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Mn.width=t.width,Mn.height=t.height;var n=Mn.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=Mn}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}},Pn=0;function On(t,e,n,r,i,o,a,s,c,l){Object.defineProperty(this,"id",{value:Pn++}),this.uuid=En.generateUUID(),this.name="",this.image=void 0!==t?t:On.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:On.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:yt,this.wrapT=void 0!==r?r:yt,this.magFilter=void 0!==i?i:Et,this.minFilter=void 0!==o?o:Ct,this.anisotropy=void 0!==c?c:1,this.format=void 0!==a?a:Gt,this.internalFormat=null,this.type=void 0!==s?s:Ot,this.offset=new Tn(0,0),this.repeat=new Tn(1,1),this.center=new Tn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new An,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==l?l:ze,this.version=0,this.onUpdate=null}function kn(t,e,n,r){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==r?r:1}function Ln(t,e,n){this.width=t,this.height=e,this.scissor=new kn(0,0,t,e),this.scissorTest=!1,this.viewport=new kn(0,0,t,e),n=n||{},this.texture=new On(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=e,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:Et,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function Rn(t,e,n){Ln.call(this,t,e,n),this.samples=4}function In(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==r?r:1}On.DEFAULT_IMAGE=void 0,On.DEFAULT_MAPPING=lt,On.prototype=Object.assign(Object.create(_n.prototype),{constructor:On,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=En.generateUUID()),!e&&void 0===t.images[r.uuid]){var i;if(Array.isArray(r)){i=[];for(var o=0,a=r.length;o<a;o++)i.push(Cn.getDataURL(r[o]))}else i=Cn.getDataURL(r);t.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return e||(t.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping!==lt)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case vt:t.x=t.x-Math.floor(t.x);break;case yt:t.x=t.x<0?0:1;break;case bt:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case vt:t.y=t.y-Math.floor(t.y);break;case yt:t.y=t.y<0?0:1;break;case bt:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(On.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.defineProperties(kn.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign(kn.prototype,{isVector4:!0,set:function(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*e+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*e+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*e+o[7]*n+o[11]*r+o[15]*i,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,r,i,o=t.elements,a=o[0],s=o[4],c=o[8],l=o[1],u=o[5],d=o[9],h=o[2],f=o[6],p=o[10];if(Math.abs(s-l)<.01&&Math.abs(c-h)<.01&&Math.abs(d-f)<.01){if(Math.abs(s+l)<.1&&Math.abs(c+h)<.1&&Math.abs(d+f)<.1&&Math.abs(a+u+p-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;var m=(a+1)/2,g=(u+1)/2,v=(p+1)/2,y=(s+l)/4,b=(c+h)/4,x=(d+f)/4;return m>g&&m>v?m<.01?(n=0,r=.707106781,i=.707106781):(r=y/(n=Math.sqrt(m)),i=b/n):g>v?g<.01?(n=.707106781,r=0,i=.707106781):(n=y/(r=Math.sqrt(g)),i=x/r):v<.01?(n=.707106781,r=.707106781,i=0):(n=b/(i=Math.sqrt(v)),r=x/i),this.set(n,r,i,e),this}var _=Math.sqrt((f-d)*(f-d)+(c-h)*(c-h)+(l-s)*(l-s));return Math.abs(_)<.001&&(_=1),this.x=(f-d)/_,this.y=(c-h)/_,this.z=(l-s)/_,this.w=Math.acos((a+u+p-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}}),Ln.prototype=Object.assign(Object.create(_n.prototype),{constructor:Ln,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.texture.image.width=t,this.texture.image.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Rn.prototype=Object.assign(Object.create(Ln.prototype),{constructor:Rn,isWebGLMultisampleRenderTarget:!0,copy:function(t){return Ln.prototype.copy.call(this,t),this.samples=t.samples,this}}),Object.assign(In,{slerp:function(t,e,n,r){return n.copy(t).slerp(e,r)},slerpFlat:function(t,e,n,r,i,o,a){var s=n[r+0],c=n[r+1],l=n[r+2],u=n[r+3],d=i[o+0],h=i[o+1],f=i[o+2],p=i[o+3];if(u!==p||s!==d||c!==h||l!==f){var m=1-a,g=s*d+c*h+l*f+u*p,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){var b=Math.sqrt(y),x=Math.atan2(b,g*v);m=Math.sin(m*x)/b,a=Math.sin(a*x)/b}var _=a*v;if(s=s*m+d*_,c=c*m+h*_,l=l*m+f*_,u=u*m+p*_,m===1-a){var w=1/Math.sqrt(s*s+c*c+l*l+u*u);s*=w,c*=w,l*=w,u*=w}}t[e]=s,t[e+1]=c,t[e+2]=l,t[e+3]=u}}),Object.defineProperties(In.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(In.prototype,{isQuaternion:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,r=t._y,i=t._z,o=t.order,a=Math.cos,s=Math.sin,c=a(n/2),l=a(r/2),u=a(i/2),d=s(n/2),h=s(r/2),f=s(i/2);return"XYZ"===o?(this._x=d*l*u+c*h*f,this._y=c*h*u-d*l*f,this._z=c*l*f+d*h*u,this._w=c*l*u-d*h*f):"YXZ"===o?(this._x=d*l*u+c*h*f,this._y=c*h*u-d*l*f,this._z=c*l*f-d*h*u,this._w=c*l*u+d*h*f):"ZXY"===o?(this._x=d*l*u-c*h*f,this._y=c*h*u+d*l*f,this._z=c*l*f+d*h*u,this._w=c*l*u-d*h*f):"ZYX"===o?(this._x=d*l*u-c*h*f,this._y=c*h*u+d*l*f,this._z=c*l*f-d*h*u,this._w=c*l*u+d*h*f):"YZX"===o?(this._x=d*l*u+c*h*f,this._y=c*h*u+d*l*f,this._z=c*l*f-d*h*u,this._w=c*l*u-d*h*f):"XZY"===o&&(this._x=d*l*u-c*h*f,this._y=c*h*u-d*l*f,this._z=c*l*f+d*h*u,this._w=c*l*u+d*h*f),!1!==e&&this._onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,r=n[0],i=n[4],o=n[8],a=n[1],s=n[5],c=n[9],l=n[2],u=n[6],d=n[10],h=r+s+d;return h>0?(e=.5/Math.sqrt(h+1),this._w=.25/e,this._x=(u-c)*e,this._y=(o-l)*e,this._z=(a-i)*e):r>s&&r>d?(e=2*Math.sqrt(1+r-s-d),this._w=(u-c)/e,this._x=.25*e,this._y=(i+a)/e,this._z=(o+l)/e):s>d?(e=2*Math.sqrt(1+s-r-d),this._w=(o-l)/e,this._x=(i+a)/e,this._y=.25*e,this._z=(c+u)/e):(e=2*Math.sqrt(1+d-r-s),this._w=(a-i)/e,this._x=(o+l)/e,this._y=(c+u)/e,this._z=.25*e),this._onChangeCallback(),this},setFromUnitVectors:function(t,e){var n=t.dot(e)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(En.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var n=this.angleTo(t);if(0===n)return this;var r=Math.min(1,e/n);return this.slerp(t,r),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,r=t._y,i=t._z,o=t._w,a=e._x,s=e._y,c=e._z,l=e._w;return this._x=n*l+o*a+r*c-i*s,this._y=r*l+o*s+i*a-n*c,this._z=i*l+o*c+n*s-r*a,this._w=o*l-n*a-r*s-i*c,this._onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,r=this._y,i=this._z,o=this._w,a=o*t._w+n*t._x+r*t._y+i*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;var s=1-a*a;if(s<=Number.EPSILON){var c=1-e;return this._w=c*o+e*this._w,this._x=c*n+e*this._x,this._y=c*r+e*this._y,this._z=c*i+e*this._z,this.normalize(),this._onChangeCallback(),this}var l=Math.sqrt(s),u=Math.atan2(l,a),d=Math.sin((1-e)*u)/l,h=Math.sin(e*u)/l;return this._w=o*d+this._w*h,this._x=n*d+this._x*h,this._y=r*d+this._y*h,this._z=i*d+this._z*h,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});var Nn=new zn,Dn=new In;function zn(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}Object.assign(zn.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Dn.setFromEuler(t))},applyAxisAngle:function(t,e){return this.applyQuaternion(Dn.setFromAxisAngle(t,e))},applyMatrix3:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements,o=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*o,this},applyQuaternion:function(t){var e=this.x,n=this.y,r=this.z,i=t.x,o=t.y,a=t.z,s=t.w,c=s*e+o*r-a*n,l=s*n+a*e-i*r,u=s*r+i*n-o*e,d=-i*e-o*n-a*r;return this.x=c*s+d*-i+l*-a-u*-o,this.y=l*s+d*-o+u*-i-c*-a,this.z=u*s+d*-a+c*-o-l*-i,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,r=t.y,i=t.z,o=e.x,a=e.y,s=e.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this},projectOnVector:function(t){var e=t.lengthSq();if(0===e)return this.set(0,0,0);var n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)},projectOnPlane:function(t){return Nn.copy(this).projectOnVector(t),this.sub(Nn)},reflect:function(t){return this.sub(Nn.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;var n=this.dot(t)/e;return Math.acos(En.clamp(n,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,n){var r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},setFromMatrix3Column:function(t,e){return this.fromArray(t.elements,3*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}});var jn=new zn,Fn=new Wn,Bn=new zn(0,0,0),Un=new zn(1,1,1),Hn=new zn,Vn=new zn,Gn=new zn;function Wn(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(Wn.prototype,{isMatrix4:!0,set:function(t,e,n,r,i,o,a,s,c,l,u,d,h,f,p,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=r,g[1]=i,g[5]=o,g[9]=a,g[13]=s,g[2]=c,g[6]=l,g[10]=u,g[14]=d,g[3]=h,g[7]=f,g[11]=p,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Wn).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(t){var e=this.elements,n=t.elements,r=1/jn.setFromMatrixColumn(t,0).length(),i=1/jn.setFromMatrixColumn(t,1).length(),o=1/jn.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[7]=0,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,r=t.y,i=t.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(r),c=Math.sin(r),l=Math.cos(i),u=Math.sin(i);if("XYZ"===t.order){var d=o*l,h=o*u,f=a*l,p=a*u;e[0]=s*l,e[4]=-s*u,e[8]=c,e[1]=h+f*c,e[5]=d-p*c,e[9]=-a*s,e[2]=p-d*c,e[6]=f+h*c,e[10]=o*s}else if("YXZ"===t.order){var m=s*l,g=s*u,v=c*l,y=c*u;e[0]=m+y*a,e[4]=v*a-g,e[8]=o*c,e[1]=o*u,e[5]=o*l,e[9]=-a,e[2]=g*a-v,e[6]=y+m*a,e[10]=o*s}else if("ZXY"===t.order){m=s*l,g=s*u,v=c*l,y=c*u;e[0]=m-y*a,e[4]=-o*u,e[8]=v+g*a,e[1]=g+v*a,e[5]=o*l,e[9]=y-m*a,e[2]=-o*c,e[6]=a,e[10]=o*s}else if("ZYX"===t.order){d=o*l,h=o*u,f=a*l,p=a*u;e[0]=s*l,e[4]=f*c-h,e[8]=d*c+p,e[1]=s*u,e[5]=p*c+d,e[9]=h*c-f,e[2]=-c,e[6]=a*s,e[10]=o*s}else if("YZX"===t.order){var b=o*s,x=o*c,_=a*s,w=a*c;e[0]=s*l,e[4]=w-b*u,e[8]=_*u+x,e[1]=u,e[5]=o*l,e[9]=-a*l,e[2]=-c*l,e[6]=x*u+_,e[10]=b-w*u}else if("XZY"===t.order){b=o*s,x=o*c,_=a*s,w=a*c;e[0]=s*l,e[4]=-u,e[8]=c*l,e[1]=b*u+w,e[5]=o*l,e[9]=x*u-_,e[2]=_*u-x,e[6]=a*l,e[10]=w*u+b}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(Bn,t,Un)},lookAt:function(t,e,n){var r=this.elements;return Gn.subVectors(t,e),0===Gn.lengthSq()&&(Gn.z=1),Gn.normalize(),Hn.crossVectors(n,Gn),0===Hn.lengthSq()&&(1===Math.abs(n.z)?Gn.x+=1e-4:Gn.z+=1e-4,Gn.normalize(),Hn.crossVectors(n,Gn)),Hn.normalize(),Vn.crossVectors(Gn,Hn),r[0]=Hn.x,r[4]=Vn.x,r[8]=Gn.x,r[1]=Hn.y,r[5]=Vn.y,r[9]=Gn.y,r[2]=Hn.z,r[6]=Vn.z,r[10]=Gn.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[4],s=n[8],c=n[12],l=n[1],u=n[5],d=n[9],h=n[13],f=n[2],p=n[6],m=n[10],g=n[14],v=n[3],y=n[7],b=n[11],x=n[15],_=r[0],w=r[4],S=r[8],M=r[12],E=r[1],T=r[5],A=r[9],C=r[13],P=r[2],O=r[6],k=r[10],L=r[14],R=r[3],I=r[7],N=r[11],D=r[15];return i[0]=o*_+a*E+s*P+c*R,i[4]=o*w+a*T+s*O+c*I,i[8]=o*S+a*A+s*k+c*N,i[12]=o*M+a*C+s*L+c*D,i[1]=l*_+u*E+d*P+h*R,i[5]=l*w+u*T+d*O+h*I,i[9]=l*S+u*A+d*k+h*N,i[13]=l*M+u*C+d*L+h*D,i[2]=f*_+p*E+m*P+g*R,i[6]=f*w+p*T+m*O+g*I,i[10]=f*S+p*A+m*k+g*N,i[14]=f*M+p*C+m*L+g*D,i[3]=v*_+y*E+b*P+x*R,i[7]=v*w+y*T+b*O+x*I,i[11]=v*S+y*A+b*k+x*N,i[15]=v*M+y*C+b*L+x*D,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],o=t[1],a=t[5],s=t[9],c=t[13],l=t[2],u=t[6],d=t[10],h=t[14];return t[3]*(+i*s*u-r*c*u-i*a*d+n*c*d+r*a*h-n*s*h)+t[7]*(+e*s*h-e*c*d+i*o*d-r*o*h+r*c*l-i*s*l)+t[11]*(+e*c*u-e*a*h-i*o*u+n*o*h+i*a*l-n*c*l)+t[15]*(-r*a*l-e*s*u+e*a*d+r*o*u-n*o*d+n*s*l)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t,e,n){var r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this},getInverse:function(t,e){var n=this.elements,r=t.elements,i=r[0],o=r[1],a=r[2],s=r[3],c=r[4],l=r[5],u=r[6],d=r[7],h=r[8],f=r[9],p=r[10],m=r[11],g=r[12],v=r[13],y=r[14],b=r[15],x=f*y*d-v*p*d+v*u*m-l*y*m-f*u*b+l*p*b,_=g*p*d-h*y*d-g*u*m+c*y*m+h*u*b-c*p*b,w=h*v*d-g*f*d+g*l*m-c*v*m-h*l*b+c*f*b,S=g*f*u-h*v*u-g*l*p+c*v*p+h*l*y-c*f*y,M=i*x+o*_+a*w+s*S;if(0===M){var E="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(E);return console.warn(E),this.identity()}var T=1/M;return n[0]=x*T,n[1]=(v*p*s-f*y*s-v*a*m+o*y*m+f*a*b-o*p*b)*T,n[2]=(l*y*s-v*u*s+v*a*d-o*y*d-l*a*b+o*u*b)*T,n[3]=(f*u*s-l*p*s-f*a*d+o*p*d+l*a*m-o*u*m)*T,n[4]=_*T,n[5]=(h*y*s-g*p*s+g*a*m-i*y*m-h*a*b+i*p*b)*T,n[6]=(g*u*s-c*y*s-g*a*d+i*y*d+c*a*b-i*u*b)*T,n[7]=(c*p*s-h*u*s+h*a*d-i*p*d-c*a*m+i*u*m)*T,n[8]=w*T,n[9]=(g*f*s-h*v*s-g*o*m+i*v*m+h*o*b-i*f*b)*T,n[10]=(c*v*s-g*l*s+g*o*d-i*v*d-c*o*b+i*l*b)*T,n[11]=(h*l*s-c*f*s-h*o*d+i*f*d+c*o*m-i*l*m)*T,n[12]=S*T,n[13]=(h*v*a-g*f*a+g*o*p-i*v*p-h*o*y+i*f*y)*T,n[14]=(g*l*a-c*v*a-g*o*u+i*v*u+c*o*y-i*l*y)*T,n[15]=(c*f*a-h*l*a+h*o*u-i*f*u-c*o*p+i*l*p)*T,this},scale:function(t){var e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=1-n,o=t.x,a=t.y,s=t.z,c=i*o,l=i*a;return this.set(c*o+n,c*a-r*s,c*s+r*a,0,c*a+r*s,l*a+n,l*s-r*o,0,c*s-r*a,l*s+r*o,i*s*s+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){var r=this.elements,i=e._x,o=e._y,a=e._z,s=e._w,c=i+i,l=o+o,u=a+a,d=i*c,h=i*l,f=i*u,p=o*l,m=o*u,g=a*u,v=s*c,y=s*l,b=s*u,x=n.x,_=n.y,w=n.z;return r[0]=(1-(p+g))*x,r[1]=(h+b)*x,r[2]=(f-y)*x,r[3]=0,r[4]=(h-b)*_,r[5]=(1-(d+g))*_,r[6]=(m+v)*_,r[7]=0,r[8]=(f+y)*w,r[9]=(m-v)*w,r[10]=(1-(d+p))*w,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this},decompose:function(t,e,n){var r=this.elements,i=jn.set(r[0],r[1],r[2]).length(),o=jn.set(r[4],r[5],r[6]).length(),a=jn.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),t.x=r[12],t.y=r[13],t.z=r[14],Fn.copy(this);var s=1/i,c=1/o,l=1/a;return Fn.elements[0]*=s,Fn.elements[1]*=s,Fn.elements[2]*=s,Fn.elements[4]*=c,Fn.elements[5]*=c,Fn.elements[6]*=c,Fn.elements[8]*=l,Fn.elements[9]*=l,Fn.elements[10]*=l,e.setFromRotationMatrix(Fn),n.x=i,n.y=o,n.z=a,this},makePerspective:function(t,e,n,r,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*i/(e-t),c=2*i/(n-r),l=(e+t)/(e-t),u=(n+r)/(n-r),d=-(o+i)/(o-i),h=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=l,a[12]=0,a[1]=0,a[5]=c,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=h,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(t,e,n,r,i,o){var a=this.elements,s=1/(e-t),c=1/(n-r),l=1/(o-i),u=(e+t)*s,d=(n+r)*c,h=(o+i)*l;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=-2*l,a[14]=-h,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}});var $n=new Wn,qn=new In;function Xn(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._order=r||Xn.DefaultOrder}function Yn(){this.mask=1}Xn.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Xn.DefaultOrder="XYZ",Object.defineProperties(Xn.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Object.assign(Xn.prototype,{isEuler:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._order=r||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var r=En.clamp,i=t.elements,o=i[0],a=i[4],s=i[8],c=i[1],l=i[5],u=i[9],d=i[2],h=i[6],f=i[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-u,f),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(h,l),this._z=0)):"YXZ"===e?(this._x=Math.asin(-r(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(s,f),this._z=Math.atan2(c,l)):(this._y=Math.atan2(-d,o),this._z=0)):"ZXY"===e?(this._x=Math.asin(r(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-d,f),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(c,o))):"ZYX"===e?(this._y=Math.asin(-r(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(h,f),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,l))):"YZX"===e?(this._z=Math.asin(r(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-u,l),this._y=Math.atan2(-d,o)):(this._x=0,this._y=Math.atan2(s,f))):"XZY"===e?(this._z=Math.asin(-r(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-u,f),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==n&&this._onChangeCallback(),this},setFromQuaternion:function(t,e,n){return $n.makeRotationFromQuaternion(t),this.setFromRotationMatrix($n,e,n)},setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(t){return qn.setFromEuler(this),this.setFromQuaternion(qn,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new zn(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),Object.assign(Yn.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return 0!=(this.mask&t.mask)}});var Kn=0,Zn=new zn,Jn=new In,Qn=new Wn,tr=new zn,er=new zn,nr=new zn,rr=new In,ir=new zn(1,0,0),or=new zn(0,1,0),ar=new zn(0,0,1),sr={type:"added"},cr={type:"removed"};function lr(){Object.defineProperty(this,"id",{value:Kn++}),this.uuid=En.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=lr.DefaultUp.clone();var t=new zn,e=new Xn,n=new In,r=new zn(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Wn},normalMatrix:{value:new An}}),this.matrix=new Wn,this.matrixWorld=new Wn,this.matrixAutoUpdate=lr.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Yn,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function ur(){lr.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}lr.DefaultUp=new zn(0,1,0),lr.DefaultMatrixAutoUpdate=!0,lr.prototype=Object.assign(Object.create(_n.prototype),{constructor:lr,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return Jn.setFromAxisAngle(t,e),this.quaternion.multiply(Jn),this},rotateOnWorldAxis:function(t,e){return Jn.setFromAxisAngle(t,e),this.quaternion.premultiply(Jn),this},rotateX:function(t){return this.rotateOnAxis(ir,t)},rotateY:function(t){return this.rotateOnAxis(or,t)},rotateZ:function(t){return this.rotateOnAxis(ar,t)},translateOnAxis:function(t,e){return Zn.copy(t).applyQuaternion(this.quaternion),this.position.add(Zn.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(ir,t)},translateY:function(t){return this.translateOnAxis(or,t)},translateZ:function(t){return this.translateOnAxis(ar,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(Qn.getInverse(this.matrixWorld))},lookAt:function(t,e,n){t.isVector3?tr.copy(t):tr.set(t,e,n);var r=this.parent;this.updateWorldMatrix(!0,!1),er.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Qn.lookAt(er,tr,this.up):Qn.lookAt(tr,er,this.up),this.quaternion.setFromRotationMatrix(Qn),r&&(Qn.extractRotation(r.matrixWorld),Jn.setFromRotationMatrix(Qn),this.quaternion.premultiply(Jn.inverse()))},add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(sr)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var n=this.children.indexOf(t);return-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(cr)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),Qn.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Qn.multiply(t.parent.matrixWorld)),t.applyMatrix4(Qn),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new zn),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new In),this.updateMatrixWorld(!0),this.matrixWorld.decompose(er,t,nr),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new zn),this.updateMatrixWorld(!0),this.matrixWorld.decompose(er,rr,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new zn),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){var n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(var r=this.children,i=0,o=r.length;i<o;i++)r[i].updateWorldMatrix(!1,!0)},toJSON:function(t){var e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){r.geometry=i(t.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var a=o.shapes;if(Array.isArray(a))for(var s=0,c=a.length;s<c;s++){var l=a[s];i(t.shapes,l)}else i(t.shapes,a)}}if(void 0!==this.material)if(Array.isArray(this.material)){var u=[];for(s=0,c=this.material.length;s<c;s++)u.push(i(t.materials,this.material[s]));r.material=u}else r.material=i(t.materials,this.material);if(this.children.length>0){r.children=[];for(s=0;s<this.children.length;s++)r.children.push(this.children[s].toJSON(t).object)}if(e){var d=m(t.geometries),h=m(t.materials),f=m(t.textures),p=m(t.images);a=m(t.shapes);d.length>0&&(n.geometries=d),h.length>0&&(n.materials=h),f.length>0&&(n.textures=f),p.length>0&&(n.images=p),a.length>0&&(n.shapes=a)}return n.object=r,n;function m(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++){var r=t.children[n];this.add(r.clone())}return this}}),ur.prototype=Object.assign(Object.create(lr.prototype),{constructor:ur,isScene:!0,copy:function(t,e){return lr.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=lr.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.environment&&(e.object.environment=this.environment.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},dispose:function(){this.dispatchEvent({type:"dispose"})}});var dr=[new zn,new zn,new zn,new zn,new zn,new zn,new zn,new zn],hr=new zn,fr=new Mr,pr=new zn,mr=new zn,gr=new zn,vr=new zn,yr=new zn,br=new zn,xr=new zn,_r=new zn,wr=new zn,Sr=new zn;function Mr(t,e){this.min=void 0!==t?t:new zn(1/0,1/0,1/0),this.max=void 0!==e?e:new zn(-1/0,-1/0,-1/0)}function Er(t,e,n,r,i){var o,a;for(o=0,a=t.length-3;o<=a;o+=3){Sr.fromArray(t,o);var s=i.x*Math.abs(Sr.x)+i.y*Math.abs(Sr.y)+i.z*Math.abs(Sr.z),c=e.dot(Sr),l=n.dot(Sr),u=r.dot(Sr);if(Math.max(-Math.max(c,l,u),Math.min(c,l,u))>s)return!1}return!0}Object.assign(Mr.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,c=t.length;s<c;s+=3){var l=t[s],u=t[s+1],d=t[s+2];l<e&&(e=l),u<n&&(n=u),d<r&&(r=d),l>i&&(i=l),u>o&&(o=u),d>a&&(a=d)}return this.min.set(e,n,r),this.max.set(i,o,a),this},setFromBufferAttribute:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,c=t.count;s<c;s++){var l=t.getX(s),u=t.getY(s),d=t.getZ(s);l<e&&(e=l),u<n&&(n=u),d<r&&(r=d),l>i&&(i=l),u>o&&(o=u),d>a&&(a=d)}return this.min.set(e,n,r),this.max.set(i,o,a),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){var n=hr.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new zn),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new zn),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);var e=t.geometry;void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),fr.copy(e.boundingBox),fr.applyMatrix4(t.matrixWorld),this.expandByPoint(fr.min),this.expandByPoint(fr.max));for(var n=t.children,r=0,i=n.length;r<i;r++)this.expandByObject(n[r]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new zn),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,hr),hr.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){var e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant},intersectsTriangle:function(t){if(this.isEmpty())return!1;this.getCenter(xr),_r.subVectors(this.max,xr),pr.subVectors(t.a,xr),mr.subVectors(t.b,xr),gr.subVectors(t.c,xr),vr.subVectors(mr,pr),yr.subVectors(gr,mr),br.subVectors(pr,gr);var e=[0,-vr.z,vr.y,0,-yr.z,yr.y,0,-br.z,br.y,vr.z,0,-vr.x,yr.z,0,-yr.x,br.z,0,-br.x,-vr.y,vr.x,0,-yr.y,yr.x,0,-br.y,br.x,0];return!!Er(e,pr,mr,gr,_r)&&(!!Er(e=[1,0,0,0,1,0,0,0,1],pr,mr,gr,_r)&&(wr.crossVectors(vr,yr),Er(e=[wr.x,wr.y,wr.z],pr,mr,gr,_r)))},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new zn),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return hr.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(hr).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()||(dr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),dr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),dr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),dr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),dr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),dr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),dr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),dr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(dr)),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var Tr=new Mr;function Ar(t,e){this.center=void 0!==t?t:new zn,this.radius=void 0!==e?e:0}Object.assign(Ar.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(t,e){var n=this.center;void 0!==e?n.copy(e):Tr.setFromPoints(t).getCenter(n);for(var r=0,i=0,o=t.length;i<o;i++)r=Math.max(r,n.distanceToSquared(t[i]));return this.radius=Math.sqrt(r),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var n=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new zn),e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new Mr),t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}});var Cr=new zn,Pr=new zn,Or=new zn,kr=new zn,Lr=new zn,Rr=new zn,Ir=new zn;function Nr(t,e){this.origin=void 0!==t?t:new zn,this.direction=void 0!==e?e:new zn(0,0,-1)}Object.assign(Nr.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return void 0===e&&(console.warn("THREE.Ray: .at() target is now required"),e=new zn),e.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,Cr)),this},closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new zn),e.subVectors(t,this.origin);var n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){var e=Cr.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Cr.copy(this.direction).multiplyScalar(e).add(this.origin),Cr.distanceToSquared(t))},distanceSqToSegment:function(t,e,n,r){Pr.copy(t).add(e).multiplyScalar(.5),Or.copy(e).sub(t).normalize(),kr.copy(this.origin).sub(Pr);var i,o,a,s,c=.5*t.distanceTo(e),l=-this.direction.dot(Or),u=kr.dot(this.direction),d=-kr.dot(Or),h=kr.lengthSq(),f=Math.abs(1-l*l);if(f>0)if(o=l*u-d,s=c*f,(i=l*d-u)>=0)if(o>=-s)if(o<=s){var p=1/f;a=(i*=p)*(i+l*(o*=p)+2*u)+o*(l*i+o+2*d)+h}else o=c,a=-(i=Math.max(0,-(l*o+u)))*i+o*(o+2*d)+h;else o=-c,a=-(i=Math.max(0,-(l*o+u)))*i+o*(o+2*d)+h;else o<=-s?a=-(i=Math.max(0,-(-l*c+u)))*i+(o=i>0?-c:Math.min(Math.max(-c,-d),c))*(o+2*d)+h:o<=s?(i=0,a=(o=Math.min(Math.max(-c,-d),c))*(o+2*d)+h):a=-(i=Math.max(0,-(l*c+u)))*i+(o=i>0?c:Math.min(Math.max(-c,-d),c))*(o+2*d)+h;else o=l>0?-c:c,a=-(i=Math.max(0,-(l*o+u)))*i+o*(o+2*d)+h;return n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(Or).multiplyScalar(o).add(Pr),a},intersectSphere:function(t,e){Cr.subVectors(t.center,this.origin);var n=Cr.dot(this.direction),r=Cr.dot(Cr)-n*n,i=t.radius*t.radius;if(r>i)return null;var o=Math.sqrt(i-r),a=n-o,s=n+o;return a<0&&s<0?null:a<0?this.at(s,e):this.at(a,e)},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null},intersectPlane:function(t,e){var n=this.distanceToPlane(t);return null===n?null:this.at(n,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var n,r,i,o,a,s,c=1/this.direction.x,l=1/this.direction.y,u=1/this.direction.z,d=this.origin;return c>=0?(n=(t.min.x-d.x)*c,r=(t.max.x-d.x)*c):(n=(t.max.x-d.x)*c,r=(t.min.x-d.x)*c),l>=0?(i=(t.min.y-d.y)*l,o=(t.max.y-d.y)*l):(i=(t.max.y-d.y)*l,o=(t.min.y-d.y)*l),n>o||i>r?null:((i>n||n!=n)&&(n=i),(o<r||r!=r)&&(r=o),u>=0?(a=(t.min.z-d.z)*u,s=(t.max.z-d.z)*u):(a=(t.max.z-d.z)*u,s=(t.min.z-d.z)*u),n>s||a>r?null:((a>n||n!=n)&&(n=a),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,e)))},intersectsBox:function(t){return null!==this.intersectBox(t,Cr)},intersectTriangle:function(t,e,n,r,i){Lr.subVectors(e,t),Rr.subVectors(n,t),Ir.crossVectors(Lr,Rr);var o,a=this.direction.dot(Ir);if(a>0){if(r)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}kr.subVectors(this.origin,t);var s=o*this.direction.dot(Rr.crossVectors(kr,Rr));if(s<0)return null;var c=o*this.direction.dot(Lr.cross(kr));if(c<0)return null;if(s+c>a)return null;var l=-o*kr.dot(Ir);return l<0?null:this.at(l/a,i)},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}});var Dr=new zn,zr=new zn,jr=new An;function Fr(t,e){this.normal=void 0!==t?t:new zn(1,0,0),this.constant=void 0!==e?e:0}Object.assign(Fr.prototype,{isPlane:!0,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(t,e,n){var r=Dr.subVectors(n,e).cross(zr.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new zn),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,e){void 0===e&&(console.warn("THREE.Plane: .intersectLine() target is now required"),e=new zn);var n=t.delta(Dr),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(t.start)?e.copy(t.start):void 0;var i=-(t.start.dot(this.normal)+this.constant)/r;return i<0||i>1?void 0:e.copy(n).multiplyScalar(i).add(t.start)},intersectsLine:function(t){var e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new zn),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,e){var n=e||jr.getNormalMatrix(t),r=this.coplanarPoint(Dr).applyMatrix4(t),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});var Br=new zn,Ur=new zn,Hr=new zn,Vr=new zn,Gr=new zn,Wr=new zn,$r=new zn,qr=new zn,Xr=new zn,Yr=new zn;function Kr(t,e,n){this.a=void 0!==t?t:new zn,this.b=void 0!==e?e:new zn,this.c=void 0!==n?n:new zn}Object.assign(Kr,{getNormal:function(t,e,n,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new zn),r.subVectors(n,e),Br.subVectors(t,e),r.cross(Br);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)},getBarycoord:function(t,e,n,r,i){Br.subVectors(r,e),Ur.subVectors(n,e),Hr.subVectors(t,e);var o=Br.dot(Br),a=Br.dot(Ur),s=Br.dot(Hr),c=Ur.dot(Ur),l=Ur.dot(Hr),u=o*c-a*a;if(void 0===i&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),i=new zn),0===u)return i.set(-2,-1,-1);var d=1/u,h=(c*s-a*l)*d,f=(o*l-a*s)*d;return i.set(1-h-f,f,h)},containsPoint:function(t,e,n,r){return Kr.getBarycoord(t,e,n,r,Vr),Vr.x>=0&&Vr.y>=0&&Vr.x+Vr.y<=1},getUV:function(t,e,n,r,i,o,a,s){return this.getBarycoord(t,e,n,r,Vr),s.set(0,0),s.addScaledVector(i,Vr.x),s.addScaledVector(o,Vr.y),s.addScaledVector(a,Vr.z),s},isFrontFacing:function(t,e,n,r){return Br.subVectors(n,e),Ur.subVectors(t,e),Br.cross(Ur).dot(r)<0}}),Object.assign(Kr.prototype,{set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return Br.subVectors(this.c,this.b),Ur.subVectors(this.a,this.b),.5*Br.cross(Ur).length()},getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new zn),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return Kr.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new Fr),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,e){return Kr.getBarycoord(t,this.a,this.b,this.c,e)},getUV:function(t,e,n,r,i){return Kr.getUV(t,this.a,this.b,this.c,e,n,r,i)},containsPoint:function(t){return Kr.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return Kr.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),e=new zn);var n,r,i=this.a,o=this.b,a=this.c;Gr.subVectors(o,i),Wr.subVectors(a,i),qr.subVectors(t,i);var s=Gr.dot(qr),c=Wr.dot(qr);if(s<=0&&c<=0)return e.copy(i);Xr.subVectors(t,o);var l=Gr.dot(Xr),u=Wr.dot(Xr);if(l>=0&&u<=l)return e.copy(o);var d=s*u-l*c;if(d<=0&&s>=0&&l<=0)return n=s/(s-l),e.copy(i).addScaledVector(Gr,n);Yr.subVectors(t,a);var h=Gr.dot(Yr),f=Wr.dot(Yr);if(f>=0&&h<=f)return e.copy(a);var p=h*c-s*f;if(p<=0&&c>=0&&f<=0)return r=c/(c-f),e.copy(i).addScaledVector(Wr,r);var m=l*f-h*u;if(m<=0&&u-l>=0&&h-f>=0)return $r.subVectors(a,o),r=(u-l)/(u-l+(h-f)),e.copy(o).addScaledVector($r,r);var g=1/(m+p+d);return n=p*g,r=d*g,e.copy(i).addScaledVector(Gr,n).addScaledVector(Wr,r)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}});var Zr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Jr={h:0,s:0,l:0},Qr={h:0,s:0,l:0};function ti(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}function ei(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function ni(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function ri(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}function ii(t,e,n,r,i,o){this.a=t,this.b=e,this.c=n,this.normal=r&&r.isVector3?r:new zn,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new ti,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==o?o:0}Object.assign(ti.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(t,e,n){if(t=En.euclideanModulo(t,1),e=En.clamp(e,0,1),n=En.clamp(n,0,1),0===e)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+e):n+e-n*e,i=2*n-r;this.r=ei(i,r,t+1/3),this.g=ei(i,r,t),this.b=ei(i,r,t-1/3)}return this},setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var r,i=n[1],o=n[2];switch(i){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,e(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,e(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,c=parseInt(r[3],10)/100;return e(r[5]),this.setHSL(a,s,c)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){var l=n[1],u=l.length;if(3===u)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,this;if(6===u)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this},setColorName:function(t){var e=Zr[t];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=ni(t.r),this.g=ni(t.g),this.b=ni(t.b),this},copyLinearToSRGB:function(t){return this.r=ri(t.r),this.g=ri(t.g),this.b=ri(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var e,n,r=this.r,i=this.g,o=this.b,a=Math.max(r,i,o),s=Math.min(r,i,o),c=(s+a)/2;if(s===a)e=0,n=0;else{var l=a-s;switch(n=c<=.5?l/(a+s):l/(2-a-s),a){case r:e=(i-o)/l+(i<o?6:0);break;case i:e=(o-r)/l+2;break;case o:e=(r-i)/l+4}e/=6}return t.h=e,t.s=n,t.l=c,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,n){return this.getHSL(Jr),Jr.h+=t,Jr.s+=e,Jr.l+=n,this.setHSL(Jr.h,Jr.s,Jr.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},lerpHSL:function(t,e){this.getHSL(Jr),t.getHSL(Qr);var n=En.lerp(Jr.h,Qr.h,e),r=En.lerp(Jr.s,Qr.s,e),i=En.lerp(Jr.l,Qr.l,e);return this.setHSL(n,r,i),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}}),ti.NAMES=Zr,Object.assign(ii.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var oi=0;function ai(){Object.defineProperty(this,"id",{value:oi++}),this.uuid=En.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=E,this.side=g,this.flatShading=!1,this.vertexTangents=!1,this.vertexColors=_,this.opacity=1,this.transparent=!1,this.blendSrc=F,this.blendDst=B,this.blendEquation=O,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Y,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=dn,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Ke,this.stencilZFail=Ke,this.stencilZPass=Ke,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function si(t){ai.call(this),this.type="MeshBasicMaterial",this.color=new ti(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=tt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(t)}ai.prototype=Object.assign(Object.create(_n.prototype),{constructor:ai,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0!==n)if("shading"!==e){var r=this[e];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===b;else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){var e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==E&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),this.side!==g&&(n.side=this.side),this.vertexColors!==_&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){var i=r(t.textures),o=r(t.images);i.length>0&&(n.textures=i),o.length>0&&(n.images=o)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexTangents=t.vertexTangents,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var e=t.clippingPlanes,n=null;if(null!==e){var r=e.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=e[i].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(ai.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),si.prototype=Object.create(ai.prototype),si.prototype.constructor=si,si.prototype.isMeshBasicMaterial=!0,si.prototype.copy=function(t){return ai.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};var ci=new zn;function li(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=hn,this.updateRange={offset:0,count:-1},this.version=0}function ui(t,e,n){li.call(this,new Int8Array(t),e,n)}function di(t,e,n){li.call(this,new Uint8Array(t),e,n)}function hi(t,e,n){li.call(this,new Uint8ClampedArray(t),e,n)}function fi(t,e,n){li.call(this,new Int16Array(t),e,n)}function pi(t,e,n){li.call(this,new Uint16Array(t),e,n)}function mi(t,e,n){li.call(this,new Int32Array(t),e,n)}function gi(t,e,n){li.call(this,new Uint32Array(t),e,n)}function vi(t,e,n){li.call(this,new Float32Array(t),e,n)}function yi(t,e,n){li.call(this,new Float64Array(t),e,n)}function bi(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function xi(t){if(0===t.length)return-1/0;for(var e=t[0],n=1,r=t.length;n<r;++n)t[n]>e&&(e=t[n]);return e}Object.defineProperty(li.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(li.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new ti),e[n++]=o.r,e[n++]=o.g,e[n++]=o.b}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new Tn),e[n++]=o.x,e[n++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new zn),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new kn),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z,e[n++]=o.w}return this},applyMatrix3:function(t){for(var e=0,n=this.count;e<n;e++)ci.x=this.getX(e),ci.y=this.getY(e),ci.z=this.getZ(e),ci.applyMatrix3(t),this.setXYZ(e,ci.x,ci.y,ci.z);return this},applyMatrix4:function(t){for(var e=0,n=this.count;e<n;e++)ci.x=this.getX(e),ci.y=this.getY(e),ci.z=this.getZ(e),ci.applyMatrix4(t),this.setXYZ(e,ci.x,ci.y,ci.z);return this},applyNormalMatrix:function(t){for(var e=0,n=this.count;e<n;e++)ci.x=this.getX(e),ci.y=this.getY(e),ci.z=this.getZ(e),ci.applyNormalMatrix(t),this.setXYZ(e,ci.x,ci.y,ci.z);return this},transformDirection:function(t){for(var e=0,n=this.count;e<n;e++)ci.x=this.getX(e),ci.y=this.getY(e),ci.z=this.getZ(e),ci.transformDirection(t),this.setXYZ(e,ci.x,ci.y,ci.z);return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),ui.prototype=Object.create(li.prototype),ui.prototype.constructor=ui,di.prototype=Object.create(li.prototype),di.prototype.constructor=di,hi.prototype=Object.create(li.prototype),hi.prototype.constructor=hi,fi.prototype=Object.create(li.prototype),fi.prototype.constructor=fi,pi.prototype=Object.create(li.prototype),pi.prototype.constructor=pi,mi.prototype=Object.create(li.prototype),mi.prototype.constructor=mi,gi.prototype=Object.create(li.prototype),gi.prototype.constructor=gi,vi.prototype=Object.create(li.prototype),vi.prototype.constructor=vi,yi.prototype=Object.create(li.prototype),yi.prototype.constructor=yi,Object.assign(bi.prototype,{computeGroups:function(t){for(var e,n=[],r=void 0,i=t.faces,o=0;o<i.length;o++){var a=i[o];a.materialIndex!==r&&(r=a.materialIndex,void 0!==e&&(e.count=3*o-e.start,n.push(e)),e={start:3*o,materialIndex:r})}void 0!==e&&(e.count=3*o-e.start,n.push(e)),this.groups=n},fromGeometry:function(t){var e,n=t.faces,r=t.vertices,i=t.faceVertexUvs,o=i[0]&&i[0].length>0,a=i[1]&&i[1].length>0,s=t.morphTargets,c=s.length;if(c>0){e=[];for(var l=0;l<c;l++)e[l]={name:s[l].name,data:[]};this.morphTargets.position=e}var u,d=t.morphNormals,h=d.length;if(h>0){u=[];for(l=0;l<h;l++)u[l]={name:d[l].name,data:[]};this.morphTargets.normal=u}var f=t.skinIndices,p=t.skinWeights,m=f.length===r.length,g=p.length===r.length;r.length>0&&0===n.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(l=0;l<n.length;l++){var v=n[l];this.vertices.push(r[v.a],r[v.b],r[v.c]);var y=v.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var b=v.normal;this.normals.push(b,b,b)}var x,_=v.vertexColors;if(3===_.length)this.colors.push(_[0],_[1],_[2]);else{var w=v.color;this.colors.push(w,w,w)}if(!0===o)void 0!==(x=i[0][l])?this.uvs.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new Tn,new Tn,new Tn));if(!0===a)void 0!==(x=i[1][l])?this.uvs2.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new Tn,new Tn,new Tn));for(var S=0;S<c;S++){var M=s[S].vertices;e[S].data.push(M[v.a],M[v.b],M[v.c])}for(S=0;S<h;S++){var E=d[S].vertexNormals[l];u[S].data.push(E.a,E.b,E.c)}m&&this.skinIndices.push(f[v.a],f[v.b],f[v.c]),g&&this.skinWeights.push(p[v.a],p[v.b],p[v.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}});var _i=1,wi=new Wn,Si=new lr,Mi=new zn,Ei=new Mr,Ti=new Mr,Ai=new zn;function Ci(){Object.defineProperty(this,"id",{value:_i+=2}),this.uuid=En.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Ci.prototype=Object.assign(Object.create(_n.prototype),{constructor:Ci,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(xi(t)>65535?gi:pi)(t,1):this.index=t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,e){return this.attributes[t]=e,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix4:function(t){var e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var r=(new An).getNormalMatrix(t);n.applyNormalMatrix(r),n.needsUpdate=!0}var i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(t),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return wi.makeRotationX(t),this.applyMatrix4(wi),this},rotateY:function(t){return wi.makeRotationY(t),this.applyMatrix4(wi),this},rotateZ:function(t){return wi.makeRotationZ(t),this.applyMatrix4(wi),this},translate:function(t,e,n){return wi.makeTranslation(t,e,n),this.applyMatrix4(wi),this},scale:function(t,e,n){return wi.makeScale(t,e,n),this.applyMatrix4(wi),this},lookAt:function(t){return Si.lookAt(t),Si.updateMatrix(),this.applyMatrix4(Si.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Mi).negate(),this.translate(Mi.x,Mi.y,Mi.z),this},setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){var n=new vi(3*e.vertices.length,3),r=new vi(3*e.colors.length,3);if(this.setAttribute("position",n.copyVector3sArray(e.vertices)),this.setAttribute("color",r.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var i=new vi(e.lineDistances.length,1);this.setAttribute("lineDistance",i.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];e.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new vi(e,3)),this},updateFromObject:function(t){var e,n=t.geometry;if(t.isMesh){var r=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(r=void 0,n.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(n);r.verticesNeedUpdate=n.verticesNeedUpdate,r.normalsNeedUpdate=n.normalsNeedUpdate,r.colorsNeedUpdate=n.colorsNeedUpdate,r.uvsNeedUpdate=n.uvsNeedUpdate,r.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=r}return!0===n.verticesNeedUpdate&&(void 0!==(e=this.attributes.position)&&(e.copyVector3sArray(n.vertices),e.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(e=this.attributes.normal)&&(e.copyVector3sArray(n.normals),e.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(e=this.attributes.color)&&(e.copyColorsArray(n.colors),e.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(e=this.attributes.uv)&&(e.copyVector2sArray(n.uvs),e.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(e=this.attributes.lineDistance)&&(e.copyArray(n.lineDistances),e.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(t.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new bi).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.setAttribute("position",new li(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var n=new Float32Array(3*t.normals.length);this.setAttribute("normal",new li(n,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var r=new Float32Array(3*t.colors.length);this.setAttribute("color",new li(r,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var i=new Float32Array(2*t.uvs.length);this.setAttribute("uv",new li(i,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var o=new Float32Array(2*t.uvs2.length);this.setAttribute("uv2",new li(o,2).copyVector2sArray(t.uvs2))}for(var a in this.groups=t.groups,t.morphTargets){for(var s=[],c=t.morphTargets[a],l=0,u=c.length;l<u;l++){var d=c[l],h=new vi(3*d.data.length,3);h.name=d.name,s.push(h.copyVector3sArray(d.data))}this.morphAttributes[a]=s}if(t.skinIndices.length>0){var f=new vi(4*t.skinIndices.length,4);this.setAttribute("skinIndex",f.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var p=new vi(4*t.skinWeights.length,4);this.setAttribute("skinWeight",p.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Mr);var t=this.attributes.position,e=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(var n=0,r=e.length;n<r;n++){var i=e[n];Ei.setFromBufferAttribute(i),this.morphTargetsRelative?(Ai.addVectors(this.boundingBox.min,Ei.min),this.boundingBox.expandByPoint(Ai),Ai.addVectors(this.boundingBox.max,Ei.max),this.boundingBox.expandByPoint(Ai)):(this.boundingBox.expandByPoint(Ei.min),this.boundingBox.expandByPoint(Ei.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Ar);var t=this.attributes.position,e=this.morphAttributes.position;if(t){var n=this.boundingSphere.center;if(Ei.setFromBufferAttribute(t),e)for(var r=0,i=e.length;r<i;r++){var o=e[r];Ti.setFromBufferAttribute(o),this.morphTargetsRelative?(Ai.addVectors(Ei.min,Ti.min),Ei.expandByPoint(Ai),Ai.addVectors(Ei.max,Ti.max),Ei.expandByPoint(Ai)):(Ei.expandByPoint(Ti.min),Ei.expandByPoint(Ti.max))}Ei.getCenter(n);var a=0;for(r=0,i=t.count;r<i;r++)Ai.fromBufferAttribute(t,r),a=Math.max(a,n.distanceToSquared(Ai));if(e)for(r=0,i=e.length;r<i;r++){o=e[r];for(var s=this.morphTargetsRelative,c=0,l=o.count;c<l;c++)Ai.fromBufferAttribute(o,c),s&&(Mi.fromBufferAttribute(t,c),Ai.add(Mi)),a=Math.max(a,n.distanceToSquared(Ai))}this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes;if(e.position){var n=e.position.array;if(void 0===e.normal)this.setAttribute("normal",new li(new Float32Array(n.length),3));else for(var r=e.normal.array,i=0,o=r.length;i<o;i++)r[i]=0;var a,s,c,l=e.normal.array,u=new zn,d=new zn,h=new zn,f=new zn,p=new zn;if(t){var m=t.array;for(i=0,o=t.count;i<o;i+=3)a=3*m[i+0],s=3*m[i+1],c=3*m[i+2],u.fromArray(n,a),d.fromArray(n,s),h.fromArray(n,c),f.subVectors(h,d),p.subVectors(u,d),f.cross(p),l[a]+=f.x,l[a+1]+=f.y,l[a+2]+=f.z,l[s]+=f.x,l[s+1]+=f.y,l[s+2]+=f.z,l[c]+=f.x,l[c+1]+=f.y,l[c+2]+=f.z}else for(i=0,o=n.length;i<o;i+=9)u.fromArray(n,i),d.fromArray(n,i+3),h.fromArray(n,i+6),f.subVectors(h,d),p.subVectors(u,d),f.cross(p),l[i]=f.x,l[i+1]=f.y,l[i+2]=f.z,l[i+3]=f.x,l[i+4]=f.y,l[i+5]=f.z,l[i+6]=f.x,l[i+7]=f.y,l[i+8]=f.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==t.attributes[r])for(var i=n[r].array,o=t.attributes[r],a=o.array,s=o.itemSize*e,c=Math.min(a.length,i.length-s),l=0,u=s;l<c;l++,u++)i[u]=a[l];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){for(var t=this.attributes.normal,e=0,n=t.count;e<n;e++)Ai.x=t.getX(e),Ai.y=t.getY(e),Ai.z=t.getZ(e),Ai.normalize(),t.setXYZ(e,Ai.x,Ai.y,Ai.z)},toNonIndexed:function(){function t(t,e){for(var n=t.array,r=t.itemSize,i=new n.constructor(e.length*r),o=0,a=0,s=0,c=e.length;s<c;s++){o=e[s]*r;for(var l=0;l<r;l++)i[a++]=n[o++]}return new li(i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new Ci,n=this.index.array,r=this.attributes;for(var i in r){var o=t(r[i],n);e.setAttribute(i,o)}var a=this.morphAttributes;for(i in a){for(var s=[],c=a[i],l=0,u=c.length;l<u;l++){o=t(c[l],n);s.push(o)}e.morphAttributes[i]=s}e.morphTargetsRelative=this.morphTargetsRelative;for(var d=this.groups,h=(l=0,d.length);l<h;l++){var f=d[l];e.addGroup(f.start,f.count,f.materialIndex)}return e},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};var r=this.index;null!==r&&(t.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(var n in i){var o=(h=i[n]).toJSON();""!==h.name&&(o.name=h.name),t.data.attributes[n]=o}var a={},s=!1;for(var n in this.morphAttributes){for(var c=this.morphAttributes[n],l=[],u=0,d=c.length;u<d;u++){var h;o=(h=c[u]).toJSON();""!==h.name&&(o.name=h.name),l.push(o)}l.length>0&&(a[n]=l,s=!0)}s&&(t.data.morphAttributes=a,t.data.morphTargetsRelative=this.morphTargetsRelative);var f=this.groups;f.length>0&&(t.data.groups=JSON.parse(JSON.stringify(f)));var p=this.boundingSphere;return null!==p&&(t.data.boundingSphere={center:p.center.toArray(),radius:p.radius}),t},clone:function(){return(new Ci).copy(this)},copy:function(t){var e,n,r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var i=t.index;null!==i&&this.setIndex(i.clone());var o=t.attributes;for(e in o){var a=o[e];this.setAttribute(e,a.clone())}var s=t.morphAttributes;for(e in s){var c=[],l=s[e];for(n=0,r=l.length;n<r;n++)c.push(l[n].clone());this.morphAttributes[e]=c}this.morphTargetsRelative=t.morphTargetsRelative;var u=t.groups;for(n=0,r=u.length;n<r;n++){var d=u[n];this.addGroup(d.start,d.count,d.materialIndex)}var h=t.boundingBox;null!==h&&(this.boundingBox=h.clone());var f=t.boundingSphere;return null!==f&&(this.boundingSphere=f.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Pi=new Wn,Oi=new Nr,ki=new Ar,Li=new zn,Ri=new zn,Ii=new zn,Ni=new zn,Di=new zn,zi=new zn,ji=new zn,Fi=new zn,Bi=new zn,Ui=new Tn,Hi=new Tn,Vi=new Tn,Gi=new zn,Wi=new zn;function $i(t,e){lr.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new Ci,this.material=void 0!==e?e:new si,this.updateMorphTargets()}function qi(t,e,n,r,i,o,a,s){if(null===(e.side===v?r.intersectTriangle(a,o,i,!0,s):r.intersectTriangle(i,o,a,e.side!==y,s)))return null;Wi.copy(s),Wi.applyMatrix4(t.matrixWorld);var c=n.ray.origin.distanceTo(Wi);return c<n.near||c>n.far?null:{distance:c,point:Wi.clone(),object:t}}function Xi(t,e,n,r,i,o,a,s,c,l,u,d){Li.fromBufferAttribute(i,l),Ri.fromBufferAttribute(i,u),Ii.fromBufferAttribute(i,d);var h=t.morphTargetInfluences;if(e.morphTargets&&o&&h){ji.set(0,0,0),Fi.set(0,0,0),Bi.set(0,0,0);for(var f=0,p=o.length;f<p;f++){var m=h[f],g=o[f];0!==m&&(Ni.fromBufferAttribute(g,l),Di.fromBufferAttribute(g,u),zi.fromBufferAttribute(g,d),a?(ji.addScaledVector(Ni,m),Fi.addScaledVector(Di,m),Bi.addScaledVector(zi,m)):(ji.addScaledVector(Ni.sub(Li),m),Fi.addScaledVector(Di.sub(Ri),m),Bi.addScaledVector(zi.sub(Ii),m)))}Li.add(ji),Ri.add(Fi),Ii.add(Bi)}var v=qi(t,e,n,r,Li,Ri,Ii,Gi);if(v){s&&(Ui.fromBufferAttribute(s,l),Hi.fromBufferAttribute(s,u),Vi.fromBufferAttribute(s,d),v.uv=Kr.getUV(Gi,Li,Ri,Ii,Ui,Hi,Vi,new Tn)),c&&(Ui.fromBufferAttribute(c,l),Hi.fromBufferAttribute(c,u),Vi.fromBufferAttribute(c,d),v.uv2=Kr.getUV(Gi,Li,Ri,Ii,Ui,Hi,Vi,new Tn));var y=new ii(l,u,d);Kr.getNormal(Li,Ri,Ii,y.normal),v.face=y}return v}$i.prototype=Object.assign(Object.create(lr.prototype),{constructor:$i,isMesh:!0,copy:function(t){return lr.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t,e,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,o=Object.keys(i);if(o.length>0){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=a.length;t<e;t++)n=a[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else{var s=r.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(t,e){var n,r=this.geometry,i=this.material,o=this.matrixWorld;if(void 0!==i&&(null===r.boundingSphere&&r.computeBoundingSphere(),ki.copy(r.boundingSphere),ki.applyMatrix4(o),!1!==t.ray.intersectsSphere(ki)&&(Pi.getInverse(o),Oi.copy(t.ray).applyMatrix4(Pi),null===r.boundingBox||!1!==Oi.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){var a,s,c,l,u,d,h,f,p,m=r.index,g=r.attributes.position,v=r.morphAttributes.position,y=r.morphTargetsRelative,b=r.attributes.uv,x=r.attributes.uv2,_=r.groups,w=r.drawRange;if(null!==m)if(Array.isArray(i))for(l=0,d=_.length;l<d;l++)for(p=i[(f=_[l]).materialIndex],u=Math.max(f.start,w.start),h=Math.min(f.start+f.count,w.start+w.count);u<h;u+=3)a=m.getX(u),s=m.getX(u+1),c=m.getX(u+2),(n=Xi(this,p,t,Oi,g,v,y,b,x,a,s,c))&&(n.faceIndex=Math.floor(u/3),n.face.materialIndex=f.materialIndex,e.push(n));else for(l=Math.max(0,w.start),d=Math.min(m.count,w.start+w.count);l<d;l+=3)a=m.getX(l),s=m.getX(l+1),c=m.getX(l+2),(n=Xi(this,i,t,Oi,g,v,y,b,x,a,s,c))&&(n.faceIndex=Math.floor(l/3),e.push(n));else if(void 0!==g)if(Array.isArray(i))for(l=0,d=_.length;l<d;l++)for(p=i[(f=_[l]).materialIndex],u=Math.max(f.start,w.start),h=Math.min(f.start+f.count,w.start+w.count);u<h;u+=3)(n=Xi(this,p,t,Oi,g,v,y,b,x,a=u,s=u+1,c=u+2))&&(n.faceIndex=Math.floor(u/3),n.face.materialIndex=f.materialIndex,e.push(n));else for(l=Math.max(0,w.start),d=Math.min(g.count,w.start+w.count);l<d;l+=3)(n=Xi(this,i,t,Oi,g,v,y,b,x,a=l,s=l+1,c=l+2))&&(n.faceIndex=Math.floor(l/3),e.push(n))}else if(r.isGeometry){var S,M,E,T,A=Array.isArray(i),C=r.vertices,P=r.faces,O=r.faceVertexUvs[0];O.length>0&&(T=O);for(var k=0,L=P.length;k<L;k++){var R=P[k],I=A?i[R.materialIndex]:i;if(void 0!==I&&(S=C[R.a],M=C[R.b],E=C[R.c],n=qi(this,I,t,Oi,S,M,E,Gi))){if(T&&T[k]){var N=T[k];Ui.copy(N[0]),Hi.copy(N[1]),Vi.copy(N[2]),n.uv=Kr.getUV(Gi,S,M,E,Ui,Hi,Vi,new Tn)}n.face=R,n.faceIndex=k,e.push(n)}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Yi=0,Ki=new Wn,Zi=new lr,Ji=new zn;function Qi(){Object.defineProperty(this,"id",{value:Yi+=2}),this.uuid=En.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}Qi.prototype=Object.assign(Object.create(_n.prototype),{constructor:Qi,isGeometry:!0,applyMatrix4:function(t){for(var e=(new An).getNormalMatrix(t),n=0,r=this.vertices.length;n<r;n++){this.vertices[n].applyMatrix4(t)}for(n=0,r=this.faces.length;n<r;n++){var i=this.faces[n];i.normal.applyMatrix3(e).normalize();for(var o=0,a=i.vertexNormals.length;o<a;o++)i.vertexNormals[o].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(t){return Ki.makeRotationX(t),this.applyMatrix4(Ki),this},rotateY:function(t){return Ki.makeRotationY(t),this.applyMatrix4(Ki),this},rotateZ:function(t){return Ki.makeRotationZ(t),this.applyMatrix4(Ki),this},translate:function(t,e,n){return Ki.makeTranslation(t,e,n),this.applyMatrix4(Ki),this},scale:function(t,e,n){return Ki.makeScale(t,e,n),this.applyMatrix4(Ki),this},lookAt:function(t){return Zi.lookAt(t),Zi.updateMatrix(),this.applyMatrix4(Zi.matrix),this},fromBufferGeometry:function(t){var e=this,n=null!==t.index?t.index.array:void 0,r=t.attributes;if(void 0===r.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var i=r.position.array,o=void 0!==r.normal?r.normal.array:void 0,a=void 0!==r.color?r.color.array:void 0,s=void 0!==r.uv?r.uv.array:void 0,c=void 0!==r.uv2?r.uv2.array:void 0;void 0!==c&&(this.faceVertexUvs[1]=[]);for(var l=0;l<i.length;l+=3)e.vertices.push((new zn).fromArray(i,l)),void 0!==a&&e.colors.push((new ti).fromArray(a,l));function u(t,n,r,i){var l=void 0===a?[]:[e.colors[t].clone(),e.colors[n].clone(),e.colors[r].clone()],u=new ii(t,n,r,void 0===o?[]:[(new zn).fromArray(o,3*t),(new zn).fromArray(o,3*n),(new zn).fromArray(o,3*r)],l,i);e.faces.push(u),void 0!==s&&e.faceVertexUvs[0].push([(new Tn).fromArray(s,2*t),(new Tn).fromArray(s,2*n),(new Tn).fromArray(s,2*r)]),void 0!==c&&e.faceVertexUvs[1].push([(new Tn).fromArray(c,2*t),(new Tn).fromArray(c,2*n),(new Tn).fromArray(c,2*r)])}var d=t.groups;if(d.length>0)for(l=0;l<d.length;l++)for(var h=d[l],f=h.start,p=f,m=f+h.count;p<m;p+=3)void 0!==n?u(n[p],n[p+1],n[p+2],h.materialIndex):u(p,p+1,p+2,h.materialIndex);else if(void 0!==n)for(l=0;l<n.length;l+=3)u(n[l],n[l+1],n[l+2]);else for(l=0;l<i.length/3;l+=3)u(l,l+1,l+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ji).negate(),this.translate(Ji.x,Ji.y,Ji.z),this},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,n=0===e?1:1/e,r=new Wn;return r.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix4(r),this},computeFaceNormals:function(){for(var t=new zn,e=new zn,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],o=this.vertices[i.a],a=this.vertices[i.b],s=this.vertices[i.c];t.subVectors(s,a),e.subVectors(o,a),t.cross(e),t.normalize(),i.normal.copy(t)}},computeVertexNormals:function(t){var e,n,r,i,o,a;for(void 0===t&&(t=!0),a=new Array(this.vertices.length),e=0,n=this.vertices.length;e<n;e++)a[e]=new zn;if(t){var s,c,l,u=new zn,d=new zn;for(r=0,i=this.faces.length;r<i;r++)o=this.faces[r],s=this.vertices[o.a],c=this.vertices[o.b],l=this.vertices[o.c],u.subVectors(l,c),d.subVectors(s,c),u.cross(d),a[o.a].add(u),a[o.b].add(u),a[o.c].add(u)}else for(this.computeFaceNormals(),r=0,i=this.faces.length;r<i;r++)a[(o=this.faces[r]).a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(e=0,n=this.vertices.length;e<n;e++)a[e].normalize();for(r=0,i=this.faces.length;r<i;r++){var h=(o=this.faces[r]).vertexNormals;3===h.length?(h[0].copy(a[o.a]),h[1].copy(a[o.b]),h[2].copy(a[o.c])):(h[0]=a[o.a].clone(),h[1]=a[o.b].clone(),h[2]=a[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e,n;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){var r=(n=this.faces[t]).vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,n,r,i;for(n=0,r=this.faces.length;n<r;n++)for((i=this.faces[n]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),t=0,e=i.vertexNormals.length;t<e;t++)i.__originalVertexNormals[t]?i.__originalVertexNormals[t].copy(i.vertexNormals[t]):i.__originalVertexNormals[t]=i.vertexNormals[t].clone();var o=new Qi;for(o.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var a=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(n=0,r=this.faces.length;n<r;n++)c=new zn,l={a:new zn,b:new zn,c:new zn},a.push(c),s.push(l)}var c,l,u=this.morphNormals[t];for(o.vertices=this.morphTargets[t].vertices,o.computeFaceNormals(),o.computeVertexNormals(),n=0,r=this.faces.length;n<r;n++)i=this.faces[n],c=u.faceNormals[n],l=u.vertexNormals[n],c.copy(i.normal),l.a.copy(i.vertexNormals[0]),l.b.copy(i.vertexNormals[1]),l.c.copy(i.vertexNormals[2])}for(n=0,r=this.faces.length;n<r;n++)(i=this.faces[n]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Mr),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Ar),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if(t&&t.isGeometry){var r,i=this.vertices.length,o=this.vertices,a=t.vertices,s=this.faces,c=t.faces,l=this.colors,u=t.colors;void 0===n&&(n=0),void 0!==e&&(r=(new An).getNormalMatrix(e));for(var d=0,h=a.length;d<h;d++){var f=a[d].clone();void 0!==e&&f.applyMatrix4(e),o.push(f)}for(d=0,h=u.length;d<h;d++)l.push(u[d].clone());for(d=0,h=c.length;d<h;d++){var p,m,g,v=c[d],y=v.vertexNormals,b=v.vertexColors;(p=new ii(v.a+i,v.b+i,v.c+i)).normal.copy(v.normal),void 0!==r&&p.normal.applyMatrix3(r).normalize();for(var x=0,_=y.length;x<_;x++)m=y[x].clone(),void 0!==r&&m.applyMatrix3(r).normalize(),p.vertexNormals.push(m);p.color.copy(v.color);for(x=0,_=b.length;x<_;x++)g=b[x],p.vertexColors.push(g.clone());p.materialIndex=v.materialIndex+n,s.push(p)}for(d=0,h=t.faceVertexUvs.length;d<h;d++){var w=t.faceVertexUvs[d];void 0===this.faceVertexUvs[d]&&(this.faceVertexUvs[d]=[]);for(x=0,_=w.length;x<_;x++){for(var S=w[x],M=[],E=0,T=S.length;E<T;E++)M.push(S[E].clone());this.faceVertexUvs[d].push(M)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){var t,e,n,r,i,o,a,s,c={},l=[],u=[],d=Math.pow(10,4);for(n=0,r=this.vertices.length;n<r;n++)t=this.vertices[n],void 0===c[e=Math.round(t.x*d)+"_"+Math.round(t.y*d)+"_"+Math.round(t.z*d)]?(c[e]=n,l.push(this.vertices[n]),u[n]=l.length-1):u[n]=u[c[e]];var h=[];for(n=0,r=this.faces.length;n<r;n++){(i=this.faces[n]).a=u[i.a],i.b=u[i.b],i.c=u[i.c],o=[i.a,i.b,i.c];for(var f=0;f<3;f++)if(o[f]===o[(f+1)%3]){h.push(n);break}}for(n=h.length-1;n>=0;n--){var p=h[n];for(this.faces.splice(p,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(p,1)}var m=this.vertices.length-l.length;return this.vertices=l,m},setFromPoints:function(t){this.vertices=[];for(var e=0,n=t.length;e<n;e++){var r=t[e];this.vertices.push(new zn(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,n=0;n<e;n++)t[n]._id=n;t.sort((function(t,e){return t.materialIndex-e.materialIndex}));var r,i,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];o&&o.length===e&&(r=[]),a&&a.length===e&&(i=[]);for(n=0;n<e;n++){var s=t[n]._id;r&&r.push(o[s]),i&&i.push(a[s])}r&&(this.faceVertexUvs[0]=r),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}for(var r=[],i=0;i<this.vertices.length;i++){var o=this.vertices[i];r.push(o.x,o.y,o.z)}var a=[],s=[],c={},l=[],u={},d=[],h={};for(i=0;i<this.faces.length;i++){var f=this.faces[i],p=void 0!==this.faceVertexUvs[0][i],m=f.normal.length()>0,g=f.vertexNormals.length>0,v=1!==f.color.r||1!==f.color.g||1!==f.color.b,y=f.vertexColors.length>0,b=0;if(b=S(b,0,0),b=S(b,1,!0),b=S(b,2,!1),b=S(b,3,p),b=S(b,4,m),b=S(b,5,g),b=S(b,6,v),b=S(b,7,y),a.push(b),a.push(f.a,f.b,f.c),a.push(f.materialIndex),p){var x=this.faceVertexUvs[0][i];a.push(T(x[0]),T(x[1]),T(x[2]))}if(m&&a.push(M(f.normal)),g){var _=f.vertexNormals;a.push(M(_[0]),M(_[1]),M(_[2]))}if(v&&a.push(E(f.color)),y){var w=f.vertexColors;a.push(E(w[0]),E(w[1]),E(w[2]))}}function S(t,e,n){return n?t|1<<e:t&~(1<<e)}function M(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==c[e]||(c[e]=s.length/3,s.push(t.x,t.y,t.z)),c[e]}function E(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==u[e]||(u[e]=l.length,l.push(t.getHex())),u[e]}function T(t){var e=t.x.toString()+t.y.toString();return void 0!==h[e]||(h[e]=d.length/2,d.push(t.x,t.y)),h[e]}return t.data={},t.data.vertices=r,t.data.normals=s,l.length>0&&(t.data.colors=l),d.length>0&&(t.data.uvs=[d]),t.data.faces=a,t},clone:function(){return(new Qi).copy(this)},copy:function(t){var e,n,r,i,o,a;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var s=t.vertices;for(e=0,n=s.length;e<n;e++)this.vertices.push(s[e].clone());var c=t.colors;for(e=0,n=c.length;e<n;e++)this.colors.push(c[e].clone());var l=t.faces;for(e=0,n=l.length;e<n;e++)this.faces.push(l[e].clone());for(e=0,n=t.faceVertexUvs.length;e<n;e++){var u=t.faceVertexUvs[e];for(void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]),r=0,i=u.length;r<i;r++){var d=u[r],h=[];for(o=0,a=d.length;o<a;o++){var f=d[o];h.push(f.clone())}this.faceVertexUvs[e].push(h)}}var p=t.morphTargets;for(e=0,n=p.length;e<n;e++){var m={};if(m.name=p[e].name,void 0!==p[e].vertices)for(m.vertices=[],r=0,i=p[e].vertices.length;r<i;r++)m.vertices.push(p[e].vertices[r].clone());if(void 0!==p[e].normals)for(m.normals=[],r=0,i=p[e].normals.length;r<i;r++)m.normals.push(p[e].normals[r].clone());this.morphTargets.push(m)}var g=t.morphNormals;for(e=0,n=g.length;e<n;e++){var v={};if(void 0!==g[e].vertexNormals)for(v.vertexNormals=[],r=0,i=g[e].vertexNormals.length;r<i;r++){var y=g[e].vertexNormals[r],b={};b.a=y.a.clone(),b.b=y.b.clone(),b.c=y.c.clone(),v.vertexNormals.push(b)}if(void 0!==g[e].faceNormals)for(v.faceNormals=[],r=0,i=g[e].faceNormals.length;r<i;r++)v.faceNormals.push(g[e].faceNormals[r].clone());this.morphNormals.push(v)}var x=t.skinWeights;for(e=0,n=x.length;e<n;e++)this.skinWeights.push(x[e].clone());var _=t.skinIndices;for(e=0,n=_.length;e<n;e++)this.skinIndices.push(_[e].clone());var w=t.lineDistances;for(e=0,n=w.length;e<n;e++)this.lineDistances.push(w[e]);var S=t.boundingBox;null!==S&&(this.boundingBox=S.clone());var M=t.boundingSphere;return null!==M&&(this.boundingSphere=M.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class to extends Qi{constructor(t,e,n,r,i,o){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o},this.fromBufferGeometry(new eo(t,e,n,r,i,o)),this.mergeVertices()}}class eo extends Ci{constructor(t,e,n,r,i,o){super(),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};var a=this;t=t||1,e=e||1,n=n||1,r=Math.floor(r)||1,i=Math.floor(i)||1,o=Math.floor(o)||1;var s=[],c=[],l=[],u=[],d=0,h=0;function f(t,e,n,r,i,o,f,p,m,g,v){var y,b,x=o/m,_=f/g,w=o/2,S=f/2,M=p/2,E=m+1,T=g+1,A=0,C=0,P=new zn;for(b=0;b<T;b++){var O=b*_-S;for(y=0;y<E;y++){var k=y*x-w;P[t]=k*r,P[e]=O*i,P[n]=M,c.push(P.x,P.y,P.z),P[t]=0,P[e]=0,P[n]=p>0?1:-1,l.push(P.x,P.y,P.z),u.push(y/m),u.push(1-b/g),A+=1}}for(b=0;b<g;b++)for(y=0;y<m;y++){var L=d+y+E*b,R=d+y+E*(b+1),I=d+(y+1)+E*(b+1),N=d+(y+1)+E*b;s.push(L,R,N),s.push(R,I,N),C+=6}a.addGroup(h,C,v),h+=C,d+=A}f("z","y","x",-1,-1,n,e,t,o,i,0),f("z","y","x",1,-1,n,e,-t,o,i,1),f("x","z","y",1,1,t,n,e,r,o,2),f("x","z","y",1,-1,t,n,-e,r,o,3),f("x","y","z",1,-1,t,e,n,r,i,4),f("x","y","z",-1,-1,t,e,-n,r,i,5),this.setIndex(s),this.setAttribute("position",new vi(c,3)),this.setAttribute("normal",new vi(l,3)),this.setAttribute("uv",new vi(u,2))}}function no(t){var e={};for(var n in t)for(var r in e[n]={},t[n]){var i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}return e}function ro(t){for(var e={},n=0;n<t.length;n++){var r=no(t[n]);for(var i in r)e[i]=r[i]}return e}var io={clone:no,merge:ro};function oo(t){ai.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function ao(){lr.call(this),this.type="Camera",this.matrixWorldInverse=new Wn,this.projectionMatrix=new Wn,this.projectionMatrixInverse=new Wn}function so(t,e,n,r){ao.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}oo.prototype=Object.create(ai.prototype),oo.prototype.constructor=oo,oo.prototype.isShaderMaterial=!0,oo.prototype.copy=function(t){return ai.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=no(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},oo.prototype.toJSON=function(t){var e=ai.prototype.toJSON.call(this,t);for(var n in e.uniforms={},this.uniforms){var r=this.uniforms[n].value;r&&r.isTexture?e.uniforms[n]={type:"t",value:r.toJSON(t).uuid}:r&&r.isColor?e.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?e.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?e.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?e.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?e.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?e.uniforms[n]={type:"m4",value:r.toArray()}:e.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;var i={};for(var o in this.extensions)!0===this.extensions[o]&&(i[o]=!0);return Object.keys(i).length>0&&(e.extensions=i),e},ao.prototype=Object.assign(Object.create(lr.prototype),{constructor:ao,isCamera:!0,copy:function(t,e){return lr.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new zn),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()},updateMatrixWorld:function(t){lr.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(t,e){lr.prototype.updateWorldMatrix.call(this,t,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),so.prototype=Object.assign(Object.create(ao.prototype),{constructor:so,isPerspectiveCamera:!0,copy:function(t,e){return ao.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*En.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*En.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*En.RAD2DEG*Math.atan(Math.tan(.5*En.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,r,i,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*En.DEG2RAD*this.fov)/this.zoom,n=2*e,r=this.aspect*n,i=-.5*r,o=this.view;if(null!==this.view&&this.view.enabled){var a=o.fullWidth,s=o.fullHeight;i+=o.offsetX*r/a,e-=o.offsetY*n/s,r*=o.width/a,n*=o.height/s}var c=this.filmOffset;0!==c&&(i+=t*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,e,e-n,t,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){var e=lr.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}});function co(t,e,n,r){lr.call(this),this.type="CubeCamera";var i=new so(90,1,t,e);i.up.set(0,-1,0),i.lookAt(new zn(1,0,0)),this.add(i);var o=new so(90,1,t,e);o.up.set(0,-1,0),o.lookAt(new zn(-1,0,0)),this.add(o);var a=new so(90,1,t,e);a.up.set(0,0,1),a.lookAt(new zn(0,1,0)),this.add(a);var s=new so(90,1,t,e);s.up.set(0,0,-1),s.lookAt(new zn(0,-1,0)),this.add(s);var c=new so(90,1,t,e);c.up.set(0,-1,0),c.lookAt(new zn(0,0,1)),this.add(c);var l=new so(90,1,t,e);l.up.set(0,-1,0),l.lookAt(new zn(0,0,-1)),this.add(l),r=r||{format:Vt,magFilter:Et,minFilter:Et},this.renderTarget=new lo(n,r),this.renderTarget.texture.name="CubeCamera",this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var n=t.getRenderTarget(),r=this.renderTarget,u=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,t.setRenderTarget(r,0),t.render(e,i),t.setRenderTarget(r,1),t.render(e,o),t.setRenderTarget(r,2),t.render(e,a),t.setRenderTarget(r,3),t.render(e,s),t.setRenderTarget(r,4),t.render(e,c),r.texture.generateMipmaps=u,t.setRenderTarget(r,5),t.render(e,l),t.setRenderTarget(n)},this.clear=function(t,e,n,r){for(var i=t.getRenderTarget(),o=this.renderTarget,a=0;a<6;a++)t.setRenderTarget(o,a),t.clear(e,n,r);t.setRenderTarget(i)}}function lo(t,e,n){Number.isInteger(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=n),Ln.call(this,t,t,e)}function uo(t,e,n,r,i,o,a,s,c,l,u,d){On.call(this,null,o,a,s,c,l,r,i,u,d),this.image={data:t||null,width:e||1,height:n||1},this.magFilter=void 0!==c?c:xt,this.minFilter=void 0!==l?l:xt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}co.prototype=Object.create(lr.prototype),co.prototype.constructor=co,lo.prototype=Object.create(Ln.prototype),lo.prototype.constructor=lo,lo.prototype.isWebGLCubeRenderTarget=!0,lo.prototype.fromEquirectangularTexture=function(t,e){this.texture.type=e.type,this.texture.format=e.format,this.texture.encoding=e.encoding;var n=new ur,r={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","\tvWorldDirection = transformDirection( position, modelMatrix );","\t#include <begin_vertex>","\t#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#define RECIPROCAL_PI 0.31830988618","#define RECIPROCAL_PI2 0.15915494","void main() {","\tvec3 direction = normalize( vWorldDirection );","\tvec2 sampleUV;","\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;","\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","\tgl_FragColor = texture2D( tEquirect, sampleUV );","}"].join("\n")},i=new oo({type:"CubemapFromEquirect",uniforms:no(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:v,blending:M});i.uniforms.tEquirect.value=e;var o=new $i(new eo(5,5,5),i);n.add(o);var a=new co(1,10,1);return a.renderTarget=this,a.renderTarget.texture.name="CubeCameraTexture",a.update(t,n),o.geometry.dispose(),o.material.dispose(),this},uo.prototype=Object.create(On.prototype),uo.prototype.constructor=uo,uo.prototype.isDataTexture=!0;var ho=new Ar,fo=new zn;function po(t,e,n,r,i,o){this.planes=[void 0!==t?t:new Fr,void 0!==e?e:new Fr,void 0!==n?n:new Fr,void 0!==r?r:new Fr,void 0!==i?i:new Fr,void 0!==o?o:new Fr]}Object.assign(po.prototype,{set:function(t,e,n,r,i,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,n=0;n<6;n++)e[n].copy(t.planes[n]);return this},setFromProjectionMatrix:function(t){var e=this.planes,n=t.elements,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],c=n[5],l=n[6],u=n[7],d=n[8],h=n[9],f=n[10],p=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return e[0].setComponents(a-r,u-s,p-d,y-m).normalize(),e[1].setComponents(a+r,u+s,p+d,y+m).normalize(),e[2].setComponents(a+i,u+c,p+h,y+g).normalize(),e[3].setComponents(a-i,u-c,p-h,y-g).normalize(),e[4].setComponents(a-o,u-l,p-f,y-v).normalize(),e[5].setComponents(a+o,u+l,p+f,y+v).normalize(),this},intersectsObject:function(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),ho.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(ho)},intersectsSprite:function(t){return ho.center.set(0,0,0),ho.radius=.7071067811865476,ho.applyMatrix4(t.matrixWorld),this.intersectsSphere(ho)},intersectsSphere:function(t){for(var e=this.planes,n=t.center,r=-t.radius,i=0;i<6;i++){if(e[i].distanceToPoint(n)<r)return!1}return!0},intersectsBox:function(t){for(var e=this.planes,n=0;n<6;n++){var r=e[n];if(fo.x=r.normal.x>0?t.max.x:t.min.x,fo.y=r.normal.y>0?t.max.y:t.min.y,fo.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(fo)<0)return!1}return!0},containsPoint:function(t){for(var e=this.planes,n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}});var mo={common:{diffuse:{value:new ti(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new An},uv2Transform:{value:new An},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Tn(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ti(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new ti(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new An}},sprite:{diffuse:{value:new ti(15658734)},opacity:{value:1},center:{value:new Tn(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new An}}};function go(){var t=null,e=!1,n=null;function r(i,o){!1!==e&&(n(i,o),t.requestAnimationFrame(r))}return{start:function(){!0!==e&&null!==n&&(t.requestAnimationFrame(r),e=!0)},stop:function(){e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function vo(t,e){var n=e.isWebGL2,r=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),r.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);var n=r.get(e);n&&(t.deleteBuffer(n.buffer),r.delete(e))},update:function(e,i){e.isInterleavedBufferAttribute&&(e=e.data);var o=r.get(e);void 0===o?r.set(e,function(e,n){var r=e.array,i=e.usage,o=t.createBuffer();t.bindBuffer(n,o),t.bufferData(n,r,i),e.onUploadCallback();var a=5126;return r instanceof Float32Array?a=5126:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?a=5123:r instanceof Int16Array?a=5122:r instanceof Uint32Array?a=5125:r instanceof Int32Array?a=5124:r instanceof Int8Array?a=5120:r instanceof Uint8Array&&(a=5121),{buffer:o,type:a,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version}}(e,i)):o.version<e.version&&(!function(e,r,i){var o=r.array,a=r.updateRange;t.bindBuffer(i,e),-1===a.count?t.bufferSubData(i,0,o):(n?t.bufferSubData(i,a.offset*o.BYTES_PER_ELEMENT,o,a.offset,a.count):t.bufferSubData(i,a.offset*o.BYTES_PER_ELEMENT,o.subarray(a.offset,a.offset+a.count)),a.count=-1)}(o.buffer,e,i),o.version=e.version)}}}function yo(t,e,n,r){Qi.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new bo(t,e,n,r)),this.mergeVertices()}function bo(t,e,n,r){Ci.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};var i,o,a=(t=t||1)/2,s=(e=e||1)/2,c=Math.floor(n)||1,l=Math.floor(r)||1,u=c+1,d=l+1,h=t/c,f=e/l,p=[],m=[],g=[],v=[];for(o=0;o<d;o++){var y=o*f-s;for(i=0;i<u;i++){var b=i*h-a;m.push(b,-y,0),g.push(0,0,1),v.push(i/c),v.push(1-o/l)}}for(o=0;o<l;o++)for(i=0;i<c;i++){var x=i+u*o,_=i+u*(o+1),w=i+1+u*(o+1),S=i+1+u*o;p.push(x,_,S),p.push(_,w,S)}this.setIndex(p),this.setAttribute("position",new vi(m,3)),this.setAttribute("normal",new vi(g,3)),this.setAttribute("uv",new vi(v,2))}yo.prototype=Object.create(Qi.prototype),yo.prototype.constructor=yo,bo.prototype=Object.create(Ci.prototype),bo.prototype.constructor=bo;var xo={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n  return m[ 2 ][ 3 ] == - 1.0;\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);\n    } else if (face == 1.0) {\n      uv = vec2(direction.x, -direction.z) / abs(direction.y);\n    } else if (face == 2.0) {\n      uv = direction.xy / abs(direction.z);\n    } else if (face == 3.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);\n    } else if (face == 4.0) {\n      uv = direction.xz / abs(direction.y);\n    } else {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);\n    }\n    return 0.5 * (uv + 1.0);\n}\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);  }\n  return mip;\n}\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\ttransformedNormal = mat3( instanceMatrix ) * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t}  else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) { \n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = saturate( clearcoat );\tmaterial.clearcoatRoughness = max( clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tdirectLight.color *= all( bvec3( pointLight.shadow, directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tdirectLight.color *= all( bvec3( spotLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectLight.color *= all( bvec3( directionalLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_normalmap_pars_fragment:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= all( bvec2( directionalLight.shadow, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= all( bvec2( spotLight.shadow, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= all( bvec2( pointLight.shadow, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},_o={basic:{uniforms:ro([mo.common,mo.specularmap,mo.envmap,mo.aomap,mo.lightmap,mo.fog]),vertexShader:xo.meshbasic_vert,fragmentShader:xo.meshbasic_frag},lambert:{uniforms:ro([mo.common,mo.specularmap,mo.envmap,mo.aomap,mo.lightmap,mo.emissivemap,mo.fog,mo.lights,{emissive:{value:new ti(0)}}]),vertexShader:xo.meshlambert_vert,fragmentShader:xo.meshlambert_frag},phong:{uniforms:ro([mo.common,mo.specularmap,mo.envmap,mo.aomap,mo.lightmap,mo.emissivemap,mo.bumpmap,mo.normalmap,mo.displacementmap,mo.fog,mo.lights,{emissive:{value:new ti(0)},specular:{value:new ti(1118481)},shininess:{value:30}}]),vertexShader:xo.meshphong_vert,fragmentShader:xo.meshphong_frag},standard:{uniforms:ro([mo.common,mo.envmap,mo.aomap,mo.lightmap,mo.emissivemap,mo.bumpmap,mo.normalmap,mo.displacementmap,mo.roughnessmap,mo.metalnessmap,mo.fog,mo.lights,{emissive:{value:new ti(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:xo.meshphysical_vert,fragmentShader:xo.meshphysical_frag},toon:{uniforms:ro([mo.common,mo.specularmap,mo.aomap,mo.lightmap,mo.emissivemap,mo.bumpmap,mo.normalmap,mo.displacementmap,mo.gradientmap,mo.fog,mo.lights,{emissive:{value:new ti(0)},specular:{value:new ti(1118481)},shininess:{value:30}}]),vertexShader:xo.meshtoon_vert,fragmentShader:xo.meshtoon_frag},matcap:{uniforms:ro([mo.common,mo.bumpmap,mo.normalmap,mo.displacementmap,mo.fog,{matcap:{value:null}}]),vertexShader:xo.meshmatcap_vert,fragmentShader:xo.meshmatcap_frag},points:{uniforms:ro([mo.points,mo.fog]),vertexShader:xo.points_vert,fragmentShader:xo.points_frag},dashed:{uniforms:ro([mo.common,mo.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:xo.linedashed_vert,fragmentShader:xo.linedashed_frag},depth:{uniforms:ro([mo.common,mo.displacementmap]),vertexShader:xo.depth_vert,fragmentShader:xo.depth_frag},normal:{uniforms:ro([mo.common,mo.bumpmap,mo.normalmap,mo.displacementmap,{opacity:{value:1}}]),vertexShader:xo.normal_vert,fragmentShader:xo.normal_frag},sprite:{uniforms:ro([mo.sprite,mo.fog]),vertexShader:xo.sprite_vert,fragmentShader:xo.sprite_frag},background:{uniforms:{uvTransform:{value:new An},t2D:{value:null}},vertexShader:xo.background_vert,fragmentShader:xo.background_frag},cube:{uniforms:ro([mo.envmap,{opacity:{value:1}}]),vertexShader:xo.cube_vert,fragmentShader:xo.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:xo.equirect_vert,fragmentShader:xo.equirect_frag},distanceRGBA:{uniforms:ro([mo.common,mo.displacementmap,{referencePosition:{value:new zn},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:xo.distanceRGBA_vert,fragmentShader:xo.distanceRGBA_frag},shadow:{uniforms:ro([mo.lights,mo.fog,{color:{value:new ti(0)},opacity:{value:1}}]),vertexShader:xo.shadow_vert,fragmentShader:xo.shadow_frag}};function wo(t,e,n,r){var i,o,a=new ti(0),s=0,c=null,l=0,u=null;function d(t,n){e.buffers.color.setClear(t.r,t.g,t.b,n,r)}return{getClearColor:function(){return a},setClearColor:function(t,e){a.set(t),d(a,s=void 0!==e?e:1)},getClearAlpha:function(){return s},setClearAlpha:function(t){d(a,s=t)},render:function(e,r,h,f){var p=r.background,m=t.xr,y=m.getSession&&m.getSession();if(y&&"additive"===y.environmentBlendMode&&(p=null),null===p?d(a,s):p&&p.isColor&&(d(p,1),f=!0),(t.autoClear||f)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),p&&(p.isCubeTexture||p.isWebGLCubeRenderTarget||p.mapping===mt)){void 0===o&&((o=new $i(new eo(1,1,1),new oo({type:"BackgroundCubeMaterial",uniforms:no(_o.cube.uniforms),vertexShader:_o.cube.vertexShader,fragmentShader:_o.cube.fragmentShader,side:v,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),o.geometry.deleteAttribute("uv"),o.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(o.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(o));var b=p.isWebGLCubeRenderTarget?p.texture:p;o.material.uniforms.envMap.value=b,o.material.uniforms.flipEnvMap.value=b.isCubeTexture?-1:1,c===p&&l===b.version&&u===t.toneMapping||(o.material.needsUpdate=!0,c=p,l=b.version,u=t.toneMapping),e.unshift(o,o.geometry,o.material,0,0,null)}else p&&p.isTexture&&(void 0===i&&((i=new $i(new bo(2,2),new oo({type:"BackgroundMaterial",uniforms:no(_o.background.uniforms),vertexShader:_o.background.vertexShader,fragmentShader:_o.background.fragmentShader,side:g,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(i.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(i)),i.material.uniforms.t2D.value=p,!0===p.matrixAutoUpdate&&p.updateMatrix(),i.material.uniforms.uvTransform.value.copy(p.matrix),c===p&&l===p.version&&u===t.toneMapping||(i.material.needsUpdate=!0,c=p,l=p.version,u=t.toneMapping),e.unshift(i,i.geometry,i.material,0,0,null))}}}function So(t,e,n,r){var i,o=r.isWebGL2;this.setMode=function(t){i=t},this.render=function(e,r){t.drawArrays(i,e,r),n.update(r,i)},this.renderInstances=function(r,a,s,c){if(0!==c){var l,u;if(o)l=t,u="drawArraysInstanced";else if(u="drawArraysInstancedANGLE",null===(l=e.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[u](i,a,s,c),n.update(s,i,c)}}}function Mo(t,e,n){var r;function i(e){if("highp"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var o="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext,a=void 0!==n.precision?n.precision:"highp",s=i(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);var c=!0===n.logarithmicDepthBuffer,l=t.getParameter(34930),u=t.getParameter(35660),d=t.getParameter(3379),h=t.getParameter(34076),f=t.getParameter(34921),p=t.getParameter(36347),m=t.getParameter(36348),g=t.getParameter(36349),v=u>0,y=o||!!e.get("OES_texture_float");return{isWebGL2:o,getMaxAnisotropy:function(){if(void 0!==r)return r;var n=e.get("EXT_texture_filter_anisotropic");return r=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:c,maxTextures:l,maxVertexTextures:u,maxTextureSize:d,maxCubemapSize:h,maxAttributes:f,maxVertexUniforms:p,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:v&&y,maxSamples:o?t.getParameter(36183):0}}function Eo(){var t=this,e=null,n=0,r=!1,i=!1,o=new Fr,a=new An,s={value:null,needsUpdate:!1};function c(){s.value!==e&&(s.value=e,s.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function l(e,n,r,i){var c=null!==e?e.length:0,l=null;if(0!==c){if(l=s.value,!0!==i||null===l){var u=r+4*c,d=n.matrixWorldInverse;a.getNormalMatrix(d),(null===l||l.length<u)&&(l=new Float32Array(u));for(var h=0,f=r;h!==c;++h,f+=4)o.copy(e[h]).applyMatrix4(d,a),o.normal.toArray(l,f),l[f+3]=o.constant}s.value=l,s.needsUpdate=!0}return t.numPlanes=c,l}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(t,i,o){var a=0!==t.length||i||0!==n||r;return r=i,e=l(t,o,0),n=t.length,a},this.beginShadows=function(){i=!0,l(null)},this.endShadows=function(){i=!1,c()},this.setState=function(t,o,a,u,d,h){if(!r||null===t||0===t.length||i&&!a)i?l(null):c();else{var f=i?0:n,p=4*f,m=d.clippingState||null;s.value=m,m=l(t,u,p,h);for(var g=0;g!==p;++g)m[g]=e[g];d.clippingState=m,this.numIntersection=o?this.numPlanes:0,this.numPlanes+=f}}}function To(t){var e={};return{get:function(n){if(void 0!==e[n])return e[n];var r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(n)}return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),e[n]=r,r}}}function Ao(t,e,n){var r=new WeakMap,i=new WeakMap;function o(t){var a=t.target,s=r.get(a);for(var c in null!==s.index&&e.remove(s.index),s.attributes)e.remove(s.attributes[c]);a.removeEventListener("dispose",o),r.delete(a);var l=i.get(s);l&&(e.remove(l),i.delete(s)),n.memory.geometries--}function a(t){var n=[],r=t.index,o=t.attributes.position,a=0;if(null!==r){var s=r.array;a=r.version;for(var c=0,l=s.length;c<l;c+=3){var u=s[c+0],d=s[c+1],h=s[c+2];n.push(u,d,d,h,h,u)}}else{s=o.array;a=o.version;for(c=0,l=s.length/3-1;c<l;c+=3){u=c+0,d=c+1,h=c+2;n.push(u,d,d,h,h,u)}}var f=new(xi(n)>65535?gi:pi)(n,1);f.version=a,e.update(f,34963);var p=i.get(t);p&&e.remove(p),i.set(t,f)}return{get:function(t,e){var i=r.get(e);return i||(e.addEventListener("dispose",o),e.isBufferGeometry?i=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new Ci).setFromObject(t)),i=e._bufferGeometry),r.set(e,i),n.memory.geometries++,i)},update:function(t){var n=t.index,r=t.attributes;for(var i in null!==n&&e.update(n,34963),r)e.update(r[i],34962);var o=t.morphAttributes;for(var i in o)for(var a=o[i],s=0,c=a.length;s<c;s++)e.update(a[s],34962)},getWireframeAttribute:function(t){var e=i.get(t);if(e){var n=t.index;null!==n&&e.version<n.version&&a(t)}else a(t);return i.get(t)}}}function Co(t,e,n,r){var i,o,a,s=r.isWebGL2;this.setMode=function(t){i=t},this.setIndex=function(t){o=t.type,a=t.bytesPerElement},this.render=function(e,r){t.drawElements(i,r,o,e*a),n.update(r,i)},this.renderInstances=function(r,c,l,u){if(0!==u){var d,h;if(s)d=t,h="drawElementsInstanced";else if(h="drawElementsInstancedANGLE",null===(d=e.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");d[h](i,l,o,c*a,u),n.update(l,i,u)}}}function Po(t){var e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,n,r){switch(r=r||1,e.calls++,n){case 4:e.triangles+=r*(t/3);break;case 1:e.lines+=r*(t/2);break;case 3:e.lines+=r*(t-1);break;case 2:e.lines+=r*t;break;case 0:e.points+=r*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function Oo(t,e){return Math.abs(e[1])-Math.abs(t[1])}function ko(t){var e={},n=new Float32Array(8);return{update:function(r,i,o,a){var s=r.morphTargetInfluences,c=void 0===s?0:s.length,l=e[i.id];if(void 0===l){l=[];for(var u=0;u<c;u++)l[u]=[u,0];e[i.id]=l}var d=o.morphTargets&&i.morphAttributes.position,h=o.morphNormals&&i.morphAttributes.normal;for(u=0;u<c;u++){0!==(p=l[u])[1]&&(d&&i.deleteAttribute("morphTarget"+u),h&&i.deleteAttribute("morphNormal"+u))}for(u=0;u<c;u++){(p=l[u])[0]=u,p[1]=s[u]}l.sort(Oo);var f=0;for(u=0;u<8;u++){var p;if(p=l[u]){var m=p[0],g=p[1];if(g){d&&i.setAttribute("morphTarget"+u,d[m]),h&&i.setAttribute("morphNormal"+u,h[m]),n[u]=g,f+=g;continue}}n[u]=0}var v=i.morphTargetsRelative?1:1-f;a.getUniforms().setValue(t,"morphTargetBaseInfluence",v),a.getUniforms().setValue(t,"morphTargetInfluences",n)}}}function Lo(t,e,n,r){var i={};return{update:function(t){var o=r.render.frame,a=t.geometry,s=e.get(t,a);return i[s.id]!==o&&(a.isGeometry&&s.updateFromObject(t),e.update(s),i[s.id]=o),t.isInstancedMesh&&n.update(t.instanceMatrix,34962),s},dispose:function(){i={}}}}function Ro(t,e,n,r,i,o,a,s,c,l){t=void 0!==t?t:[],e=void 0!==e?e:ut,a=void 0!==a?a:Vt,On.call(this,t,e,n,r,i,o,a,s,c,l),this.flipY=!1}function Io(t,e,n,r){On.call(this,null),this.image={data:t||null,width:e||1,height:n||1,depth:r||1},this.magFilter=xt,this.minFilter=xt,this.wrapR=yt,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function No(t,e,n,r){On.call(this,null),this.image={data:t||null,width:e||1,height:n||1,depth:r||1},this.magFilter=xt,this.minFilter=xt,this.wrapR=yt,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}_o.physical={uniforms:ro([_o.standard.uniforms,{transparency:{value:0},clearcoat:{value:0},clearcoatRoughness:{value:0},sheen:{value:new ti(0)},clearcoatNormalScale:{value:new Tn(1,1)},clearcoatNormalMap:{value:null}}]),vertexShader:xo.meshphysical_vert,fragmentShader:xo.meshphysical_frag},Ro.prototype=Object.create(On.prototype),Ro.prototype.constructor=Ro,Ro.prototype.isCubeTexture=!0,Object.defineProperty(Ro.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),Io.prototype=Object.create(On.prototype),Io.prototype.constructor=Io,Io.prototype.isDataTexture2DArray=!0,No.prototype=Object.create(On.prototype),No.prototype.constructor=No,No.prototype.isDataTexture3D=!0;var Do=new On,zo=new Io,jo=new No,Fo=new Ro,Bo=[],Uo=[],Ho=new Float32Array(16),Vo=new Float32Array(9),Go=new Float32Array(4);function Wo(t,e,n){var r=t[0];if(r<=0||r>0)return t;var i=e*n,o=Bo[i];if(void 0===o&&(o=new Float32Array(i),Bo[i]=o),0!==e){r.toArray(o,0);for(var a=1,s=0;a!==e;++a)s+=n,t[a].toArray(o,s)}return o}function $o(t,e){if(t.length!==e.length)return!1;for(var n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function qo(t,e){for(var n=0,r=e.length;n<r;n++)t[n]=e[n]}function Xo(t,e){var n=Uo[e];void 0===n&&(n=new Int32Array(e),Uo[e]=n);for(var r=0;r!==e;++r)n[r]=t.allocateTextureUnit();return n}function Yo(t,e){var n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function Ko(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if($o(n,e))return;t.uniform2fv(this.addr,e),qo(n,e)}}function Zo(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if($o(n,e))return;t.uniform3fv(this.addr,e),qo(n,e)}}function Jo(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if($o(n,e))return;t.uniform4fv(this.addr,e),qo(n,e)}}function Qo(t,e){var n=this.cache,r=e.elements;if(void 0===r){if($o(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),qo(n,e)}else{if($o(n,r))return;Go.set(r),t.uniformMatrix2fv(this.addr,!1,Go),qo(n,r)}}function ta(t,e){var n=this.cache,r=e.elements;if(void 0===r){if($o(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),qo(n,e)}else{if($o(n,r))return;Vo.set(r),t.uniformMatrix3fv(this.addr,!1,Vo),qo(n,r)}}function ea(t,e){var n=this.cache,r=e.elements;if(void 0===r){if($o(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),qo(n,e)}else{if($o(n,r))return;Ho.set(r),t.uniformMatrix4fv(this.addr,!1,Ho),qo(n,r)}}function na(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(e||Do,i)}function ra(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(e||zo,i)}function ia(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(e||jo,i)}function oa(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(e||Fo,i)}function aa(t,e){var n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function sa(t,e){var n=this.cache;$o(n,e)||(t.uniform2iv(this.addr,e),qo(n,e))}function ca(t,e){var n=this.cache;$o(n,e)||(t.uniform3iv(this.addr,e),qo(n,e))}function la(t,e){var n=this.cache;$o(n,e)||(t.uniform4iv(this.addr,e),qo(n,e))}function ua(t,e){var n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function da(t,e){t.uniform1fv(this.addr,e)}function ha(t,e){t.uniform1iv(this.addr,e)}function fa(t,e){t.uniform2iv(this.addr,e)}function pa(t,e){t.uniform3iv(this.addr,e)}function ma(t,e){t.uniform4iv(this.addr,e)}function ga(t,e){var n=Wo(e,this.size,2);t.uniform2fv(this.addr,n)}function va(t,e){var n=Wo(e,this.size,3);t.uniform3fv(this.addr,n)}function ya(t,e){var n=Wo(e,this.size,4);t.uniform4fv(this.addr,n)}function ba(t,e){var n=Wo(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function xa(t,e){var n=Wo(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function _a(t,e){var n=Wo(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function wa(t,e,n){var r=e.length,i=Xo(n,r);t.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.safeSetTexture2D(e[o]||Do,i[o])}function Sa(t,e,n){var r=e.length,i=Xo(n,r);t.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.safeSetTextureCube(e[o]||Fo,i[o])}function Ma(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=function(t){switch(t){case 5126:return Yo;case 35664:return Ko;case 35665:return Zo;case 35666:return Jo;case 35674:return Qo;case 35675:return ta;case 35676:return ea;case 5124:case 35670:return aa;case 35667:case 35671:return sa;case 35668:case 35672:return ca;case 35669:case 35673:return la;case 5125:return ua;case 35678:case 36198:case 36298:case 36306:case 35682:return na;case 35679:case 36299:case 36307:return ia;case 35680:case 36300:case 36308:case 36293:return oa;case 36289:case 36303:case 36311:case 36292:return ra}}(e.type)}function Ea(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return da;case 35664:return ga;case 35665:return va;case 35666:return ya;case 35674:return ba;case 35675:return xa;case 35676:return _a;case 5124:case 35670:return ha;case 35667:case 35671:return fa;case 35668:case 35672:return pa;case 35669:case 35673:return ma;case 35678:case 36198:case 36298:case 36306:case 35682:return wa;case 35680:case 36300:case 36308:case 36293:return Sa}}(e.type)}function Ta(t){this.id=t,this.seq=[],this.map={}}Ea.prototype.updateCache=function(t){var e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),qo(e,t)},Ta.prototype.setValue=function(t,e,n){for(var r=this.seq,i=0,o=r.length;i!==o;++i){var a=r[i];a.setValue(t,e[a.id],n)}};var Aa=/([\w\d_]+)(\])?(\[|\.)?/g;function Ca(t,e){t.seq.push(e),t.map[e.id]=e}function Pa(t,e,n){var r=t.name,i=r.length;for(Aa.lastIndex=0;;){var o=Aa.exec(r),a=Aa.lastIndex,s=o[1],c="]"===o[2],l=o[3];if(c&&(s|=0),void 0===l||"["===l&&a+2===i){Ca(n,void 0===l?new Ma(s,t,e):new Ea(s,t,e));break}var u=n.map[s];void 0===u&&Ca(n,u=new Ta(s)),n=u}}function Oa(t,e){this.seq=[],this.map={};for(var n=t.getProgramParameter(e,35718),r=0;r<n;++r){var i=t.getActiveUniform(e,r);Pa(i,t.getUniformLocation(e,i.name),this)}}function ka(t,e,n){var r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}Oa.prototype.setValue=function(t,e,n,r){var i=this.map[e];void 0!==i&&i.setValue(t,n,r)},Oa.prototype.setOptional=function(t,e,n){var r=e[n];void 0!==r&&this.setValue(t,n,r)},Oa.upload=function(t,e,n,r){for(var i=0,o=e.length;i!==o;++i){var a=e[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(t,s.value,r)}},Oa.seqWithValue=function(t,e){for(var n=[],r=0,i=t.length;r!==i;++r){var o=t[r];o.id in e&&n.push(o)}return n};var La=0;function Ra(t){switch(t){case ze:return["Linear","( value )"];case je:return["sRGB","( value )"];case Be:return["RGBE","( value )"];case He:return["RGBM","( value, 7.0 )"];case Ve:return["RGBM","( value, 16.0 )"];case Ge:return["RGBD","( value, 256.0 )"];case Fe:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Ue:return["LogLuv","( value )"];default:throw new Error("unsupported encoding: "+t)}}function Ia(t,e,n){var r=t.getShaderParameter(e,35713),i=t.getShaderInfoLog(e).trim();return r&&""===i?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+i+function(t){for(var e=t.split("\n"),n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}(t.getShaderSource(e))}function Na(t,e){var n=Ra(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Da(t,e){var n;switch(e){case it:n="Linear";break;case ot:n="Reinhard";break;case at:n="Uncharted2";break;case st:n="OptimizedCineon";break;case ct:n="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function za(t){return""!==t}function ja(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Fa(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var Ba=/^[ \t]*#include +<([\w\d./]+)>/gm;function Ua(t){return t.replace(Ba,Ha)}function Ha(t,e){var n=xo[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return Ua(n)}var Va=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;function Ga(t){return t.replace(Va,Wa)}function Wa(t,e,n,r){for(var i="",o=parseInt(e);o<parseInt(n);o++)i+=r.replace(/\[ i \]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return i}function $a(t){var e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function qa(t,e,n){var r,i,o,a,s,c=t.getContext(),l=n.defines,u=n.vertexShader,d=n.fragmentShader,h=function(t){var e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===f?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===p?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===m&&(e="SHADOWMAP_TYPE_VSM"),e}(n),g=function(t){var e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case ut:case dt:e="ENVMAP_TYPE_CUBE";break;case mt:case gt:e="ENVMAP_TYPE_CUBE_UV";break;case ht:case ft:e="ENVMAP_TYPE_EQUIREC";break;case pt:e="ENVMAP_TYPE_SPHERE"}return e}(n),v=function(t){var e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case dt:case ft:e="ENVMAP_MODE_REFRACTION"}return e}(n),y=function(t){var e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case tt:e="ENVMAP_BLENDING_MULTIPLY";break;case et:e="ENVMAP_BLENDING_MIX";break;case nt:e="ENVMAP_BLENDING_ADD"}return e}(n),b=t.gammaFactor>0?t.gammaFactor:1,x=n.isWebGL2?"":function(t){return[t.extensionDerivatives||t.envMapCubeUV||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(za).join("\n")}(n),_=function(t){var e=[];for(var n in t){var r=t[n];!1!==r&&e.push("#define "+n+" "+r)}return e.join("\n")}(l),w=c.createProgram(),S=n.numMultiviewViews;if(n.isRawShaderMaterial?((r=[_].filter(za).join("\n")).length>0&&(r+="\n"),(i=[x,_].filter(za).join("\n")).length>0&&(i+="\n")):(r=[$a(n),"#define SHADER_NAME "+n.shaderName,_,n.instancing?"#define USE_INSTANCING":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+b,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+v:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+h:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(za).join("\n"),i=[x,$a(n),"#define SHADER_NAME "+n.shaderName,_,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+b,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+g:"",n.envMap?"#define "+v:"",n.envMap?"#define "+y:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+h:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==rt?"#define TONE_MAPPING":"",n.toneMapping!==rt?xo.tonemapping_pars_fragment:"",n.toneMapping!==rt?Da("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.outputEncoding||n.mapEncoding||n.matcapEncoding||n.envMapEncoding||n.emissiveMapEncoding||n.lightMapEncoding?xo.encodings_pars_fragment:"",n.mapEncoding?Na("mapTexelToLinear",n.mapEncoding):"",n.matcapEncoding?Na("matcapTexelToLinear",n.matcapEncoding):"",n.envMapEncoding?Na("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMapEncoding?Na("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMapEncoding?Na("lightMapTexelToLinear",n.lightMapEncoding):"",n.outputEncoding?(o="linearToOutputTexel",a=n.outputEncoding,s=Ra(a),"vec4 "+o+"( vec4 value ) { return LinearTo"+s[0]+s[1]+"; }"):"",n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(za).join("\n")),u=Fa(u=ja(u=Ua(u),n),n),d=Fa(d=ja(d=Ua(d),n),n),u=Ga(u),d=Ga(d),n.isWebGL2&&!n.isRawShaderMaterial){var M=!1,E=/^\s*#version\s+300\s+es\s*\n/;n.isShaderMaterial&&null!==u.match(E)&&null!==d.match(E)&&(M=!0,u=u.replace(E,""),d=d.replace(E,"")),r=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+r,i=["#version 300 es\n","#define varying in",M?"":"out highp vec4 pc_fragColor;",M?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+i,S>0&&(r=(r=r.replace("#version 300 es\n",["#version 300 es\n","#extension GL_OVR_multiview2 : require","layout(num_views = "+S+") in;","#define VIEW_ID gl_ViewID_OVR"].join("\n"))).replace(["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;"].join("\n"),["uniform mat4 modelViewMatrices["+S+"];","uniform mat4 projectionMatrices["+S+"];","uniform mat4 viewMatrices["+S+"];","uniform mat3 normalMatrices["+S+"];","#define modelViewMatrix modelViewMatrices[VIEW_ID]","#define projectionMatrix projectionMatrices[VIEW_ID]","#define viewMatrix viewMatrices[VIEW_ID]","#define normalMatrix normalMatrices[VIEW_ID]"].join("\n")),i=(i=i.replace("#version 300 es\n",["#version 300 es\n","#extension GL_OVR_multiview2 : require","#define VIEW_ID gl_ViewID_OVR"].join("\n"))).replace("uniform mat4 viewMatrix;",["uniform mat4 viewMatrices["+S+"];","#define viewMatrix viewMatrices[VIEW_ID]"].join("\n")))}var T,A,C=i+d,P=ka(c,35633,r+u),O=ka(c,35632,C);if(c.attachShader(w,P),c.attachShader(w,O),void 0!==n.index0AttributeName?c.bindAttribLocation(w,0,n.index0AttributeName):!0===n.morphTargets&&c.bindAttribLocation(w,0,"position"),c.linkProgram(w),t.debug.checkShaderErrors){var k=c.getProgramInfoLog(w).trim(),L=c.getShaderInfoLog(P).trim(),R=c.getShaderInfoLog(O).trim(),I=!0,N=!0;if(!1===c.getProgramParameter(w,35714)){I=!1;var D=Ia(c,P,"vertex"),z=Ia(c,O,"fragment");console.error("THREE.WebGLProgram: shader error: ",c.getError(),"35715",c.getProgramParameter(w,35715),"gl.getProgramInfoLog",k,D,z)}else""!==k?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",k):""!==L&&""!==R||(N=!1);N&&(this.diagnostics={runnable:I,programLog:k,vertexShader:{log:L,prefix:r},fragmentShader:{log:R,prefix:i}})}return c.deleteShader(P),c.deleteShader(O),this.getUniforms=function(){return void 0===T&&(T=new Oa(c,w)),T},this.getAttributes=function(){return void 0===A&&(A=function(t,e){for(var n={},r=t.getProgramParameter(e,35721),i=0;i<r;i++){var o=t.getActiveAttrib(e,i).name;n[o]=t.getAttribLocation(e,o)}return n}(c,w)),A},this.destroy=function(){c.deleteProgram(w),this.program=void 0},this.name=n.shaderName,this.id=La++,this.cacheKey=e,this.usedTimes=1,this.program=w,this.vertexShader=P,this.fragmentShader=O,this.numMultiviewViews=S,this}function Xa(t,e,n){var r=[],i=n.isWebGL2,o=n.logarithmicDepthBuffer,a=n.floatVertexTextures,s=n.precision,c=n.maxVertexUniforms,l=n.vertexTextures,u={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},d=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","numMultiviewViews","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen"];function h(t){var e;return t?t.isTexture?e=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),e=t.texture.encoding):e=ze,e}this.getParameters=function(r,d,f,p,m,g,b){var x=p.fog,_=r.isMeshStandardMaterial?p.environment:null,w=r.envMap||_,S=u[r.type],M=b.isSkinnedMesh?function(t){var e=t.skeleton.bones;if(a)return 1024;var n=c,r=Math.floor((n-20)/4),i=Math.min(r,e.length);return i<e.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+e.length+" bones. This GPU supports "+i+"."),0):i}(b):0;null!==r.precision&&(s=n.getMaxPrecision(r.precision))!==r.precision&&console.warn("THREE.WebGLProgram.getParameters:",r.precision,"not supported, using",s,"instead.");var E=function(t,e){var n;if(e){var r=_o[e];n={name:t.type,uniforms:io.clone(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}}else n={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};return n}(r,S);r.onBeforeCompile(E,t);var T=t.getRenderTarget(),A=T&&T.isWebGLMultiviewRenderTarget?T.numViews:0;return{isWebGL2:i,shaderID:S,shaderName:E.name,uniforms:E.uniforms,vertexShader:E.vertexShader,fragmentShader:E.fragmentShader,defines:r.defines,isRawShaderMaterial:r.isRawShaderMaterial,isShaderMaterial:r.isShaderMaterial,precision:s,instancing:!0===b.isInstancedMesh,supportsVertexTextures:l,numMultiviewViews:A,outputEncoding:null!==T?h(T.texture):t.outputEncoding,map:!!r.map,mapEncoding:h(r.map),matcap:!!r.matcap,matcapEncoding:h(r.matcap),envMap:!!w,envMapMode:w&&w.mapping,envMapEncoding:h(w),envMapCubeUV:!!w&&(w.mapping===mt||w.mapping===gt),lightMap:!!r.lightMap,lightMapEncoding:h(r.lightMap),aoMap:!!r.aoMap,emissiveMap:!!r.emissiveMap,emissiveMapEncoding:h(r.emissiveMap),bumpMap:!!r.bumpMap,normalMap:!!r.normalMap,objectSpaceNormalMap:r.normalMapType===Xe,tangentSpaceNormalMap:r.normalMapType===qe,clearcoatNormalMap:!!r.clearcoatNormalMap,displacementMap:!!r.displacementMap,roughnessMap:!!r.roughnessMap,metalnessMap:!!r.metalnessMap,specularMap:!!r.specularMap,alphaMap:!!r.alphaMap,gradientMap:!!r.gradientMap,sheen:!!r.sheen,combine:r.combine,vertexTangents:r.normalMap&&r.vertexTangents,vertexColors:r.vertexColors,vertexUvs:!!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatNormalMap||r.displacementMap),uvsVertexOnly:!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatNormalMap||!r.displacementMap),fog:!!x,useFog:r.fog,fogExp2:x&&x.isFogExp2,flatShading:r.flatShading,sizeAttenuation:r.sizeAttenuation,logarithmicDepthBuffer:o,skinning:r.skinning&&M>0,maxBones:M,useVertexTexture:a,morphTargets:r.morphTargets,morphNormals:r.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:d.directional.length,numPointLights:d.point.length,numSpotLights:d.spot.length,numRectAreaLights:d.rectArea.length,numHemiLights:d.hemi.length,numDirLightShadows:d.directionalShadowMap.length,numPointLightShadows:d.pointShadowMap.length,numSpotLightShadows:d.spotShadowMap.length,numClippingPlanes:m,numClipIntersection:g,dithering:r.dithering,shadowMapEnabled:t.shadowMap.enabled&&f.length>0,shadowMapType:t.shadowMap.type,toneMapping:r.toneMapped?t.toneMapping:rt,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:r.premultipliedAlpha,alphaTest:r.alphaTest,doubleSided:r.side===y,flipSided:r.side===v,depthPacking:void 0!==r.depthPacking&&r.depthPacking,index0AttributeName:r.index0AttributeName,extensionDerivatives:r.extensions&&r.extensions.derivatives,extensionFragDepth:r.extensions&&r.extensions.frawbuffers,extensionDrawbuffers:r.extensions&&r.extensions.drawbuffers,extensionShaderTextureLOD:r.extensions&&r.extensions.shaderTextureLOD,rendererExtensionFragDepth:i||null!==e.get("EXT_frag_depth"),rendererExtensionDrawBuffers:i||null!==e.get("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:i||null!==e.get("EXT_shader_texture_lod"),onBeforeCompile:r.onBeforeCompile}},this.getProgramCacheKey=function(e){var n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.fragmentShader),n.push(e.vertexShader)),void 0!==e.defines)for(var r in e.defines)n.push(r),n.push(e.defines[r]);if(void 0===e.isRawShaderMaterial){for(var i=0;i<d.length;i++)n.push(e[d[i]]);n.push(t.outputEncoding),n.push(t.gammaFactor)}return n.push(e.onBeforeCompile.toString()),n.join()},this.acquireProgram=function(e,n){for(var i,o=0,a=r.length;o<a;o++){var s=r[o];if(s.cacheKey===n){++(i=s).usedTimes;break}}return void 0===i&&(i=new qa(t,n,e),r.push(i)),i},this.releaseProgram=function(t){if(0==--t.usedTimes){var e=r.indexOf(t);r[e]=r[r.length-1],r.pop(),t.destroy()}},this.programs=r}function Ya(){var t=new WeakMap;return{get:function(e){var n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,r){t.get(e)[n]=r},dispose:function(){t=new WeakMap}}}function Ka(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Za(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Ja(){var t=[],e=0,n=[],r=[],i={id:-1};function o(n,r,o,a,s,c){var l=t[e];return void 0===l?(l={id:n.id,object:n,geometry:r,material:o,program:o.program||i,groupOrder:a,renderOrder:n.renderOrder,z:s,group:c},t[e]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=o,l.program=o.program||i,l.groupOrder=a,l.renderOrder=n.renderOrder,l.z=s,l.group=c),e++,l}return{opaque:n,transparent:r,init:function(){e=0,n.length=0,r.length=0},push:function(t,e,i,a,s,c){var l=o(t,e,i,a,s,c);(!0===i.transparent?r:n).push(l)},unshift:function(t,e,i,a,s,c){var l=o(t,e,i,a,s,c);(!0===i.transparent?r:n).unshift(l)},sort:function(t,e){n.length>1&&n.sort(t||Ka),r.length>1&&r.sort(e||Za)}}}function Qa(){var t=new WeakMap;function e(n){var r=n.target;r.removeEventListener("dispose",e),t.delete(r)}return{get:function(n,r){var i,o=t.get(n);return void 0===o?(i=new Ja,t.set(n,new WeakMap),t.get(n).set(r,i),n.addEventListener("dispose",e)):void 0===(i=o.get(r))&&(i=new Ja,o.set(r,i)),i},dispose:function(){t=new WeakMap}}}function ts(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":n={direction:new zn,color:new ti,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Tn};break;case"SpotLight":n={position:new zn,direction:new zn,color:new ti,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Tn};break;case"PointLight":n={position:new zn,color:new ti,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Tn,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":n={direction:new zn,skyColor:new ti,groundColor:new ti};break;case"RectAreaLight":n={color:new ti,position:new zn,halfWidth:new zn,halfHeight:new zn}}return t[e.id]=n,n}}}var es=0;function ns(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function rs(){for(var t=new ts,e={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},n=0;n<9;n++)e.probe.push(new zn);var r=new zn,i=new Wn,o=new Wn;return{setup:function(n,a,s){for(var c=0,l=0,u=0,d=0;d<9;d++)e.probe[d].set(0,0,0);var h=0,f=0,p=0,m=0,g=0,v=0,y=0,b=0,x=s.matrixWorldInverse;n.sort(ns),d=0;for(var _=n.length;d<_;d++){var w=n[d],S=w.color,M=w.intensity,E=w.distance,T=w.shadow&&w.shadow.map?w.shadow.map.texture:null;if(w.isAmbientLight)c+=S.r*M,l+=S.g*M,u+=S.b*M;else if(w.isLightProbe)for(var A=0;A<9;A++)e.probe[A].addScaledVector(w.sh.coefficients[A],M);else if(w.isDirectionalLight){if((P=t.get(w)).color.copy(w.color).multiplyScalar(w.intensity),P.direction.setFromMatrixPosition(w.matrixWorld),r.setFromMatrixPosition(w.target.matrixWorld),P.direction.sub(r),P.direction.transformDirection(x),P.shadow=w.castShadow,w.castShadow){var C=w.shadow;P.shadowBias=C.bias,P.shadowRadius=C.radius,P.shadowMapSize=C.mapSize,e.directionalShadowMap[h]=T,e.directionalShadowMatrix[h]=w.shadow.matrix,v++}e.directional[h]=P,h++}else if(w.isSpotLight){if((P=t.get(w)).position.setFromMatrixPosition(w.matrixWorld),P.position.applyMatrix4(x),P.color.copy(S).multiplyScalar(M),P.distance=E,P.direction.setFromMatrixPosition(w.matrixWorld),r.setFromMatrixPosition(w.target.matrixWorld),P.direction.sub(r),P.direction.transformDirection(x),P.coneCos=Math.cos(w.angle),P.penumbraCos=Math.cos(w.angle*(1-w.penumbra)),P.decay=w.decay,P.shadow=w.castShadow,w.castShadow){C=w.shadow;P.shadowBias=C.bias,P.shadowRadius=C.radius,P.shadowMapSize=C.mapSize,e.spotShadowMap[p]=T,e.spotShadowMatrix[p]=w.shadow.matrix,b++}e.spot[p]=P,p++}else if(w.isRectAreaLight){(P=t.get(w)).color.copy(S).multiplyScalar(M),P.position.setFromMatrixPosition(w.matrixWorld),P.position.applyMatrix4(x),o.identity(),i.copy(w.matrixWorld),i.premultiply(x),o.extractRotation(i),P.halfWidth.set(.5*w.width,0,0),P.halfHeight.set(0,.5*w.height,0),P.halfWidth.applyMatrix4(o),P.halfHeight.applyMatrix4(o),e.rectArea[m]=P,m++}else if(w.isPointLight){if((P=t.get(w)).position.setFromMatrixPosition(w.matrixWorld),P.position.applyMatrix4(x),P.color.copy(w.color).multiplyScalar(w.intensity),P.distance=w.distance,P.decay=w.decay,P.shadow=w.castShadow,w.castShadow){C=w.shadow;P.shadowBias=C.bias,P.shadowRadius=C.radius,P.shadowMapSize=C.mapSize,P.shadowCameraNear=C.camera.near,P.shadowCameraFar=C.camera.far,e.pointShadowMap[f]=T,e.pointShadowMatrix[f]=w.shadow.matrix,y++}e.point[f]=P,f++}else if(w.isHemisphereLight){var P;(P=t.get(w)).direction.setFromMatrixPosition(w.matrixWorld),P.direction.transformDirection(x),P.direction.normalize(),P.skyColor.copy(w.color).multiplyScalar(M),P.groundColor.copy(w.groundColor).multiplyScalar(M),e.hemi[g]=P,g++}}e.ambient[0]=c,e.ambient[1]=l,e.ambient[2]=u;var O=e.hash;O.directionalLength===h&&O.pointLength===f&&O.spotLength===p&&O.rectAreaLength===m&&O.hemiLength===g&&O.numDirectionalShadows===v&&O.numPointShadows===y&&O.numSpotShadows===b||(e.directional.length=h,e.spot.length=p,e.rectArea.length=m,e.point.length=f,e.hemi.length=g,e.directionalShadowMap.length=v,e.pointShadowMap.length=y,e.spotShadowMap.length=b,e.directionalShadowMatrix.length=v,e.pointShadowMatrix.length=y,e.spotShadowMatrix.length=b,O.directionalLength=h,O.pointLength=f,O.spotLength=p,O.rectAreaLength=m,O.hemiLength=g,O.numDirectionalShadows=v,O.numPointShadows=y,O.numSpotShadows=b,e.version=es++)},state:e}}function is(){var t=new rs,e=[],n=[];return{init:function(){e.length=0,n.length=0},state:{lightsArray:e,shadowsArray:n,lights:t},setupLights:function(r){t.setup(e,n,r)},pushLight:function(t){e.push(t)},pushShadow:function(t){n.push(t)}}}function os(){var t=new WeakMap;function e(n){var r=n.target;r.removeEventListener("dispose",e),t.delete(r)}return{get:function(n,r){var i;return!1===t.has(n)?(i=new is,t.set(n,new WeakMap),t.get(n).set(r,i),n.addEventListener("dispose",e)):!1===t.get(n).has(r)?(i=new is,t.get(n).set(r,i)):i=t.get(n).get(r),i},dispose:function(){t=new WeakMap}}}function as(t){ai.call(this),this.type="MeshDepthMaterial",this.depthPacking=We,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function ss(t){ai.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new zn,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}as.prototype=Object.create(ai.prototype),as.prototype.constructor=as,as.prototype.isMeshDepthMaterial=!0,as.prototype.copy=function(t){return ai.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},ss.prototype=Object.create(ai.prototype),ss.prototype.constructor=ss,ss.prototype.isMeshDistanceMaterial=!0,ss.prototype.copy=function(t){return ai.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this};function cs(t,e,n){var r=new po,i=new Tn,o=new Tn,a=new kn,s=[],c=[],l={},u={0:v,1:g,2:y},d=new oo({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new Tn},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = sqrt( squared_mean - mean * mean );\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),h=d.clone();h.defines.HORIZONAL_PASS=1;var p=new Ci;p.setAttribute("position",new li(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var b=new $i(p,d),x=this;function _(n,r){var i=e.update(b);d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(r,null,i,d,b,null),h.uniforms.shadow_pass.value=n.mapPass.texture,h.uniforms.resolution.value=n.mapSize,h.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(r,null,i,h,b,null)}function w(t,e,n){var r=t<<0|e<<1|n<<2,i=s[r];return void 0===i&&(i=new as({depthPacking:$e,morphTargets:t,skinning:e}),s[r]=i),i}function S(t,e,n){var r=t<<0|e<<1|n<<2,i=c[r];return void 0===i&&(i=new ss({morphTargets:t,skinning:e}),c[r]=i),i}function E(e,n,r,i,o,a){var s=e.geometry,c=null,d=w,h=e.customDepthMaterial;if(!0===r.isPointLight&&(d=S,h=e.customDistanceMaterial),void 0===h){var f=!1;!0===n.morphTargets&&(!0===s.isBufferGeometry?f=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:!0===s.isGeometry&&(f=s.morphTargets&&s.morphTargets.length>0));var p=!1;!0===e.isSkinnedMesh&&(!0===n.skinning?p=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e)),c=d(f,p,!0===e.isInstancedMesh)}else c=h;if(t.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var g=c.uuid,v=n.uuid,y=l[g];void 0===y&&(y={},l[g]=y);var b=y[v];void 0===b&&(b=c.clone(),y[v]=b),c=b}return c.visible=n.visible,c.wireframe=n.wireframe,c.side=a===m?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:u[n.side],c.clipShadows=n.clipShadows,c.clippingPlanes=n.clippingPlanes,c.clipIntersection=n.clipIntersection,c.wireframeLinewidth=n.wireframeLinewidth,c.linewidth=n.linewidth,!0===r.isPointLight&&!0===c.isMeshDistanceMaterial&&(c.referencePosition.setFromMatrixPosition(r.matrixWorld),c.nearDistance=i,c.farDistance=o),c}function T(n,i,o,a,s){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&s===m)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);var c=e.update(n),l=n.material;if(Array.isArray(l))for(var u=c.groups,d=0,h=u.length;d<h;d++){var f=u[d],p=l[f.materialIndex];if(p&&p.visible){var g=E(n,p,a,o.near,o.far,s);t.renderBufferDirect(o,null,c,g,n,f)}}else if(l.visible){g=E(n,l,a,o.near,o.far,s);t.renderBufferDirect(o,null,c,g,n,null)}}for(var v=n.children,y=0,b=v.length;y<b;y++)T(v[y],i,o,a,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=f,this.render=function(e,s,c){if(!1!==x.enabled&&(!1!==x.autoUpdate||!1!==x.needsUpdate)&&0!==e.length){var l=t.getRenderTarget(),u=t.getActiveCubeFace(),d=t.getActiveMipmapLevel(),h=t.state;h.setBlending(M),h.buffers.color.setClear(1,1,1,1),h.buffers.depth.setTest(!0),h.setScissorTest(!1);for(var f=0,p=e.length;f<p;f++){var g=e[f],v=g.shadow;if(void 0!==v){i.copy(v.mapSize);var y=v.getFrameExtents();if(i.multiply(y),o.copy(v.mapSize),(i.x>n||i.y>n)&&(console.warn("THREE.WebGLShadowMap:",g,"has shadow exceeding max texture size, reducing"),i.x>n&&(o.x=Math.floor(n/y.x),i.x=o.x*y.x,v.mapSize.x=o.x),i.y>n&&(o.y=Math.floor(n/y.y),i.y=o.y*y.y,v.mapSize.y=o.y)),null===v.map&&!v.isPointLightShadow&&this.type===m){var b={minFilter:Et,magFilter:Et,format:Gt};v.map=new Ln(i.x,i.y,b),v.map.texture.name=g.name+".shadowMap",v.mapPass=new Ln(i.x,i.y,b),v.camera.updateProjectionMatrix()}if(null===v.map){b={minFilter:xt,magFilter:xt,format:Gt};v.map=new Ln(i.x,i.y,b),v.map.texture.name=g.name+".shadowMap",v.camera.updateProjectionMatrix()}t.setRenderTarget(v.map),t.clear();for(var w=v.getViewportCount(),S=0;S<w;S++){var E=v.getViewport(S);a.set(o.x*E.x,o.y*E.y,o.x*E.z,o.y*E.w),h.viewport(a),v.updateMatrices(g,S),r=v.getFrustum(),T(s,c,v.camera,g,this.type)}v.isPointLightShadow||this.type!==m||_(v,c)}else console.warn("THREE.WebGLShadowMap:",g,"has no shadow.")}x.needsUpdate=!1,t.setRenderTarget(l,u,d)}}}function ls(t,e,n){var r=n.isWebGL2;var i=new function(){var e=!1,n=new kn,r=null,i=new kn(0,0,0,0);return{setMask:function(n){r===n||e||(t.colorMask(n,n,n,n),r=n)},setLocked:function(t){e=t},setClear:function(e,r,o,a,s){!0===s&&(e*=a,r*=a,o*=a),n.set(e,r,o,a),!1===i.equals(n)&&(t.clearColor(e,r,o,a),i.copy(n))},reset:function(){e=!1,r=null,i.set(-1,0,0,0)}}},o=new function(){var e=!1,n=null,r=null,i=null;return{setTest:function(t){t?bt(2929):xt(2929)},setMask:function(r){n===r||e||(t.depthMask(r),n=r)},setFunc:function(e){if(r!==e){if(e)switch(e){case $:t.depthFunc(512);break;case q:t.depthFunc(519);break;case X:t.depthFunc(513);break;case Y:t.depthFunc(515);break;case K:t.depthFunc(514);break;case Z:t.depthFunc(518);break;case J:t.depthFunc(516);break;case Q:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);r=e}},setLocked:function(t){e=t},setClear:function(e){i!==e&&(t.clearDepth(e),i=e)},reset:function(){e=!1,n=null,r=null,i=null}}},l=new function(){var e=!1,n=null,r=null,i=null,o=null,a=null,s=null,c=null,l=null;return{setTest:function(t){e||(t?bt(2960):xt(2960))},setMask:function(r){n===r||e||(t.stencilMask(r),n=r)},setFunc:function(e,n,a){r===e&&i===n&&o===a||(t.stencilFunc(e,n,a),r=e,i=n,o=a)},setOp:function(e,n,r){a===e&&s===n&&c===r||(t.stencilOp(e,n,r),a=e,s=n,c=r)},setLocked:function(t){e=t},setClear:function(e){l!==e&&(t.clearStencil(e),l=e)},reset:function(){e=!1,n=null,r=null,i=null,o=null,a=null,s=null,c=null,l=null}}},u=t.getParameter(34921),d=new Uint8Array(u),h=new Uint8Array(u),f=new Uint8Array(u),p={},m=null,g=null,b=null,x=null,_=null,w=null,S=null,tt=null,et=null,nt=!1,rt=null,it=null,ot=null,at=null,st=null,ct=t.getParameter(35661),lt=!1,ut=0,dt=t.getParameter(7938);-1!==dt.indexOf("WebGL")?(ut=parseFloat(/^WebGL\ ([0-9])/.exec(dt)[1]),lt=ut>=1):-1!==dt.indexOf("OpenGL ES")&&(ut=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(dt)[1]),lt=ut>=2);var ht=null,ft={},pt=new kn,mt=new kn;function gt(e,n,r){var i=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(var a=0;a<r;a++)t.texImage2D(n+a,0,6408,1,1,0,6408,5121,i);return o}var vt={};function yt(n,i){(d[n]=1,0===h[n]&&(t.enableVertexAttribArray(n),h[n]=1),f[n]!==i)&&((r?t:e.get("ANGLE_instanced_arrays"))[r?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),f[n]=i)}function bt(e){!0!==p[e]&&(t.enable(e),p[e]=!0)}function xt(e){!1!==p[e]&&(t.disable(e),p[e]=!1)}vt[3553]=gt(3553,3553,1),vt[34067]=gt(34067,34069,6),i.setClear(0,0,0,1),o.setClear(1),l.setClear(0),bt(2929),o.setFunc(Y),Et(!1),Tt(s),bt(2884),Mt(M);var _t={[O]:32774,[k]:32778,[L]:32779};if(r)_t[R]=32775,_t[I]=32776;else{var wt=e.get("EXT_blend_minmax");null!==wt&&(_t[R]=wt.MIN_EXT,_t[I]=wt.MAX_EXT)}var St={[N]:0,[D]:1,[z]:768,[F]:770,[W]:776,[V]:774,[U]:772,[j]:769,[B]:771,[G]:775,[H]:773};function Mt(e,n,r,i,o,a,s,c){if(e!==M){if(g||(bt(3042),g=!0),e===P)o=o||n,a=a||r,s=s||i,n===x&&o===S||(t.blendEquationSeparate(_t[n],_t[o]),x=n,S=o),r===_&&i===w&&a===tt&&s===et||(t.blendFuncSeparate(St[r],St[i],St[a],St[s]),_=r,w=i,tt=a,et=s),b=e,nt=null;else if(e!==b||c!==nt){if(x===O&&S===O||(t.blendEquation(32774),x=O,S=O),c)switch(e){case E:t.blendFuncSeparate(1,771,1,771);break;case T:t.blendFunc(1,1);break;case A:t.blendFuncSeparate(0,0,769,771);break;case C:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case E:t.blendFuncSeparate(770,771,1,771);break;case T:t.blendFunc(770,1);break;case A:t.blendFunc(0,769);break;case C:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}_=null,w=null,tt=null,et=null,b=e,nt=c}}else g&&(xt(3042),g=!1)}function Et(e){rt!==e&&(e?t.frontFace(2304):t.frontFace(2305),rt=e)}function Tt(e){e!==a?(bt(2884),e!==it&&(e===s?t.cullFace(1029):e===c?t.cullFace(1028):t.cullFace(1032))):xt(2884),it=e}function At(e,n,r){e?(bt(32823),at===n&&st===r||(t.polygonOffset(n,r),at=n,st=r)):xt(32823)}function Ct(e){void 0===e&&(e=33984+ct-1),ht!==e&&(t.activeTexture(e),ht=e)}return{buffers:{color:i,depth:o,stencil:l},initAttributes:function(){for(var t=0,e=d.length;t<e;t++)d[t]=0},enableAttribute:function(t){yt(t,0)},enableAttributeAndDivisor:yt,disableUnusedAttributes:function(){for(var e=0,n=h.length;e!==n;++e)h[e]!==d[e]&&(t.disableVertexAttribArray(e),h[e]=0)},enable:bt,disable:xt,useProgram:function(e){return m!==e&&(t.useProgram(e),m=e,!0)},setBlending:Mt,setMaterial:function(t,e){t.side===y?xt(2884):bt(2884);var n=t.side===v;e&&(n=!n),Et(n),t.blending===E&&!1===t.transparent?Mt(M):Mt(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),o.setFunc(t.depthFunc),o.setTest(t.depthTest),o.setMask(t.depthWrite),i.setMask(t.colorWrite);var r=t.stencilWrite;l.setTest(r),r&&(l.setMask(t.stencilWriteMask),l.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),l.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),At(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:Et,setCullFace:Tt,setLineWidth:function(e){e!==ot&&(lt&&t.lineWidth(e),ot=e)},setPolygonOffset:At,setScissorTest:function(t){t?bt(3089):xt(3089)},activeTexture:Ct,bindTexture:function(e,n){null===ht&&Ct();var r=ft[ht];void 0===r&&(r={type:void 0,texture:void 0},ft[ht]=r),r.type===e&&r.texture===n||(t.bindTexture(e,n||vt[e]),r.type=e,r.texture=n)},unbindTexture:function(){var e=ft[ht];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(e){!1===pt.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),pt.copy(e))},viewport:function(e){!1===mt.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),mt.copy(e))},reset:function(){for(var e=0;e<h.length;e++)1===h[e]&&(t.disableVertexAttribArray(e),h[e]=0);p={},ht=null,ft={},m=null,b=null,rt=null,it=null,i.reset(),o.reset(),l.reset()}}}function us(t,e,n,r,i,o,a){var s,c=i.isWebGL2,l=i.maxTextures,u=i.maxCubemapSize,d=i.maxTextureSize,h=i.maxSamples,f=new WeakMap,p=!1;try{p="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(t){}function m(t,e){return p?new OffscreenCanvas(t,e):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function g(t,e,n,r){var i=1;if((t.width>r||t.height>r)&&(i=r/Math.max(t.width,t.height)),i<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){var o=e?En.floorPowerOfTwo:Math.floor,a=o(i*t.width),c=o(i*t.height);void 0===s&&(s=m(a,c));var l=n?m(a,c):s;return l.width=a,l.height=c,l.getContext("2d").drawImage(t,0,0,a,c),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+a+"x"+c+")."),l}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+")."),t}return t}function v(t){return En.isPowerOfTwo(t.width)&&En.isPowerOfTwo(t.height)}function y(t,e){return t.generateMipmaps&&e&&t.minFilter!==xt&&t.minFilter!==Et}function b(e,n,i,o){t.generateMipmap(e),r.get(n).__maxMipLevel=Math.log(Math.max(i,o))*Math.LOG2E}function x(n,r,i){if(!1===c)return r;if(null!==n){if(void 0!==t[n])return t[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var o=r;return 6403===r&&(5126===i&&(o=33326),5131===i&&(o=33325),5121===i&&(o=33321)),6407===r&&(5126===i&&(o=34837),5131===i&&(o=34843),5121===i&&(o=32849)),6408===r&&(5126===i&&(o=34836),5131===i&&(o=34842),5121===i&&(o=32856)),33325===o||33326===o||34842===o||34836===o?e.get("EXT_color_buffer_float"):34843!==o&&34837!==o||console.warn("THREE.WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."),o}function _(t){return t===xt||t===_t||t===St?9728:9729}function w(e){var n=e.target;n.removeEventListener("dispose",w),function(e){var n=r.get(e);if(void 0===n.__webglInit)return;t.deleteTexture(n.__webglTexture),r.remove(e)}(n),n.isVideoTexture&&f.delete(n),a.memory.textures--}function S(e){var n=e.target;n.removeEventListener("dispose",S),function(e){var n=r.get(e),i=r.get(e.texture);if(!e)return;void 0!==i.__webglTexture&&t.deleteTexture(i.__webglTexture);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLCubeRenderTarget)for(var o=0;o<6;o++)t.deleteFramebuffer(n.__webglFramebuffer[o]),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[o]);else t.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer);if(e.isWebGLMultiviewRenderTarget){t.deleteTexture(n.__webglColorTexture),t.deleteTexture(n.__webglDepthStencilTexture),a.memory.textures-=2;o=0;for(var s=n.__webglViewFramebuffers.length;o<s;o++)t.deleteFramebuffer(n.__webglViewFramebuffers[o])}r.remove(e.texture),r.remove(e)}(n),a.memory.textures--}var M=0;function E(t,e){var i=r.get(t);if(t.isVideoTexture&&function(t){var e=a.render.frame;f.get(t)!==e&&(f.set(t,e),t.update())}(t),t.version>0&&i.__version!==t.version){var o=t.image;if(void 0===o)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==o.complete)return void L(i,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+e),n.bindTexture(3553,i.__webglTexture)}function T(e,i){if(6===e.image.length){var a=r.get(e);if(e.version>0&&a.__version!==e.version){k(a,e),n.activeTexture(33984+i),n.bindTexture(34067,a.__webglTexture),t.pixelStorei(37440,e.flipY);for(var s=e&&(e.isCompressedTexture||e.image[0].isCompressedTexture),l=e.image[0]&&e.image[0].isDataTexture,d=[],h=0;h<6;h++)d[h]=s||l?l?e.image[h].image:e.image[h]:g(e.image[h],!1,!0,u);var f,p=d[0],m=v(p)||c,_=o.convert(e.format),w=o.convert(e.type),S=x(e.internalFormat,_,w);if(O(34067,e,m),s){for(h=0;h<6;h++){f=d[h].mipmaps;for(var M=0;M<f.length;M++){var E=f[M];e.format!==Gt&&e.format!==Vt?null!==_?n.compressedTexImage2D(34069+h,M,S,E.width,E.height,0,E.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+h,M,S,E.width,E.height,0,_,w,E.data)}}a.__maxMipLevel=f.length-1}else{f=e.mipmaps;for(h=0;h<6;h++)if(l){n.texImage2D(34069+h,0,S,d[h].width,d[h].height,0,_,w,d[h].data);for(M=0;M<f.length;M++){var T=(E=f[M]).image[h].image;n.texImage2D(34069+h,M+1,S,T.width,T.height,0,_,w,T.data)}}else{n.texImage2D(34069+h,0,S,_,w,d[h]);for(M=0;M<f.length;M++){E=f[M];n.texImage2D(34069+h,M+1,S,_,w,E.image[h])}}a.__maxMipLevel=f.length}y(e,m)&&b(34067,e,p.width,p.height),a.__version=e.version,e.onUpdate&&e.onUpdate(e)}else n.activeTexture(33984+i),n.bindTexture(34067,a.__webglTexture)}}function A(t,e){n.activeTexture(33984+e),n.bindTexture(34067,r.get(t).__webglTexture)}var C={[vt]:10497,[yt]:33071,[bt]:33648},P={[xt]:9728,[_t]:9984,[St]:9986,[Et]:9729,[Tt]:9985,[Ct]:9987};function O(n,o,a){a?(t.texParameteri(n,10242,C[o.wrapS]),t.texParameteri(n,10243,C[o.wrapT]),32879!==n&&35866!==n||t.texParameteri(n,32882,C[o.wrapR]),t.texParameteri(n,10240,P[o.magFilter]),t.texParameteri(n,10241,P[o.minFilter])):(t.texParameteri(n,10242,33071),t.texParameteri(n,10243,33071),32879!==n&&35866!==n||t.texParameteri(n,32882,33071),o.wrapS===yt&&o.wrapT===yt||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(n,10240,_(o.magFilter)),t.texParameteri(n,10241,_(o.minFilter)),o.minFilter!==xt&&o.minFilter!==Et&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var s=e.get("EXT_texture_filter_anisotropic");if(s){if(o.type===Dt&&null===e.get("OES_texture_float_linear"))return;if(o.type===zt&&null===(c||e.get("OES_texture_half_float_linear")))return;(o.anisotropy>1||r.get(o).__currentAnisotropy)&&(t.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,i.getMaxAnisotropy())),r.get(o).__currentAnisotropy=o.anisotropy)}}function k(e,n){void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",w),e.__webglTexture=t.createTexture(),a.memory.textures++)}function L(e,r,i){var a=3553;r.isDataTexture2DArray&&(a=35866),r.isDataTexture3D&&(a=32879),k(e,r),n.activeTexture(33984+i),n.bindTexture(a,e.__webglTexture),t.pixelStorei(37440,r.flipY),t.pixelStorei(37441,r.premultiplyAlpha),t.pixelStorei(3317,r.unpackAlignment);var s=function(t){return!c&&(t.wrapS!==yt||t.wrapT!==yt||t.minFilter!==xt&&t.minFilter!==Et)}(r)&&!1===v(r.image),l=g(r.image,s,!1,d),u=v(l)||c,h=o.convert(r.format),f=o.convert(r.type),p=x(r.internalFormat,h,f);O(a,r,u);var m,_=r.mipmaps;if(r.isDepthTexture){if(p=6402,r.type===Dt){if(!1===c)throw new Error("Float Depth Texture only supported in WebGL2.0");p=36012}else c&&(p=33189);r.format===Xt&&6402===p&&r.type!==Rt&&r.type!==Nt&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=Rt,f=o.convert(r.type)),r.format===Yt&&(p=34041,r.type!==Ut&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=Ut,f=o.convert(r.type))),n.texImage2D(3553,0,p,l.width,l.height,0,h,f,null)}else if(r.isDataTexture)if(_.length>0&&u){for(var w=0,S=_.length;w<S;w++)m=_[w],n.texImage2D(3553,w,p,m.width,m.height,0,h,f,m.data);r.generateMipmaps=!1,e.__maxMipLevel=_.length-1}else n.texImage2D(3553,0,p,l.width,l.height,0,h,f,l.data),e.__maxMipLevel=0;else if(r.isCompressedTexture){for(w=0,S=_.length;w<S;w++)m=_[w],r.format!==Gt&&r.format!==Vt?null!==h?n.compressedTexImage2D(3553,w,p,m.width,m.height,0,m.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,w,p,m.width,m.height,0,h,f,m.data);e.__maxMipLevel=_.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,p,l.width,l.height,l.depth,0,h,f,l.data),e.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,p,l.width,l.height,l.depth,0,h,f,l.data),e.__maxMipLevel=0;else if(_.length>0&&u){for(w=0,S=_.length;w<S;w++)m=_[w],n.texImage2D(3553,w,p,h,f,m);r.generateMipmaps=!1,e.__maxMipLevel=_.length-1}else n.texImage2D(3553,0,p,h,f,l),e.__maxMipLevel=0;y(r,u)&&b(a,r,l.width,l.height),e.__version=r.version,r.onUpdate&&r.onUpdate(r)}function R(e,i,a,s){var c=o.convert(i.texture.format),l=o.convert(i.texture.type),u=x(i.texture.internalFormat,c,l);n.texImage2D(s,0,u,i.width,i.height,0,c,l,null),t.bindFramebuffer(36160,e),t.framebufferTexture2D(36160,a,s,r.get(i.texture).__webglTexture,0),t.bindFramebuffer(36160,null)}function I(e,n,r){if(t.bindRenderbuffer(36161,e),n.depthBuffer&&!n.stencilBuffer){if(r){var i=D(n);t.renderbufferStorageMultisample(36161,i,33189,n.width,n.height)}else t.renderbufferStorage(36161,33189,n.width,n.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(n.depthBuffer&&n.stencilBuffer){if(r){i=D(n);t.renderbufferStorageMultisample(36161,i,35056,n.width,n.height)}else t.renderbufferStorage(36161,34041,n.width,n.height);t.framebufferRenderbuffer(36160,33306,36161,e)}else{var a=o.convert(n.texture.format),s=o.convert(n.texture.type),c=x(n.texture.internalFormat,a,s);if(r){i=D(n);t.renderbufferStorageMultisample(36161,i,c,n.width,n.height)}else t.renderbufferStorage(36161,c,n.width,n.height)}t.bindRenderbuffer(36161,null)}function N(e){var n=r.get(e),i=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,n){if(n&&n.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,e),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),E(n.depthTexture,0);var i=r.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===Xt)t.framebufferTexture2D(36160,36096,3553,i,0);else{if(n.depthTexture.format!==Yt)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(36160,33306,3553,i,0)}}(n.__webglFramebuffer,e)}else if(i){n.__webglDepthbuffer=[];for(var o=0;o<6;o++)t.bindFramebuffer(36160,n.__webglFramebuffer[o]),n.__webglDepthbuffer[o]=t.createRenderbuffer(),I(n.__webglDepthbuffer[o],e)}else t.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=t.createRenderbuffer(),I(n.__webglDepthbuffer,e);t.bindFramebuffer(36160,null)}function D(t){return c&&t.isWebGLMultisampleRenderTarget?Math.min(h,t.samples):0}var z=!1,j=!1;this.allocateTextureUnit=function(){var t=M;return t>=l&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+l),M+=1,t},this.resetTextureUnits=function(){M=0},this.setTexture2D=E,this.setTexture2DArray=function(t,e){var i=r.get(t);t.version>0&&i.__version!==t.version?L(i,t,e):(n.activeTexture(33984+e),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(t,e){var i=r.get(t);t.version>0&&i.__version!==t.version?L(i,t,e):(n.activeTexture(33984+e),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=T,this.setTextureCubeDynamic=A,this.setupRenderTarget=function(i){var s=r.get(i),l=r.get(i.texture);i.addEventListener("dispose",S),l.__webglTexture=t.createTexture(),a.memory.textures++;var u=!0===i.isWebGLCubeRenderTarget,d=!0===i.isWebGLMultisampleRenderTarget,h=!0===i.isWebGLMultiviewRenderTarget,f=v(i)||c;if(u){s.__webglFramebuffer=[];for(var p=0;p<6;p++)s.__webglFramebuffer[p]=t.createFramebuffer()}else if(s.__webglFramebuffer=t.createFramebuffer(),d)if(c){s.__webglMultisampledFramebuffer=t.createFramebuffer(),s.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,s.__webglColorRenderbuffer);var m=o.convert(i.texture.format),g=o.convert(i.texture.type),_=x(i.texture.internalFormat,m,g),w=D(i);t.renderbufferStorageMultisample(36161,w,_,i.width,i.height),t.bindFramebuffer(36160,s.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,s.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),i.depthBuffer&&(s.__webglDepthRenderbuffer=t.createRenderbuffer(),I(s.__webglDepthRenderbuffer,i,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");else if(h){var M=i.width,E=i.height,T=i.numViews;t.bindFramebuffer(36160,s.__webglFramebuffer);var A=e.get("OVR_multiview2");a.memory.textures+=2;var C=t.createTexture();t.bindTexture(35866,C),t.texParameteri(35866,10240,9728),t.texParameteri(35866,10241,9728),t.texImage3D(35866,0,32856,M,E,T,0,6408,5121,null),A.framebufferTextureMultiviewOVR(36160,36064,C,0,0,T);var P=t.createTexture();t.bindTexture(35866,P),t.texParameteri(35866,10240,9728),t.texParameteri(35866,10241,9728),t.texImage3D(35866,0,35056,M,E,T,0,34041,34042,null),A.framebufferTextureMultiviewOVR(36160,33306,P,0,0,T);var k=new Array(T);for(p=0;p<T;++p)k[p]=t.createFramebuffer(),t.bindFramebuffer(36160,k[p]),t.framebufferTextureLayer(36160,36064,C,0,p);s.__webglColorTexture=C,s.__webglDepthStencilTexture=P,s.__webglViewFramebuffers=k,t.bindFramebuffer(36160,null),t.bindTexture(35866,null)}if(u){n.bindTexture(34067,l.__webglTexture),O(34067,i.texture,f);for(p=0;p<6;p++)R(s.__webglFramebuffer[p],i,36064,34069+p);y(i.texture,f)&&b(34067,i.texture,i.width,i.height),n.bindTexture(34067,null)}else h||(n.bindTexture(3553,l.__webglTexture),O(3553,i.texture,f),R(s.__webglFramebuffer,i,36064,3553),y(i.texture,f)&&b(3553,i.texture,i.width,i.height),n.bindTexture(3553,null));i.depthBuffer&&N(i)},this.updateRenderTargetMipmap=function(t){var e=t.texture;if(y(e,v(t)||c)){var i=t.isWebGLCubeRenderTarget?34067:3553,o=r.get(e).__webglTexture;n.bindTexture(i,o),b(i,e,t.width,t.height),n.bindTexture(i,null)}},this.updateMultisampleRenderTarget=function(e){if(e.isWebGLMultisampleRenderTarget)if(c){var n=r.get(e);t.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,n.__webglFramebuffer);var i=e.width,o=e.height,a=16384;e.depthBuffer&&(a|=256),e.stencilBuffer&&(a|=1024),t.blitFramebuffer(0,0,i,o,0,0,i,o,a,9728)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(t,e){t&&t.isWebGLRenderTarget&&(!1===z&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),z=!0),t=t.texture),E(t,e)},this.safeSetTextureCube=function(t,e){t&&t.isWebGLCubeRenderTarget&&(!1===j&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),j=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?T(t,e):A(t,e)}}function ds(t,e,n){var r=n.isWebGL2;return{convert:function(t){var n;if(t===Ot)return 5121;if(t===jt)return 32819;if(t===Ft)return 32820;if(t===Bt)return 33635;if(t===kt)return 5120;if(t===Lt)return 5122;if(t===Rt)return 5123;if(t===It)return 5124;if(t===Nt)return 5125;if(t===Dt)return 5126;if(t===zt)return r?5131:null!==(n=e.get("OES_texture_half_float"))?n.HALF_FLOAT_OES:null;if(t===Ht)return 6406;if(t===Vt)return 6407;if(t===Gt)return 6408;if(t===Wt)return 6409;if(t===$t)return 6410;if(t===Xt)return 6402;if(t===Yt)return 34041;if(t===Kt)return 6403;if(t===Zt)return 36244;if(t===Jt)return 33319;if(t===Qt)return 33320;if(t===te)return 36248;if(t===ee)return 36249;if(t===ne||t===re||t===ie||t===oe){if(null===(n=e.get("WEBGL_compressed_texture_s3tc")))return null;if(t===ne)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===re)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===ie)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===oe)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(t===ae||t===se||t===ce||t===le){if(null===(n=e.get("WEBGL_compressed_texture_pvrtc")))return null;if(t===ae)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===se)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===ce)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===le)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}return t===ue?null!==(n=e.get("WEBGL_compressed_texture_etc1"))?n.COMPRESSED_RGB_ETC1_WEBGL:null:t===de||t===he||t===fe||t===pe||t===me||t===ge||t===ve||t===ye||t===be||t===xe||t===_e||t===we||t===Se||t===Me?null!==(n=e.get("WEBGL_compressed_texture_astc"))?t:null:t===Ut?r?34042:null!==(n=e.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function hs(t,e,n,r){Ln.call(this,t,e,r),this.depthBuffer=!1,this.stencilBuffer=!1,this.numViews=n}function fs(t,e){var n,r,i,o,a,s,c,l=t.extensions,u=t.properties,d=0;function h(t){return t.isArrayCamera?t.cameras:(a[0]=t,a)}this.isAvailable=function(){if(void 0===c){var t=l.get("OVR_multiview2");if(c=null!==t&&!1===e.getContextAttributes().antialias){d=e.getParameter(t.MAX_VIEWS_OVR),n=new hs(0,0,2),s=new Tn,o=[],i=[],a=[];for(var r=0;r<d;r++)o[r]=new Wn,i[r]=new An}}return c},this.attachCamera=function(e){!1!==function(t){if(void 0===t.isArrayCamera)return!0;var e=t.cameras;if(e.length>d)return!1;for(var n=1,r=e.length;n<r;n++)if(e[0].viewport.z!==e[n].viewport.z||e[0].viewport.w!==e[n].viewport.w)return!1;return!0}(e)&&(r=t.getRenderTarget(),function(e){if(r?s.set(r.width,r.height):t.getDrawingBufferSize(s),e.isArrayCamera){var i=e.cameras[0].viewport;n.setSize(i.z,i.w),n.setNumViews(e.cameras.length)}else n.setSize(s.x,s.y),n.setNumViews(2)}(e),t.setRenderTarget(n))},this.detachCamera=function(i){n===t.getRenderTarget()&&(t.setRenderTarget(r),function(t){var r=n,i=r.numViews,o=u.get(r).__webglViewFramebuffers,a=r.width,c=r.height;if(t.isArrayCamera)for(var l=0;l<i;l++){var d=t.cameras[l].viewport,h=d.x,f=d.y,p=h+d.z,m=f+d.w;e.bindFramebuffer(36008,o[l]),e.blitFramebuffer(0,0,a,c,h,f,p,m,16384,9728)}else e.bindFramebuffer(36008,o[0]),e.blitFramebuffer(0,0,a,c,0,0,s.x,s.y,16384,9728)}(i))},this.updateCameraProjectionMatricesUniform=function(t,n){for(var r=h(t),i=0;i<r.length;i++)o[i].copy(r[i].projectionMatrix);n.setValue(e,"projectionMatrices",o)},this.updateCameraViewMatricesUniform=function(t,n){for(var r=h(t),i=0;i<r.length;i++)o[i].copy(r[i].matrixWorldInverse);n.setValue(e,"viewMatrices",o)},this.updateObjectMatricesUniforms=function(t,n,r){for(var a=h(n),s=0;s<a.length;s++)o[s].multiplyMatrices(a[s].matrixWorldInverse,t.matrixWorld),i[s].getNormalMatrix(o[s]);r.setValue(e,"modelViewMatrices",o),r.setValue(e,"normalMatrices",i)}}function ps(t){so.call(this),this.cameras=t||[]}function ms(){lr.call(this),this.type="Group"}function gs(t,e){var n=this,r=null,i=null,o="local-floor",a=null,s=[],c=new Map,l=new so;l.layers.enable(1),l.viewport=new kn;var u=new so;u.layers.enable(2),u.viewport=new kn;var d=new ps([l,u]);d.layers.enable(1),d.layers.enable(2);var h=null,f=null;function p(t){var e=c.get(t.inputSource);e&&(e.targetRay&&e.targetRay.dispatchEvent({type:t.type}),e.grip&&e.grip.dispatchEvent({type:t.type}))}function m(){c.forEach((function(t,e){t.targetRay&&(t.targetRay.dispatchEvent({type:"disconnected",data:e}),t.targetRay.visible=!1),t.grip&&(t.grip.dispatchEvent({type:"disconnected",data:e}),t.grip.visible=!1)})),c.clear(),t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),w.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function g(t){i=t,w.setContext(r),w.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}function v(t){for(var e=r.inputSources,n=0;n<s.length;n++)c.set(e[n],s[n]);for(n=0;n<t.removed.length;n++){var i=t.removed[n];(o=c.get(i))&&(o.targetRay&&o.targetRay.dispatchEvent({type:"disconnected",data:i}),o.grip&&o.grip.dispatchEvent({type:"disconnected",data:i}),c.delete(i))}for(n=0;n<t.added.length;n++){var o;i=t.added[n];(o=c.get(i))&&(o.targetRay&&o.targetRay.dispatchEvent({type:"connected",data:i}),o.grip&&o.grip.dispatchEvent({type:"connected",data:i}))}}this.enabled=!1,this.isPresenting=!1,this.getController=function(t){var e=s[t];return void 0===e&&(e={},s[t]=e),void 0===e.targetRay&&(e.targetRay=new ms,e.targetRay.matrixAutoUpdate=!1,e.targetRay.visible=!1),e.targetRay},this.getControllerGrip=function(t){var e=s[t];return void 0===e&&(e={},s[t]=e),void 0===e.grip&&(e.grip=new ms,e.grip.matrixAutoUpdate=!1,e.grip.visible=!1),e.grip},this.setFramebufferScaleFactor=function(){},this.setReferenceSpaceType=function(t){o=t},this.getReferenceSpace=function(){return i},this.getSession=function(){return r},this.setSession=function(t){if(null!==(r=t)){r.addEventListener("select",p),r.addEventListener("selectstart",p),r.addEventListener("selectend",p),r.addEventListener("squeeze",p),r.addEventListener("squeezestart",p),r.addEventListener("squeezeend",p),r.addEventListener("end",m);var n=e.getContextAttributes(),i={antialias:n.antialias,alpha:n.alpha,depth:n.depth,stencil:n.stencil},a=new XRWebGLLayer(r,e,i);r.updateRenderState({baseLayer:a}),r.requestReferenceSpace(o).then(g),r.addEventListener("inputsourceschange",v)}};var y=new zn,b=new zn;function x(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.getInverse(t.matrixWorld)}this.getCamera=function(t){d.near=u.near=l.near=t.near,d.far=u.far=l.far=t.far,h===d.near&&f===d.far||(r.updateRenderState({depthNear:d.near,depthFar:d.far}),h=d.near,f=d.far);var e=t.parent,n=d.cameras;x(d,e);for(var i=0;i<n.length;i++)x(n[i],e);t.matrixWorld.copy(d.matrixWorld);for(var o=t.children,a=(i=0,o.length);i<a;i++)o[i].updateMatrixWorld(!0);return function(t,e,n){y.setFromMatrixPosition(e.matrixWorld),b.setFromMatrixPosition(n.matrixWorld);var r=y.distanceTo(b),i=e.projectionMatrix.elements,o=n.projectionMatrix.elements,a=i[14]/(i[10]-1),s=i[14]/(i[10]+1),c=(i[9]+1)/i[5],l=(i[9]-1)/i[5],u=(i[8]-1)/i[0],d=(o[8]+1)/o[0],h=a*u,f=a*d,p=r/(-u+d),m=p*-u;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(p),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.getInverse(t.matrixWorld);var g=a+p,v=s+p,x=h-m,_=f+(r-m),w=c*s/v*g,S=l*s/v*g;t.projectionMatrix.makePerspective(x,_,w,S,g,v)}(d,l,u),d};var _=null;var w=new go;w.setAnimationLoop((function(e,n){if(null!==(a=n.getViewerPose(i))){var o=a.views,c=r.renderState.baseLayer;t.setFramebuffer(c.framebuffer);for(var l=0;l<o.length;l++){var u=o[l],h=c.getViewport(u),f=d.cameras[l];f.matrix.fromArray(u.transform.matrix),f.projectionMatrix.fromArray(u.projectionMatrix),f.viewport.set(h.x,h.y,h.width,h.height),0===l&&d.matrix.copy(f.matrix)}}var p=r.inputSources;for(l=0;l<s.length;l++){var m=s[l],g=p[l],v=null,y=null;g&&(m.targetRay&&null!==(v=n.getPose(g.targetRaySpace,i))&&(m.targetRay.matrix.fromArray(v.transform.matrix),m.targetRay.matrix.decompose(m.targetRay.position,m.targetRay.rotation,m.targetRay.scale)),m.grip&&g.gripSpace&&null!==(y=n.getPose(g.gripSpace,i))&&(m.grip.matrix.fromArray(y.transform.matrix),m.grip.matrix.decompose(m.grip.position,m.grip.rotation,m.grip.scale))),m.targetRay&&(m.targetRay.visible=null!==v),m.grip&&(m.grip.visible=null!==y)}_&&_(e,n)})),this.setAnimationLoop=function(t){_=t},this.dispose=function(){}}function vs(t){var e=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==t.context?t.context:null,r=void 0!==t.alpha&&t.alpha,i=void 0===t.depth||t.depth,o=void 0===t.stencil||t.stencil,a=void 0!==t.antialias&&t.antialias,s=void 0===t.premultipliedAlpha||t.premultipliedAlpha,c=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,l=void 0!==t.powerPreference?t.powerPreference:"default",u=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat,d=null,h=null;this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=ze,this.physicallyCorrectLights=!1,this.toneMapping=it,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var f,p,m,g,y,b,x,_,w,S,M,E,T,A,C,P,O,k,L=this,R=!1,I=null,N=0,D=0,z=null,j=null,F=-1,B={geometry:null,program:null,wireframe:!1},U=null,H=null,V=new kn,G=new kn,W=null,$=e.width,q=e.height,X=1,Y=null,K=null,Z=new kn(0,0,$,q),J=new kn(0,0,$,q),Q=!1,tt=new po,et=new Eo,nt=!1,rt=!1,ot=new Wn,at=new zn;function st(){return null===z?X:1}try{var ct={alpha:r,depth:i,stencil:o,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:c,powerPreference:l,failIfMajorPerformanceCaveat:u,xrCompatible:!0};if(e.addEventListener("webglcontextlost",ft,!1),e.addEventListener("webglcontextrestored",pt,!1),null===(f=n||e.getContext("webgl",ct)||e.getContext("experimental-webgl",ct)))throw null!==e.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===f.getShaderPrecisionFormat&&(f.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw console.error("THREE.WebGLRenderer: "+t.message),t}function lt(){p=new To(f),!1===(m=new Mo(f,p,t)).isWebGL2&&(p.get("WEBGL_depth_texture"),p.get("OES_texture_float"),p.get("OES_texture_half_float"),p.get("OES_texture_half_float_linear"),p.get("OES_standard_derivatives"),p.get("OES_element_index_uint"),p.get("ANGLE_instanced_arrays")),p.get("OES_texture_float_linear"),k=new ds(f,p,m),(g=new ls(f,p,m)).scissor(G.copy(J).multiplyScalar(X).floor()),g.viewport(V.copy(Z).multiplyScalar(X).floor()),y=new Po(f),b=new Ya,x=new us(f,p,g,b,m,k,y),_=new vo(f,m),w=new Ao(f,_,y),S=new Lo(f,w,_,y),C=new ko(f),M=new Xa(L,p,m),E=new Qa,T=new os,A=new wo(L,g,S,s),P=new So(f,p,y,m),O=new Co(f,p,y,m),y.programs=M.programs,L.capabilities=m,L.extensions=p,L.properties=b,L.renderLists=E,L.state=g,L.info=y}lt();var ut=new gs(L,f);this.xr=ut;var dt=new fs(L,f),ht=new cs(L,S,m.maxTextureSize);function ft(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),R=!0}function pt(){console.log("THREE.WebGLRenderer: Context Restored."),R=!1,lt()}function mt(t){var e=t.target;e.removeEventListener("dispose",mt),function(t){gt(t),b.remove(t)}(e)}function gt(t){var e=b.get(t).program;t.program=void 0,void 0!==e&&M.releaseProgram(e)}this.shadowMap=ht,this.getContext=function(){return f},this.getContextAttributes=function(){return f.getContextAttributes()},this.forceContextLoss=function(){var t=p.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=p.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return X},this.setPixelRatio=function(t){void 0!==t&&(X=t,this.setSize($,q,!1))},this.getSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),t=new Tn),t.set($,q)},this.setSize=function(t,n,r){ut.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):($=t,q=n,e.width=Math.floor(t*X),e.height=Math.floor(n*X),!1!==r&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),t=new Tn),t.set($*X,q*X).floor()},this.setDrawingBufferSize=function(t,n,r){$=t,q=n,X=r,e.width=Math.floor(t*r),e.height=Math.floor(n*r),this.setViewport(0,0,t,n)},this.getCurrentViewport=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),t=new kn),t.copy(V)},this.getViewport=function(t){return t.copy(Z)},this.setViewport=function(t,e,n,r){t.isVector4?Z.set(t.x,t.y,t.z,t.w):Z.set(t,e,n,r),g.viewport(V.copy(Z).multiplyScalar(X).floor())},this.getScissor=function(t){return t.copy(J)},this.setScissor=function(t,e,n,r){t.isVector4?J.set(t.x,t.y,t.z,t.w):J.set(t,e,n,r),g.scissor(G.copy(J).multiplyScalar(X).floor())},this.getScissorTest=function(){return Q},this.setScissorTest=function(t){g.setScissorTest(Q=t)},this.setOpaqueSort=function(t){Y=t},this.setTransparentSort=function(t){K=t},this.getClearColor=function(){return A.getClearColor()},this.setClearColor=function(){A.setClearColor.apply(A,arguments)},this.getClearAlpha=function(){return A.getClearAlpha()},this.setClearAlpha=function(){A.setClearAlpha.apply(A,arguments)},this.clear=function(t,e,n){var r=0;(void 0===t||t)&&(r|=16384),(void 0===e||e)&&(r|=256),(void 0===n||n)&&(r|=1024),f.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",ft,!1),e.removeEventListener("webglcontextrestored",pt,!1),E.dispose(),T.dispose(),b.dispose(),S.dispose(),ut.dispose(),bt.stop()},this.renderBufferImmediate=function(t,e){g.initAttributes();var n=b.get(t);t.hasPositions&&!n.position&&(n.position=f.createBuffer()),t.hasNormals&&!n.normal&&(n.normal=f.createBuffer()),t.hasUvs&&!n.uv&&(n.uv=f.createBuffer()),t.hasColors&&!n.color&&(n.color=f.createBuffer());var r=e.getAttributes();t.hasPositions&&(f.bindBuffer(34962,n.position),f.bufferData(34962,t.positionArray,35048),g.enableAttribute(r.position),f.vertexAttribPointer(r.position,3,5126,!1,0,0)),t.hasNormals&&(f.bindBuffer(34962,n.normal),f.bufferData(34962,t.normalArray,35048),g.enableAttribute(r.normal),f.vertexAttribPointer(r.normal,3,5126,!1,0,0)),t.hasUvs&&(f.bindBuffer(34962,n.uv),f.bufferData(34962,t.uvArray,35048),g.enableAttribute(r.uv),f.vertexAttribPointer(r.uv,2,5126,!1,0,0)),t.hasColors&&(f.bindBuffer(34962,n.color),f.bufferData(34962,t.colorArray,35048),g.enableAttribute(r.color),f.vertexAttribPointer(r.color,3,5126,!1,0,0)),g.disableUnusedAttributes(),f.drawArrays(4,0,t.count),t.count=0};var vt=new ur;this.renderBufferDirect=function(t,e,n,r,i,o){null===e&&(e=vt);var a=i.isMesh&&i.matrixWorld.determinant()<0,s=Mt(t,e,r,i);g.setMaterial(r,a);var c=!1;B.geometry===n.id&&B.program===s.id&&B.wireframe===(!0===r.wireframe)||(B.geometry=n.id,B.program=s.id,B.wireframe=!0===r.wireframe,c=!0),(r.morphTargets||r.morphNormals)&&(C.update(i,n,r,s),c=!0);var l=n.index,u=n.attributes.position;if(null===l){if(void 0===u||0===u.count)return}else if(0===l.count)return;var d,h=1;!0===r.wireframe&&(l=w.getWireframeAttribute(n),h=2);var v=P;null!==l&&(d=_.get(l),(v=O).setIndex(d)),c&&(!function(t,e,n,r){if(!1===m.isWebGL2&&(t.isInstancedMesh||e.isInstancedBufferGeometry)&&null===p.get("ANGLE_instanced_arrays"))return;g.initAttributes();var i=e.attributes,o=r.getAttributes(),a=n.defaultAttributeValues;for(var s in o){var c=o[s];if(c>=0){var l=i[s];if(void 0!==l){var u=l.normalized,d=l.itemSize;if(void 0===(S=_.get(l)))continue;var h=S.buffer,v=S.type,y=S.bytesPerElement;if(l.isInterleavedBufferAttribute){var b=l.data,x=b.stride,w=l.offset;b&&b.isInstancedInterleavedBuffer?(g.enableAttributeAndDivisor(c,b.meshPerAttribute),void 0===e.maxInstancedCount&&(e.maxInstancedCount=b.meshPerAttribute*b.count)):g.enableAttribute(c),f.bindBuffer(34962,h),f.vertexAttribPointer(c,d,v,u,x*y,w*y)}else l.isInstancedBufferAttribute?(g.enableAttributeAndDivisor(c,l.meshPerAttribute),void 0===e.maxInstancedCount&&(e.maxInstancedCount=l.meshPerAttribute*l.count)):g.enableAttribute(c),f.bindBuffer(34962,h),f.vertexAttribPointer(c,d,v,u,0,0)}else if("instanceMatrix"===s){var S;if(void 0===(S=_.get(t.instanceMatrix)))continue;h=S.buffer,v=S.type;g.enableAttributeAndDivisor(c+0,1),g.enableAttributeAndDivisor(c+1,1),g.enableAttributeAndDivisor(c+2,1),g.enableAttributeAndDivisor(c+3,1),f.bindBuffer(34962,h),f.vertexAttribPointer(c+0,4,v,!1,64,0),f.vertexAttribPointer(c+1,4,v,!1,64,16),f.vertexAttribPointer(c+2,4,v,!1,64,32),f.vertexAttribPointer(c+3,4,v,!1,64,48)}else if(void 0!==a){var M=a[s];if(void 0!==M)switch(M.length){case 2:f.vertexAttrib2fv(c,M);break;case 3:f.vertexAttrib3fv(c,M);break;case 4:f.vertexAttrib4fv(c,M);break;default:f.vertexAttrib1fv(c,M)}}}}g.disableUnusedAttributes()}(i,n,r,s),null!==l&&f.bindBuffer(34963,d.buffer));var y=null!==l?l.count:u.count,b=n.drawRange.start*h,x=n.drawRange.count*h,S=null!==o?o.start*h:0,M=null!==o?o.count*h:1/0,E=Math.max(b,S),T=Math.min(y,b+x,S+M)-1,A=Math.max(0,T-E+1);if(0!==A){if(i.isMesh)!0===r.wireframe?(g.setLineWidth(r.wireframeLinewidth*st()),v.setMode(1)):v.setMode(4);else if(i.isLine){var k=r.linewidth;void 0===k&&(k=1),g.setLineWidth(k*st()),i.isLineSegments?v.setMode(1):i.isLineLoop?v.setMode(2):v.setMode(3)}else i.isPoints?v.setMode(0):i.isSprite&&v.setMode(4);i.isInstancedMesh?v.renderInstances(n,E,A,i.count):n.isInstancedBufferGeometry?v.renderInstances(n,E,A,n.maxInstancedCount):v.render(E,A)}},this.compile=function(t,e){(h=T.get(t,e)).init(),t.traverse((function(t){t.isLight&&(h.pushLight(t),t.castShadow&&h.pushShadow(t))})),h.setupLights(e);var n={};t.traverse((function(e){if(e.material)if(Array.isArray(e.material))for(var r=0;r<e.material.length;r++)e.material[r].uuid in n==!1&&(St(e.material[r],t,e),n[e.material[r].uuid]=!0);else e.material.uuid in n==!1&&(St(e.material,t,e),n[e.material.uuid]=!0)}))};var yt=null;var bt=new go;function xt(t,e,n,r){if(!1!==t.visible){if(t.layers.test(e.layers))if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)h.pushLight(t),t.castShadow&&h.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||tt.intersectsSprite(t)){r&&at.setFromMatrixPosition(t.matrixWorld).applyMatrix4(ot);var i=S.update(t);(o=t.material).visible&&d.push(t,i,o,n,at.z,null)}}else if(t.isImmediateRenderObject)r&&at.setFromMatrixPosition(t.matrixWorld).applyMatrix4(ot),d.push(t,null,t.material,n,at.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==y.render.frame&&(t.skeleton.update(),t.skeleton.frame=y.render.frame),!t.frustumCulled||tt.intersectsObject(t))){r&&at.setFromMatrixPosition(t.matrixWorld).applyMatrix4(ot);i=S.update(t);var o=t.material;if(Array.isArray(o))for(var a=i.groups,s=0,c=a.length;s<c;s++){var l=a[s],u=o[l.materialIndex];u&&u.visible&&d.push(t,i,u,n,at.z,l)}else o.visible&&d.push(t,i,o,n,at.z,null)}var f=t.children;for(s=0,c=f.length;s<c;s++)xt(f[s],e,n,r)}}function _t(t,e,n,r){for(var i=0,o=t.length;i<o;i++){var a=t[i],s=a.object,c=a.geometry,l=void 0===r?a.material:r,u=a.group;if(n.isArrayCamera)if(H=n,ut.enabled&&dt.isAvailable())wt(s,e,n,c,l,u);else for(var d=n.cameras,f=0,p=d.length;f<p;f++){var m=d[f];s.layers.test(m.layers)&&(g.viewport(V.copy(m.viewport)),h.setupLights(m),wt(s,e,m,c,l,u))}else H=null,wt(s,e,n,c,l,u)}}function wt(t,e,n,r,i,o){if(t.onBeforeRender(L,e,n,r,i,o),h=T.get(e,H||n),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){var a=Mt(n,e,i,t);g.setMaterial(i),B.geometry=null,B.program=null,B.wireframe=!1,function(t,e){t.render((function(t){L.renderBufferImmediate(t,e)}))}(t,a)}else L.renderBufferDirect(n,e,r,i,t,o);t.onAfterRender(L,e,n,r,i,o),h=T.get(e,H||n)}function St(t,e,n){var r=b.get(t),i=h.state.lights,o=h.state.shadowsArray,a=i.state.version,s=M.getParameters(t,i.state,o,e,et.numPlanes,et.numIntersection,n),c=M.getProgramCacheKey(s),l=r.program,u=!0;if(void 0===l)t.addEventListener("dispose",mt);else if(l.cacheKey!==c)gt(t);else if(r.lightsStateVersion!==a)r.lightsStateVersion=a,u=!1;else{if(void 0!==s.shaderID)return;u=!1}u&&(l=M.acquireProgram(s,c),r.program=l,r.uniforms=s.uniforms,r.environment=t.isMeshStandardMaterial?e.environment:null,r.outputEncoding=L.outputEncoding,t.program=l);var d=l.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var f=0;f<L.maxMorphTargets;f++)d["morphTarget"+f]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;for(f=0;f<L.maxMorphNormals;f++)d["morphNormal"+f]>=0&&t.numSupportedMorphNormals++}var p=r.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(r.numClippingPlanes=et.numPlanes,r.numIntersection=et.numIntersection,p.clippingPlanes=et.uniform),r.fog=e.fog,r.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),r.lightsStateVersion=a,r.needsLights&&(p.ambientLightColor.value=i.state.ambient,p.lightProbe.value=i.state.probe,p.directionalLights.value=i.state.directional,p.spotLights.value=i.state.spot,p.rectAreaLights.value=i.state.rectArea,p.pointLights.value=i.state.point,p.hemisphereLights.value=i.state.hemi,p.directionalShadowMap.value=i.state.directionalShadowMap,p.directionalShadowMatrix.value=i.state.directionalShadowMatrix,p.spotShadowMap.value=i.state.spotShadowMap,p.spotShadowMatrix.value=i.state.spotShadowMatrix,p.pointShadowMap.value=i.state.pointShadowMap,p.pointShadowMatrix.value=i.state.pointShadowMatrix);var m=r.program.getUniforms(),g=Oa.seqWithValue(m.seq,p);r.uniformsList=g}function Mt(t,e,n,r){x.resetTextureUnits();var i=e.fog,o=n.isMeshStandardMaterial?e.environment:null,a=b.get(n),s=h.state.lights;if(nt&&(rt||t!==U)){var c=t===U&&n.id===F;et.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,t,a,c)}n.version===a.__version?void 0===a.program||n.fog&&a.fog!==i||a.environment!==o||a.needsLights&&a.lightsStateVersion!==s.state.version?St(n,e,r):void 0===a.numClippingPlanes||a.numClippingPlanes===et.numPlanes&&a.numIntersection===et.numIntersection?a.outputEncoding!==L.outputEncoding&&St(n,e,r):St(n,e,r):(St(n,e,r),a.__version=n.version);var l,u,d=!1,p=!1,y=!1,_=a.program,w=_.getUniforms(),S=a.uniforms;if(g.useProgram(_.program)&&(d=!0,p=!0,y=!0),n.id!==F&&(F=n.id,p=!0),d||U!==t){if(_.numMultiviewViews>0?dt.updateCameraProjectionMatricesUniform(t,w):w.setValue(f,"projectionMatrix",t.projectionMatrix),m.logarithmicDepthBuffer&&w.setValue(f,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),U!==t&&(U=t,p=!0,y=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){var M=w.map.cameraPosition;void 0!==M&&M.setValue(f,at.setFromMatrixPosition(t.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&w.setValue(f,"isOrthographic",!0===t.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&(_.numMultiviewViews>0?dt.updateCameraViewMatricesUniform(t,w):w.setValue(f,"viewMatrix",t.matrixWorldInverse))}if(n.skinning){w.setOptional(f,r,"bindMatrix"),w.setOptional(f,r,"bindMatrixInverse");var E=r.skeleton;if(E){var T=E.bones;if(m.floatVertexTextures){if(void 0===E.boneTexture){var A=Math.sqrt(4*T.length);A=En.ceilPowerOfTwo(A),A=Math.max(A,4);var C=new Float32Array(A*A*4);C.set(E.boneMatrices);var P=new uo(C,A,A,Gt,Dt);E.boneMatrices=C,E.boneTexture=P,E.boneTextureSize=A}w.setValue(f,"boneTexture",E.boneTexture,x),w.setValue(f,"boneTextureSize",E.boneTextureSize)}else w.setOptional(f,E,"boneMatrices")}}return(p||a.receiveShadow!==r.receiveShadow)&&(a.receiveShadow=r.receiveShadow,w.setValue(f,"receiveShadow",r.receiveShadow)),p&&(w.setValue(f,"toneMappingExposure",L.toneMappingExposure),w.setValue(f,"toneMappingWhitePoint",L.toneMappingWhitePoint),a.needsLights&&(u=y,(l=S).ambientLightColor.needsUpdate=u,l.lightProbe.needsUpdate=u,l.directionalLights.needsUpdate=u,l.pointLights.needsUpdate=u,l.spotLights.needsUpdate=u,l.rectAreaLights.needsUpdate=u,l.hemisphereLights.needsUpdate=u),i&&n.fog&&function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)}(S,i),n.isMeshBasicMaterial?Et(S,n):n.isMeshLambertMaterial?(Et(S,n),function(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}(S,n)):n.isMeshToonMaterial?(Et(S,n),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.gradientMap&&(t.gradientMap.value=e.gradientMap);e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===v&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===v&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(S,n)):n.isMeshPhongMaterial?(Et(S,n),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===v&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===v&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(S,n)):n.isMeshStandardMaterial?(Et(S,n,o),n.isMeshPhysicalMaterial?function(t,e,n){Tt(t,e,n),t.reflectivity.value=e.reflectivity,t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.sheen&&t.sheen.value.copy(e.sheen);e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,e.side===v&&t.clearcoatNormalScale.value.negate());t.transparency.value=e.transparency}(S,n,o):Tt(S,n,o)):n.isMeshMatcapMaterial?(Et(S,n),function(t,e){e.matcap&&(t.matcap.value=e.matcap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===v&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===v&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(S,n)):n.isMeshDepthMaterial?(Et(S,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(S,n)):n.isMeshDistanceMaterial?(Et(S,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias);t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(S,n)):n.isMeshNormalMaterial?(Et(S,n),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===v&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===v&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(S,n)):n.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}(S,n),n.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(S,n)):n.isPointsMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*X,t.scale.value=.5*q,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);var n;e.map?n=e.map:e.alphaMap&&(n=e.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(S,n):n.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);var n;e.map?n=e.map:e.alphaMap&&(n=e.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(S,n):n.isShadowMaterial&&(S.color.value.copy(n.color),S.opacity.value=n.opacity),void 0!==S.ltc_1&&(S.ltc_1.value=mo.LTC_1),void 0!==S.ltc_2&&(S.ltc_2.value=mo.LTC_2),Oa.upload(f,a.uniformsList,S,x),n.isShaderMaterial&&(n.uniformsNeedUpdate=!1)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(Oa.upload(f,a.uniformsList,S,x),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&w.setValue(f,"center",r.center),_.numMultiviewViews>0?dt.updateObjectMatricesUniforms(r,t,w):(w.setValue(f,"modelViewMatrix",r.modelViewMatrix),w.setValue(f,"normalMatrix",r.normalMatrix)),w.setValue(f,"modelMatrix",r.matrixWorld),_}function Et(t,e,n){t.opacity.value=e.opacity,e.color&&t.diffuse.value.copy(e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap);var r,i,o=e.envMap||n;o&&(t.envMap.value=o,t.flipEnvMap.value=o.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio,t.maxMipLevel.value=b.get(o).__maxMipLevel),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),e.map?r=e.map:e.specularMap?r=e.specularMap:e.displacementMap?r=e.displacementMap:e.normalMap?r=e.normalMap:e.bumpMap?r=e.bumpMap:e.roughnessMap?r=e.roughnessMap:e.metalnessMap?r=e.metalnessMap:e.alphaMap?r=e.alphaMap:e.emissiveMap&&(r=e.emissiveMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix)),e.aoMap?i=e.aoMap:e.lightMap&&(i=e.lightMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uv2Transform.value.copy(i.matrix))}function Tt(t,e,n){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===v&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===v&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),(e.envMap||n)&&(t.envMapIntensity.value=e.envMapIntensity)}bt.setAnimationLoop((function(t){ut.isPresenting||yt&&yt(t)})),"undefined"!=typeof window&&bt.setContext(window),this.setAnimationLoop=function(t){yt=t,ut.setAnimationLoop(t),bt.start()},this.render=function(t,e){var n,r;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),r=arguments[3]),e&&e.isCamera){if(!R){B.geometry=null,B.program=null,B.wireframe=!1,F=-1,U=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),ut.enabled&&ut.isPresenting&&(e=ut.getCamera(e)),(h=T.get(t,e)).init(),t.onBeforeRender(L,t,e,n||z),ot.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),tt.setFromProjectionMatrix(ot),rt=this.localClippingEnabled,nt=et.init(this.clippingPlanes,rt,e),(d=E.get(t,e)).init(),xt(t,e,0,L.sortObjects),!0===L.sortObjects&&d.sort(Y,K),nt&&et.beginShadows();var i=h.state.shadowsArray;ht.render(i,t,e),h.setupLights(e),nt&&et.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),ut.enabled&&dt.isAvailable()&&dt.attachCamera(e),A.render(d,t,e,r);var o=d.opaque,a=d.transparent;if(t.overrideMaterial){var s=t.overrideMaterial;o.length&&_t(o,t,e,s),a.length&&_t(a,t,e,s)}else o.length&&_t(o,t,e),a.length&&_t(a,t,e);t.onAfterRender(L,t,e),null!==z&&(x.updateRenderTargetMipmap(z),x.updateMultisampleRenderTarget(z)),g.buffers.depth.setTest(!0),g.buffers.depth.setMask(!0),g.buffers.color.setMask(!0),g.setPolygonOffset(!1),ut.enabled&&dt.isAvailable()&&dt.detachCamera(e),d=null,h=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(t){I!==t&&null===z&&f.bindFramebuffer(36160,t),I=t},this.getActiveCubeFace=function(){return N},this.getActiveMipmapLevel=function(){return D},this.getRenderTarget=function(){return z},this.setRenderTarget=function(t,e,n){z=t,N=e,D=n,t&&void 0===b.get(t).__webglFramebuffer&&x.setupRenderTarget(t);var r=I,i=!1;if(t){var o=b.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(r=o[e||0],i=!0):r=t.isWebGLMultisampleRenderTarget?b.get(t).__webglMultisampledFramebuffer:o,V.copy(t.viewport),G.copy(t.scissor),W=t.scissorTest}else V.copy(Z).multiplyScalar(X).floor(),G.copy(J).multiplyScalar(X).floor(),W=Q;if(j!==r&&(f.bindFramebuffer(36160,r),j=r),g.viewport(V),g.scissor(G),g.setScissorTest(W),i){var a=b.get(t.texture);f.framebufferTexture2D(36160,36064,34069+(e||0),a.__webglTexture,n||0)}},this.readRenderTargetPixels=function(t,e,n,r,i,o,a){if(t&&t.isWebGLRenderTarget){var s=b.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==a&&(s=s[a]),s){var c=!1;s!==j&&(f.bindFramebuffer(36160,s),c=!0);try{var l=t.texture,u=l.format,d=l.type;if(u!==Gt&&k.convert(u)!==f.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(d===Ot||k.convert(d)===f.getParameter(35738)||d===Dt&&(m.isWebGL2||p.get("OES_texture_float")||p.get("WEBGL_color_buffer_float"))||d===zt&&(m.isWebGL2?p.get("EXT_color_buffer_float"):p.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===f.checkFramebufferStatus(36160)?e>=0&&e<=t.width-r&&n>=0&&n<=t.height-i&&f.readPixels(e,n,r,i,k.convert(u),k.convert(d),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{c&&f.bindFramebuffer(36160,j)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(t,e,n){void 0===n&&(n=0);var r=Math.pow(2,-n),i=Math.floor(e.image.width*r),o=Math.floor(e.image.height*r),a=k.convert(e.format);x.setTexture2D(e,0),f.copyTexImage2D(3553,n,a,t.x,t.y,i,o,0),g.unbindTexture()},this.copyTextureToTexture=function(t,e,n,r){var i=e.image.width,o=e.image.height,a=k.convert(n.format),s=k.convert(n.type);x.setTexture2D(n,0),e.isDataTexture?f.texSubImage2D(3553,r||0,t.x,t.y,i,o,a,s,e.image.data):f.texSubImage2D(3553,r||0,t.x,t.y,a,s,e.image),g.unbindTexture()},this.initTexture=function(t){x.setTexture2D(t,0),g.unbindTexture()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function ys(t,e){this.name="",this.color=new ti(t),this.density=void 0!==e?e:25e-5}function bs(t,e,n){this.name="",this.color=new ti(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3}function xs(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=hn,this.updateRange={offset:0,count:-1},this.version=0}hs.prototype=Object.assign(Object.create(Ln.prototype),{constructor:hs,isWebGLMultiviewRenderTarget:!0,copy:function(t){return Ln.prototype.copy.call(this,t),this.numViews=t.numViews,this},setNumViews:function(t){return this.numViews!==t&&(this.numViews=t,this.dispose()),this}}),ps.prototype=Object.assign(Object.create(so.prototype),{constructor:ps,isArrayCamera:!0}),ms.prototype=Object.assign(Object.create(lr.prototype),{constructor:ms,isGroup:!0}),Object.assign(gs.prototype,_n.prototype),Object.assign(ys.prototype,{isFogExp2:!0,clone:function(){return new ys(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(bs.prototype,{isFog:!0,clone:function(){return new bs(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(xs.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(xs.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(var r=0,i=this.stride;r<i;r++)this.array[t+r]=e.array[n+r];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}});var _s,ws=new zn;function Ss(t,e,n,r){this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===r}function Ms(t){ai.call(this),this.type="SpriteMaterial",this.color=new ti(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}Object.defineProperties(Ss.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(Ss.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(var e=0,n=this.data.count;e<n;e++)ws.x=this.getX(e),ws.y=this.getY(e),ws.z=this.getZ(e),ws.applyMatrix4(t),this.setXYZ(e,ws.x,ws.y,ws.z);return this},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=i,this}}),Ms.prototype=Object.create(ai.prototype),Ms.prototype.constructor=Ms,Ms.prototype.isSpriteMaterial=!0,Ms.prototype.copy=function(t){return ai.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};var Es=new zn,Ts=new zn,As=new zn,Cs=new Tn,Ps=new Tn,Os=new Wn,ks=new zn,Ls=new zn,Rs=new zn,Is=new Tn,Ns=new Tn,Ds=new Tn;function zs(t){if(lr.call(this),this.type="Sprite",void 0===_s){_s=new Ci;var e=new xs(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);_s.setIndex([0,1,2,0,2,3]),_s.setAttribute("position",new Ss(e,3,0,!1)),_s.setAttribute("uv",new Ss(e,2,3,!1))}this.geometry=_s,this.material=void 0!==t?t:new Ms,this.center=new Tn(.5,.5)}function js(t,e,n,r,i,o){Cs.subVectors(t,n).addScalar(.5).multiply(r),void 0!==i?(Ps.x=o*Cs.x-i*Cs.y,Ps.y=i*Cs.x+o*Cs.y):Ps.copy(Cs),t.copy(e),t.x+=Ps.x,t.y+=Ps.y,t.applyMatrix4(Os)}zs.prototype=Object.assign(Object.create(lr.prototype),{constructor:zs,isSprite:!0,raycast:function(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Ts.setFromMatrixScale(this.matrixWorld),Os.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),As.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Ts.multiplyScalar(-As.z);var n,r,i=this.material.rotation;0!==i&&(r=Math.cos(i),n=Math.sin(i));var o=this.center;js(ks.set(-.5,-.5,0),As,o,Ts,n,r),js(Ls.set(.5,-.5,0),As,o,Ts,n,r),js(Rs.set(.5,.5,0),As,o,Ts,n,r),Is.set(0,0),Ns.set(1,0),Ds.set(1,1);var a=t.ray.intersectTriangle(ks,Ls,Rs,!1,Es);if(null!==a||(js(Ls.set(-.5,.5,0),As,o,Ts,n,r),Ns.set(0,1),null!==(a=t.ray.intersectTriangle(ks,Rs,Ls,!1,Es)))){var s=t.ray.origin.distanceTo(Es);s<t.near||s>t.far||e.push({distance:s,point:Es.clone(),uv:Kr.getUV(Es,ks,Ls,Rs,Is,Ns,Ds,new Tn),face:null,object:this})}},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return lr.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this}});var Fs=new zn,Bs=new zn;function Us(){lr.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function Hs(t,e){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),$i.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Wn,this.bindMatrixInverse=new Wn}Us.prototype=Object.assign(Object.create(lr.prototype),{constructor:Us,isLOD:!0,copy:function(t){lr.prototype.copy.call(this,t,!1);for(var e=t.levels,n=0,r=e.length;n<r;n++){var i=e[n];this.addLevel(i.object.clone(),i.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var n=this.levels,r=0;r<n.length&&!(e<n[r].distance);r++);return n.splice(r,0,{distance:e,object:t}),this.add(t),this},getObjectForDistance:function(t){var e=this.levels;if(e.length>0){for(var n=1,r=e.length;n<r&&!(t<e[n].distance);n++);return e[n-1].object}return null},raycast:function(t,e){if(this.levels.length>0){Fs.setFromMatrixPosition(this.matrixWorld);var n=t.ray.origin.distanceTo(Fs);this.getObjectForDistance(n).raycast(t,e)}},update:function(t){var e=this.levels;if(e.length>1){Fs.setFromMatrixPosition(t.matrixWorld),Bs.setFromMatrixPosition(this.matrixWorld);var n=Fs.distanceTo(Bs);e[0].object.visible=!0;for(var r=1,i=e.length;r<i&&n>=e[r].distance;r++)e[r-1].object.visible=!1,e[r].object.visible=!0;for(;r<i;r++)e[r].object.visible=!1}},toJSON:function(t){var e=lr.prototype.toJSON.call(this,t);!1===this.autoUpdate&&(e.object.autoUpdate=!1),e.object.levels=[];for(var n=this.levels,r=0,i=n.length;r<i;r++){var o=n[r];e.object.levels.push({object:o.object.uuid,distance:o.distance})}return e}}),Hs.prototype=Object.assign(Object.create($i.prototype),{constructor:Hs,isSkinnedMesh:!0,bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new kn,e=this.geometry.attributes.skinWeight,n=0,r=e.count;n<r;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);var i=1/t.manhattanLength();i!==1/0?t.multiplyScalar(i):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){$i.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Vs=new Wn,Gs=new Wn;function Ws(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Wn)}}function $s(){lr.call(this),this.type="Bone"}Object.assign(Ws.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var n=new Wn;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},pose:function(){var t,e,n;for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){for(var t=this.bones,e=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,o=t.length;i<o;i++){var a=t[i]?t[i].matrixWorld:Gs;Vs.multiplyMatrices(a,e[i]),Vs.toArray(n,16*i)}void 0!==r&&(r.needsUpdate=!0)},clone:function(){return new Ws(this.bones,this.boneInverses)},getBoneByName:function(t){for(var e=0,n=this.bones.length;e<n;e++){var r=this.bones[e];if(r.name===t)return r}}}),$s.prototype=Object.assign(Object.create(lr.prototype),{constructor:$s,isBone:!0});var qs=new Wn,Xs=new Wn,Ys=[],Ks=new $i;function Zs(t,e,n){$i.call(this,t,e),this.instanceMatrix=new li(new Float32Array(16*n),16),this.count=n,this.frustumCulled=!1}function Js(t){ai.call(this),this.type="LineBasicMaterial",this.color=new ti(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(t)}Zs.prototype=Object.assign(Object.create($i.prototype),{constructor:Zs,isInstancedMesh:!0,getMatrixAt:function(t,e){e.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,e){var n=this.matrixWorld,r=this.count;if(Ks.geometry=this.geometry,Ks.material=this.material,void 0!==Ks.material)for(var i=0;i<r;i++)this.getMatrixAt(i,qs),Xs.multiplyMatrices(n,qs),Ks.matrixWorld=Xs,Ks.raycast(t,Ys),Ys.length>0&&(Ys[0].instanceId=i,Ys[0].object=this,e.push(Ys[0]),Ys.length=0)},setMatrixAt:function(t,e){e.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){}}),Js.prototype=Object.create(ai.prototype),Js.prototype.constructor=Js,Js.prototype.isLineBasicMaterial=!0,Js.prototype.copy=function(t){return ai.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this};var Qs=new zn,tc=new zn,ec=new Wn,nc=new Nr,rc=new Ar;function ic(t,e,n){1===n&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),lr.call(this),this.type="Line",this.geometry=void 0!==t?t:new Ci,this.material=void 0!==e?e:new Js}ic.prototype=Object.assign(Object.create(lr.prototype),{constructor:ic,isLine:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,n=[0],r=1,i=e.count;r<i;r++)Qs.fromBufferAttribute(e,r-1),tc.fromBufferAttribute(e,r),n[r]=n[r-1],n[r]+=Qs.distanceTo(tc);t.setAttribute("lineDistance",new vi(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){var o=t.vertices;(n=t.lineDistances)[0]=0;for(r=1,i=o.length;r<i;r++)n[r]=n[r-1],n[r]+=o[r-1].distanceTo(o[r])}return this},raycast:function(t,e){var n=t.linePrecision,r=this.geometry,i=this.matrixWorld;if(null===r.boundingSphere&&r.computeBoundingSphere(),rc.copy(r.boundingSphere),rc.applyMatrix4(i),rc.radius+=n,!1!==t.ray.intersectsSphere(rc)){ec.getInverse(i),nc.copy(t.ray).applyMatrix4(ec);var o=n/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,s=new zn,c=new zn,l=new zn,u=new zn,d=this&&this.isLineSegments?2:1;if(r.isBufferGeometry){var h=r.index,f=r.attributes.position.array;if(null!==h)for(var p=h.array,m=0,g=p.length-1;m<g;m+=d){var v=p[m],y=p[m+1];if(s.fromArray(f,3*v),c.fromArray(f,3*y),!(nc.distanceSqToSegment(s,c,u,l)>a))u.applyMatrix4(this.matrixWorld),(_=t.ray.origin.distanceTo(u))<t.near||_>t.far||e.push({distance:_,point:l.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}else for(m=0,g=f.length/3-1;m<g;m+=d){if(s.fromArray(f,3*m),c.fromArray(f,3*m+3),!(nc.distanceSqToSegment(s,c,u,l)>a))u.applyMatrix4(this.matrixWorld),(_=t.ray.origin.distanceTo(u))<t.near||_>t.far||e.push({distance:_,point:l.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}else if(r.isGeometry){var b=r.vertices,x=b.length;for(m=0;m<x-1;m+=d){var _;if(!(nc.distanceSqToSegment(b[m],b[m+1],u,l)>a))u.applyMatrix4(this.matrixWorld),(_=t.ray.origin.distanceTo(u))<t.near||_>t.far||e.push({distance:_,point:l.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var oc=new zn,ac=new zn;function sc(t,e){ic.call(this,t,e),this.type="LineSegments"}function cc(t,e){ic.call(this,t,e),this.type="LineLoop"}function lc(t){ai.call(this),this.type="PointsMaterial",this.color=new ti(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}sc.prototype=Object.assign(Object.create(ic.prototype),{constructor:sc,isLineSegments:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,n=[],r=0,i=e.count;r<i;r+=2)oc.fromBufferAttribute(e,r),ac.fromBufferAttribute(e,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+oc.distanceTo(ac);t.setAttribute("lineDistance",new vi(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){var o=t.vertices;for(n=t.lineDistances,r=0,i=o.length;r<i;r+=2)oc.copy(o[r]),ac.copy(o[r+1]),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+oc.distanceTo(ac)}return this}}),cc.prototype=Object.assign(Object.create(ic.prototype),{constructor:cc,isLineLoop:!0}),lc.prototype=Object.create(ai.prototype),lc.prototype.constructor=lc,lc.prototype.isPointsMaterial=!0,lc.prototype.copy=function(t){return ai.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};var uc=new Wn,dc=new Nr,hc=new Ar,fc=new zn;function pc(t,e){lr.call(this),this.type="Points",this.geometry=void 0!==t?t:new Ci,this.material=void 0!==e?e:new lc,this.updateMorphTargets()}function mc(t,e,n,r,i,o,a){var s=dc.distanceSqToPoint(t);if(s<n){var c=new zn;dc.closestPointToPoint(t,c),c.applyMatrix4(r);var l=i.ray.origin.distanceTo(c);if(l<i.near||l>i.far)return;o.push({distance:l,distanceToRay:Math.sqrt(s),point:c,index:e,face:null,object:a})}}function gc(t,e,n,r,i,o,a,s,c){On.call(this,t,e,n,r,i,o,a,s,c),this.format=void 0!==a?a:Vt,this.minFilter=void 0!==o?o:Et,this.magFilter=void 0!==i?i:Et,this.generateMipmaps=!1}function vc(t,e,n,r,i,o,a,s,c,l,u,d){On.call(this,null,o,a,s,c,l,r,i,u,d),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function yc(t,e,n,r,i,o,a,s,c){On.call(this,t,e,n,r,i,o,a,s,c),this.needsUpdate=!0}function bc(t,e,n,r,i,o,a,s,c,l){if((l=void 0!==l?l:Xt)!==Xt&&l!==Yt)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&l===Xt&&(n=Rt),void 0===n&&l===Yt&&(n=Ut),On.call(this,null,r,i,o,a,s,l,n,c),this.image={width:t,height:e},this.magFilter=void 0!==a?a:xt,this.minFilter=void 0!==s?s:xt,this.flipY=!1,this.generateMipmaps=!1}function xc(t){Ci.call(this),this.type="WireframeGeometry";var e,n,r,i,o,a,s,c,l,u,d=[],h=[0,0],f={},p=["a","b","c"];if(t&&t.isGeometry){var m=t.faces;for(e=0,r=m.length;e<r;e++){var g=m[e];for(n=0;n<3;n++)s=g[p[n]],c=g[p[(n+1)%3]],h[0]=Math.min(s,c),h[1]=Math.max(s,c),void 0===f[l=h[0]+","+h[1]]&&(f[l]={index1:h[0],index2:h[1]})}for(l in f)a=f[l],u=t.vertices[a.index1],d.push(u.x,u.y,u.z),u=t.vertices[a.index2],d.push(u.x,u.y,u.z)}else if(t&&t.isBufferGeometry){var v,y,b,x,_,w,S;if(u=new zn,null!==t.index){for(v=t.attributes.position,y=t.index,0===(b=t.groups).length&&(b=[{start:0,count:y.count,materialIndex:0}]),i=0,o=b.length;i<o;++i)for(e=_=(x=b[i]).start,r=_+x.count;e<r;e+=3)for(n=0;n<3;n++)s=y.getX(e+n),c=y.getX(e+(n+1)%3),h[0]=Math.min(s,c),h[1]=Math.max(s,c),void 0===f[l=h[0]+","+h[1]]&&(f[l]={index1:h[0],index2:h[1]});for(l in f)a=f[l],u.fromBufferAttribute(v,a.index1),d.push(u.x,u.y,u.z),u.fromBufferAttribute(v,a.index2),d.push(u.x,u.y,u.z)}else for(e=0,r=(v=t.attributes.position).count/3;e<r;e++)for(n=0;n<3;n++)w=3*e+n,u.fromBufferAttribute(v,w),d.push(u.x,u.y,u.z),S=3*e+(n+1)%3,u.fromBufferAttribute(v,S),d.push(u.x,u.y,u.z)}this.setAttribute("position",new vi(d,3))}function _c(t,e,n){Qi.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n},this.fromBufferGeometry(new wc(t,e,n)),this.mergeVertices()}function wc(t,e,n){Ci.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:n};var r,i,o=[],a=[],s=[],c=[],l=1e-5,u=new zn,d=new zn,h=new zn,f=new zn,p=new zn;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var m=e+1;for(r=0;r<=n;r++){var g=r/n;for(i=0;i<=e;i++){var v=i/e;t(v,g,d),a.push(d.x,d.y,d.z),v-l>=0?(t(v-l,g,h),f.subVectors(d,h)):(t(v+l,g,h),f.subVectors(h,d)),g-l>=0?(t(v,g-l,h),p.subVectors(d,h)):(t(v,g+l,h),p.subVectors(h,d)),u.crossVectors(f,p).normalize(),s.push(u.x,u.y,u.z),c.push(v,g)}}for(r=0;r<n;r++)for(i=0;i<e;i++){var y=r*m+i,b=r*m+i+1,x=(r+1)*m+i+1,_=(r+1)*m+i;o.push(y,b,_),o.push(b,x,_)}this.setIndex(o),this.setAttribute("position",new vi(a,3)),this.setAttribute("normal",new vi(s,3)),this.setAttribute("uv",new vi(c,2))}function Sc(t,e,n,r){Qi.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},this.fromBufferGeometry(new Mc(t,e,n,r)),this.mergeVertices()}function Mc(t,e,n,r){Ci.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},n=n||1;var i=[],o=[];function a(t,e,n,r){var i,o,a=Math.pow(2,r),c=[];for(i=0;i<=a;i++){c[i]=[];var l=t.clone().lerp(n,i/a),u=e.clone().lerp(n,i/a),d=a-i;for(o=0;o<=d;o++)c[i][o]=0===o&&i===a?l:l.clone().lerp(u,o/d)}for(i=0;i<a;i++)for(o=0;o<2*(a-i)-1;o++){var h=Math.floor(o/2);o%2==0?(s(c[i][h+1]),s(c[i+1][h]),s(c[i][h])):(s(c[i][h+1]),s(c[i+1][h+1]),s(c[i+1][h]))}}function s(t){i.push(t.x,t.y,t.z)}function c(e,n){var r=3*e;n.x=t[r+0],n.y=t[r+1],n.z=t[r+2]}function l(t,e,n,r){r<0&&1===t.x&&(o[e]=t.x-1),0===n.x&&0===n.z&&(o[e]=r/2/Math.PI+.5)}function u(t){return Math.atan2(t.z,-t.x)}!function(t){for(var n=new zn,r=new zn,i=new zn,o=0;o<e.length;o+=3)c(e[o+0],n),c(e[o+1],r),c(e[o+2],i),a(n,r,i,t)}(r=r||0),function(t){for(var e=new zn,n=0;n<i.length;n+=3)e.x=i[n+0],e.y=i[n+1],e.z=i[n+2],e.normalize().multiplyScalar(t),i[n+0]=e.x,i[n+1]=e.y,i[n+2]=e.z}(n),function(){for(var t=new zn,e=0;e<i.length;e+=3){t.x=i[e+0],t.y=i[e+1],t.z=i[e+2];var n=u(t)/2/Math.PI+.5,r=(a=t,Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+.5);o.push(n,1-r)}var a;(function(){for(var t=new zn,e=new zn,n=new zn,r=new zn,a=new Tn,s=new Tn,c=new Tn,d=0,h=0;d<i.length;d+=9,h+=6){t.set(i[d+0],i[d+1],i[d+2]),e.set(i[d+3],i[d+4],i[d+5]),n.set(i[d+6],i[d+7],i[d+8]),a.set(o[h+0],o[h+1]),s.set(o[h+2],o[h+3]),c.set(o[h+4],o[h+5]),r.copy(t).add(e).add(n).divideScalar(3);var f=u(r);l(a,h+0,t,f),l(s,h+2,e,f),l(c,h+4,n,f)}})(),function(){for(var t=0;t<o.length;t+=6){var e=o[t+0],n=o[t+2],r=o[t+4],i=Math.max(e,n,r),a=Math.min(e,n,r);i>.9&&a<.1&&(e<.2&&(o[t+0]+=1),n<.2&&(o[t+2]+=1),r<.2&&(o[t+4]+=1))}}()}(),this.setAttribute("position",new vi(i,3)),this.setAttribute("normal",new vi(i.slice(),3)),this.setAttribute("uv",new vi(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function Ec(t,e){Qi.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Tc(t,e)),this.mergeVertices()}function Tc(t,e){Mc.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Ac(t,e){Qi.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Cc(t,e)),this.mergeVertices()}function Cc(t,e){Mc.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Pc(t,e){Qi.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Oc(t,e)),this.mergeVertices()}function Oc(t,e){var n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1];Mc.call(this,r,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function kc(t,e){Qi.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Lc(t,e)),this.mergeVertices()}function Lc(t,e){var n=(1+Math.sqrt(5))/2,r=1/n,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r];Mc.call(this,i,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Rc(t,e,n,r,i,o){Qi.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");var a=new Ic(t,e,n,r,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function Ic(t,e,n,r,i){Ci.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},e=e||64,n=n||1,r=r||8,i=i||!1;var o=t.computeFrenetFrames(e,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;var a,s,c=new zn,l=new zn,u=new Tn,d=new zn,h=[],f=[],p=[],m=[];function g(i){d=t.getPointAt(i/e,d);var a=o.normals[i],u=o.binormals[i];for(s=0;s<=r;s++){var p=s/r*Math.PI*2,m=Math.sin(p),g=-Math.cos(p);l.x=g*a.x+m*u.x,l.y=g*a.y+m*u.y,l.z=g*a.z+m*u.z,l.normalize(),f.push(l.x,l.y,l.z),c.x=d.x+n*l.x,c.y=d.y+n*l.y,c.z=d.z+n*l.z,h.push(c.x,c.y,c.z)}}!function(){for(a=0;a<e;a++)g(a);g(!1===i?e:0),function(){for(a=0;a<=e;a++)for(s=0;s<=r;s++)u.x=a/e,u.y=s/r,p.push(u.x,u.y)}(),function(){for(s=1;s<=e;s++)for(a=1;a<=r;a++){var t=(r+1)*(s-1)+(a-1),n=(r+1)*s+(a-1),i=(r+1)*s+a,o=(r+1)*(s-1)+a;m.push(t,n,o),m.push(n,i,o)}}()}(),this.setIndex(m),this.setAttribute("position",new vi(h,3)),this.setAttribute("normal",new vi(f,3)),this.setAttribute("uv",new vi(p,2))}function Nc(t,e,n,r,i,o,a){Qi.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Dc(t,e,n,r,i,o)),this.mergeVertices()}function Dc(t,e,n,r,i,o){Ci.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},t=t||1,e=e||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,i=i||2,o=o||3;var a,s,c=[],l=[],u=[],d=[],h=new zn,f=new zn,p=new zn,m=new zn,g=new zn,v=new zn,y=new zn;for(a=0;a<=n;++a){var b=a/n*i*Math.PI*2;for(A(b,i,o,t,p),A(b+.01,i,o,t,m),v.subVectors(m,p),y.addVectors(m,p),g.crossVectors(v,y),y.crossVectors(g,v),g.normalize(),y.normalize(),s=0;s<=r;++s){var x=s/r*Math.PI*2,_=-e*Math.cos(x),w=e*Math.sin(x);h.x=p.x+(_*y.x+w*g.x),h.y=p.y+(_*y.y+w*g.y),h.z=p.z+(_*y.z+w*g.z),l.push(h.x,h.y,h.z),f.subVectors(h,p).normalize(),u.push(f.x,f.y,f.z),d.push(a/n),d.push(s/r)}}for(s=1;s<=n;s++)for(a=1;a<=r;a++){var S=(r+1)*(s-1)+(a-1),M=(r+1)*s+(a-1),E=(r+1)*s+a,T=(r+1)*(s-1)+a;c.push(S,M,T),c.push(M,E,T)}function A(t,e,n,r,i){var o=Math.cos(t),a=Math.sin(t),s=n/e*t,c=Math.cos(s);i.x=r*(2+c)*.5*o,i.y=r*(2+c)*a*.5,i.z=r*Math.sin(s)*.5}this.setIndex(c),this.setAttribute("position",new vi(l,3)),this.setAttribute("normal",new vi(u,3)),this.setAttribute("uv",new vi(d,2))}function zc(t,e,n,r,i){Qi.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new jc(t,e,n,r,i)),this.mergeVertices()}function jc(t,e,n,r,i){Ci.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},t=t||1,e=e||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;var o,a,s=[],c=[],l=[],u=[],d=new zn,h=new zn,f=new zn;for(o=0;o<=n;o++)for(a=0;a<=r;a++){var p=a/r*i,m=o/n*Math.PI*2;h.x=(t+e*Math.cos(m))*Math.cos(p),h.y=(t+e*Math.cos(m))*Math.sin(p),h.z=e*Math.sin(m),c.push(h.x,h.y,h.z),d.x=t*Math.cos(p),d.y=t*Math.sin(p),f.subVectors(h,d).normalize(),l.push(f.x,f.y,f.z),u.push(a/r),u.push(o/n)}for(o=1;o<=n;o++)for(a=1;a<=r;a++){var g=(r+1)*o+a-1,v=(r+1)*(o-1)+a-1,y=(r+1)*(o-1)+a,b=(r+1)*o+a;s.push(g,v,b),s.push(v,y,b)}this.setIndex(s),this.setAttribute("position",new vi(c,3)),this.setAttribute("normal",new vi(l,3)),this.setAttribute("uv",new vi(u,2))}pc.prototype=Object.assign(Object.create(lr.prototype),{constructor:pc,isPoints:!0,raycast:function(t,e){var n=this.geometry,r=this.matrixWorld,i=t.params.Points.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),hc.copy(n.boundingSphere),hc.applyMatrix4(r),hc.radius+=i,!1!==t.ray.intersectsSphere(hc)){uc.getInverse(r),dc.copy(t.ray).applyMatrix4(uc);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o;if(n.isBufferGeometry){var s=n.index,c=n.attributes.position.array;if(null!==s)for(var l=s.array,u=0,d=l.length;u<d;u++){var h=l[u];fc.fromArray(c,3*h),mc(fc,h,a,r,t,e,this)}else{u=0;for(var f=c.length/3;u<f;u++)fc.fromArray(c,3*u),mc(fc,u,a,r,t,e,this)}}else{var p=n.vertices;for(u=0,f=p.length;u<f;u++)mc(p[u],u,a,r,t,e,this)}}},updateMorphTargets:function(){var t,e,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,o=Object.keys(i);if(o.length>0){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=a.length;t<e;t++)n=a[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else{var s=r.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),gc.prototype=Object.assign(Object.create(On.prototype),{constructor:gc,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),vc.prototype=Object.create(On.prototype),vc.prototype.constructor=vc,vc.prototype.isCompressedTexture=!0,yc.prototype=Object.create(On.prototype),yc.prototype.constructor=yc,yc.prototype.isCanvasTexture=!0,bc.prototype=Object.create(On.prototype),bc.prototype.constructor=bc,bc.prototype.isDepthTexture=!0,xc.prototype=Object.create(Ci.prototype),xc.prototype.constructor=xc,_c.prototype=Object.create(Qi.prototype),_c.prototype.constructor=_c,wc.prototype=Object.create(Ci.prototype),wc.prototype.constructor=wc,Sc.prototype=Object.create(Qi.prototype),Sc.prototype.constructor=Sc,Mc.prototype=Object.create(Ci.prototype),Mc.prototype.constructor=Mc,Ec.prototype=Object.create(Qi.prototype),Ec.prototype.constructor=Ec,Tc.prototype=Object.create(Mc.prototype),Tc.prototype.constructor=Tc,Ac.prototype=Object.create(Qi.prototype),Ac.prototype.constructor=Ac,Cc.prototype=Object.create(Mc.prototype),Cc.prototype.constructor=Cc,Pc.prototype=Object.create(Qi.prototype),Pc.prototype.constructor=Pc,Oc.prototype=Object.create(Mc.prototype),Oc.prototype.constructor=Oc,kc.prototype=Object.create(Qi.prototype),kc.prototype.constructor=kc,Lc.prototype=Object.create(Mc.prototype),Lc.prototype.constructor=Lc,Rc.prototype=Object.create(Qi.prototype),Rc.prototype.constructor=Rc,Ic.prototype=Object.create(Ci.prototype),Ic.prototype.constructor=Ic,Ic.prototype.toJSON=function(){var t=Ci.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},Nc.prototype=Object.create(Qi.prototype),Nc.prototype.constructor=Nc,Dc.prototype=Object.create(Ci.prototype),Dc.prototype.constructor=Dc,zc.prototype=Object.create(Qi.prototype),zc.prototype.constructor=zc,jc.prototype=Object.create(Ci.prototype),jc.prototype.constructor=jc;var Fc=function(t,e,n){n=n||2;var r,i,o,a,s,c,l,u=e&&e.length,d=u?e[0]*n:t.length,h=Bc(t,0,d,n,!0),f=[];if(!h||h.next===h.prev)return f;if(u&&(h=function(t,e,n,r){var i,o,a,s,c,l=[];for(i=0,o=e.length;i<o;i++)a=e[i]*r,s=i<o-1?e[i+1]*r:t.length,(c=Bc(t,a,s,r,!1))===c.next&&(c.steiner=!0),l.push(Kc(c));for(l.sort(qc),i=0;i<l.length;i++)Xc(l[i],n),n=Uc(n,n.next);return n}(t,e,h,n)),t.length>80*n){r=o=t[0],i=a=t[1];for(var p=n;p<d;p+=n)(s=t[p])<r&&(r=s),(c=t[p+1])<i&&(i=c),s>o&&(o=s),c>a&&(a=c);l=0!==(l=Math.max(o-r,a-i))?1/l:0}return Hc(h,f,n,r,i,l),f};function Bc(t,e,n,r,i){var o,a;if(i===function(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}(t,e,n,r)>0)for(o=e;o<n;o+=r)a=il(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=il(o,t[o],t[o+1],a);return a&&tl(a,a.next)&&(ol(a),a=a.next),a}function Uc(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!tl(r,r.next)&&0!==Qc(r.prev,r,r.next))r=r.next;else{if(ol(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function Hc(t,e,n,r,i,o,a){if(t){!a&&o&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=Yc(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,c,l=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<l&&(s++,r=r.nextZ);e++);for(c=l;s>0||c>0&&r;)0!==s&&(0===c||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,c--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,l*=2}while(a>1)}(i)}(t,r,i,o);for(var s,c,l=t;t.prev!==t.next;)if(s=t.prev,c=t.next,o?Gc(t,r,i,o):Vc(t))e.push(s.i/n),e.push(t.i/n),e.push(c.i/n),ol(t),t=c.next,l=c.next;else if((t=c)===l){a?1===a?Hc(t=Wc(t,e,n),e,n,r,i,o,2):2===a&&$c(t,e,n,r,i,o):Hc(Uc(t),e,n,r,i,o,1);break}}}function Vc(t){var e=t.prev,n=t,r=t.next;if(Qc(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(Zc(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&Qc(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function Gc(t,e,n,r){var i=t.prev,o=t,a=t.next;if(Qc(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,c=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,l=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,u=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,d=Yc(s,c,e,n,r),h=Yc(l,u,e,n,r),f=t.prevZ,p=t.nextZ;f&&f.z>=d&&p&&p.z<=h;){if(f!==t.prev&&f!==t.next&&Zc(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&Qc(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,p!==t.prev&&p!==t.next&&Zc(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&Qc(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;f&&f.z>=d;){if(f!==t.prev&&f!==t.next&&Zc(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&Qc(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=h;){if(p!==t.prev&&p!==t.next&&Zc(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&Qc(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function Wc(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!tl(i,o)&&el(i,r,r.next,o)&&nl(i,o)&&nl(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),ol(r),ol(r.next),r=t=o),r=r.next}while(r!==t);return r}function $c(t,e,n,r,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&Jc(a,s)){var c=rl(a,s);return a=Uc(a,a.next),c=Uc(c,c.next),Hc(a,e,n,r,i,o),void Hc(c,e,n,r,i,o)}s=s.next}a=a.next}while(a!==t)}function qc(t,e){return t.x-e.x}function Xc(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n.prev;var c,l=n,u=n.x,d=n.y,h=1/0;r=n.next;for(;r!==l;)i>=r.x&&r.x>=u&&i!==r.x&&Zc(o<d?i:a,o,u,d,o<d?a:i,o,r.x,r.y)&&((c=Math.abs(o-r.y)/(i-r.x))<h||c===h&&r.x>n.x)&&nl(r,t)&&(n=r,h=c),r=r.next;return n}(t,e)){var n=rl(e,t);Uc(n,n.next)}}function Yc(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Kc(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function Zc(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function Jc(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&el(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&nl(t,e)&&nl(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)}function Qc(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function tl(t,e){return t.x===e.x&&t.y===e.y}function el(t,e,n,r){return!!(tl(t,n)&&tl(e,r)||tl(t,r)&&tl(n,e))||Qc(t,e,n)>0!=Qc(t,e,r)>0&&Qc(n,r,t)>0!=Qc(n,r,e)>0}function nl(t,e){return Qc(t.prev,t,t.next)<0?Qc(t,e,t.next)>=0&&Qc(t,t.prev,e)>=0:Qc(t,e,t.prev)<0||Qc(t,t.next,e)<0}function rl(t,e){var n=new al(t.i,t.x,t.y),r=new al(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function il(t,e,n,r){var i=new al(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function ol(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function al(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var sl={area:function(t){for(var e=t.length,n=0,r=e-1,i=0;i<e;r=i++)n+=t[r].x*t[i].y-t[i].x*t[r].y;return.5*n},isClockWise:function(t){return sl.area(t)<0},triangulateShape:function(t,e){var n=[],r=[],i=[];cl(t),ll(n,t);var o=t.length;e.forEach(cl);for(var a=0;a<e.length;a++)r.push(o),o+=e[a].length,ll(n,e[a]);var s=Fc(n,r);for(a=0;a<s.length;a+=3)i.push(s.slice(a,a+3));return i}};function cl(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function ll(t,e){for(var n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}function ul(t,e){Qi.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new dl(t,e)),this.mergeVertices()}function dl(t,e){Ci.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];for(var n=this,r=[],i=[],o=0,a=t.length;o<a;o++){s(t[o])}function s(t){var o=[],a=void 0!==e.curveSegments?e.curveSegments:12,s=void 0!==e.steps?e.steps:1,c=void 0!==e.depth?e.depth:100,l=void 0===e.bevelEnabled||e.bevelEnabled,u=void 0!==e.bevelThickness?e.bevelThickness:6,d=void 0!==e.bevelSize?e.bevelSize:u-2,h=void 0!==e.bevelOffset?e.bevelOffset:0,f=void 0!==e.bevelSegments?e.bevelSegments:3,p=e.extrudePath,m=void 0!==e.UVGenerator?e.UVGenerator:hl;void 0!==e.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),c=e.amount);var g,v,y,b,x,_,w,S,M=!1;p&&(g=p.getSpacedPoints(s),M=!0,l=!1,v=p.computeFrenetFrames(s,!1),y=new zn,b=new zn,x=new zn),l||(f=0,u=0,d=0,h=0);var E=t.extractPoints(a),T=E.shape,A=E.holes;if(!sl.isClockWise(T))for(T=T.reverse(),w=0,S=A.length;w<S;w++)_=A[w],sl.isClockWise(_)&&(A[w]=_.reverse());var C=sl.triangulateShape(T,A),P=T;for(w=0,S=A.length;w<S;w++)_=A[w],T=T.concat(_);function O(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}var k,L,R,I,N,D,z=T.length,j=C.length;function F(t,e,n){var r,i,o,a=t.x-e.x,s=t.y-e.y,c=n.x-t.x,l=n.y-t.y,u=a*a+s*s,d=a*l-s*c;if(Math.abs(d)>Number.EPSILON){var h=Math.sqrt(u),f=Math.sqrt(c*c+l*l),p=e.x-s/h,m=e.y+a/h,g=((n.x-l/f-p)*l-(n.y+c/f-m)*c)/(a*l-s*c),v=(r=p+a*g-t.x)*r+(i=m+s*g-t.y)*i;if(v<=2)return new Tn(r,i);o=Math.sqrt(v/2)}else{var y=!1;a>Number.EPSILON?c>Number.EPSILON&&(y=!0):a<-Number.EPSILON?c<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(l)&&(y=!0),y?(r=-s,i=a,o=Math.sqrt(u)):(r=a,i=s,o=Math.sqrt(u/2))}return new Tn(r/o,i/o)}for(var B=[],U=0,H=P.length,V=H-1,G=U+1;U<H;U++,V++,G++)V===H&&(V=0),G===H&&(G=0),B[U]=F(P[U],P[V],P[G]);var W,$,q=[],X=B.concat();for(w=0,S=A.length;w<S;w++){for(_=A[w],W=[],U=0,V=(H=_.length)-1,G=U+1;U<H;U++,V++,G++)V===H&&(V=0),G===H&&(G=0),W[U]=F(_[U],_[V],_[G]);q.push(W),X=X.concat(W)}for(k=0;k<f;k++){for(R=k/f,I=u*Math.cos(R*Math.PI/2),L=d*Math.sin(R*Math.PI/2)+h,U=0,H=P.length;U<H;U++)K((N=O(P[U],B[U],L)).x,N.y,-I);for(w=0,S=A.length;w<S;w++)for(_=A[w],W=q[w],U=0,H=_.length;U<H;U++)K((N=O(_[U],W[U],L)).x,N.y,-I)}for(L=d+h,U=0;U<z;U++)N=l?O(T[U],X[U],L):T[U],M?(b.copy(v.normals[0]).multiplyScalar(N.x),y.copy(v.binormals[0]).multiplyScalar(N.y),x.copy(g[0]).add(b).add(y),K(x.x,x.y,x.z)):K(N.x,N.y,0);for($=1;$<=s;$++)for(U=0;U<z;U++)N=l?O(T[U],X[U],L):T[U],M?(b.copy(v.normals[$]).multiplyScalar(N.x),y.copy(v.binormals[$]).multiplyScalar(N.y),x.copy(g[$]).add(b).add(y),K(x.x,x.y,x.z)):K(N.x,N.y,c/s*$);for(k=f-1;k>=0;k--){for(R=k/f,I=u*Math.cos(R*Math.PI/2),L=d*Math.sin(R*Math.PI/2)+h,U=0,H=P.length;U<H;U++)K((N=O(P[U],B[U],L)).x,N.y,c+I);for(w=0,S=A.length;w<S;w++)for(_=A[w],W=q[w],U=0,H=_.length;U<H;U++)N=O(_[U],W[U],L),M?K(N.x,N.y+g[s-1].y,g[s-1].x+I):K(N.x,N.y,c+I)}function Y(t,e){var n,r;for(U=t.length;--U>=0;){n=U,(r=U-1)<0&&(r=t.length-1);var i=0,o=s+2*f;for(i=0;i<o;i++){var a=z*i,c=z*(i+1);J(e+n+a,e+r+a,e+r+c,e+n+c)}}}function K(t,e,n){o.push(t),o.push(e),o.push(n)}function Z(t,e,i){Q(t),Q(e),Q(i);var o=r.length/3,a=m.generateTopUV(n,r,o-3,o-2,o-1);tt(a[0]),tt(a[1]),tt(a[2])}function J(t,e,i,o){Q(t),Q(e),Q(o),Q(e),Q(i),Q(o);var a=r.length/3,s=m.generateSideWallUV(n,r,a-6,a-3,a-2,a-1);tt(s[0]),tt(s[1]),tt(s[3]),tt(s[1]),tt(s[2]),tt(s[3])}function Q(t){r.push(o[3*t+0]),r.push(o[3*t+1]),r.push(o[3*t+2])}function tt(t){i.push(t.x),i.push(t.y)}!function(){var t=r.length/3;if(l){var e=0,i=z*e;for(U=0;U<j;U++)Z((D=C[U])[2]+i,D[1]+i,D[0]+i);for(i=z*(e=s+2*f),U=0;U<j;U++)Z((D=C[U])[0]+i,D[1]+i,D[2]+i)}else{for(U=0;U<j;U++)Z((D=C[U])[2],D[1],D[0]);for(U=0;U<j;U++)Z((D=C[U])[0]+z*s,D[1]+z*s,D[2]+z*s)}n.addGroup(t,r.length/3-t,0)}(),function(){var t=r.length/3,e=0;for(Y(P,e),e+=P.length,w=0,S=A.length;w<S;w++)Y(_=A[w],e),e+=_.length;n.addGroup(t,r.length/3-t,1)}()}this.setAttribute("position",new vi(r,3)),this.setAttribute("uv",new vi(i,2)),this.computeVertexNormals()}ul.prototype=Object.create(Qi.prototype),ul.prototype.constructor=ul,ul.prototype.toJSON=function(){var t=Qi.prototype.toJSON.call(this);return fl(this.parameters.shapes,this.parameters.options,t)},dl.prototype=Object.create(Ci.prototype),dl.prototype.constructor=dl,dl.prototype.toJSON=function(){var t=Ci.prototype.toJSON.call(this);return fl(this.parameters.shapes,this.parameters.options,t)};var hl={generateTopUV:function(t,e,n,r,i){var o=e[3*n],a=e[3*n+1],s=e[3*r],c=e[3*r+1],l=e[3*i],u=e[3*i+1];return[new Tn(o,a),new Tn(s,c),new Tn(l,u)]},generateSideWallUV:function(t,e,n,r,i,o){var a=e[3*n],s=e[3*n+1],c=e[3*n+2],l=e[3*r],u=e[3*r+1],d=e[3*r+2],h=e[3*i],f=e[3*i+1],p=e[3*i+2],m=e[3*o],g=e[3*o+1],v=e[3*o+2];return Math.abs(s-u)<.01?[new Tn(a,1-c),new Tn(l,1-d),new Tn(h,1-p),new Tn(m,1-v)]:[new Tn(s,1-c),new Tn(u,1-d),new Tn(f,1-p),new Tn(g,1-v)]}};function fl(t,e,n){if(n.shapes=[],Array.isArray(t))for(var r=0,i=t.length;r<i;r++){var o=t[r];n.shapes.push(o.uuid)}else n.shapes.push(t.uuid);return void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON()),n}function pl(t,e){Qi.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new ml(t,e)),this.mergeVertices()}function ml(t,e){var n=(e=e||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Qi;var r=n.generateShapes(t,e.size);e.depth=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),dl.call(this,r,e),this.type="TextBufferGeometry"}function gl(t,e,n,r,i,o,a){Qi.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new vl(t,e,n,r,i,o,a)),this.mergeVertices()}function vl(t,e,n,r,i,o,a){Ci.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},t=t||1,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI,o=void 0!==o?o:0,a=void 0!==a?a:Math.PI;var s,c,l=Math.min(o+a,Math.PI),u=0,d=[],h=new zn,f=new zn,p=[],m=[],g=[],v=[];for(c=0;c<=n;c++){var y=[],b=c/n,x=0;for(0==c&&0==o?x=.5/e:c==n&&l==Math.PI&&(x=-.5/e),s=0;s<=e;s++){var _=s/e;h.x=-t*Math.cos(r+_*i)*Math.sin(o+b*a),h.y=t*Math.cos(o+b*a),h.z=t*Math.sin(r+_*i)*Math.sin(o+b*a),m.push(h.x,h.y,h.z),f.copy(h).normalize(),g.push(f.x,f.y,f.z),v.push(_+x,1-b),y.push(u++)}d.push(y)}for(c=0;c<n;c++)for(s=0;s<e;s++){var w=d[c][s+1],S=d[c][s],M=d[c+1][s],E=d[c+1][s+1];(0!==c||o>0)&&p.push(w,S,E),(c!==n-1||l<Math.PI)&&p.push(S,M,E)}this.setIndex(p),this.setAttribute("position",new vi(m,3)),this.setAttribute("normal",new vi(g,3)),this.setAttribute("uv",new vi(v,2))}function yl(t,e,n,r,i,o){Qi.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},this.fromBufferGeometry(new bl(t,e,n,r,i,o)),this.mergeVertices()}function bl(t,e,n,r,i,o){Ci.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},t=t||.5,e=e||1,i=void 0!==i?i:0,o=void 0!==o?o:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var a,s,c,l=[],u=[],d=[],h=[],f=t,p=(e-t)/(r=void 0!==r?Math.max(1,r):1),m=new zn,g=new Tn;for(s=0;s<=r;s++){for(c=0;c<=n;c++)a=i+c/n*o,m.x=f*Math.cos(a),m.y=f*Math.sin(a),u.push(m.x,m.y,m.z),d.push(0,0,1),g.x=(m.x/e+1)/2,g.y=(m.y/e+1)/2,h.push(g.x,g.y);f+=p}for(s=0;s<r;s++){var v=s*(n+1);for(c=0;c<n;c++){var y=a=c+v,b=a+n+1,x=a+n+2,_=a+1;l.push(y,b,_),l.push(b,x,_)}}this.setIndex(l),this.setAttribute("position",new vi(u,3)),this.setAttribute("normal",new vi(d,3)),this.setAttribute("uv",new vi(h,2))}function xl(t,e,n,r){Qi.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},this.fromBufferGeometry(new _l(t,e,n,r)),this.mergeVertices()}function _l(t,e,n,r){Ci.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},e=Math.floor(e)||12,n=n||0,r=r||2*Math.PI,r=En.clamp(r,0,2*Math.PI);var i,o,a,s=[],c=[],l=[],u=1/e,d=new zn,h=new Tn;for(o=0;o<=e;o++){var f=n+o*u*r,p=Math.sin(f),m=Math.cos(f);for(a=0;a<=t.length-1;a++)d.x=t[a].x*p,d.y=t[a].y,d.z=t[a].x*m,c.push(d.x,d.y,d.z),h.x=o/e,h.y=a/(t.length-1),l.push(h.x,h.y)}for(o=0;o<e;o++)for(a=0;a<t.length-1;a++){var g=i=a+o*t.length,v=i+t.length,y=i+t.length+1,b=i+1;s.push(g,v,b),s.push(v,y,b)}if(this.setIndex(s),this.setAttribute("position",new vi(c,3)),this.setAttribute("uv",new vi(l,2)),this.computeVertexNormals(),r===2*Math.PI){var x=this.attributes.normal.array,_=new zn,w=new zn,S=new zn;for(i=e*t.length*3,o=0,a=0;o<t.length;o++,a+=3)_.x=x[a+0],_.y=x[a+1],_.z=x[a+2],w.x=x[i+a+0],w.y=x[i+a+1],w.z=x[i+a+2],S.addVectors(_,w).normalize(),x[a+0]=x[i+a+0]=S.x,x[a+1]=x[i+a+1]=S.y,x[a+2]=x[i+a+2]=S.z}}function wl(t,e){Qi.call(this),this.type="ShapeGeometry","object"==typeof e&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new Sl(t,e)),this.mergeVertices()}function Sl(t,e){Ci.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var n=[],r=[],i=[],o=[],a=0,s=0;if(!1===Array.isArray(t))l(t);else for(var c=0;c<t.length;c++)l(t[c]),this.addGroup(a,s,c),a+=s,s=0;function l(t){var a,c,l,u=r.length/3,d=t.extractPoints(e),h=d.shape,f=d.holes;for(!1===sl.isClockWise(h)&&(h=h.reverse()),a=0,c=f.length;a<c;a++)l=f[a],!0===sl.isClockWise(l)&&(f[a]=l.reverse());var p=sl.triangulateShape(h,f);for(a=0,c=f.length;a<c;a++)l=f[a],h=h.concat(l);for(a=0,c=h.length;a<c;a++){var m=h[a];r.push(m.x,m.y,0),i.push(0,0,1),o.push(m.x,m.y)}for(a=0,c=p.length;a<c;a++){var g=p[a],v=g[0]+u,y=g[1]+u,b=g[2]+u;n.push(v,y,b),s+=3}}this.setIndex(n),this.setAttribute("position",new vi(r,3)),this.setAttribute("normal",new vi(i,3)),this.setAttribute("uv",new vi(o,2))}function Ml(t,e){if(e.shapes=[],Array.isArray(t))for(var n=0,r=t.length;n<r;n++){var i=t[n];e.shapes.push(i.uuid)}else e.shapes.push(t.uuid);return e}function El(t,e){Ci.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e},e=void 0!==e?e:1;var n,r,i,o,a=[],s=Math.cos(En.DEG2RAD*e),c=[0,0],l={},u=["a","b","c"];t.isBufferGeometry?(o=new Qi).fromBufferGeometry(t):o=t.clone(),o.mergeVertices(),o.computeFaceNormals();for(var d=o.vertices,h=o.faces,f=0,p=h.length;f<p;f++)for(var m=h[f],g=0;g<3;g++)n=m[u[g]],r=m[u[(g+1)%3]],c[0]=Math.min(n,r),c[1]=Math.max(n,r),void 0===l[i=c[0]+","+c[1]]?l[i]={index1:c[0],index2:c[1],face1:f,face2:void 0}:l[i].face2=f;for(i in l){var v=l[i];if(void 0===v.face2||h[v.face1].normal.dot(h[v.face2].normal)<=s){var y=d[v.index1];a.push(y.x,y.y,y.z),y=d[v.index2],a.push(y.x,y.y,y.z)}}this.setAttribute("position",new vi(a,3))}function Tl(t,e,n,r,i,o,a,s){Qi.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new Al(t,e,n,r,i,o,a,s)),this.mergeVertices()}function Al(t,e,n,r,i,o,a,s){Ci.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s};var c=this;t=void 0!==t?t:1,e=void 0!==e?e:1,n=n||1,r=Math.floor(r)||8,i=Math.floor(i)||1,o=void 0!==o&&o,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var l=[],u=[],d=[],h=[],f=0,p=[],m=n/2,g=0;function v(n){var i,o,p,v=new Tn,y=new zn,b=0,x=!0===n?t:e,_=!0===n?1:-1;for(o=f,i=1;i<=r;i++)u.push(0,m*_,0),d.push(0,_,0),h.push(.5,.5),f++;for(p=f,i=0;i<=r;i++){var w=i/r*s+a,S=Math.cos(w),M=Math.sin(w);y.x=x*M,y.y=m*_,y.z=x*S,u.push(y.x,y.y,y.z),d.push(0,_,0),v.x=.5*S+.5,v.y=.5*M*_+.5,h.push(v.x,v.y),f++}for(i=0;i<r;i++){var E=o+i,T=p+i;!0===n?l.push(T,T+1,E):l.push(T+1,T,E),b+=3}c.addGroup(g,b,!0===n?1:2),g+=b}!function(){var o,v,y=new zn,b=new zn,x=0,_=(e-t)/n;for(v=0;v<=i;v++){var w=[],S=v/i,M=S*(e-t)+t;for(o=0;o<=r;o++){var E=o/r,T=E*s+a,A=Math.sin(T),C=Math.cos(T);b.x=M*A,b.y=-S*n+m,b.z=M*C,u.push(b.x,b.y,b.z),y.set(A,_,C).normalize(),d.push(y.x,y.y,y.z),h.push(E,1-S),w.push(f++)}p.push(w)}for(o=0;o<r;o++)for(v=0;v<i;v++){var P=p[v][o],O=p[v+1][o],k=p[v+1][o+1],L=p[v][o+1];l.push(P,O,L),l.push(O,k,L),x+=6}c.addGroup(g,x,0),g+=x}(),!1===o&&(t>0&&v(!0),e>0&&v(!1)),this.setIndex(l),this.setAttribute("position",new vi(u,3)),this.setAttribute("normal",new vi(d,3)),this.setAttribute("uv",new vi(h,2))}function Cl(t,e,n,r,i,o,a){Tl.call(this,0,t,e,n,r,i,o,a),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function Pl(t,e,n,r,i,o,a){Al.call(this,0,t,e,n,r,i,o,a),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function Ol(t,e,n,r){Qi.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new kl(t,e,n,r)),this.mergeVertices()}function kl(t,e,n,r){Ci.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},t=t||1,e=void 0!==e?Math.max(3,e):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var i,o,a=[],s=[],c=[],l=[],u=new zn,d=new Tn;for(s.push(0,0,0),c.push(0,0,1),l.push(.5,.5),o=0,i=3;o<=e;o++,i+=3){var h=n+o/e*r;u.x=t*Math.cos(h),u.y=t*Math.sin(h),s.push(u.x,u.y,u.z),c.push(0,0,1),d.x=(s[i]/t+1)/2,d.y=(s[i+1]/t+1)/2,l.push(d.x,d.y)}for(i=1;i<=e;i++)a.push(i,i+1,0);this.setIndex(a),this.setAttribute("position",new vi(s,3)),this.setAttribute("normal",new vi(c,3)),this.setAttribute("uv",new vi(l,2))}pl.prototype=Object.create(Qi.prototype),pl.prototype.constructor=pl,ml.prototype=Object.create(dl.prototype),ml.prototype.constructor=ml,gl.prototype=Object.create(Qi.prototype),gl.prototype.constructor=gl,vl.prototype=Object.create(Ci.prototype),vl.prototype.constructor=vl,yl.prototype=Object.create(Qi.prototype),yl.prototype.constructor=yl,bl.prototype=Object.create(Ci.prototype),bl.prototype.constructor=bl,xl.prototype=Object.create(Qi.prototype),xl.prototype.constructor=xl,_l.prototype=Object.create(Ci.prototype),_l.prototype.constructor=_l,wl.prototype=Object.create(Qi.prototype),wl.prototype.constructor=wl,wl.prototype.toJSON=function(){var t=Qi.prototype.toJSON.call(this);return Ml(this.parameters.shapes,t)},Sl.prototype=Object.create(Ci.prototype),Sl.prototype.constructor=Sl,Sl.prototype.toJSON=function(){var t=Ci.prototype.toJSON.call(this);return Ml(this.parameters.shapes,t)},El.prototype=Object.create(Ci.prototype),El.prototype.constructor=El,Tl.prototype=Object.create(Qi.prototype),Tl.prototype.constructor=Tl,Al.prototype=Object.create(Ci.prototype),Al.prototype.constructor=Al,Cl.prototype=Object.create(Tl.prototype),Cl.prototype.constructor=Cl,Pl.prototype=Object.create(Al.prototype),Pl.prototype.constructor=Pl,Ol.prototype=Object.create(Qi.prototype),Ol.prototype.constructor=Ol,kl.prototype=Object.create(Ci.prototype),kl.prototype.constructor=kl;var Ll=Object.freeze({__proto__:null,WireframeGeometry:xc,ParametricGeometry:_c,ParametricBufferGeometry:wc,TetrahedronGeometry:Ec,TetrahedronBufferGeometry:Tc,OctahedronGeometry:Ac,OctahedronBufferGeometry:Cc,IcosahedronGeometry:Pc,IcosahedronBufferGeometry:Oc,DodecahedronGeometry:kc,DodecahedronBufferGeometry:Lc,PolyhedronGeometry:Sc,PolyhedronBufferGeometry:Mc,TubeGeometry:Rc,TubeBufferGeometry:Ic,TorusKnotGeometry:Nc,TorusKnotBufferGeometry:Dc,TorusGeometry:zc,TorusBufferGeometry:jc,TextGeometry:pl,TextBufferGeometry:ml,SphereGeometry:gl,SphereBufferGeometry:vl,RingGeometry:yl,RingBufferGeometry:bl,PlaneGeometry:yo,PlaneBufferGeometry:bo,LatheGeometry:xl,LatheBufferGeometry:_l,ShapeGeometry:wl,ShapeBufferGeometry:Sl,ExtrudeGeometry:ul,ExtrudeBufferGeometry:dl,EdgesGeometry:El,ConeGeometry:Cl,ConeBufferGeometry:Pl,CylinderGeometry:Tl,CylinderBufferGeometry:Al,CircleGeometry:Ol,CircleBufferGeometry:kl,BoxGeometry:to,BoxBufferGeometry:eo});function Rl(t){ai.call(this),this.type="ShadowMaterial",this.color=new ti(0),this.transparent=!0,this.setValues(t)}function Il(t){oo.call(this,t),this.type="RawShaderMaterial"}function Nl(t){ai.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ti(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ti(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qe,this.normalScale=new Tn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Dl(t){Nl.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearcoat=0,this.clearcoatRoughness=0,this.sheen=null,this.clearcoatNormalScale=new Tn(1,1),this.clearcoatNormalMap=null,this.transparency=0,this.setValues(t)}function zl(t){ai.call(this),this.type="MeshPhongMaterial",this.color=new ti(16777215),this.specular=new ti(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ti(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qe,this.normalScale=new Tn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=tt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function jl(t){ai.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ti(16777215),this.specular=new ti(1118481),this.shininess=30,this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ti(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qe,this.normalScale=new Tn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Fl(t){ai.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qe,this.normalScale=new Tn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Bl(t){ai.call(this),this.type="MeshLambertMaterial",this.color=new ti(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ti(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=tt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Ul(t){ai.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ti(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qe,this.normalScale=new Tn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Hl(t){Js.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}Rl.prototype=Object.create(ai.prototype),Rl.prototype.constructor=Rl,Rl.prototype.isShadowMaterial=!0,Rl.prototype.copy=function(t){return ai.prototype.copy.call(this,t),this.color.copy(t.color),this},Il.prototype=Object.create(oo.prototype),Il.prototype.constructor=Il,Il.prototype.isRawShaderMaterial=!0,Nl.prototype=Object.create(ai.prototype),Nl.prototype.constructor=Nl,Nl.prototype.isMeshStandardMaterial=!0,Nl.prototype.copy=function(t){return ai.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Dl.prototype=Object.create(Nl.prototype),Dl.prototype.constructor=Dl,Dl.prototype.isMeshPhysicalMaterial=!0,Dl.prototype.copy=function(t){return Nl.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearcoat=t.clearcoat,this.clearcoatRoughness=t.clearcoatRoughness,t.sheen?this.sheen=(this.sheen||new ti).copy(t.sheen):this.sheen=null,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.transparency=t.transparency,this},zl.prototype=Object.create(ai.prototype),zl.prototype.constructor=zl,zl.prototype.isMeshPhongMaterial=!0,zl.prototype.copy=function(t){return ai.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},jl.prototype=Object.create(ai.prototype),jl.prototype.constructor=jl,jl.prototype.isMeshToonMaterial=!0,jl.prototype.copy=function(t){return ai.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Fl.prototype=Object.create(ai.prototype),Fl.prototype.constructor=Fl,Fl.prototype.isMeshNormalMaterial=!0,Fl.prototype.copy=function(t){return ai.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Bl.prototype=Object.create(ai.prototype),Bl.prototype.constructor=Bl,Bl.prototype.isMeshLambertMaterial=!0,Bl.prototype.copy=function(t){return ai.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Ul.prototype=Object.create(ai.prototype),Ul.prototype.constructor=Ul,Ul.prototype.isMeshMatcapMaterial=!0,Ul.prototype.copy=function(t){return ai.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Hl.prototype=Object.create(Js.prototype),Hl.prototype.constructor=Hl,Hl.prototype.isLineDashedMaterial=!0,Hl.prototype.copy=function(t){return Js.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var Vl=Object.freeze({__proto__:null,ShadowMaterial:Rl,SpriteMaterial:Ms,RawShaderMaterial:Il,ShaderMaterial:oo,PointsMaterial:lc,MeshPhysicalMaterial:Dl,MeshStandardMaterial:Nl,MeshPhongMaterial:zl,MeshToonMaterial:jl,MeshNormalMaterial:Fl,MeshLambertMaterial:Bl,MeshDepthMaterial:as,MeshDistanceMaterial:ss,MeshBasicMaterial:si,MeshMatcapMaterial:Ul,LineDashedMaterial:Hl,LineBasicMaterial:Js,Material:ai}),Gl={arraySlice:function(t,e,n){return Gl.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,n=new Array(e),r=0;r!==e;++r)n[r]=r;return n.sort((function(e,n){return t[e]-t[n]})),n},sortedArray:function(t,e,n){for(var r=t.length,i=new t.constructor(r),o=0,a=0;a!==r;++o)for(var s=n[o]*e,c=0;c!==e;++c)i[a++]=t[s+c];return i},flattenJSON:function(t,e,n,r){for(var i=1,o=t[0];void 0!==o&&void 0===o[r];)o=t[i++];if(void 0!==o){var a=o[r];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[r])&&(e.push(o.time),n.push.apply(n,a)),o=t[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[r])&&(e.push(o.time),a.toArray(n,n.length)),o=t[i++]}while(void 0!==o);else do{void 0!==(a=o[r])&&(e.push(o.time),n.push(a)),o=t[i++]}while(void 0!==o)}},subclip:function(t,e,n,r,i){i=i||30;var o=t.clone();o.name=e;for(var a=[],s=0;s<o.tracks.length;++s){for(var c=o.tracks[s],l=c.getValueSize(),u=[],d=[],h=0;h<c.times.length;++h){var f=c.times[h]*i;if(!(f<n||f>=r)){u.push(c.times[h]);for(var p=0;p<l;++p)d.push(c.values[h*l+p])}}0!==u.length&&(c.times=Gl.convertArray(u,c.times.constructor),c.values=Gl.convertArray(d,c.values.constructor),a.push(c))}o.tracks=a;var m=1/0;for(s=0;s<o.tracks.length;++s)m>o.tracks[s].times[0]&&(m=o.tracks[s].times[0]);for(s=0;s<o.tracks.length;++s)o.tracks[s].shift(-1*m);return o.resetDuration(),o}};function Wl(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function $l(t,e,n,r){Wl.call(this,t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function ql(t,e,n,r){Wl.call(this,t,e,n,r)}function Xl(t,e,n,r){Wl.call(this,t,e,n,r)}function Yl(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Gl.convertArray(e,this.TimeBufferType),this.values=Gl.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}function Kl(t,e,n){Yl.call(this,t,e,n)}function Zl(t,e,n,r){Yl.call(this,t,e,n,r)}function Jl(t,e,n,r){Yl.call(this,t,e,n,r)}function Ql(t,e,n,r){Wl.call(this,t,e,n,r)}function tu(t,e,n,r){Yl.call(this,t,e,n,r)}function eu(t,e,n,r){Yl.call(this,t,e,n,r)}function nu(t,e,n,r){Yl.call(this,t,e,n,r)}function ru(t,e,n){this.name=t,this.tracks=n,this.duration=void 0!==e?e:-1,this.uuid=En.generateUUID(),this.duration<0&&this.resetDuration()}function iu(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Jl;case"vector":case"vector2":case"vector3":case"vector4":return nu;case"color":return Zl;case"quaternion":return tu;case"bool":case"boolean":return Kl;case"string":return eu}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){var n=[],r=[];Gl.flattenJSON(t.keys,n,r,"value"),t.times=n,t.values=r}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}Object.assign(Wl.prototype,{evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{var o;n:{r:if(!(t<r)){for(var a=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,i)}if(n===a)break;if(i=r,t<(r=e[++n]))break e}o=e.length;break n}if(t>=i)break t;var s=e[1];t<s&&(n=2,i=s);for(a=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===a)break;if(r=i,t>=(i=e[--n-1]))break e}o=n,n=0}for(;n<o;){var c=n+o>>>1;t<e[c]?o=c:n=c+1}if(r=e[n],void 0===(i=e[n-1]))return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,i,t)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r,o=0;o!==r;++o)e[o]=n[i+o];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(Wl.prototype,{beforeStart_:Wl.prototype.copySampleValue_,afterEnd_:Wl.prototype.copySampleValue_}),$l.prototype=Object.assign(Object.create(Wl.prototype),{constructor:$l,DefaultSettings_:{endingStart:ke,endingEnd:ke},intervalChanged_:function(t,e,n){var r=this.parameterPositions,i=t-2,o=t+1,a=r[i],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case Le:i=t,a=2*e-n;break;case Re:a=e+r[i=r.length-2]-r[i+1];break;default:i=t,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case Le:o=t,s=2*n-e;break;case Re:o=1,s=n+r[1]-r[0];break;default:o=t-1,s=e}var c=.5*(n-e),l=this.valueSize;this._weightPrev=c/(e-a),this._weightNext=c/(s-n),this._offsetPrev=i*l,this._offsetNext=o*l},interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,c=s-a,l=this._offsetPrev,u=this._offsetNext,d=this._weightPrev,h=this._weightNext,f=(n-e)/(r-e),p=f*f,m=p*f,g=-d*m+2*d*p-d*f,v=(1+d)*m+(-1.5-2*d)*p+(-.5+d)*f+1,y=(-1-h)*m+(1.5+h)*p+.5*f,b=h*m-h*p,x=0;x!==a;++x)i[x]=g*o[l+x]+v*o[c+x]+y*o[s+x]+b*o[u+x];return i}}),ql.prototype=Object.assign(Object.create(Wl.prototype),{constructor:ql,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,c=s-a,l=(n-e)/(r-e),u=1-l,d=0;d!==a;++d)i[d]=o[c+d]*u+o[s+d]*l;return i}}),Xl.prototype=Object.assign(Object.create(Wl.prototype),{constructor:Xl,interpolate_:function(t){return this.copySampleValue_(t-1)}}),Object.assign(Yl,{toJSON:function(t){var e,n=t.constructor;if(void 0!==n.toJSON)e=n.toJSON(t);else{e={name:t.name,times:Gl.convertArray(t.times,Array),values:Gl.convertArray(t.values,Array)};var r=t.getInterpolation();r!==t.DefaultInterpolation&&(e.interpolation=r)}return e.type=t.ValueTypeName,e}}),Object.assign(Yl.prototype,{constructor:Yl,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Pe,InterpolantFactoryMethodDiscrete:function(t){return new Xl(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new ql(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new $l(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case Ce:e=this.InterpolantFactoryMethodDiscrete;break;case Pe:e=this.InterpolantFactoryMethodLinear;break;case Oe:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=e,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Ce;case this.InterpolantFactoryMethodLinear:return Pe;case this.InterpolantFactoryMethodSmooth:return Oe}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]*=t;return this},trim:function(t,e){for(var n=this.times,r=n.length,i=0,o=r-1;i!==r&&n[i]<t;)++i;for(;-1!==o&&n[o]>e;)--o;if(++o,0!==i||o!==r){i>=o&&(i=(o=Math.max(o,1))-1);var a=this.getValueSize();this.times=Gl.arraySlice(n,i,o),this.values=Gl.arraySlice(this.values,i*a,o*a)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var o=null,a=0;a!==i;a++){var s=n[a];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,s),t=!1;break}if(null!==o&&o>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,s,o),t=!1;break}o=s}if(void 0!==r&&Gl.isTypedArray(r)){a=0;for(var c=r.length;a!==c;++a){var l=r[a];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,l),t=!1;break}}}return t},optimize:function(){for(var t=Gl.arraySlice(this.times),e=Gl.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===Oe,i=1,o=t.length-1,a=1;a<o;++a){var s=!1,c=t[a];if(c!==t[a+1]&&(1!==a||c!==c[0]))if(r)s=!0;else for(var l=a*n,u=l-n,d=l+n,h=0;h!==n;++h){var f=e[l+h];if(f!==e[u+h]||f!==e[d+h]){s=!0;break}}if(s){if(a!==i){t[i]=t[a];var p=a*n,m=i*n;for(h=0;h!==n;++h)e[m+h]=e[p+h]}++i}}if(o>0){t[i]=t[o];for(p=o*n,m=i*n,h=0;h!==n;++h)e[m+h]=e[p+h];++i}return i!==t.length?(this.times=Gl.arraySlice(t,0,i),this.values=Gl.arraySlice(e,0,i*n)):(this.times=t,this.values=e),this},clone:function(){var t=Gl.arraySlice(this.times,0),e=Gl.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}),Kl.prototype=Object.assign(Object.create(Yl.prototype),{constructor:Kl,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Ce,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Zl.prototype=Object.assign(Object.create(Yl.prototype),{constructor:Zl,ValueTypeName:"color"}),Jl.prototype=Object.assign(Object.create(Yl.prototype),{constructor:Jl,ValueTypeName:"number"}),Ql.prototype=Object.assign(Object.create(Wl.prototype),{constructor:Ql,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,c=(n-e)/(r-e),l=s+a;s!==l;s+=4)In.slerpFlat(i,0,o,s-a,o,s,c);return i}}),tu.prototype=Object.assign(Object.create(Yl.prototype),{constructor:tu,ValueTypeName:"quaternion",DefaultInterpolation:Pe,InterpolantFactoryMethodLinear:function(t){return new Ql(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),eu.prototype=Object.assign(Object.create(Yl.prototype),{constructor:eu,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Ce,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),nu.prototype=Object.assign(Object.create(Yl.prototype),{constructor:nu,ValueTypeName:"vector"}),Object.assign(ru,{parse:function(t){for(var e=[],n=t.tracks,r=1/(t.fps||1),i=0,o=n.length;i!==o;++i)e.push(iu(n[i]).scale(r));return new ru(t.name,t.duration,e)},toJSON:function(t){for(var e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid},i=0,o=n.length;i!==o;++i)e.push(Yl.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(t,e,n,r){for(var i=e.length,o=[],a=0;a<i;a++){var s=[],c=[];s.push((a+i-1)%i,a,(a+1)%i),c.push(0,1,0);var l=Gl.getKeyframeOrder(s);s=Gl.sortedArray(s,1,l),c=Gl.sortedArray(c,1,l),r||0!==s[0]||(s.push(i),c.push(c[0])),o.push(new Jl(".morphTargetInfluences["+e[a].name+"]",s,c).scale(1/n))}return new ru(t,-1,o)},findByName:function(t,e){var n=t;if(!Array.isArray(t)){var r=t;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===e)return n[i];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,o=0,a=t.length;o<a;o++){var s=t[o],c=s.name.match(i);if(c&&c.length>1){var l=r[d=c[1]];l||(r[d]=l=[]),l.push(s)}}var u=[];for(var d in r)u.push(ru.CreateFromMorphTargetSequence(d,r[d],e,n));return u},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(t,e,n,r,i){if(0!==n.length){var o=[],a=[];Gl.flattenJSON(n,o,a,r),0!==o.length&&i.push(new t(e,o,a))}},r=[],i=t.name||"default",o=t.length||-1,a=t.fps||30,s=t.hierarchy||[],c=0;c<s.length;c++){var l=s[c].keys;if(l&&0!==l.length)if(l[0].morphTargets){for(var u={},d=0;d<l.length;d++)if(l[d].morphTargets)for(var h=0;h<l[d].morphTargets.length;h++)u[l[d].morphTargets[h]]=-1;for(var f in u){var p=[],m=[];for(h=0;h!==l[d].morphTargets.length;++h){var g=l[d];p.push(g.time),m.push(g.morphTarget===f?1:0)}r.push(new Jl(".morphTargetInfluence["+f+"]",p,m))}o=u.length*(a||1)}else{var v=".bones["+e[c].name+"]";n(nu,v+".position",l,"pos",r),n(tu,v+".quaternion",l,"rot",r),n(nu,v+".scale",l,"scl",r)}}return 0===r.length?null:new ru(i,o,r)}}),Object.assign(ru.prototype,{resetDuration:function(){for(var t=0,e=0,n=this.tracks.length;e!==n;++e){var r=this.tracks[e];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new ru(this.name,this.duration,t)}});var ou={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function au(t,e,n){var r=this,i=!1,o=0,a=0,s=void 0,c=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===i&&void 0!==r.onStart&&r.onStart(t,o,a),i=!0},this.itemEnd=function(t){o++,void 0!==r.onProgress&&r.onProgress(t,o,a),o===a&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this},this.addHandler=function(t,e){return c.push(t,e),this},this.removeHandler=function(t){var e=c.indexOf(t);return-1!==e&&c.splice(e,2),this},this.getHandler=function(t){for(var e=0,n=c.length;e<n;e+=2){var r=c[e],i=c[e+1];if(r.global&&(r.lastIndex=0),r.test(t))return i}return null}}var su=new au;function cu(t){this.manager=void 0!==t?t:su,this.crossOrigin="anonymous",this.path="",this.resourcePath=""}Object.assign(cu.prototype,{load:function(){},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this}});var lu={};function uu(t){cu.call(this,t)}function du(t){cu.call(this,t)}function hu(t){cu.call(this,t)}function fu(t){cu.call(this,t)}function pu(t){cu.call(this,t)}function mu(t){cu.call(this,t)}function gu(t){cu.call(this,t)}function vu(){this.type="Curve",this.arcLengthDivisions=200}function yu(t,e,n,r,i,o,a,s){vu.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function bu(t,e,n,r,i,o){yu.call(this,t,e,n,n,r,i,o),this.type="ArcCurve"}function xu(){var t=0,e=0,n=0,r=0;function i(i,o,a,s){t=i,e=a,n=-3*i+3*o-2*a-s,r=2*i-2*o+a+s}return{initCatmullRom:function(t,e,n,r,o){i(e,n,o*(n-t),o*(r-e))},initNonuniformCatmullRom:function(t,e,n,r,o,a,s){var c=(e-t)/o-(n-t)/(o+a)+(n-e)/a,l=(n-e)/a-(r-e)/(a+s)+(r-n)/s;i(e,n,c*=a,l*=a)},calc:function(i){var o=i*i;return t+e*i+n*o+r*(o*i)}}}uu.prototype=Object.assign(Object.create(cu.prototype),{constructor:uu,load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=ou.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;if(void 0===lu[t]){var a=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(a){var s=a[1],c=!!a[2],l=a[3];l=decodeURIComponent(l),c&&(l=atob(l));try{var u,d=(this.responseType||"").toLowerCase();switch(d){case"arraybuffer":case"blob":for(var h=new Uint8Array(l.length),f=0;f<l.length;f++)h[f]=l.charCodeAt(f);u="blob"===d?new Blob([h.buffer],{type:s}):h.buffer;break;case"document":var p=new DOMParser;u=p.parseFromString(l,s);break;case"json":u=JSON.parse(l);break;default:u=l}setTimeout((function(){e&&e(u),i.manager.itemEnd(t)}),0)}catch(e){setTimeout((function(){r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)}),0)}}else{lu[t]=[],lu[t].push({onLoad:e,onProgress:n,onError:r});var m=new XMLHttpRequest;for(var g in m.open("GET",t,!0),m.addEventListener("load",(function(e){var n=this.response,r=lu[t];if(delete lu[t],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),ou.add(t,n);for(var o=0,a=r.length;o<a;o++){(s=r[o]).onLoad&&s.onLoad(n)}i.manager.itemEnd(t)}else{for(o=0,a=r.length;o<a;o++){var s;(s=r[o]).onError&&s.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}}),!1),m.addEventListener("progress",(function(e){for(var n=lu[t],r=0,i=n.length;r<i;r++){var o=n[r];o.onProgress&&o.onProgress(e)}}),!1),m.addEventListener("error",(function(e){var n=lu[t];delete lu[t];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}),!1),m.addEventListener("abort",(function(e){var n=lu[t];delete lu[t];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}),!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(g,this.requestHeader[g]);m.send(null)}return i.manager.itemStart(t),m}lu[t].push({onLoad:e,onProgress:n,onError:r})},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}}),du.prototype=Object.assign(Object.create(cu.prototype),{constructor:du,load:function(t,e,n,r){var i=this,o=new uu(i.manager);o.setPath(i.path),o.load(t,(function(t){e(i.parse(JSON.parse(t)))}),n,r)},parse:function(t){for(var e=[],n=0;n<t.length;n++){var r=ru.parse(t[n]);e.push(r)}return e}}),hu.prototype=Object.assign(Object.create(cu.prototype),{constructor:hu,load:function(t,e,n,r){var i=this,o=[],a=new vc;a.image=o;var s=new uu(this.manager);function c(c){s.load(t[c],(function(t){var n=i.parse(t,!0);o[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(l+=1)&&(1===n.mipmapCount&&(a.minFilter=Et),a.format=n.format,a.needsUpdate=!0,e&&e(a))}),n,r)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(t))for(var l=0,u=0,d=t.length;u<d;++u)c(u);else s.load(t,(function(t){var n=i.parse(t,!0);if(n.isCubemap)for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){o[s]={mipmaps:[]};for(var c=0;c<n.mipmapCount;c++)o[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+c]),o[s].format=n.format,o[s].width=n.width,o[s].height=n.height}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=Et),a.format=n.format,a.needsUpdate=!0,e&&e(a)}),n,r);return a}}),fu.prototype=Object.assign(Object.create(cu.prototype),{constructor:fu,load:function(t,e,n,r){var i=this,o=new uo,a=new uu(this.manager);return a.setResponseType("arraybuffer"),a.setPath(this.path),a.load(t,(function(t){var n=i.parse(t);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:yt,o.wrapT=void 0!==n.wrapT?n.wrapT:yt,o.magFilter=void 0!==n.magFilter?n.magFilter:Et,o.minFilter=void 0!==n.minFilter?n.minFilter:Et,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps,o.minFilter=Ct),1===n.mipmapCount&&(o.minFilter=Et),o.needsUpdate=!0,e&&e(o,n))}),n,r),o}}),pu.prototype=Object.assign(Object.create(cu.prototype),{constructor:pu,load:function(t,e,n,r){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=ou.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){a.removeEventListener("load",s,!1),a.removeEventListener("error",c,!1),ou.add(t,this),e&&e(this),i.manager.itemEnd(t)}function c(e){a.removeEventListener("load",s,!1),a.removeEventListener("error",c,!1),r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)}return a.addEventListener("load",s,!1),a.addEventListener("error",c,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(t),a.src=t,a}}),mu.prototype=Object.assign(Object.create(cu.prototype),{constructor:mu,load:function(t,e,n,r){var i=new Ro,o=new pu(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;function s(n){o.load(t[n],(function(t){i.images[n]=t,6===++a&&(i.needsUpdate=!0,e&&e(i))}),void 0,r)}for(var c=0;c<t.length;++c)s(c);return i}}),gu.prototype=Object.assign(Object.create(cu.prototype),{constructor:gu,load:function(t,e,n,r){var i=new On,o=new pu(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,(function(n){i.image=n;var r=t.search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/);i.format=r?Vt:Gt,i.needsUpdate=!0,void 0!==e&&e(i)}),n,r),i}}),Object.assign(vu.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){var n=this.getUtoTmapping(t);return this.getPoint(n,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n,r=[],i=this.getPoint(0),o=0;for(r.push(0),n=1;n<=t;n++)o+=(e=this.getPoint(n/t)).distanceTo(i),r.push(o),i=e;return this.cacheArcLengths=r,r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var n,r=this.getLengths(),i=0,o=r.length;n=e||t*r[o-1];for(var a,s=0,c=o-1;s<=c;)if((a=r[i=Math.floor(s+(c-s)/2)]-n)<0)s=i+1;else{if(!(a>0)){c=i;break}c=i-1}if(r[i=c]===n)return i/(o-1);var l=r[i];return(i+(n-l)/(r[i+1]-l))/(o-1)},getTangent:function(t){var e=t-1e-4,n=t+1e-4;e<0&&(e=0),n>1&&(n=1);var r=this.getPoint(e);return this.getPoint(n).clone().sub(r).normalize()},getTangentAt:function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},computeFrenetFrames:function(t,e){var n,r,i,o=new zn,a=[],s=[],c=[],l=new zn,u=new Wn;for(n=0;n<=t;n++)r=n/t,a[n]=this.getTangentAt(r),a[n].normalize();s[0]=new zn,c[0]=new zn;var d=Number.MAX_VALUE,h=Math.abs(a[0].x),f=Math.abs(a[0].y),p=Math.abs(a[0].z);for(h<=d&&(d=h,o.set(1,0,0)),f<=d&&(d=f,o.set(0,1,0)),p<=d&&o.set(0,0,1),l.crossVectors(a[0],o).normalize(),s[0].crossVectors(a[0],l),c[0].crossVectors(a[0],s[0]),n=1;n<=t;n++)s[n]=s[n-1].clone(),c[n]=c[n-1].clone(),l.crossVectors(a[n-1],a[n]),l.length()>Number.EPSILON&&(l.normalize(),i=Math.acos(En.clamp(a[n-1].dot(a[n]),-1,1)),s[n].applyMatrix4(u.makeRotationAxis(l,i))),c[n].crossVectors(a[n],s[n]);if(!0===e)for(i=Math.acos(En.clamp(s[0].dot(s[t]),-1,1)),i/=t,a[0].dot(l.crossVectors(s[0],s[t]))>0&&(i=-i),n=1;n<=t;n++)s[n].applyMatrix4(u.makeRotationAxis(a[n],i*n)),c[n].crossVectors(a[n],s[n]);return{tangents:a,normals:s,binormals:c}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),yu.prototype=Object.create(vu.prototype),yu.prototype.constructor=yu,yu.prototype.isEllipseCurve=!0,yu.prototype.getPoint=function(t,e){for(var n=e||new Tn,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,o=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=o?0:r),!0!==this.aClockwise||o||(i===r?i=-r:i-=r);var a=this.aStartAngle+t*i,s=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){var l=Math.cos(this.aRotation),u=Math.sin(this.aRotation),d=s-this.aX,h=c-this.aY;s=d*l-h*u+this.aX,c=d*u+h*l+this.aY}return n.set(s,c)},yu.prototype.copy=function(t){return vu.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},yu.prototype.toJSON=function(){var t=vu.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},yu.prototype.fromJSON=function(t){return vu.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},bu.prototype=Object.create(yu.prototype),bu.prototype.constructor=bu,bu.prototype.isArcCurve=!0;var _u=new zn,wu=new xu,Su=new xu,Mu=new xu;function Eu(t,e,n,r){vu.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=n||"centripetal",this.tension=r||.5}function Tu(t,e,n,r,i){var o=.5*(r-e),a=.5*(i-n),s=t*t;return(2*n-2*r+o+a)*(t*s)+(-3*n+3*r-2*o-a)*s+o*t+n}function Au(t,e,n,r){return function(t,e){var n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,r)}function Cu(t,e,n,r,i){return function(t,e){var n=1-t;return n*n*n*e}(t,e)+function(t,e){var n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,r)+function(t,e){return t*t*t*e}(t,i)}function Pu(t,e,n,r){vu.call(this),this.type="CubicBezierCurve",this.v0=t||new Tn,this.v1=e||new Tn,this.v2=n||new Tn,this.v3=r||new Tn}function Ou(t,e,n,r){vu.call(this),this.type="CubicBezierCurve3",this.v0=t||new zn,this.v1=e||new zn,this.v2=n||new zn,this.v3=r||new zn}function ku(t,e){vu.call(this),this.type="LineCurve",this.v1=t||new Tn,this.v2=e||new Tn}function Lu(t,e){vu.call(this),this.type="LineCurve3",this.v1=t||new zn,this.v2=e||new zn}function Ru(t,e,n){vu.call(this),this.type="QuadraticBezierCurve",this.v0=t||new Tn,this.v1=e||new Tn,this.v2=n||new Tn}function Iu(t,e,n){vu.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new zn,this.v1=e||new zn,this.v2=n||new zn}function Nu(t){vu.call(this),this.type="SplineCurve",this.points=t||[]}Eu.prototype=Object.create(vu.prototype),Eu.prototype.constructor=Eu,Eu.prototype.isCatmullRomCurve3=!0,Eu.prototype.getPoint=function(t,e){var n,r,i,o,a=e||new zn,s=this.points,c=s.length,l=(c-(this.closed?0:1))*t,u=Math.floor(l),d=l-u;if(this.closed?u+=u>0?0:(Math.floor(Math.abs(u)/c)+1)*c:0===d&&u===c-1&&(u=c-2,d=1),this.closed||u>0?n=s[(u-1)%c]:(_u.subVectors(s[0],s[1]).add(s[0]),n=_u),r=s[u%c],i=s[(u+1)%c],this.closed||u+2<c?o=s[(u+2)%c]:(_u.subVectors(s[c-1],s[c-2]).add(s[c-1]),o=_u),"centripetal"===this.curveType||"chordal"===this.curveType){var h="chordal"===this.curveType?.5:.25,f=Math.pow(n.distanceToSquared(r),h),p=Math.pow(r.distanceToSquared(i),h),m=Math.pow(i.distanceToSquared(o),h);p<1e-4&&(p=1),f<1e-4&&(f=p),m<1e-4&&(m=p),wu.initNonuniformCatmullRom(n.x,r.x,i.x,o.x,f,p,m),Su.initNonuniformCatmullRom(n.y,r.y,i.y,o.y,f,p,m),Mu.initNonuniformCatmullRom(n.z,r.z,i.z,o.z,f,p,m)}else"catmullrom"===this.curveType&&(wu.initCatmullRom(n.x,r.x,i.x,o.x,this.tension),Su.initCatmullRom(n.y,r.y,i.y,o.y,this.tension),Mu.initCatmullRom(n.z,r.z,i.z,o.z,this.tension));return a.set(wu.calc(d),Su.calc(d),Mu.calc(d)),a},Eu.prototype.copy=function(t){vu.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push(r.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Eu.prototype.toJSON=function(){var t=vu.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){var r=this.points[e];t.points.push(r.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},Eu.prototype.fromJSON=function(t){vu.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new zn).fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Pu.prototype=Object.create(vu.prototype),Pu.prototype.constructor=Pu,Pu.prototype.isCubicBezierCurve=!0,Pu.prototype.getPoint=function(t,e){var n=e||new Tn,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(Cu(t,r.x,i.x,o.x,a.x),Cu(t,r.y,i.y,o.y,a.y)),n},Pu.prototype.copy=function(t){return vu.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Pu.prototype.toJSON=function(){var t=vu.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Pu.prototype.fromJSON=function(t){return vu.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},Ou.prototype=Object.create(vu.prototype),Ou.prototype.constructor=Ou,Ou.prototype.isCubicBezierCurve3=!0,Ou.prototype.getPoint=function(t,e){var n=e||new zn,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(Cu(t,r.x,i.x,o.x,a.x),Cu(t,r.y,i.y,o.y,a.y),Cu(t,r.z,i.z,o.z,a.z)),n},Ou.prototype.copy=function(t){return vu.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Ou.prototype.toJSON=function(){var t=vu.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Ou.prototype.fromJSON=function(t){return vu.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},ku.prototype=Object.create(vu.prototype),ku.prototype.constructor=ku,ku.prototype.isLineCurve=!0,ku.prototype.getPoint=function(t,e){var n=e||new Tn;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},ku.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},ku.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},ku.prototype.copy=function(t){return vu.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ku.prototype.toJSON=function(){var t=vu.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ku.prototype.fromJSON=function(t){return vu.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Lu.prototype=Object.create(vu.prototype),Lu.prototype.constructor=Lu,Lu.prototype.isLineCurve3=!0,Lu.prototype.getPoint=function(t,e){var n=e||new zn;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},Lu.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Lu.prototype.copy=function(t){return vu.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Lu.prototype.toJSON=function(){var t=vu.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Lu.prototype.fromJSON=function(t){return vu.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Ru.prototype=Object.create(vu.prototype),Ru.prototype.constructor=Ru,Ru.prototype.isQuadraticBezierCurve=!0,Ru.prototype.getPoint=function(t,e){var n=e||new Tn,r=this.v0,i=this.v1,o=this.v2;return n.set(Au(t,r.x,i.x,o.x),Au(t,r.y,i.y,o.y)),n},Ru.prototype.copy=function(t){return vu.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Ru.prototype.toJSON=function(){var t=vu.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Ru.prototype.fromJSON=function(t){return vu.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Iu.prototype=Object.create(vu.prototype),Iu.prototype.constructor=Iu,Iu.prototype.isQuadraticBezierCurve3=!0,Iu.prototype.getPoint=function(t,e){var n=e||new zn,r=this.v0,i=this.v1,o=this.v2;return n.set(Au(t,r.x,i.x,o.x),Au(t,r.y,i.y,o.y),Au(t,r.z,i.z,o.z)),n},Iu.prototype.copy=function(t){return vu.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Iu.prototype.toJSON=function(){var t=vu.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Iu.prototype.fromJSON=function(t){return vu.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Nu.prototype=Object.create(vu.prototype),Nu.prototype.constructor=Nu,Nu.prototype.isSplineCurve=!0,Nu.prototype.getPoint=function(t,e){var n=e||new Tn,r=this.points,i=(r.length-1)*t,o=Math.floor(i),a=i-o,s=r[0===o?o:o-1],c=r[o],l=r[o>r.length-2?r.length-1:o+1],u=r[o>r.length-3?r.length-1:o+2];return n.set(Tu(a,s.x,c.x,l.x,u.x),Tu(a,s.y,c.y,l.y,u.y)),n},Nu.prototype.copy=function(t){vu.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push(r.clone())}return this},Nu.prototype.toJSON=function(){var t=vu.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){var r=this.points[e];t.points.push(r.toArray())}return t},Nu.prototype.fromJSON=function(t){vu.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new Tn).fromArray(r))}return this};var Du=Object.freeze({__proto__:null,ArcCurve:bu,CatmullRomCurve3:Eu,CubicBezierCurve:Pu,CubicBezierCurve3:Ou,EllipseCurve:yu,LineCurve:ku,LineCurve3:Lu,QuadraticBezierCurve:Ru,QuadraticBezierCurve3:Iu,SplineCurve:Nu});function zu(){vu.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function ju(t){zu.call(this),this.type="Path",this.currentPoint=new Tn,t&&this.setFromPoints(t)}function Fu(t){ju.call(this,t),this.uuid=En.generateUUID(),this.type="Shape",this.holes=[]}function Bu(t,e){lr.call(this),this.type="Light",this.color=new ti(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function Uu(t,e,n){Bu.call(this,t,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(lr.DefaultUp),this.updateMatrix(),this.groundColor=new ti(e)}function Hu(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new Tn(512,512),this.map=null,this.mapPass=null,this.matrix=new Wn,this._frustum=new po,this._frameExtents=new Tn(1,1),this._viewportCount=1,this._viewports=[new kn(0,0,1,1)]}function Vu(){Hu.call(this,new so(50,1,.5,500))}function Gu(t,e,n,r,i,o){Bu.call(this,t,e),this.type="SpotLight",this.position.copy(lr.DefaultUp),this.updateMatrix(),this.target=new lr,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new Vu}function Wu(){Hu.call(this,new so(90,1,.5,500)),this._frameExtents=new Tn(4,2),this._viewportCount=6,this._viewports=[new kn(2,1,1,1),new kn(0,1,1,1),new kn(3,1,1,1),new kn(1,1,1,1),new kn(3,0,1,1),new kn(1,0,1,1)],this._cubeDirections=[new zn(1,0,0),new zn(-1,0,0),new zn(0,0,1),new zn(0,0,-1),new zn(0,1,0),new zn(0,-1,0)],this._cubeUps=[new zn(0,1,0),new zn(0,1,0),new zn(0,1,0),new zn(0,1,0),new zn(0,0,1),new zn(0,0,-1)]}function $u(t,e,n,r){Bu.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new Wu}function qu(t,e,n,r,i,o){ao.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==t?t:-1,this.right=void 0!==e?e:1,this.top=void 0!==n?n:1,this.bottom=void 0!==r?r:-1,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function Xu(){Hu.call(this,new qu(-5,5,5,-5,.5,500))}function Yu(t,e){Bu.call(this,t,e),this.type="DirectionalLight",this.position.copy(lr.DefaultUp),this.updateMatrix(),this.target=new lr,this.shadow=new Xu}function Ku(t,e){Bu.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function Zu(t,e,n,r){Bu.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}function Ju(t){cu.call(this,t),this.textures={}}zu.prototype=Object.assign(Object.create(vu.prototype),{constructor:zu,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new ku(e,t))},getPoint:function(t){for(var e=t*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=e){var i=n[r]-e,o=this.curves[r],a=o.getLength(),s=0===a?0:1-i/a;return o.getPointAt(s)}r++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,n=[],r=0,i=this.curves;r<i.length;r++)for(var o=i[r],a=o&&o.isEllipseCurve?2*t:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?t*o.points.length:t,s=o.getPoints(a),c=0;c<s.length;c++){var l=s[c];e&&e.equals(l)||(n.push(l),e=l)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(t){vu.prototype.copy.call(this,t),this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var r=t.curves[e];this.curves.push(r.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){var t=vu.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,n=this.curves.length;e<n;e++){var r=this.curves[e];t.curves.push(r.toJSON())}return t},fromJSON:function(t){vu.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var r=t.curves[e];this.curves.push((new Du[r.type]).fromJSON(r))}return this}}),ju.prototype=Object.assign(Object.create(zu.prototype),{constructor:ju,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this},moveTo:function(t,e){return this.currentPoint.set(t,e),this},lineTo:function(t,e){var n=new ku(this.currentPoint.clone(),new Tn(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this},quadraticCurveTo:function(t,e,n,r){var i=new Ru(this.currentPoint.clone(),new Tn(t,e),new Tn(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this},bezierCurveTo:function(t,e,n,r,i,o){var a=new Pu(this.currentPoint.clone(),new Tn(t,e),new Tn(n,r),new Tn(i,o));return this.curves.push(a),this.currentPoint.set(i,o),this},splineThru:function(t){var e=new Nu([this.currentPoint.clone()].concat(t));return this.curves.push(e),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,e,n,r,i,o){var a=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(t+a,e+s,n,r,i,o),this},absarc:function(t,e,n,r,i,o){return this.absellipse(t,e,n,n,r,i,o),this},ellipse:function(t,e,n,r,i,o,a,s){var c=this.currentPoint.x,l=this.currentPoint.y;return this.absellipse(t+c,e+l,n,r,i,o,a,s),this},absellipse:function(t,e,n,r,i,o,a,s){var c=new yu(t,e,n,r,i,o,a,s);if(this.curves.length>0){var l=c.getPoint(0);l.equals(this.currentPoint)||this.lineTo(l.x,l.y)}this.curves.push(c);var u=c.getPoint(1);return this.currentPoint.copy(u),this},copy:function(t){return zu.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=zu.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return zu.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),Fu.prototype=Object.assign(Object.create(ju.prototype),{constructor:Fu,getPointsHoles:function(t){for(var e=[],n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){ju.prototype.copy.call(this,t),this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var r=t.holes[e];this.holes.push(r.clone())}return this},toJSON:function(){var t=ju.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,n=this.holes.length;e<n;e++){var r=this.holes[e];t.holes.push(r.toJSON())}return t},fromJSON:function(t){ju.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var r=t.holes[e];this.holes.push((new ju).fromJSON(r))}return this}}),Bu.prototype=Object.assign(Object.create(lr.prototype),{constructor:Bu,isLight:!0,copy:function(t){return lr.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var e=lr.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),Uu.prototype=Object.assign(Object.create(Bu.prototype),{constructor:Uu,isHemisphereLight:!0,copy:function(t){return Bu.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(Hu.prototype,{_projScreenMatrix:new Wn,_lightPositionWorld:new zn,_lookTarget:new zn,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){var e=this.camera,n=this.matrix,r=this._projScreenMatrix,i=this._lookTarget,o=this._lightPositionWorld;o.setFromMatrixPosition(t.matrixWorld),e.position.copy(o),i.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(i),e.updateMatrixWorld(),r.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(r),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),Vu.prototype=Object.assign(Object.create(Hu.prototype),{constructor:Vu,isSpotLightShadow:!0,updateMatrices:function(t){var e=this.camera,n=2*En.RAD2DEG*t.angle,r=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;n===e.fov&&r===e.aspect&&i===e.far||(e.fov=n,e.aspect=r,e.far=i,e.updateProjectionMatrix()),Hu.prototype.updateMatrices.call(this,t)}}),Gu.prototype=Object.assign(Object.create(Bu.prototype),{constructor:Gu,isSpotLight:!0,copy:function(t){return Bu.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Wu.prototype=Object.assign(Object.create(Hu.prototype),{constructor:Wu,isPointLightShadow:!0,updateMatrices:function(t,e){void 0===e&&(e=0);var n=this.camera,r=this.matrix,i=this._lightPositionWorld,o=this._lookTarget,a=this._projScreenMatrix;i.setFromMatrixPosition(t.matrixWorld),n.position.copy(i),o.copy(n.position),o.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(o),n.updateMatrixWorld(),r.makeTranslation(-i.x,-i.y,-i.z),a.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(a)}}),$u.prototype=Object.assign(Object.create(Bu.prototype),{constructor:$u,isPointLight:!0,copy:function(t){return Bu.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),qu.prototype=Object.assign(Object.create(ao.prototype),{constructor:qu,isOrthographicCamera:!0,copy:function(t,e){return ao.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-t,o=n+t,a=r+e,s=r-e;if(null!==this.view&&this.view.enabled){var c=(this.right-this.left)/this.view.fullWidth/this.zoom,l=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o=(i+=c*this.view.offsetX)+c*this.view.width,s=(a-=l*this.view.offsetY)-l*this.view.height}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){var e=lr.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),Xu.prototype=Object.assign(Object.create(Hu.prototype),{constructor:Xu,isDirectionalLightShadow:!0,updateMatrices:function(t){Hu.prototype.updateMatrices.call(this,t)}}),Yu.prototype=Object.assign(Object.create(Bu.prototype),{constructor:Yu,isDirectionalLight:!0,copy:function(t){return Bu.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Ku.prototype=Object.assign(Object.create(Bu.prototype),{constructor:Ku,isAmbientLight:!0}),Zu.prototype=Object.assign(Object.create(Bu.prototype),{constructor:Zu,isRectAreaLight:!0,copy:function(t){return Bu.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){var e=Bu.prototype.toJSON.call(this,t);return e.object.width=this.width,e.object.height=this.height,e}}),Ju.prototype=Object.assign(Object.create(cu.prototype),{constructor:Ju,load:function(t,e,n,r){var i=this,o=new uu(i.manager);o.setPath(i.path),o.load(t,(function(t){e(i.parse(JSON.parse(t)))}),n,r)},parse:function(t){var e=this.textures;function n(t){return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]}var r=new Vl[t.type];if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.sheen&&(r.sheen=(new ti).setHex(t.sheen)),void 0!==t.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&r.specular.setHex(t.specular),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearcoat&&(r.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(r.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.vertexColors&&(r.vertexColors=t.vertexColors),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.flatShading&&(r.flatShading=t.flatShading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.combine&&(r.combine=t.combine),void 0!==t.side&&(r.side=t.side),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(r.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(r.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(r.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(r.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(r.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(r.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(r.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(r.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(r.rotation=t.rotation),1!==t.linewidth&&(r.linewidth=t.linewidth),void 0!==t.dashSize&&(r.dashSize=t.dashSize),void 0!==t.gapSize&&(r.gapSize=t.gapSize),void 0!==t.scale&&(r.scale=t.scale),void 0!==t.polygonOffset&&(r.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(r.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(r.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(r.skinning=t.skinning),void 0!==t.morphTargets&&(r.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(r.morphNormals=t.morphNormals),void 0!==t.dithering&&(r.dithering=t.dithering),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.toneMapped&&(r.toneMapped=t.toneMapped),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.uniforms)for(var i in t.uniforms){var o=t.uniforms[i];switch(r.uniforms[i]={},o.type){case"t":r.uniforms[i].value=n(o.value);break;case"c":r.uniforms[i].value=(new ti).setHex(o.value);break;case"v2":r.uniforms[i].value=(new Tn).fromArray(o.value);break;case"v3":r.uniforms[i].value=(new zn).fromArray(o.value);break;case"v4":r.uniforms[i].value=(new kn).fromArray(o.value);break;case"m3":r.uniforms[i].value=(new An).fromArray(o.value);case"m4":r.uniforms[i].value=(new Wn).fromArray(o.value);break;default:r.uniforms[i].value=o.value}}if(void 0!==t.defines&&(r.defines=t.defines),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(var a in t.extensions)r.extensions[a]=t.extensions[a];if(void 0!==t.shading&&(r.flatShading=1===t.shading),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=n(t.map)),void 0!==t.matcap&&(r.matcap=n(t.matcap)),void 0!==t.alphaMap&&(r.alphaMap=n(t.alphaMap),r.transparent=!0),void 0!==t.bumpMap&&(r.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=n(t.normalMap)),void 0!==t.normalMapType&&(r.normalMapType=t.normalMapType),void 0!==t.normalScale){var s=t.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new Tn).fromArray(s)}return void 0!==t.displacementMap&&(r.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=n(t.specularMap)),void 0!==t.envMap&&(r.envMap=n(t.envMap)),void 0!==t.envMapIntensity&&(r.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(r.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(r.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=n(t.gradientMap)),void 0!==t.clearcoatNormalMap&&(r.clearcoatNormalMap=n(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(r.clearcoatNormalScale=(new Tn).fromArray(t.clearcoatNormalScale)),r},setTextures:function(t){return this.textures=t,this}});var Qu={decodeText:function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",n=0,r=t.length;n<r;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch(t){return e}},extractUrlBase:function(t){var e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)}};function td(){Ci.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function ed(t,e,n,r){"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),li.call(this,t,e,n),this.meshPerAttribute=r||1}function nd(t){cu.call(this,t)}td.prototype=Object.assign(Object.create(Ci.prototype),{constructor:td,isInstancedBufferGeometry:!0,copy:function(t){return Ci.prototype.copy.call(this,t),this.maxInstancedCount=t.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t=Ci.prototype.toJSON.call(this);return t.maxInstancedCount=this.maxInstancedCount,t.isInstancedBufferGeometry=!0,t}}),ed.prototype=Object.assign(Object.create(li.prototype),{constructor:ed,isInstancedBufferAttribute:!0,copy:function(t){return li.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){var t=li.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),nd.prototype=Object.assign(Object.create(cu.prototype),{constructor:nd,load:function(t,e,n,r){var i=this,o=new uu(i.manager);o.setPath(i.path),o.load(t,(function(t){e(i.parse(JSON.parse(t)))}),n,r)},parse:function(t){var e=t.isInstancedBufferGeometry?new td:new Ci,n=t.data.index;if(void 0!==n){var r=new rd[n.type](n.array);e.setIndex(new li(r,1))}var i=t.data.attributes;for(var o in i){var a=i[o],s=(r=new rd[a.type](a.array),new(a.isInstancedBufferAttribute?ed:li)(r,a.itemSize,a.normalized));void 0!==a.name&&(s.name=a.name),e.setAttribute(o,s)}var c=t.data.morphAttributes;if(c)for(var o in c){for(var l=c[o],u=[],d=0,h=l.length;d<h;d++){a=l[d],s=new li(r=new rd[a.type](a.array),a.itemSize,a.normalized);void 0!==a.name&&(s.name=a.name),u.push(s)}e.morphAttributes[o]=u}t.data.morphTargetsRelative&&(e.morphTargetsRelative=!0);var f=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==f){d=0;for(var p=f.length;d!==p;++d){var m=f[d];e.addGroup(m.start,m.count,m.materialIndex)}}var g=t.data.boundingSphere;if(void 0!==g){var v=new zn;void 0!==g.center&&v.fromArray(g.center),e.boundingSphere=new Ar(v,g.radius)}return t.name&&(e.name=t.name),t.userData&&(e.userData=t.userData),e}});var rd={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function id(t){cu.call(this,t)}id.prototype=Object.assign(Object.create(cu.prototype),{constructor:id,load:function(t,e,n,r){var i=this,o=""===this.path?Qu.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||o;var a=new uu(i.manager);a.setPath(this.path),a.load(t,(function(n){var o=null;try{o=JSON.parse(n)}catch(e){return void 0!==r&&r(e),void console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message)}var a=o.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?i.parse(o,e):console.error("THREE.ObjectLoader: Can't load "+t)}),n,r)},parse:function(t,e){var n=this.parseShape(t.shapes),r=this.parseGeometries(t.geometries,n),i=this.parseImages(t.images,(function(){void 0!==e&&e(s)})),o=this.parseTextures(t.textures,i),a=this.parseMaterials(t.materials,o),s=this.parseObject(t.object,r,a);return t.animations&&(s.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(s),s},parseShape:function(t){var e={};if(void 0!==t)for(var n=0,r=t.length;n<r;n++){var i=(new Fu).fromJSON(t[n]);e[i.uuid]=i}return e},parseGeometries:function(t,e){var n={};if(void 0!==t)for(var r=new nd,i=0,o=t.length;i<o;i++){var a,s=t[i];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new Ll[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new Ll[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new Ll[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new Ll[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new Ll[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new Ll[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":a=new Ll[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new Ll[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new Ll[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new Ll[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":a=new Ll[s.type]((new Du[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":a=new Ll[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":a=new Ll[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var c=[],l=0,u=s.shapes.length;l<u;l++){var d=e[s.shapes[l]];c.push(d)}a=new Ll[s.type](c,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(c=[],l=0,u=s.shapes.length;l<u;l++){d=e[s.shapes[l]];c.push(d)}var h=s.options.extrudePath;void 0!==h&&(s.options.extrudePath=(new Du[h.type]).fromJSON(h)),a=new Ll[s.type](c,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(s);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE)a=(new THREE.LegacyJSONLoader).parse(s,this.resourcePath).geometry;else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),!0===a.isBufferGeometry&&void 0!==s.userData&&(a.userData=s.userData),n[s.uuid]=a}return n},parseMaterials:function(t,e){var n={},r={};if(void 0!==t){var i=new Ju;i.setTextures(e);for(var o=0,a=t.length;o<a;o++){var s=t[o];if("MultiMaterial"===s.type){for(var c=[],l=0;l<s.materials.length;l++){var u=s.materials[l];void 0===n[u.uuid]&&(n[u.uuid]=i.parse(u)),c.push(n[u.uuid])}r[s.uuid]=c}else void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r},parseAnimations:function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n],i=ru.parse(r);void 0!==r.uuid&&(i.uuid=r.uuid),e.push(i)}return e},parseImages:function(t,e){var n=this,r={};function i(t){return n.manager.itemStart(t),o.load(t,(function(){n.manager.itemEnd(t)}),void 0,(function(){n.manager.itemError(t),n.manager.itemEnd(t)}))}if(void 0!==t&&t.length>0){var o=new pu(new au(e));o.setCrossOrigin(this.crossOrigin);for(var a=0,s=t.length;a<s;a++){var c=t[a],l=c.url;if(Array.isArray(l)){r[c.uuid]=[];for(var u=0,d=l.length;u<d;u++){var h=l[u],f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h)?h:n.resourcePath+h;r[c.uuid].push(i(f))}}else{f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:n.resourcePath+c.url;r[c.uuid]=i(f)}}}return r},parseTextures:function(t,e){function n(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var r={};if(void 0!==t)for(var i=0,o=t.length;i<o;i++){var a,s=t[i];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===e[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image),(a=Array.isArray(e[s.image])?new Ro(e[s.image]):new On(e[s.image])).needsUpdate=!0,a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.mapping&&(a.mapping=n(s.mapping,ad)),void 0!==s.offset&&a.offset.fromArray(s.offset),void 0!==s.repeat&&a.repeat.fromArray(s.repeat),void 0!==s.center&&a.center.fromArray(s.center),void 0!==s.rotation&&(a.rotation=s.rotation),void 0!==s.wrap&&(a.wrapS=n(s.wrap[0],sd),a.wrapT=n(s.wrap[1],sd)),void 0!==s.format&&(a.format=s.format),void 0!==s.type&&(a.type=s.type),void 0!==s.encoding&&(a.encoding=s.encoding),void 0!==s.minFilter&&(a.minFilter=n(s.minFilter,cd)),void 0!==s.magFilter&&(a.magFilter=n(s.magFilter,cd)),void 0!==s.anisotropy&&(a.anisotropy=s.anisotropy),void 0!==s.flipY&&(a.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(a.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(a.unpackAlignment=s.unpackAlignment),r[s.uuid]=a}return r},parseObject:function(t,e,n){var r;function i(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function o(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],r=0,i=t.length;r<i;r++){var o=t[r];void 0===n[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),e.push(n[o])}return e}return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),n[t]}}switch(t.type){case"Scene":r=new ur,void 0!==t.background&&Number.isInteger(t.background)&&(r.background=new ti(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?r.fog=new bs(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(r.fog=new ys(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":r=new so(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(r.focus=t.focus),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.filmGauge&&(r.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(r.filmOffset=t.filmOffset),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"OrthographicCamera":r=new qu(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"AmbientLight":r=new Ku(t.color,t.intensity);break;case"DirectionalLight":r=new Yu(t.color,t.intensity);break;case"PointLight":r=new $u(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":r=new Zu(t.color,t.intensity,t.width,t.height);break;case"SpotLight":r=new Gu(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":r=new Uu(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var a=i(t.geometry),s=o(t.material);r=a.bones&&a.bones.length>0?new Hs(a,s):new $i(a,s);break;case"InstancedMesh":a=i(t.geometry),s=o(t.material);var c=t.count,l=t.instanceMatrix;(r=new Zs(a,s,c)).instanceMatrix=new li(new Float32Array(l.array),16);break;case"LOD":r=new Us;break;case"Line":r=new ic(i(t.geometry),o(t.material),t.mode);break;case"LineLoop":r=new cc(i(t.geometry),o(t.material));break;case"LineSegments":r=new sc(i(t.geometry),o(t.material));break;case"PointCloud":case"Points":r=new pc(i(t.geometry),o(t.material));break;case"Sprite":r=new zs(o(t.material));break;case"Group":r=new ms;break;default:r=new lr}if(r.uuid=t.uuid,void 0!==t.name&&(r.name=t.name),void 0!==t.matrix?(r.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(r.matrixAutoUpdate=t.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==t.position&&r.position.fromArray(t.position),void 0!==t.rotation&&r.rotation.fromArray(t.rotation),void 0!==t.quaternion&&r.quaternion.fromArray(t.quaternion),void 0!==t.scale&&r.scale.fromArray(t.scale)),void 0!==t.castShadow&&(r.castShadow=t.castShadow),void 0!==t.receiveShadow&&(r.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(r.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(r.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&r.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(r.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.frustumCulled&&(r.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(r.renderOrder=t.renderOrder),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.layers&&(r.layers.mask=t.layers),void 0!==t.children)for(var u=t.children,d=0;d<u.length;d++)r.add(this.parseObject(u[d],e,n));if("LOD"===t.type){void 0!==t.autoUpdate&&(r.autoUpdate=t.autoUpdate);for(var h=t.levels,f=0;f<h.length;f++){var p=h[f],m=r.getObjectByProperty("uuid",p.object);void 0!==m&&r.addLevel(m,p.distance)}}return r}});var od,ad={UVMapping:lt,CubeReflectionMapping:ut,CubeRefractionMapping:dt,EquirectangularReflectionMapping:ht,EquirectangularRefractionMapping:ft,SphericalReflectionMapping:pt,CubeUVReflectionMapping:mt,CubeUVRefractionMapping:gt},sd={RepeatWrapping:vt,ClampToEdgeWrapping:yt,MirroredRepeatWrapping:bt},cd={NearestFilter:xt,NearestMipmapNearestFilter:_t,NearestMipmapLinearFilter:St,LinearFilter:Et,LinearMipmapNearestFilter:Tt,LinearMipmapLinearFilter:Ct};function ld(t){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),cu.call(this,t),this.options=void 0}function ud(){this.type="ShapePath",this.color=new ti,this.subPaths=[],this.currentPath=null}function dd(t){this.type="Font",this.data=t}function hd(t,e,n,r,i){var o=i.glyphs[t]||i.glyphs["?"];if(o){var a,s,c,l,u,d,h,f,p=new ud;if(o.o)for(var m=o._cachedOutline||(o._cachedOutline=o.o.split(" ")),g=0,v=m.length;g<v;){switch(m[g++]){case"m":a=m[g++]*e+n,s=m[g++]*e+r,p.moveTo(a,s);break;case"l":a=m[g++]*e+n,s=m[g++]*e+r,p.lineTo(a,s);break;case"q":c=m[g++]*e+n,l=m[g++]*e+r,u=m[g++]*e+n,d=m[g++]*e+r,p.quadraticCurveTo(u,d,c,l);break;case"b":c=m[g++]*e+n,l=m[g++]*e+r,u=m[g++]*e+n,d=m[g++]*e+r,h=m[g++]*e+n,f=m[g++]*e+r,p.bezierCurveTo(u,d,h,f,c,l)}}return{offsetX:o.ha*e,path:p}}console.error('THREE.Font: character "'+t+'" does not exists in font family '+i.familyName+".")}function fd(t){cu.call(this,t)}ld.prototype=Object.assign(Object.create(cu.prototype),{constructor:ld,setOptions:function(t){return this.options=t,this},load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=ou.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;fetch(t).then((function(t){return t.blob()})).then((function(t){return void 0===i.options?createImageBitmap(t):createImageBitmap(t,i.options)})).then((function(n){ou.add(t,n),e&&e(n),i.manager.itemEnd(t)})).catch((function(e){r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)})),i.manager.itemStart(t)}}),Object.assign(ud.prototype,{moveTo:function(t,e){return this.currentPath=new ju,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this},lineTo:function(t,e){return this.currentPath.lineTo(t,e),this},quadraticCurveTo:function(t,e,n,r){return this.currentPath.quadraticCurveTo(t,e,n,r),this},bezierCurveTo:function(t,e,n,r,i,o){return this.currentPath.bezierCurveTo(t,e,n,r,i,o),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,e){function n(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n],o=new Fu;o.curves=i.curves,e.push(o)}return e}function r(t,e){for(var n=e.length,r=!1,i=n-1,o=0;o<n;i=o++){var a=e[i],s=e[o],c=s.x-a.x,l=s.y-a.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(a=e[o],c=-c,s=e[i],l=-l),t.y<a.y||t.y>s.y)continue;if(t.y===a.y){if(t.x===a.x)return!0}else{var u=l*(t.x-a.x)-c*(t.y-a.y);if(0===u)return!0;if(u<0)continue;r=!r}}else{if(t.y!==a.y)continue;if(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x)return!0}}return r}var i=sl.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===e)return n(o);var a,s,c,l=[];if(1===o.length)return s=o[0],(c=new Fu).curves=s.curves,l.push(c),l;var u=!i(o[0].getPoints());u=t?!u:u;var d,h,f=[],p=[],m=[],g=0;p[g]=void 0,m[g]=[];for(var v=0,y=o.length;v<y;v++)a=i(d=(s=o[v]).getPoints()),(a=t?!a:a)?(!u&&p[g]&&g++,p[g]={s:new Fu,p:d},p[g].s.curves=s.curves,u&&g++,m[g]=[]):m[g].push({h:s,p:d[0]});if(!p[0])return n(o);if(p.length>1){for(var b=!1,x=[],_=0,w=p.length;_<w;_++)f[_]=[];for(_=0,w=p.length;_<w;_++)for(var S=m[_],M=0;M<S.length;M++){for(var E=S[M],T=!0,A=0;A<p.length;A++)r(E.p,p[A].p)&&(_!==A&&x.push({froms:_,tos:A,hole:M}),T?(T=!1,f[A].push(E)):b=!0);T&&f[_].push(E)}x.length>0&&(b||(m=f))}v=0;for(var C=p.length;v<C;v++){c=p[v].s,l.push(c);for(var P=0,O=(h=m[v]).length;P<O;P++)c.holes.push(h[P].h)}return l}}),Object.assign(dd.prototype,{isFont:!0,generateShapes:function(t,e){void 0===e&&(e=100);for(var n=[],r=function(t,e,n){for(var r=Array.from?Array.from(t):String(t).split(""),i=e/n.resolution,o=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,a=[],s=0,c=0,l=0;l<r.length;l++){var u=r[l];if("\n"===u)s=0,c-=o;else{var d=hd(u,i,s,c,n);s+=d.offsetX,a.push(d.path)}}return a}(t,e,this.data),i=0,o=r.length;i<o;i++)Array.prototype.push.apply(n,r[i].toShapes());return n}}),fd.prototype=Object.assign(Object.create(cu.prototype),{constructor:fd,load:function(t,e,n,r){var i=this,o=new uu(this.manager);o.setPath(this.path),o.load(t,(function(t){var n;try{n=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}var r=i.parse(n);e&&e(r)}),n,r)},parse:function(t){return new dd(t)}});var pd={getContext:function(){return void 0===od&&(od=new(window.AudioContext||window.webkitAudioContext)),od},setContext:function(t){od=t}};function md(t){cu.call(this,t)}function gd(){this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new zn)}function vd(t,e){Bu.call(this,void 0,e),this.sh=void 0!==t?t:new gd}function yd(t,e,n){vd.call(this,void 0,n);var r=(new ti).set(t),i=(new ti).set(e),o=new zn(r.r,r.g,r.b),a=new zn(i.r,i.g,i.b),s=Math.sqrt(Math.PI),c=s*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(s),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(c)}function bd(t,e){vd.call(this,void 0,e);var n=(new ti).set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}md.prototype=Object.assign(Object.create(cu.prototype),{constructor:md,load:function(t,e,n,r){var i=new uu(this.manager);i.setResponseType("arraybuffer"),i.setPath(this.path),i.load(t,(function(t){var n=t.slice(0);pd.getContext().decodeAudioData(n,(function(t){e(t)}))}),n,r)}}),Object.assign(gd.prototype,{isSphericalHarmonics3:!0,set:function(t){for(var e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this},zero:function(){for(var t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},getAt:function(t,e){var n=t.x,r=t.y,i=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.282095),e.addScale(o[1],.488603*r),e.addScale(o[2],.488603*i),e.addScale(o[3],.488603*n),e.addScale(o[4],n*r*1.092548),e.addScale(o[5],r*i*1.092548),e.addScale(o[6],.315392*(3*i*i-1)),e.addScale(o[7],n*i*1.092548),e.addScale(o[8],.546274*(n*n-r*r)),e},getIrradianceAt:function(t,e){var n=t.x,r=t.y,i=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.886227),e.addScale(o[1],1.023328*r),e.addScale(o[2],1.023328*i),e.addScale(o[3],1.023328*n),e.addScale(o[4],.858086*n*r),e.addScale(o[5],.858086*r*i),e.addScale(o[6],.743125*i*i-.247708),e.addScale(o[7],.858086*n*i),e.addScale(o[8],.429043*(n*n-r*r)),e},add:function(t){for(var e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this},scale:function(t){for(var e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this},lerp:function(t,e){for(var n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this},equals:function(t){for(var e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0},copy:function(t){return this.set(t.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(t,e){void 0===e&&(e=0);for(var n=this.coefficients,r=0;r<9;r++)n[r].fromArray(t,e+3*r);return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);for(var n=this.coefficients,r=0;r<9;r++)n[r].toArray(t,e+3*r);return t}}),Object.assign(gd,{getBasisAt:function(t,e){var n=t.x,r=t.y,i=t.z;e[0]=.282095,e[1]=.488603*r,e[2]=.488603*i,e[3]=.488603*n,e[4]=1.092548*n*r,e[5]=1.092548*r*i,e[6]=.315392*(3*i*i-1),e[7]=1.092548*n*i,e[8]=.546274*(n*n-r*r)}}),vd.prototype=Object.assign(Object.create(Bu.prototype),{constructor:vd,isLightProbe:!0,copy:function(t){return Bu.prototype.copy.call(this,t),this.sh.copy(t.sh),this.intensity=t.intensity,this},toJSON:function(t){return Bu.prototype.toJSON.call(this,t)}}),yd.prototype=Object.assign(Object.create(vd.prototype),{constructor:yd,isHemisphereLightProbe:!0,copy:function(t){return vd.prototype.copy.call(this,t),this},toJSON:function(t){return vd.prototype.toJSON.call(this,t)}}),bd.prototype=Object.assign(Object.create(vd.prototype),{constructor:bd,isAmbientLightProbe:!0,copy:function(t){return vd.prototype.copy.call(this,t),this},toJSON:function(t){return vd.prototype.toJSON.call(this,t)}});var xd=new Wn,_d=new Wn;function wd(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new so,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new so,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}function Sd(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(wd.prototype,{update:function(t){var e=this._cache;if(e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep){e.focus=t.focus,e.fov=t.fov,e.aspect=t.aspect*this.aspect,e.near=t.near,e.far=t.far,e.zoom=t.zoom,e.eyeSep=this.eyeSep;var n,r,i=t.projectionMatrix.clone(),o=e.eyeSep/2,a=o*e.near/e.focus,s=e.near*Math.tan(En.DEG2RAD*e.fov*.5)/e.zoom;_d.elements[12]=-o,xd.elements[12]=o,n=-s*e.aspect+a,r=s*e.aspect+a,i.elements[0]=2*e.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraL.projectionMatrix.copy(i),n=-s*e.aspect-a,r=s*e.aspect-a,i.elements[0]=2*e.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(_d),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(xd)}}),Object.assign(Sd.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"==typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}});var Md=new zn,Ed=new In,Td=new zn,Ad=new zn;function Cd(){lr.call(this),this.type="AudioListener",this.context=pd.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Sd}function Pd(t){lr.call(this),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._pausedAt=0,this.filters=[]}Cd.prototype=Object.assign(Object.create(lr.prototype),{constructor:Cd,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},updateMatrixWorld:function(t){lr.prototype.updateMatrixWorld.call(this,t);var e=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Md,Ed,Td),Ad.set(0,0,-1).applyQuaternion(Ed),e.positionX){var r=this.context.currentTime+this.timeDelta;e.positionX.linearRampToValueAtTime(Md.x,r),e.positionY.linearRampToValueAtTime(Md.y,r),e.positionZ.linearRampToValueAtTime(Md.z,r),e.forwardX.linearRampToValueAtTime(Ad.x,r),e.forwardY.linearRampToValueAtTime(Ad.y,r),e.forwardZ.linearRampToValueAtTime(Ad.z,r),e.upX.linearRampToValueAtTime(n.x,r),e.upY.linearRampToValueAtTime(n.y,r),e.upZ.linearRampToValueAtTime(n.z,r)}else e.setPosition(Md.x,Md.y,Md.z),e.setOrientation(Ad.x,Ad.y,Ad.z,n.x,n.y,n.z)}}),Pd.prototype=Object.assign(Object.create(lr.prototype),{constructor:Pd,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setMediaElementSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},setMediaStreamSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(t){if(void 0===t&&(t=0),!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+t;var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._pausedAt+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._pausedAt=(this.context.currentTime-this._startedAt)*this.playbackRate,this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this._pausedAt=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},setDetune:function(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},setLoopStart:function(t){return this.loopStart=t,this},setLoopEnd:function(t){return this.loopEnd=t,this},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}});var Od=new zn,kd=new In,Ld=new zn,Rd=new zn;function Id(t){Pd.call(this,t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function Nd(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function Dd(t,e,n){this.binding=t,this.valueSize=n;var r,i=Float64Array;switch(e){case"quaternion":r=this._slerp;break;case"string":case"bool":i=Array,r=this._select;break;default:r=this._lerp}this.buffer=new i(4*n),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Id.prototype=Object.assign(Object.create(Pd.prototype),{constructor:Id,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){return this.panner.refDistance=t,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){return this.panner.rolloffFactor=t,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){return this.panner.distanceModel=t,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){return this.panner.maxDistance=t,this},setDirectionalCone:function(t,e,n){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=n,this},updateMatrixWorld:function(t){if(lr.prototype.updateMatrixWorld.call(this,t),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(Od,kd,Ld),Rd.set(0,0,1).applyQuaternion(kd);var e=this.panner;if(e.positionX){var n=this.context.currentTime+this.listener.timeDelta;e.positionX.linearRampToValueAtTime(Od.x,n),e.positionY.linearRampToValueAtTime(Od.y,n),e.positionZ.linearRampToValueAtTime(Od.z,n),e.orientationX.linearRampToValueAtTime(Rd.x,n),e.orientationY.linearRampToValueAtTime(Rd.y,n),e.orientationZ.linearRampToValueAtTime(Rd.z,n)}else e.setPosition(Od.x,Od.y,Od.z),e.setOrientation(Rd.x,Rd.y,Rd.z)}}}),Object.assign(Nd.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),n=0;n<e.length;n++)t+=e[n];return t/e.length}}),Object.assign(Dd.prototype,{accumulate:function(t,e){var n=this.buffer,r=this.valueSize,i=t*r+r,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==r;++a)n[i+a]=n[a];o=e}else{var s=e/(o+=e);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=o},apply:function(t){var e=this.valueSize,n=this.buffer,r=t*e+e,i=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,i<1){var a=3*e;this._mixBufferRegion(n,r,a,1-i,e)}for(var s=e,c=e+e;s!==c;++s)if(n[s]!==n[s+e]){o.setValue(n,r);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,n=this.valueSize,r=3*n;t.getValue(e,r);for(var i=n,o=r;i!==o;++i)e[i]=e[r+i%n];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,n,r,i){if(r>=.5)for(var o=0;o!==i;++o)t[e+o]=t[n+o]},_slerp:function(t,e,n,r){In.slerpFlat(t,e,t,e,t,n,r)},_lerp:function(t,e,n,r,i){for(var o=1-r,a=0;a!==i;++a){var s=e+a;t[s]=t[s]*o+t[n+a]*r}}});var zd=new RegExp("[\\[\\]\\.:\\/]","g"),jd="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",Fd=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),Bd=/(WCOD+)?/.source.replace("WCOD",jd),Ud=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Hd=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Vd=new RegExp("^"+Fd+Bd+Ud+Hd+"$"),Gd=["material","materials","bones"];function Wd(t,e,n){var r=n||$d.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}function $d(t,e,n){this.path=e,this.parsedPath=n||$d.parseTrackName(e),this.node=$d.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function qd(){this.uuid=En.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,n=arguments.length;e!==n;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}function Xd(t,e,n){this._mixer=t,this._clip=e,this._localRoot=n||null;for(var r=e.tracks,i=r.length,o=new Array(i),a={endingStart:ke,endingEnd:ke},s=0;s!==i;++s){var c=r[s].createInterpolant(null);o[s]=c,c.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Te,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Yd(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Kd(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function Zd(t,e,n){xs.call(this,t,e),this.meshPerAttribute=n||1}function Jd(t,e,n,r){this.ray=new Nr(t,e),this.near=n||0,this.far=r||1/0,this.camera=null,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Qd(t,e){return t.distance-e.distance}function th(t,e,n,r){if(!1!==t.visible&&(t.raycast(e,n),!0===r))for(var i=t.children,o=0,a=i.length;o<a;o++)th(i[o],e,n,!0)}function eh(t,e,n){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==n?n:0,this}function nh(t,e,n){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==n?n:0,this}Object.assign(Wd.prototype,{getValue:function(t,e){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(t,e)},setValue:function(t,e){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}),Object.assign($d,{Composite:Wd,create:function(t,e,n){return t&&t.isAnimationObjectGroup?new $d.Composite(t,e,n):new $d(t,e,n)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(zd,"")},parseTrackName:function(t){var e=Vd.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==Gd.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n},findNode:function(t,e){if(!e||""===e||"root"===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){var r=function(t){for(var n=0;n<t.length;n++){var i=t[n];if(i.name===e||i.uuid===e)return i;var o=r(i.children);if(o)return o}return null},i=r(t.children);if(i)return i}return null}}),Object.assign($d.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)t[e++]=n[r]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,n=e.objectName,r=e.propertyName,i=e.propertyIndex;if(t||(t=$d.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(n){var o=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var a=0;a<t.length;a++)if(t[a].name===o){o=a;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==o){if(void 0===t[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[o]}}var s=t[r];if(void 0!==s){var c=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?c=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate);var l=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(t.geometry.morphAttributes.position[a].name===i){i=a;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(a=0;a<this.node.geometry.morphTargets.length;a++)if(t.geometry.morphTargets[a].name===i){i=a;break}}}l=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(l=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][c]}else{var u=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+r+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign($d.prototype,{_getValue_unbound:$d.prototype.getValue,_setValue_unbound:$d.prototype.setValue}),Object.assign(qd.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._paths,o=this._parsedPaths,a=this._bindings,s=a.length,c=void 0,l=0,u=arguments.length;l!==u;++l){var d=arguments[l],h=d.uuid,f=r[h];if(void 0===f){f=e++,r[h]=f,t.push(d);for(var p=0,m=s;p!==m;++p)a[p].push(new $d(d,i[p],o[p]))}else if(f<n){c=t[f];var g=--n,v=t[g];r[v.uuid]=f,t[f]=v,r[h]=g,t[g]=d;for(p=0,m=s;p!==m;++p){var y=a[p],b=y[g],x=y[f];y[f]=b,void 0===x&&(x=new $d(d,i[p],o[p])),y[g]=x}}else t[f]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var t=this._objects,e=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,i=r.length,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],c=s.uuid,l=n[c];if(void 0!==l&&l>=e){var u=e++,d=t[u];n[d.uuid]=l,t[l]=d,n[c]=u,t[u]=s;for(var h=0,f=i;h!==f;++h){var p=r[h],m=p[u],g=p[l];p[l]=m,p[u]=g}}}this.nCachedObjects_=e},uncache:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,o=i.length,a=0,s=arguments.length;a!==s;++a){var c=arguments[a],l=c.uuid,u=r[l];if(void 0!==u)if(delete r[l],u<n){var d=--n,h=t[d],f=t[y=--e];r[h.uuid]=u,t[u]=h,r[f.uuid]=d,t[d]=f,t.pop();for(var p=0,m=o;p!==m;++p){var g=(b=i[p])[d],v=b[y];b[u]=g,b[d]=v,b.pop()}}else{var y;r[(f=t[y=--e]).uuid]=u,t[u]=f,t.pop();for(p=0,m=o;p!==m;++p){var b;(b=i[p])[u]=b[y],b.pop()}}}this.nCachedObjects_=n},subscribe_:function(t,e){var n=this._bindingsIndicesByPath,r=n[t],i=this._bindings;if(void 0!==r)return i[r];var o=this._paths,a=this._parsedPaths,s=this._objects,c=s.length,l=this.nCachedObjects_,u=new Array(c);r=i.length,n[t]=r,o.push(t),a.push(e),i.push(u);for(var d=l,h=s.length;d!==h;++d){var f=s[d];u[d]=new $d(f,t,e)}return u},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){var r=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];e[t[a]]=n,o[n]=s,o.pop(),i[n]=i[a],i.pop(),r[n]=r[a],r.pop()}}}),Object.assign(Xd.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){var r=this._clip.duration,i=t._clip.duration,o=i/r,a=r/i;t.warp(1,o,e),this.warp(a,1,e)}return this},crossFadeTo:function(t,e,n){return t.crossFadeFrom(this,e,n)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,n){var r=this._mixer,i=r.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,c=o.sampleValues;return s[0]=i,s[1]=i+n,c[0]=t/a,c[1]=e/a,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var o=(t-i)*n;if(o<0||0===n)return;this._startTime=null,e=n*o}e*=this._updateTimeScale(t);var a=this._updateTime(e),s=this._updateWeight(t);if(s>0)for(var c=this._interpolants,l=this._propertyBindings,u=0,d=c.length;u!==d;++u)c[u].evaluate(a),l[u].accumulate(r,s)}else this._updateWeight(t)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t,n=this._clip.duration,r=this.loop,i=this._loopCount,o=r===Ae;if(0===t)return-1===i?e:o&&1==(1&i)?n-e:e;if(r===Ee){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=n)e=n;else{if(!(e<0)){this.time=e;break t}e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=e,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),e>=n||e<0){var a=Math.floor(e/n);e-=n*a,i+=Math.abs(a);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?n:0,this.time=e,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===s){var c=t<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this.time=e,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=e;if(o&&1==(1&i))return n-e}return e},_setEndings:function(t,e,n){var r=this._interpolantSettings;n?(r.endingStart=Le,r.endingEnd=Le):(r.endingStart=t?this.zeroSlopeAtStart?Le:ke:Re,r.endingEnd=e?this.zeroSlopeAtEnd?Le:ke:Re)},_scheduleFading:function(t,e,n){var r=this._mixer,i=r.time,o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=i,s[0]=e,a[1]=i+t,s[1]=n,this}}),Yd.prototype=Object.assign(Object.create(_n.prototype),{constructor:Yd,_bindAction:function(t,e){var n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,o=t._propertyBindings,a=t._interpolants,s=n.uuid,c=this._bindingsByRootAndName,l=c[s];void 0===l&&(l={},c[s]=l);for(var u=0;u!==i;++u){var d=r[u],h=d.name,f=l[h];if(void 0!==f)o[u]=f;else{if(void 0!==(f=o[u])){null===f._cacheIndex&&(++f.referenceCount,this._addInactiveBinding(f,s,h));continue}var p=e&&e._propertyBindings[u].binding.parsedPath;++(f=new Dd($d.create(n,h,p),d.ValueTypeName,d.getValueSize())).referenceCount,this._addInactiveBinding(f,s,h),o[u]=f}a[u].resultBuffer=f.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}for(var i=t._propertyBindings,o=0,a=i.length;o!==a;++o){var s=i[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,n){var r=this._actions,i=this._actionsByClip,o=i[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=o;else{var a=o.knownActions;t._byClipCacheIndex=a.length,a.push(t)}t._cacheIndex=r.length,r.push(t),o.actionByRoot[n]=t},_removeInactiveAction:function(t){var e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;var i=t._clip.uuid,o=this._actionsByClip,a=o[i],s=a.knownActions,c=s[s.length-1],l=t._byClipCacheIndex;c._byClipCacheIndex=l,s[l]=c,s.pop(),t._byClipCacheIndex=null,delete a.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete o[i],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(t){var e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackAction:function(t){var e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_addInactiveBinding:function(t,e,n){var r=this._bindingsByRootAndName,i=r[e],o=this._bindings;void 0===i&&(i={},r[e]=i),i[n]=t,t._cacheIndex=o.length,o.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,n=t.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,a=o[r],s=e[e.length-1],c=t._cacheIndex;s._cacheIndex=c,e[c]=s,e.pop(),delete a[i],0===Object.keys(a).length&&delete o[r]},_lendBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&((n=new ql(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?ru.findByName(n,t):t,o=null!==i?i.uuid:t,a=this._actionsByClip[o],s=null;if(void 0!==a){var c=a.actionByRoot[r];if(void 0!==c)return c;s=a.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var l=new Xd(this,i,e);return this._bindAction(l,s),this._addInactiveAction(l,o,r),l},existingAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?ru.findByName(n,t):t,o=i?i.uuid:t,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[r]||null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==e;++i)t[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,n=this._nActiveActions,r=this.time+=t,i=Math.sign(t),o=this._accuIndex^=1,a=0;a!==n;++a){e[a]._update(r,t,i,o)}var s=this._bindings,c=this._nActiveBindings;for(a=0;a!==c;++a)s[a].apply(o);return this},setTime:function(t){this.time=0;for(var e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,n=t.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var o=i.knownActions,a=0,s=o.length;a!==s;++a){var c=o[a];this._deactivateAction(c);var l=c._cacheIndex,u=e[e.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,u._cacheIndex=l,e[l]=u,e.pop(),this._removeInactiveBindingsForAction(c)}delete r[n]}},uncacheRoot:function(t){var e=t.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[e];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var o=this._bindingsByRootAndName[e];if(void 0!==o)for(var a in o){var s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(t,e){var n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),Kd.prototype.clone=function(){return new Kd(void 0===this.value.clone?this.value:this.value.clone())},Zd.prototype=Object.assign(Object.create(xs.prototype),{constructor:Zd,isInstancedInterleavedBuffer:!0,copy:function(t){return xs.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Object.assign(Jd.prototype,{linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e,n){var r=n||[];return th(t,this,r,e),r.sort(Qd),r},intersectObjects:function(t,e,n){var r=n||[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var i=0,o=t.length;i<o;i++)th(t[i],this,r,e);return r.sort(Qd),r}}),Object.assign(eh.prototype,{set:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(En.clamp(e/this.radius,-1,1))),this}}),Object.assign(nh.prototype,{set:function(t,e,n){return this.radius=t,this.theta=e,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,n){return this.radius=Math.sqrt(t*t+n*n),this.theta=Math.atan2(t,n),this.y=e,this}});var rh=new Tn;function ih(t,e){this.min=void 0!==t?t:new Tn(1/0,1/0),this.max=void 0!==e?e:new Tn(-1/0,-1/0)}Object.assign(ih.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){var n=rh.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new Tn),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new Tn),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .getParameter() target is now required"),e=new Tn),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .clampPoint() target is now required"),e=new Tn),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return rh.copy(t).clamp(this.min,this.max).sub(t).length()},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var oh=new zn,ah=new zn;function sh(t,e){this.start=void 0!==t?t:new zn,this.end=void 0!==e?e:new zn}function ch(t){lr.call(this),this.material=t,this.render=function(){}}Object.assign(sh.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new zn),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new zn),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){return void 0===e&&(console.warn("THREE.Line3: .at() target is now required"),e=new zn),this.delta(e).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(t,e){oh.subVectors(t,this.start),ah.subVectors(this.end,this.start);var n=ah.dot(ah),r=ah.dot(oh)/n;return e&&(r=En.clamp(r,0,1)),r},closestPointToPoint:function(t,e,n){var r=this.closestPointToPointParameter(t,e);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new zn),this.delta(n).multiplyScalar(r).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),ch.prototype=Object.create(lr.prototype),ch.prototype.constructor=ch,ch.prototype.isImmediateRenderObject=!0;var lh=new zn;function uh(t,e){lr.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;for(var n=new Ci,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,o=1;i<32;i++,o++){var a=i/32*Math.PI*2,s=o/32*Math.PI*2;r.push(Math.cos(a),Math.sin(a),1,Math.cos(s),Math.sin(s),1)}n.setAttribute("position",new vi(r,3));var c=new Js({fog:!1});this.cone=new sc(n,c),this.add(this.cone),this.update()}uh.prototype=Object.create(lr.prototype),uh.prototype.constructor=uh,uh.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},uh.prototype.update=function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),lh.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(lh),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var dh=new zn,hh=new Wn,fh=new Wn;function ph(t){for(var e=function t(e){var n=[];e&&e.isBone&&n.push(e);for(var r=0;r<e.children.length;r++)n.push.apply(n,t(e.children[r]));return n}(t),n=new Ci,r=[],i=[],o=new ti(0,0,1),a=new ti(0,1,0),s=0;s<e.length;s++){var c=e[s];c.parent&&c.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(o.r,o.g,o.b),i.push(a.r,a.g,a.b))}n.setAttribute("position",new vi(r,3)),n.setAttribute("color",new vi(i,3));var l=new Js({vertexColors:S,depthTest:!1,depthWrite:!1,transparent:!0});sc.call(this,n,l),this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function mh(t,e,n){this.light=t,this.light.updateMatrixWorld(),this.color=n;var r=new vl(e,4,2),i=new si({wireframe:!0,fog:!1});$i.call(this,r,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}ph.prototype=Object.create(sc.prototype),ph.prototype.constructor=ph,ph.prototype.updateMatrixWorld=function(t){var e=this.bones,n=this.geometry,r=n.getAttribute("position");fh.getInverse(this.root.matrixWorld);for(var i=0,o=0;i<e.length;i++){var a=e[i];a.parent&&a.parent.isBone&&(hh.multiplyMatrices(fh,a.matrixWorld),dh.setFromMatrixPosition(hh),r.setXYZ(o,dh.x,dh.y,dh.z),hh.multiplyMatrices(fh,a.parent.matrixWorld),dh.setFromMatrixPosition(hh),r.setXYZ(o+1,dh.x,dh.y,dh.z),o+=2)}n.getAttribute("position").needsUpdate=!0,lr.prototype.updateMatrixWorld.call(this,t)},mh.prototype=Object.create($i.prototype),mh.prototype.constructor=mh,mh.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},mh.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var gh=new zn,vh=new ti,yh=new ti;function bh(t,e,n){lr.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var r=new Cc(e);r.rotateY(.5*Math.PI),this.material=new si({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=S);var i=r.getAttribute("position"),o=new Float32Array(3*i.count);r.setAttribute("color",new li(o,3)),this.add(new $i(r,this.material)),this.update()}function xh(t,e,n,r){t=t||10,e=e||10,n=new ti(void 0!==n?n:4473924),r=new ti(void 0!==r?r:8947848);for(var i=e/2,o=t/e,a=t/2,s=[],c=[],l=0,u=0,d=-a;l<=e;l++,d+=o){s.push(-a,0,d,a,0,d),s.push(d,0,-a,d,0,a);var h=l===i?n:r;h.toArray(c,u),u+=3,h.toArray(c,u),u+=3,h.toArray(c,u),u+=3,h.toArray(c,u),u+=3}var f=new Ci;f.setAttribute("position",new vi(s,3)),f.setAttribute("color",new vi(c,3));var p=new Js({vertexColors:S});sc.call(this,f,p)}function _h(t,e,n,r,i,o){t=t||10,e=e||16,n=n||8,r=r||64,i=new ti(void 0!==i?i:4473924),o=new ti(void 0!==o?o:8947848);var a,s,c,l,u,d,h,f=[],p=[];for(l=0;l<=e;l++)c=l/e*(2*Math.PI),a=Math.sin(c)*t,s=Math.cos(c)*t,f.push(0,0,0),f.push(a,0,s),h=1&l?i:o,p.push(h.r,h.g,h.b),p.push(h.r,h.g,h.b);for(l=0;l<=n;l++)for(h=1&l?i:o,d=t-t/n*l,u=0;u<r;u++)c=u/r*(2*Math.PI),a=Math.sin(c)*d,s=Math.cos(c)*d,f.push(a,0,s),p.push(h.r,h.g,h.b),c=(u+1)/r*(2*Math.PI),a=Math.sin(c)*d,s=Math.cos(c)*d,f.push(a,0,s),p.push(h.r,h.g,h.b);var m=new Ci;m.setAttribute("position",new vi(f,3)),m.setAttribute("color",new vi(p,3));var g=new Js({vertexColors:S});sc.call(this,m,g)}bh.prototype=Object.create(lr.prototype),bh.prototype.constructor=bh,bh.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},bh.prototype.update=function(){var t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var e=t.geometry.getAttribute("color");vh.copy(this.light.color),yh.copy(this.light.groundColor);for(var n=0,r=e.count;n<r;n++){var i=n<r/2?vh:yh;e.setXYZ(n,i.r,i.g,i.b)}e.needsUpdate=!0}t.lookAt(gh.setFromMatrixPosition(this.light.matrixWorld).negate())},xh.prototype=Object.assign(Object.create(sc.prototype),{constructor:xh,copy:function(t){return sc.prototype.copy.call(this,t),this.geometry.copy(t.geometry),this.material.copy(t.material),this},clone:function(){return(new this.constructor).copy(this)}}),_h.prototype=Object.create(sc.prototype),_h.prototype.constructor=_h;var wh=new zn,Sh=new zn,Mh=new zn;function Eh(t,e,n){lr.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===e&&(e=1);var r=new Ci;r.setAttribute("position",new vi([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var i=new Js({fog:!1});this.lightPlane=new ic(r,i),this.add(this.lightPlane),(r=new Ci).setAttribute("position",new vi([0,0,0,0,0,1],3)),this.targetLine=new ic(r,i),this.add(this.targetLine),this.update()}Eh.prototype=Object.create(lr.prototype),Eh.prototype.constructor=Eh,Eh.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Eh.prototype.update=function(){wh.setFromMatrixPosition(this.light.matrixWorld),Sh.setFromMatrixPosition(this.light.target.matrixWorld),Mh.subVectors(Sh,wh),this.lightPlane.lookAt(Sh),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Sh),this.targetLine.scale.z=Mh.length()};var Th=new zn,Ah=new ao;function Ch(t){var e=new Ci,n=new Js({color:16777215,vertexColors:w}),r=[],i=[],o={},a=new ti(16755200),s=new ti(16711680),c=new ti(43775),l=new ti(16777215),u=new ti(3355443);function d(t,e,n){h(t,n),h(e,n)}function h(t,e){r.push(0,0,0),i.push(e.r,e.g,e.b),void 0===o[t]&&(o[t]=[]),o[t].push(r.length/3-1)}d("n1","n2",a),d("n2","n4",a),d("n4","n3",a),d("n3","n1",a),d("f1","f2",a),d("f2","f4",a),d("f4","f3",a),d("f3","f1",a),d("n1","f1",a),d("n2","f2",a),d("n3","f3",a),d("n4","f4",a),d("p","n1",s),d("p","n2",s),d("p","n3",s),d("p","n4",s),d("u1","u2",c),d("u2","u3",c),d("u3","u1",c),d("c","t",l),d("p","c",u),d("cn1","cn2",u),d("cn3","cn4",u),d("cf1","cf2",u),d("cf3","cf4",u),e.setAttribute("position",new vi(r,3)),e.setAttribute("color",new vi(i,3)),sc.call(this,e,n),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function Ph(t,e,n,r,i,o,a){Th.set(i,o,a).unproject(r);var s=e[t];if(void 0!==s)for(var c=n.getAttribute("position"),l=0,u=s.length;l<u;l++)c.setXYZ(s[l],Th.x,Th.y,Th.z)}Ch.prototype=Object.create(sc.prototype),Ch.prototype.constructor=Ch,Ch.prototype.update=function(){var t=this.geometry,e=this.pointMap;Ah.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Ph("c",e,t,Ah,0,0,-1),Ph("t",e,t,Ah,0,0,1),Ph("n1",e,t,Ah,-1,-1,-1),Ph("n2",e,t,Ah,1,-1,-1),Ph("n3",e,t,Ah,-1,1,-1),Ph("n4",e,t,Ah,1,1,-1),Ph("f1",e,t,Ah,-1,-1,1),Ph("f2",e,t,Ah,1,-1,1),Ph("f3",e,t,Ah,-1,1,1),Ph("f4",e,t,Ah,1,1,1),Ph("u1",e,t,Ah,.7,1.1,-1),Ph("u2",e,t,Ah,-.7,1.1,-1),Ph("u3",e,t,Ah,0,2,-1),Ph("cf1",e,t,Ah,-1,0,1),Ph("cf2",e,t,Ah,1,0,1),Ph("cf3",e,t,Ah,0,-1,1),Ph("cf4",e,t,Ah,0,1,1),Ph("cn1",e,t,Ah,-1,0,-1),Ph("cn2",e,t,Ah,1,0,-1),Ph("cn3",e,t,Ah,0,-1,-1),Ph("cn4",e,t,Ah,0,1,-1),t.getAttribute("position").needsUpdate=!0};var Oh=new Mr;function kh(t,e){this.object=t,void 0===e&&(e=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new Ci;i.setIndex(new li(n,1)),i.setAttribute("position",new li(r,3)),sc.call(this,i,new Js({color:e})),this.matrixAutoUpdate=!1,this.update()}function Lh(t,e){this.type="Box3Helper",this.box=t,e=e||16776960;var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Ci;r.setIndex(new li(n,1)),r.setAttribute("position",new vi([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),sc.call(this,r,new Js({color:e})),this.geometry.computeBoundingSphere()}function Rh(t,e,n){this.type="PlaneHelper",this.plane=t,this.size=void 0===e?1:e;var r=void 0!==n?n:16776960,i=new Ci;i.setAttribute("position",new vi([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),ic.call(this,i,new Js({color:r}));var o=new Ci;o.setAttribute("position",new vi([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new $i(o,new si({color:r,opacity:.2,transparent:!0,depthWrite:!1})))}kh.prototype=Object.create(sc.prototype),kh.prototype.constructor=kh,kh.prototype.update=function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Oh.setFromObject(this.object),!Oh.isEmpty()){var e=Oh.min,n=Oh.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=e.x,i[4]=n.y,i[5]=n.z,i[6]=e.x,i[7]=e.y,i[8]=n.z,i[9]=n.x,i[10]=e.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=e.z,i[15]=e.x,i[16]=n.y,i[17]=e.z,i[18]=e.x,i[19]=e.y,i[20]=e.z,i[21]=n.x,i[22]=e.y,i[23]=e.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}},kh.prototype.setFromObject=function(t){return this.object=t,this.update(),this},kh.prototype.copy=function(t){return sc.prototype.copy.call(this,t),this.object=t.object,this},kh.prototype.clone=function(){return(new this.constructor).copy(this)},Lh.prototype=Object.create(sc.prototype),Lh.prototype.constructor=Lh,Lh.prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),lr.prototype.updateMatrixWorld.call(this,t))},Rh.prototype=Object.create(ic.prototype),Rh.prototype.constructor=Rh,Rh.prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.children[0].material.side=e<0?v:g,this.lookAt(this.plane.normal),lr.prototype.updateMatrixWorld.call(this,t)};var Ih,Nh,Dh=new zn;function zh(t,e,n,r,i,o){lr.call(this),void 0===t&&(t=new zn(0,0,1)),void 0===e&&(e=new zn(0,0,0)),void 0===n&&(n=1),void 0===r&&(r=16776960),void 0===i&&(i=.2*n),void 0===o&&(o=.2*i),void 0===Ih&&((Ih=new Ci).setAttribute("position",new vi([0,0,0,0,1,0],3)),(Nh=new Al(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(e),this.line=new ic(Ih,new Js({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new $i(Nh,new si({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,i,o)}function jh(t){var e=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=new Ci;n.setAttribute("position",new vi(e,3)),n.setAttribute("color",new vi([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var r=new Js({vertexColors:S});sc.call(this,n,r)}zh.prototype=Object.create(lr.prototype),zh.prototype.constructor=zh,zh.prototype.setDirection=function(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{Dh.set(t.z,0,-t.x).normalize();var e=Math.acos(t.y);this.quaternion.setFromAxisAngle(Dh,e)}},zh.prototype.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,Math.max(1e-4,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},zh.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},zh.prototype.copy=function(t){return lr.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},zh.prototype.clone=function(){return(new this.constructor).copy(this)},jh.prototype=Object.create(sc.prototype),jh.prototype.constructor=jh;var Fh,Bh,Uh,Hh,Vh=Math.pow(2,8),Gh=[.125,.215,.35,.446,.526,.582],Wh=5+Gh.length,$h={[ze]:0,[je]:1,[Be]:2,[He]:3,[Ve]:4,[Ge]:5,[Fe]:6},qh=new qu,Xh=(Fh=20,Bh=new Float32Array(Fh),Uh=new zn(0,1,0),(Hh=new Il({defines:{n:Fh},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:Bh},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:Uh},inputEncoding:{value:$h[ze]},outputEncoding:{value:$h[ze]}},vertexShader:yf(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform int samples;\nuniform float weights[n];\nuniform bool latitudinal;\nuniform float dTheta;\nuniform float mipInt;\nuniform vec3 poleAxis;\n\n${bf()}\n\n#define ENVMAP_TYPE_CUBE_UV\n#include <cube_uv_reflection_fragment>\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tfor (int i = 0; i < n; i++) {\n\t\tif (i >= samples)\n\t\t\tbreak;\n\t\tfor (int dir = -1; dir < 2; dir += 2) {\n\t\t\tif (i == 0 && dir == 1)\n\t\t\t\tcontinue;\n\t\t\tvec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);\n\t\t\tif (all(equal(axis, vec3(0.0))))\n\t\t\t\taxis = cross(vec3(0.0, 1.0, 0.0), vOutputDirection);\n\t\t\taxis = normalize(axis);\n\t\t\tfloat theta = dTheta * float(dir * i);\n\t\t\tfloat cosTheta = cos(theta);\n\t\t\t// Rodrigues' axis-angle rotation\n\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross(axis, vOutputDirection) * sin(theta)\n\t\t\t\t\t+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);\n\t\t\tgl_FragColor.rgb +=\n\t\t\t\t\tweights[i] * bilinearCubeUV(envMap, sampleDirection, mipInt);\n\t\t}\n\t}\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:M,depthTest:!1,depthWrite:!1})).type="SphericalGaussianBlur",Hh),Yh=null,Kh=null,{_lodPlanes:Zh,_sizeLods:Jh,_sigmas:Qh}=function(){for(var t=[],e=[],n=[],r=8,i=0;i<Wh;i++){var o=Math.pow(2,r);e.push(o);var a=1/o;i>4?a=Gh[i-8+4-1]:0==i&&(a=0),n.push(a);for(var s=1/(o-1),c=-s/2,l=1+s/2,u=[c,c,l,c,l,l,c,c,l,l,c,l],d=new Float32Array(108),h=new Float32Array(72),f=new Float32Array(36),p=0;p<6;p++){var m=p%3*2/3-1,g=p>2?0:-1,v=[m,g,0,m+2/3,g,0,m+2/3,g+1,0,m,g,0,m+2/3,g+1,0,m,g+1,0];d.set(v,18*p),h.set(u,12*p);var y=[p,p,p,p,p,p];f.set(y,6*p)}var b=new Ci;b.setAttribute("position",new li(d,3)),b.setAttribute("uv",new li(h,2)),b.setAttribute("faceIndex",new li(f,1)),t.push(b),r>4&&r--}return{_lodPlanes:t,_sizeLods:e,_sigmas:n}}(),tf=null,ef=null,nf=null,rf=(1+Math.sqrt(5))/2,of=1/rf,af=[new zn(1,1,1),new zn(-1,1,1),new zn(1,1,-1),new zn(-1,1,-1),new zn(0,rf,of),new zn(0,rf,-of),new zn(of,0,rf),new zn(-of,0,rf),new zn(rf,of,0),new zn(-rf,of,0)];function sf(t){ef=t,uf(Xh)}function cf(t){var e={magFilter:xt,minFilter:xt,generateMipmaps:!1,type:t?t.type:Ot,format:t?t.format:qt,encoding:t?t.encoding:Be,depthBuffer:!1,stencilBuffer:!1},n=df(e);return n.depthBuffer=!t,tf=df(e),n}function lf(t){tf.dispose(),ef.setRenderTarget(nf),t.scissorTest=!1,t.setSize(t.width,t.height)}function uf(t){var e=new ur;e.add(new $i(Zh[0],t)),ef.compile(e,qh)}function df(t){var e=new Ln(3*Vh,3*Vh,t);return e.texture.mapping=mt,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function hf(t,e,n,r,i){t.viewport.set(e,n,r,i),t.scissor.set(e,n,r,i)}function ff(t){var e=ef.autoClear;ef.autoClear=!1;for(var n=1;n<Wh;n++){pf(t,n-1,n,Math.sqrt(Qh[n]*Qh[n]-Qh[n-1]*Qh[n-1]),af[(n-1)%af.length])}ef.autoClear=e}function pf(t,e,n,r,i){mf(t,tf,e,n,r,"latitudinal",i),mf(tf,t,n,n,r,"longitudinal",i)}function mf(t,e,n,r,i,o,a){"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");var s=new ur;s.add(new $i(Zh[r],Xh));var c=Xh.uniforms,l=Jh[n]-1,u=isFinite(i)?Math.PI/(2*l):2*Math.PI/39,d=i/u,h=isFinite(i)?1+Math.floor(3*d):20;h>20&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${h} samples when the maximum is set to 20`);for(var f=[],p=0,m=0;m<20;++m){var g=m/d,v=Math.exp(-g*g/2);f.push(v),0==m?p+=v:m<h&&(p+=2*v)}for(m=0;m<f.length;m++)f[m]=f[m]/p;c.envMap.value=t.texture,c.samples.value=h,c.weights.value=f,c.latitudinal.value="latitudinal"===o,a&&(c.poleAxis.value=a),c.dTheta.value=u,c.mipInt.value=8-n,c.inputEncoding.value=$h[t.texture.encoding],c.outputEncoding.value=$h[t.texture.encoding];var y=Jh[r];hf(e,g=3*Math.max(0,Vh-2*y),(0===r?0:2*Vh)+2*y*(r>4?r-8+4:0),3*y,2*y),ef.setRenderTarget(e),ef.render(s,qh)}function gf(){var t=new Il({uniforms:{envMap:{value:null},texelSize:{value:new Tn(1,1)},inputEncoding:{value:$h[ze]},outputEncoding:{value:$h[ze]}},vertexShader:yf(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform vec2 texelSize;\n\n${bf()}\n\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tvec3 outputDirection = normalize(vOutputDirection);\n\tvec2 uv;\n\tuv.y = asin(clamp(outputDirection.y, -1.0, 1.0)) * RECIPROCAL_PI + 0.5;\n\tuv.x = atan(outputDirection.z, outputDirection.x) * RECIPROCAL_PI2 + 0.5;\n\tvec2 f = fract(uv / texelSize - 0.5);\n\tuv -= f * texelSize;\n\tvec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x += texelSize.x;\n\tvec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.y += texelSize.y;\n\tvec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x -= texelSize.x;\n\tvec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tvec3 tm = mix(tl, tr, f.x);\n\tvec3 bm = mix(bl, br, f.x);\n\tgl_FragColor.rgb = mix(tm, bm, f.y);\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:M,depthTest:!1,depthWrite:!1});return t.type="EquirectangularToCubeUV",t}function vf(){var t=new Il({uniforms:{envMap:{value:null},inputEncoding:{value:$h[ze]},outputEncoding:{value:$h[ze]}},vertexShader:yf(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform samplerCube envMap;\n\n${bf()}\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:M,depthTest:!1,depthWrite:!1});return t.type="CubemapToCubeUV",t}function yf(){return"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.x *= -1.0;\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.y *= -1.0;\n\t} else if (face == 5.0) {\n\t\tdirection.xz *= -1.0;\n\t}\n\treturn direction;\n}\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t"}function bf(){return"\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t"}function xf(t,e,n,r,i,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new ii(t,e,n,i,o,a)}sf.prototype={constructor:sf,fromScene:function(t,e=0,n=.1,r=100){nf=ef.getRenderTarget();var i=cf();return function(t,e,n,r){var i=new so(90,1,e,n),o=[1,1,1,1,-1,1],a=[1,1,-1,-1,-1,1],s=ef.outputEncoding,c=ef.toneMapping,l=ef.toneMappingExposure,u=ef.getClearColor(),d=ef.getClearAlpha();ef.toneMapping=it,ef.toneMappingExposure=1,ef.outputEncoding=ze,t.scale.z*=-1;var h=t.background;if(h&&h.isColor){h.convertSRGBToLinear();var f=Math.max(h.r,h.g,h.b),p=Math.min(Math.max(Math.ceil(Math.log2(f)),-128),127);h=h.multiplyScalar(Math.pow(2,-p));var m=(p+128)/255;ef.setClearColor(h,m),t.background=null}for(var g=0;g<6;g++){var v=g%3;0==v?(i.up.set(0,o[g],0),i.lookAt(a[g],0,0)):1==v?(i.up.set(0,0,o[g]),i.lookAt(0,a[g],0)):(i.up.set(0,o[g],0),i.lookAt(0,0,a[g])),hf(r,v*Vh,g>2?Vh:0,Vh,Vh),ef.setRenderTarget(r),ef.render(t,i)}ef.toneMapping=c,ef.toneMappingExposure=l,ef.outputEncoding=s,ef.setClearColor(u,d),t.scale.z*=-1}(t,n,r,i),e>0&&pf(i,0,0,e),ff(i),lf(i),i},fromEquirectangular:function(t){return t.magFilter=xt,t.minFilter=xt,t.generateMipmaps=!1,this.fromCubemap(t)},fromCubemap:function(t){nf=ef.getRenderTarget();var e=cf(t);return function(t,e){var n=new ur;t.isCubeTexture?null==Kh&&(Kh=vf()):null==Yh&&(Yh=gf());var r=t.isCubeTexture?Kh:Yh;n.add(new $i(Zh[0],r));var i=r.uniforms;i.envMap.value=t,t.isCubeTexture||i.texelSize.value.set(1/t.image.width,1/t.image.height);i.inputEncoding.value=$h[t.encoding],i.outputEncoding.value=$h[t.encoding],hf(e,0,0,3*Vh,2*Vh),ef.setRenderTarget(e),ef.render(n,qh)}(t,e),ff(e),lf(e),e},compileCubemapShader:function(){null==Kh&&uf(Kh=vf())},compileEquirectangularShader:function(){null==Yh&&uf(Yh=gf())},dispose:function(){Xh.dispose(),null!=Kh&&Kh.dispose(),null!=Yh&&Yh.dispose();for(var t=0;t<Zh.length;t++)Zh[t].dispose()}};var _f=0,wf=1;function Sf(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t}function Mf(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,t.materials=t,t.clone=function(){return t.slice()},t}function Ef(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new pc(t,e)}function Tf(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new zs(t)}function Af(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new pc(t,e)}function Cf(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new lc(t)}function Pf(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new lc(t)}function Of(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new lc(t)}function kf(t,e,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new zn(t,e,n)}function Lf(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new li(t,e).setUsage(fn)}function Rf(t,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new ui(t,e)}function If(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new di(t,e)}function Nf(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new hi(t,e)}function Df(t,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new fi(t,e)}function zf(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new pi(t,e)}function jf(t,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new mi(t,e)}function Ff(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new gi(t,e)}function Bf(t,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new vi(t,e)}function Uf(t,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new yi(t,e)}function Hf(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Eu.call(this,t),this.type="catmullrom",this.closed=!0}function Vf(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Eu.call(this,t),this.type="catmullrom"}function Gf(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Eu.call(this,t),this.type="catmullrom"}function Wf(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new jh(t)}function $f(t,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new kh(t,e)}function qf(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new sc(new El(t.geometry),new Js({color:void 0!==e?e:16777215}))}function Xf(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new sc(new xc(t.geometry),new Js({color:void 0!==e?e:16777215}))}function Yf(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new uu(t)}function Kf(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new fu(t)}function Zf(t,e,n){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new lo(t,n)}vu.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(vu.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Object.assign(zu.prototype,{createPointsGeometry:function(t){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getPoints(t);return this.createGeometry(e)},createSpacedPointsGeometry:function(t){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getSpacedPoints(t);return this.createGeometry(e)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var e=new Qi,n=0,r=t.length;n<r;n++){var i=t[n];e.vertices.push(new zn(i.x,i.y,i.z||0))}return e}}),Object.assign(ju.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),Hf.prototype=Object.create(Eu.prototype),Vf.prototype=Object.create(Eu.prototype),Gf.prototype=Object.create(Eu.prototype),Object.assign(Gf.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),xh.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},ph.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(cu.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Qu.extractUrlBase(t)}}),cu.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(id.prototype,{setTexturePath:function(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}),Object.assign(ih.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(Mr.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),po.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},sh.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(En,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),En.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),En.ceilPowerOfTwo(t)}}),Object.assign(An.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Wn.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new zn).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,n,r,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,r,n,i,o)}}),Fr.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},In.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(Nr.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(Kr.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(Kr,{barycoordFromPoint:function(t,e,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Kr.getBarycoord(t,e,n,r,i)},normal:function(t,e,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Kr.getNormal(t,e,n,r)}}),Object.assign(Fu.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new ul(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new wl(this,t)}}),Object.assign(Tn.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(zn.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(kn.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Qi.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.assign(lr.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(lr.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign($i.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties($i.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Ie},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(Us.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Ws.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Hs.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(vu.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),so.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(Bu.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(li.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===fn},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(fn)}}}),Object.assign(li.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?fn:hn),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Ci.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(t,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new li(arguments[1],arguments[2])))},addDrawCall:function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(Ci.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(xs.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===fn},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),Object.assign(xs.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?fn:hn),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(dl.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(Kd.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(ai.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new ti}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===b}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Object.defineProperties(zl.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(oo.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(vs.prototype,{clearTarget:function(t,e,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,n,r)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(vs.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?je:ze}}}),Object.defineProperties(cs.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Ln.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(Pd.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this;return(new md).load(t,(function(t){e.setBuffer(t)})),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),Nd.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},co.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)};var Jf={merge:function(t,e,n){var r;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),r=e.matrix,e=e.geometry),t.merge(e,r,n)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}};function Qf(){console.error("THREE.CanvasRenderer has been removed")}function tp(){console.error("THREE.JSONLoader has been removed.")}Cn.crossOrigin=void 0,Cn.loadTexture=function(t,e,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new gu;i.setCrossOrigin(this.crossOrigin);var o=i.load(t,n,void 0,r);return e&&(o.mapping=e),o},Cn.loadTextureCube=function(t,e,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new mu;i.setCrossOrigin(this.crossOrigin);var o=i.load(t,n,void 0,r);return e&&(o.mapping=e),o},Cn.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Cn.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var ep={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}};function np(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:r}}))},function(t,e,n){"use strict";n.r(e),n.d(e,"DefaultTemplateProcessor",(function(){return i})),n.d(e,"defaultTemplateProcessor",(function(){return o})),n.d(e,"directive",(function(){return s.a})),n.d(e,"isDirective",(function(){return s.b})),n.d(e,"removeNodes",(function(){return c.b})),n.d(e,"reparentNodes",(function(){return c.c})),n.d(e,"noChange",(function(){return l.a})),n.d(e,"nothing",(function(){return l.b})),n.d(e,"AttributeCommitter",(function(){return r.a})),n.d(e,"AttributePart",(function(){return r.b})),n.d(e,"BooleanAttributePart",(function(){return r.c})),n.d(e,"EventPart",(function(){return r.d})),n.d(e,"isIterable",(function(){return r.h})),n.d(e,"isPrimitive",(function(){return r.i})),n.d(e,"NodePart",(function(){return r.e})),n.d(e,"PropertyCommitter",(function(){return r.f})),n.d(e,"PropertyPart",(function(){return r.g})),n.d(e,"parts",(function(){return u.a})),n.d(e,"render",(function(){return u.b})),n.d(e,"templateCaches",(function(){return d.a})),n.d(e,"templateFactory",(function(){return d.b})),n.d(e,"TemplateInstance",(function(){return h.a})),n.d(e,"SVGTemplateResult",(function(){return a.a})),n.d(e,"TemplateResult",(function(){return a.b})),n.d(e,"createMarker",(function(){return f.c})),n.d(e,"isTemplatePartActive",(function(){return f.d})),n.d(e,"Template",(function(){return f.a})),n.d(e,"html",(function(){return p})),n.d(e,"svg",(function(){return m}));var r=n(12);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */class i{handleAttributeExpressions(t,e,n,i){const o=e[0];if("."===o){return new r.f(t,e.slice(1),n).parts}if("@"===o)return[new r.d(t,e.slice(1),i.eventContext)];if("?"===o)return[new r.c(t,e.slice(1),n)];return new r.a(t,e,n).parts}handleTextExpression(t){return new r.e(t)}}const o=new i;var a=n(28),s=n(27),c=n(16),l=n(14),u=n(26),d=n(25),h=n(30),f=n(6);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.2.1");const p=(t,...e)=>new a.b(t,e,"html",o),m=(t,...e)=>new a.a(t,e,"svg",o)},function(t,e,n){"use strict";n.r(e),function(t,r){n.d(e,"$mobx",(function(){return w})),n.d(e,"FlowCancellationError",(function(){return Te})),n.d(e,"IDerivationState",(function(){return Q})),n.d(e,"ObservableMap",(function(){return _n})),n.d(e,"ObservableSet",(function(){return Mn})),n.d(e,"Reaction",(function(){return Xt})),n.d(e,"_allowStateChanges",(function(){return Mt})),n.d(e,"_allowStateChangesInsideComputed",(function(){return At})),n.d(e,"_allowStateReadsEnd",(function(){return mt})),n.d(e,"_allowStateReadsStart",(function(){return pt})),n.d(e,"_endAction",(function(){return St})),n.d(e,"_getAdministration",(function(){return In})),n.d(e,"_getGlobalState",(function(){return Ft})),n.d(e,"_interceptReads",(function(){return Oe})),n.d(e,"_isComputingDerivation",(function(){return st})),n.d(e,"_resetGlobalState",(function(){return Bt})),n.d(e,"_startAction",(function(){return wt})),n.d(e,"action",(function(){return oe})),n.d(e,"autorun",(function(){return le})),n.d(e,"comparer",(function(){return T})),n.d(e,"computed",(function(){return rt})),n.d(e,"configure",(function(){return ge})),n.d(e,"createAtom",(function(){return E})),n.d(e,"decorate",(function(){return ve})),n.d(e,"entries",(function(){return Be})),n.d(e,"extendObservable",(function(){return ye})),n.d(e,"flow",(function(){return Ce})),n.d(e,"get",(function(){return Ge})),n.d(e,"getAtom",(function(){return Rn})),n.d(e,"getDebugName",(function(){return Nn})),n.d(e,"getDependencyTree",(function(){return _e})),n.d(e,"getObserverTree",(function(){return Se})),n.d(e,"has",(function(){return Ve})),n.d(e,"intercept",(function(){return ke})),n.d(e,"isAction",(function(){return se})),n.d(e,"isArrayLike",(function(){return m})),n.d(e,"isBoxedObservable",(function(){return Pt})),n.d(e,"isComputed",(function(){return Re})),n.d(e,"isComputedProp",(function(){return Ie})),n.d(e,"isFlowCancellationError",(function(){return Ae})),n.d(e,"isObservable",(function(){return De})),n.d(e,"isObservableArray",(function(){return yn})),n.d(e,"isObservableMap",(function(){return wn})),n.d(e,"isObservableObject",(function(){return Ln})),n.d(e,"isObservableProp",(function(){return ze})),n.d(e,"isObservableSet",(function(){return En})),n.d(e,"keys",(function(){return je})),n.d(e,"observable",(function(){return Z})),n.d(e,"observe",(function(){return We})),n.d(e,"onBecomeObserved",(function(){return fe})),n.d(e,"onBecomeUnobserved",(function(){return pe})),n.d(e,"onReactionError",(function(){return Yt})),n.d(e,"reaction",(function(){return he})),n.d(e,"remove",(function(){return He})),n.d(e,"runInAction",(function(){return ae})),n.d(e,"set",(function(){return Ue})),n.d(e,"spy",(function(){return ee})),n.d(e,"toJS",(function(){return Xe})),n.d(e,"trace",(function(){return Ye})),n.d(e,"transaction",(function(){return Ze})),n.d(e,"untracked",(function(){return dt})),n.d(e,"values",(function(){return Fe})),n.d(e,"when",(function(){return Je}));var i=[];Object.freeze(i);var o={};function a(){return++jt.mobxGuid}function s(t){throw c(!1,t),"X"}function c(t,e){if(!t)throw new Error("[mobx] "+(e||"An invariant failed, however the error is obfuscated because this is a production build."))}Object.freeze(o);function l(t){var e=!1;return function(){if(!e)return e=!0,t.apply(this,arguments)}}var u=function(){};function d(t){return null!==t&&"object"==typeof t}function h(t){if(null===t||"object"!=typeof t)return!1;var e=Object.getPrototypeOf(t);return e===Object.prototype||null===e}function f(t,e,n){Object.defineProperty(t,e,{enumerable:!1,writable:!0,configurable:!0,value:n})}function p(t,e){var n="isMobX"+t;return e.prototype[n]=!0,function(t){return d(t)&&!0===t[n]}}function m(t){return Array.isArray(t)||yn(t)}function g(t){return t instanceof Map}function v(t){return t instanceof Set}function y(t){var e=new Set;for(var n in t)e.add(n);return Object.getOwnPropertySymbols(t).forEach((function(n){Object.getOwnPropertyDescriptor(t,n).enumerable&&e.add(n)})),Array.from(e)}function b(t){return t&&t.toString?t.toString():new String(t).toString()}function x(t){return null===t?null:"object"==typeof t?""+t:t}var _="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames,w=Symbol("mobx administration"),S=function(){function t(t){void 0===t&&(t="Atom@"+a()),this.name=t,this.isPendingUnobservation=!1,this.isBeingObserved=!1,this.observers=new Set,this.diffValue=0,this.lastAccessedBy=0,this.lowestObserverState=Q.NOT_TRACKING}return t.prototype.onBecomeObserved=function(){this.onBecomeObservedListeners&&this.onBecomeObservedListeners.forEach((function(t){return t()}))},t.prototype.onBecomeUnobserved=function(){this.onBecomeUnobservedListeners&&this.onBecomeUnobservedListeners.forEach((function(t){return t()}))},t.prototype.reportObserved=function(){return $t(this)},t.prototype.reportChanged=function(){Gt(),function(t){if(t.lowestObserverState===Q.STALE)return;t.lowestObserverState=Q.STALE,t.observers.forEach((function(e){e.dependenciesState===Q.UP_TO_DATE&&(e.isTracing!==tt.NONE&&qt(e,t),e.onBecomeStale()),e.dependenciesState=Q.STALE}))}(this),Wt()},t.prototype.toString=function(){return this.name},t}(),M=p("Atom",S);function E(t,e,n){void 0===e&&(e=u),void 0===n&&(n=u);var r=new S(t);return e!==u&&fe(r,e),n!==u&&pe(r,n),r}var T={identity:function(t,e){return t===e},structural:function(t,e){return zn(t,e)},default:function(t,e){return Object.is(t,e)},shallow:function(t,e){return zn(t,e,1)}},A=function(t,e){return(A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var C=function(){return(C=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function P(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function O(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function k(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(O(arguments[e]));return t}var L=Symbol("mobx did run lazy initializers"),R=Symbol("mobx pending decorators"),I={},N={};function D(t,e){var n=e?I:N;return n[t]||(n[t]={configurable:!0,enumerable:e,get:function(){return z(this),this[t]},set:function(e){z(this),this[t]=e}})}function z(t){var e,n;if(!0!==t[L]){var r=t[R];if(r){f(t,L,!0);var i=k(Object.getOwnPropertySymbols(r),Object.keys(r));try{for(var o=P(i),a=o.next();!a.done;a=o.next()){var s=r[a.value];s.propertyCreator(t,s.prop,s.descriptor,s.decoratorTarget,s.decoratorArguments)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}}}}function j(t,e){return function(){var n,r=function(r,i,o,a){if(!0===a)return e(r,i,o,r,n),null;if(!Object.prototype.hasOwnProperty.call(r,R)){var s=r[R];f(r,R,C({},s))}return r[R][i]={prop:i,propertyCreator:e,descriptor:o,decoratorTarget:r,decoratorArguments:n},D(i,t)};return F(arguments)?(n=i,r.apply(null,arguments)):(n=Array.prototype.slice.call(arguments),r)}}function F(t){return(2===t.length||3===t.length)&&("string"==typeof t[1]||"symbol"==typeof t[1])||4===t.length&&!0===t[3]}function B(t,e,n){return De(t)?t:Array.isArray(t)?Z.array(t,{name:n}):h(t)?Z.object(t,void 0,{name:n}):g(t)?Z.map(t,{name:n}):v(t)?Z.set(t,{name:n}):t}function U(t){return t}function H(e){c(e);var n=j(!0,(function(t,n,r,i,o){var a=r?r.initializer?r.initializer.call(t):r.value:void 0;An(t).addObservableProp(n,a,e)})),r=(void 0!==t&&t.env,n);return r.enhancer=e,r}var V={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};function G(t){return null==t?V:"string"==typeof t?{name:t,deep:!0,proxy:!0}:t}Object.freeze(V);var W=H(B),$=H((function(t,e,n){return null==t||Ln(t)||yn(t)||wn(t)||En(t)?t:Array.isArray(t)?Z.array(t,{name:n,deep:!1}):h(t)?Z.object(t,void 0,{name:n,deep:!1}):g(t)?Z.map(t,{name:n,deep:!1}):v(t)?Z.set(t,{name:n,deep:!1}):s(!1)})),q=H(U),X=H((function(t,e,n){return zn(t,e)?e:t}));function Y(t){return t.defaultDecorator?t.defaultDecorator.enhancer:!1===t.deep?U:B}var K={box:function(t,e){arguments.length>2&&J("box");var n=G(e);return new Ct(t,Y(n),n.name,!0,n.equals)},array:function(t,e){arguments.length>2&&J("array");var n=G(e);return fn(t,Y(n),n.name)},map:function(t,e){arguments.length>2&&J("map");var n=G(e);return new _n(t,Y(n),n.name)},set:function(t,e){arguments.length>2&&J("set");var n=G(e);return new Mn(t,Y(n),n.name)},object:function(t,e,n){"string"==typeof arguments[1]&&J("object");var r=G(n);if(!1===r.proxy)return ye({},t,e,r);var i=be(r),o=ye({},void 0,void 0,r),a=on(o);return xe(a,t,e,i),a},ref:q,shallow:$,deep:W,struct:X},Z=function(t,e,n){if("string"==typeof arguments[1]||"symbol"==typeof arguments[1])return W.apply(null,arguments);if(De(t))return t;var r=h(t)?Z.object(t,e,n):Array.isArray(t)?Z.array(t,e):g(t)?Z.map(t,e):v(t)?Z.set(t,e):t;if(r!==t)return r;s(!1)};function J(t){s("Expected one or two arguments to observable."+t+". Did you accidentally try to use observable."+t+" as decorator?")}Object.keys(K).forEach((function(t){return Z[t]=K[t]}));var Q,tt,et=j(!1,(function(t,e,n,r,i){var o=n.get,a=n.set,s=i[0]||{};An(t).addComputedProp(t,e,C({get:o,set:a,context:t},s))})),nt=et({equals:T.structural}),rt=function(t,e,n){if("string"==typeof e)return et.apply(null,arguments);if(null!==t&&"object"==typeof t&&1===arguments.length)return et.apply(null,arguments);var r="object"==typeof e?e:{};return r.get=t,r.set="function"==typeof e?e:r.set,r.name=r.name||t.name||"",new Ot(r)};rt.struct=nt,function(t){t[t.NOT_TRACKING=-1]="NOT_TRACKING",t[t.UP_TO_DATE=0]="UP_TO_DATE",t[t.POSSIBLY_STALE=1]="POSSIBLY_STALE",t[t.STALE=2]="STALE"}(Q||(Q={})),function(t){t[t.NONE=0]="NONE",t[t.LOG=1]="LOG",t[t.BREAK=2]="BREAK"}(tt||(tt={}));var it=function(t){this.cause=t};function ot(t){return t instanceof it}function at(t){switch(t.dependenciesState){case Q.UP_TO_DATE:return!1;case Q.NOT_TRACKING:case Q.STALE:return!0;case Q.POSSIBLY_STALE:for(var e=pt(!0),n=ht(),r=t.observing,i=r.length,o=0;o<i;o++){var a=r[o];if(kt(a)){if(jt.disableErrorBoundaries)a.get();else try{a.get()}catch(t){return ft(n),mt(e),!0}if(t.dependenciesState===Q.STALE)return ft(n),mt(e),!0}}return gt(t),ft(n),mt(e),!1}}function st(){return null!==jt.trackingDerivation}function ct(t){var e=t.observers.size>0;jt.computationDepth>0&&e&&s(!1),jt.allowStateChanges||!e&&"strict"!==jt.enforceActions||s(!1)}function lt(t,e,n){var r=pt(!0);gt(t),t.newObserving=new Array(t.observing.length+100),t.unboundDepsCount=0,t.runId=++jt.runId;var i,o=jt.trackingDerivation;if(jt.trackingDerivation=t,!0===jt.disableErrorBoundaries)i=e.call(n);else try{i=e.call(n)}catch(t){i=new it(t)}return jt.trackingDerivation=o,function(t){for(var e=t.observing,n=t.observing=t.newObserving,r=Q.UP_TO_DATE,i=0,o=t.unboundDepsCount,a=0;a<o;a++){0===(s=n[a]).diffValue&&(s.diffValue=1,i!==a&&(n[i]=s),i++),s.dependenciesState>r&&(r=s.dependenciesState)}n.length=i,t.newObserving=null,o=e.length;for(;o--;){0===(s=e[o]).diffValue&&Ht(s,t),s.diffValue=0}for(;i--;){var s;1===(s=n[i]).diffValue&&(s.diffValue=0,Ut(s,t))}r!==Q.UP_TO_DATE&&(t.dependenciesState=r,t.onBecomeStale())}(t),mt(r),i}function ut(t){var e=t.observing;t.observing=[];for(var n=e.length;n--;)Ht(e[n],t);t.dependenciesState=Q.NOT_TRACKING}function dt(t){var e=ht();try{return t()}finally{ft(e)}}function ht(){var t=jt.trackingDerivation;return jt.trackingDerivation=null,t}function ft(t){jt.trackingDerivation=t}function pt(t){var e=jt.allowStateReads;return jt.allowStateReads=t,e}function mt(t){jt.allowStateReads=t}function gt(t){if(t.dependenciesState!==Q.UP_TO_DATE){t.dependenciesState=Q.UP_TO_DATE;for(var e=t.observing,n=e.length;n--;)e[n].lowestObserverState=Q.UP_TO_DATE}}var vt=0,yt=1,bt=Object.getOwnPropertyDescriptor((function(){}),"name");bt&&bt.configurable;function xt(t,e,n){var r=function(){return _t(t,e,n||this,arguments)};return r.isMobxAction=!0,r}function _t(t,e,n,r){var i=wt(t,n,r);try{return e.apply(n,r)}catch(t){throw i.error=t,t}finally{St(i)}}function wt(t,e,n){var r=0,i=ht();Gt();var o={prevDerivation:i,prevAllowStateChanges:Et(!0),prevAllowStateReads:pt(!0),notifySpy:!1,startTime:r,actionId:yt++,parentActionId:vt};return vt=o.actionId,o}function St(t){vt!==t.actionId&&s("invalid action stack. did you forget to finish an action?"),vt=t.parentActionId,void 0!==t.error&&(jt.suppressReactionErrors=!0),Tt(t.prevAllowStateChanges),mt(t.prevAllowStateReads),Wt(),ft(t.prevDerivation),t.notifySpy,jt.suppressReactionErrors=!1}function Mt(t,e){var n,r=Et(t);try{n=e()}finally{Tt(r)}return n}function Et(t){var e=jt.allowStateChanges;return jt.allowStateChanges=t,e}function Tt(t){jt.allowStateChanges=t}function At(t){var e,n=jt.computationDepth;jt.computationDepth=0;try{e=t()}finally{jt.computationDepth=n}return e}var Ct=function(t){function e(e,n,r,i,o){void 0===r&&(r="ObservableValue@"+a()),void 0===i&&(i=!0),void 0===o&&(o=T.default);var s=t.call(this,r)||this;return s.enhancer=n,s.name=r,s.equals=o,s.hasUnreportedChange=!1,s.value=n(e,void 0,r),s}return function(t,e){function n(){this.constructor=t}A(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.dehanceValue=function(t){return void 0!==this.dehancer?this.dehancer(t):t},e.prototype.set=function(t){this.value;if((t=this.prepareNewValue(t))!==jt.UNCHANGED){0,this.setNewValue(t)}},e.prototype.prepareNewValue=function(t){if(ct(this),an(this)){var e=cn(this,{object:this,type:"update",newValue:t});if(!e)return jt.UNCHANGED;t=e.newValue}return t=this.enhancer(t,this.value,this.name),this.equals(this.value,t)?jt.UNCHANGED:t},e.prototype.setNewValue=function(t){var e=this.value;this.value=t,this.reportChanged(),ln(this)&&dn(this,{type:"update",object:this,newValue:t,oldValue:e})},e.prototype.get=function(){return this.reportObserved(),this.dehanceValue(this.value)},e.prototype.intercept=function(t){return sn(this,t)},e.prototype.observe=function(t,e){return e&&t({object:this,type:"update",newValue:this.value,oldValue:void 0}),un(this,t)},e.prototype.toJSON=function(){return this.get()},e.prototype.toString=function(){return this.name+"["+this.value+"]"},e.prototype.valueOf=function(){return x(this.get())},e.prototype[Symbol.toPrimitive]=function(){return this.valueOf()},e}(S),Pt=p("ObservableValue",Ct),Ot=function(){function t(t){this.dependenciesState=Q.NOT_TRACKING,this.observing=[],this.newObserving=null,this.isBeingObserved=!1,this.isPendingUnobservation=!1,this.observers=new Set,this.diffValue=0,this.runId=0,this.lastAccessedBy=0,this.lowestObserverState=Q.UP_TO_DATE,this.unboundDepsCount=0,this.__mapid="#"+a(),this.value=new it(null),this.isComputing=!1,this.isRunningSetter=!1,this.isTracing=tt.NONE,c(t.get,"missing option for computed: get"),this.derivation=t.get,this.name=t.name||"ComputedValue@"+a(),t.set&&(this.setter=xt(this.name+"-setter",t.set)),this.equals=t.equals||(t.compareStructural||t.struct?T.structural:T.default),this.scope=t.context,this.requiresReaction=!!t.requiresReaction,this.keepAlive=!!t.keepAlive}return t.prototype.onBecomeStale=function(){!function(t){if(t.lowestObserverState!==Q.UP_TO_DATE)return;t.lowestObserverState=Q.POSSIBLY_STALE,t.observers.forEach((function(e){e.dependenciesState===Q.UP_TO_DATE&&(e.dependenciesState=Q.POSSIBLY_STALE,e.isTracing!==tt.NONE&&qt(e,t),e.onBecomeStale())}))}(this)},t.prototype.onBecomeObserved=function(){this.onBecomeObservedListeners&&this.onBecomeObservedListeners.forEach((function(t){return t()}))},t.prototype.onBecomeUnobserved=function(){this.onBecomeUnobservedListeners&&this.onBecomeUnobservedListeners.forEach((function(t){return t()}))},t.prototype.get=function(){this.isComputing&&s("Cycle detected in computation "+this.name+": "+this.derivation),0!==jt.inBatch||0!==this.observers.size||this.keepAlive?($t(this),at(this)&&this.trackAndCompute()&&function(t){if(t.lowestObserverState===Q.STALE)return;t.lowestObserverState=Q.STALE,t.observers.forEach((function(e){e.dependenciesState===Q.POSSIBLY_STALE?e.dependenciesState=Q.STALE:e.dependenciesState===Q.UP_TO_DATE&&(t.lowestObserverState=Q.UP_TO_DATE)}))}(this)):at(this)&&(this.warnAboutUntrackedRead(),Gt(),this.value=this.computeValue(!1),Wt());var t=this.value;if(ot(t))throw t.cause;return t},t.prototype.peek=function(){var t=this.computeValue(!1);if(ot(t))throw t.cause;return t},t.prototype.set=function(t){if(this.setter){c(!this.isRunningSetter,"The setter of computed value '"+this.name+"' is trying to update itself. Did you intend to update an _observable_ value, instead of the computed property?"),this.isRunningSetter=!0;try{this.setter.call(this.scope,t)}finally{this.isRunningSetter=!1}}else c(!1,!1)},t.prototype.trackAndCompute=function(){var t=this.value,e=this.dependenciesState===Q.NOT_TRACKING,n=this.computeValue(!0),r=e||ot(t)||ot(n)||!this.equals(t,n);return r&&(this.value=n),r},t.prototype.computeValue=function(t){var e;if(this.isComputing=!0,jt.computationDepth++,t)e=lt(this,this.derivation,this.scope);else if(!0===jt.disableErrorBoundaries)e=this.derivation.call(this.scope);else try{e=this.derivation.call(this.scope)}catch(t){e=new it(t)}return jt.computationDepth--,this.isComputing=!1,e},t.prototype.suspend=function(){this.keepAlive||(ut(this),this.value=void 0)},t.prototype.observe=function(t,e){var n=this,r=!0,i=void 0;return le((function(){var o=n.get();if(!r||e){var a=ht();t({type:"update",object:n,newValue:o,oldValue:i}),ft(a)}r=!1,i=o}))},t.prototype.warnAboutUntrackedRead=function(){},t.prototype.toJSON=function(){return this.get()},t.prototype.toString=function(){return this.name+"["+this.derivation.toString()+"]"},t.prototype.valueOf=function(){return x(this.get())},t.prototype[Symbol.toPrimitive]=function(){return this.valueOf()},t}(),kt=p("ComputedValue",Ot),Lt=["mobxGuid","spyListeners","enforceActions","computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","allowStateReads","disableErrorBoundaries","runId","UNCHANGED"],Rt=function(){this.version=5,this.UNCHANGED={},this.trackingDerivation=null,this.computationDepth=0,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!0,this.allowStateReads=!0,this.enforceActions=!1,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.computedConfigurable=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1},It={};function Nt(){return"undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:It}var Dt=!0,zt=!1,jt=function(){var t=Nt();return t.__mobxInstanceCount>0&&!t.__mobxGlobals&&(Dt=!1),t.__mobxGlobals&&t.__mobxGlobals.version!==(new Rt).version&&(Dt=!1),Dt?t.__mobxGlobals?(t.__mobxInstanceCount+=1,t.__mobxGlobals.UNCHANGED||(t.__mobxGlobals.UNCHANGED={}),t.__mobxGlobals):(t.__mobxInstanceCount=1,t.__mobxGlobals=new Rt):(setTimeout((function(){zt||s("There are multiple, different versions of MobX active. Make sure MobX is loaded only once or use `configure({ isolateGlobalState: true })`")}),1),new Rt)}();function Ft(){return jt}function Bt(){var t=new Rt;for(var e in t)-1===Lt.indexOf(e)&&(jt[e]=t[e]);jt.allowStateChanges=!jt.enforceActions}function Ut(t,e){t.observers.add(e),t.lowestObserverState>e.dependenciesState&&(t.lowestObserverState=e.dependenciesState)}function Ht(t,e){t.observers.delete(e),0===t.observers.size&&Vt(t)}function Vt(t){!1===t.isPendingUnobservation&&(t.isPendingUnobservation=!0,jt.pendingUnobservations.push(t))}function Gt(){jt.inBatch++}function Wt(){if(0==--jt.inBatch){Zt();for(var t=jt.pendingUnobservations,e=0;e<t.length;e++){var n=t[e];n.isPendingUnobservation=!1,0===n.observers.size&&(n.isBeingObserved&&(n.isBeingObserved=!1,n.onBecomeUnobserved()),n instanceof Ot&&n.suspend())}jt.pendingUnobservations=[]}}function $t(t){var e=jt.trackingDerivation;return null!==e?(e.runId!==t.lastAccessedBy&&(t.lastAccessedBy=e.runId,e.newObserving[e.unboundDepsCount++]=t,t.isBeingObserved||(t.isBeingObserved=!0,t.onBecomeObserved())),!0):(0===t.observers.size&&jt.inBatch>0&&Vt(t),!1)}function qt(t,e){if(console.log("[mobx.trace] '"+t.name+"' is invalidated due to a change in: '"+e.name+"'"),t.isTracing===tt.BREAK){var n=[];!function t(e,n,r){if(n.length>=1e3)return void n.push("(and many more)");n.push(""+new Array(r).join("\t")+e.name),e.dependencies&&e.dependencies.forEach((function(e){return t(e,n,r+1)}))}(_e(t),n,1),new Function("debugger;\n/*\nTracing '"+t.name+"'\n\nYou are entering this break point because derivation '"+t.name+"' is being traced and '"+e.name+"' is now forcing it to update.\nJust follow the stacktrace you should now see in the devtools to see precisely what piece of your code is causing this update\nThe stackframe you are looking for is at least ~6-8 stack-frames up.\n\n"+(t instanceof Ot?t.derivation.toString().replace(/[*]\//g,"/"):"")+"\n\nThe dependencies for this derivation are:\n\n"+n.join("\n")+"\n*/\n    ")()}}var Xt=function(){function t(t,e,n,r){void 0===t&&(t="Reaction@"+a()),void 0===r&&(r=!1),this.name=t,this.onInvalidate=e,this.errorHandler=n,this.requiresObservable=r,this.observing=[],this.newObserving=[],this.dependenciesState=Q.NOT_TRACKING,this.diffValue=0,this.runId=0,this.unboundDepsCount=0,this.__mapid="#"+a(),this.isDisposed=!1,this._isScheduled=!1,this._isTrackPending=!1,this._isRunning=!1,this.isTracing=tt.NONE}return t.prototype.onBecomeStale=function(){this.schedule()},t.prototype.schedule=function(){this._isScheduled||(this._isScheduled=!0,jt.pendingReactions.push(this),Zt())},t.prototype.isScheduled=function(){return this._isScheduled},t.prototype.runReaction=function(){if(!this.isDisposed){if(Gt(),this._isScheduled=!1,at(this)){this._isTrackPending=!0;try{this.onInvalidate(),this._isTrackPending}catch(t){this.reportExceptionInDerivation(t)}}Wt()}},t.prototype.track=function(t){if(!this.isDisposed){Gt();0,this._isRunning=!0;var e=lt(this,t,void 0);this._isRunning=!1,this._isTrackPending=!1,this.isDisposed&&ut(this),ot(e)&&this.reportExceptionInDerivation(e.cause),Wt()}},t.prototype.reportExceptionInDerivation=function(t){var e=this;if(this.errorHandler)this.errorHandler(t,this);else{if(jt.disableErrorBoundaries)throw t;var n="[mobx] Encountered an uncaught exception that was thrown by a reaction or observer component, in: '"+this+"'";jt.suppressReactionErrors?console.warn("[mobx] (error in reaction '"+this.name+"' suppressed, fix error of causing action below)"):console.error(n,t),jt.globalReactionErrorHandlers.forEach((function(n){return n(t,e)}))}},t.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._isRunning||(Gt(),ut(this),Wt()))},t.prototype.getDisposer=function(){var t=this.dispose.bind(this);return t[w]=this,t},t.prototype.toString=function(){return"Reaction["+this.name+"]"},t.prototype.trace=function(t){void 0===t&&(t=!1),Ye(this,t)},t}();function Yt(t){return jt.globalReactionErrorHandlers.push(t),function(){var e=jt.globalReactionErrorHandlers.indexOf(t);e>=0&&jt.globalReactionErrorHandlers.splice(e,1)}}var Kt=function(t){return t()};function Zt(){jt.inBatch>0||jt.isRunningReactions||Kt(Jt)}function Jt(){jt.isRunningReactions=!0;for(var t=jt.pendingReactions,e=0;t.length>0;){100==++e&&(console.error("Reaction doesn't converge to a stable state after 100 iterations. Probably there is a cycle in the reactive function: "+t[0]),t.splice(0));for(var n=t.splice(0),r=0,i=n.length;r<i;r++)n[r].runReaction()}jt.isRunningReactions=!1}var Qt=p("Reaction",Xt);function te(t){var e=Kt;Kt=function(n){return t((function(){return e(n)}))}}function ee(t){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}function ne(){s(!1)}function re(t){return function(e,n,r){if(r){if(r.value)return{value:xt(t,r.value),enumerable:!1,configurable:!0,writable:!0};var i=r.initializer;return{enumerable:!1,configurable:!0,writable:!0,initializer:function(){return xt(t,i.call(this))}}}return ie(t).apply(this,arguments)}}function ie(t){return function(e,n,r){Object.defineProperty(e,n,{configurable:!0,enumerable:!1,get:function(){},set:function(e){f(this,n,oe(t,e))}})}}var oe=function(t,e,n,r){return 1===arguments.length&&"function"==typeof t?xt(t.name||"<unnamed action>",t):2===arguments.length&&"function"==typeof e?xt(t,e):1===arguments.length&&"string"==typeof t?re(t):!0!==r?re(e).apply(null,arguments):void f(t,e,xt(t.name||e,n.value,this))};function ae(t,e){return _t("string"==typeof t?t:t.name||"<unnamed action>","function"==typeof t?t:e,this,void 0)}function se(t){return"function"==typeof t&&!0===t.isMobxAction}function ce(t,e,n){f(t,e,xt(e,n.bind(t)))}function le(t,e){void 0===e&&(e=o);var n,r=e&&e.name||t.name||"Autorun@"+a();if(!e.scheduler&&!e.delay)n=new Xt(r,(function(){this.track(c)}),e.onError,e.requiresObservable);else{var i=de(e),s=!1;n=new Xt(r,(function(){s||(s=!0,i((function(){s=!1,n.isDisposed||n.track(c)})))}),e.onError,e.requiresObservable)}function c(){t(n)}return n.schedule(),n.getDisposer()}oe.bound=function(t,e,n,r){return!0===r?(ce(t,e,n.value),null):n?{configurable:!0,enumerable:!1,get:function(){return ce(this,e,n.value||n.initializer.call(this)),this[e]},set:ne}:{enumerable:!1,configurable:!0,set:function(t){ce(this,e,t)},get:function(){}}};var ue=function(t){return t()};function de(t){return t.scheduler?t.scheduler:t.delay?function(e){return setTimeout(e,t.delay)}:ue}function he(t,e,n){void 0===n&&(n=o);var r,i,s,c=n.name||"Reaction@"+a(),l=oe(c,n.onError?(r=n.onError,i=e,function(){try{return i.apply(this,arguments)}catch(t){r.call(this,t)}}):e),u=!n.scheduler&&!n.delay,d=de(n),h=!0,f=!1,p=n.compareStructural?T.structural:n.equals||T.default,m=new Xt(c,(function(){h||u?g():f||(f=!0,d(g))}),n.onError,n.requiresObservable);function g(){if(f=!1,!m.isDisposed){var e=!1;m.track((function(){var n=t(m);e=h||!p(s,n),s=n})),h&&n.fireImmediately&&l(s,m),h||!0!==e||l(s,m),h&&(h=!1)}}return m.schedule(),m.getDisposer()}function fe(t,e,n){return me("onBecomeObserved",t,e,n)}function pe(t,e,n){return me("onBecomeUnobserved",t,e,n)}function me(t,e,n,r){var i="function"==typeof r?Rn(e,n):Rn(e),o="function"==typeof r?r:n,a=t+"Listeners";return i[a]?i[a].add(o):i[a]=new Set([o]),"function"!=typeof i[t]?s(!1):function(){var t=i[a];t&&(t.delete(o),0===t.size&&delete i[a])}}function ge(t){var e=t.enforceActions,n=t.computedRequiresReaction,r=t.computedConfigurable,i=t.disableErrorBoundaries,o=t.reactionScheduler,a=t.reactionRequiresObservable,c=t.observableRequiresReaction;if(!0===t.isolateGlobalState&&((jt.pendingReactions.length||jt.inBatch||jt.isRunningReactions)&&s("isolateGlobalState should be called before MobX is running any reactions"),zt=!0,Dt&&(0==--Nt().__mobxInstanceCount&&(Nt().__mobxGlobals=void 0),jt=new Rt)),void 0!==e){var l=void 0;switch(e){case!0:case"observed":l=!0;break;case!1:case"never":l=!1;break;case"strict":case"always":l="strict";break;default:s("Invalid value for 'enforceActions': '"+e+"', expected 'never', 'always' or 'observed'")}jt.enforceActions=l,jt.allowStateChanges=!0!==l&&"strict"!==l}void 0!==n&&(jt.computedRequiresReaction=!!n),void 0!==a&&(jt.reactionRequiresObservable=!!a),void 0!==c&&(jt.observableRequiresReaction=!!c,jt.allowStateReads=!jt.observableRequiresReaction),void 0!==r&&(jt.computedConfigurable=!!r),void 0!==i&&(!0===i&&console.warn("WARNING: Debug feature only. MobX will NOT recover from errors when `disableErrorBoundaries` is enabled."),jt.disableErrorBoundaries=!!i),o&&te(o)}function ve(t,e){var n="function"==typeof t?t.prototype:t,r=function(t){var r=e[t];Array.isArray(r)||(r=[r]);var i=Object.getOwnPropertyDescriptor(n,t),o=r.reduce((function(e,r){return r(n,t,e)}),i);o&&Object.defineProperty(n,t,o)};for(var i in e)r(i);return t}function ye(t,e,n,r){var i=be(r=G(r));return z(t),An(t,r.name,i.enhancer),e&&xe(t,e,n,i),t}function be(t){return t.defaultDecorator||(!1===t.deep?q:W)}function xe(t,e,n,r){var i,o;Gt();try{var a=_(e);try{for(var s=P(a),c=s.next();!c.done;c=s.next()){var l=c.value,u=Object.getOwnPropertyDescriptor(e,l);0;var d=(n&&l in n?n[l]:u.get?et:r)(t,l,u,!0);d&&Object.defineProperty(t,l,d)}}catch(t){i={error:t}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}}finally{Wt()}}function _e(t,e){return we(Rn(t,e))}function we(t){var e,n,r={name:t.name};return t.observing&&t.observing.length>0&&(r.dependencies=(e=t.observing,n=[],e.forEach((function(t){-1===n.indexOf(t)&&n.push(t)})),n).map(we)),r}function Se(t,e){return Me(Rn(t,e))}function Me(t){var e={name:t.name};return function(t){return t.observers&&t.observers.size>0}(t)&&(e.observers=Array.from(function(t){return t.observers}(t)).map(Me)),e}var Ee=0;function Te(){this.message="FLOW_CANCELLED"}function Ae(t){return t instanceof Te}function Ce(t){1!==arguments.length&&s("Flow expects 1 argument and cannot be used as decorator");var e=t.name||"<unnamed flow>";return function(){var n,r=this,i=arguments,o=++Ee,a=oe(e+" - runid: "+o+" - init",t).apply(r,i),s=void 0,c=new Promise((function(t,r){var i=0;function c(t){var n;s=void 0;try{n=oe(e+" - runid: "+o+" - yield "+i++,a.next).call(a,t)}catch(t){return r(t)}u(n)}function l(t){var n;s=void 0;try{n=oe(e+" - runid: "+o+" - yield "+i++,a.throw).call(a,t)}catch(t){return r(t)}u(n)}function u(e){if(!e||"function"!=typeof e.then)return e.done?t(e.value):(s=Promise.resolve(e.value)).then(c,l);e.then(u,r)}n=r,c(void 0)}));return c.cancel=oe(e+" - runid: "+o+" - cancel",(function(){try{s&&Pe(s);var t=a.return(void 0),e=Promise.resolve(t.value);e.then(u,u),Pe(e),n(new Te)}catch(t){n(t)}})),c}}function Pe(t){"function"==typeof t.cancel&&t.cancel()}function Oe(t,e,n){var r;if(wn(t)||yn(t)||Pt(t))r=In(t);else{if(!Ln(t))return s(!1);if("string"!=typeof e)return s(!1);r=In(t,e)}return void 0!==r.dehancer?s(!1):(r.dehancer="function"==typeof e?e:n,function(){r.dehancer=void 0})}function ke(t,e,n){return"function"==typeof n?function(t,e,n){return In(t,e).intercept(n)}(t,e,n):function(t,e){return In(t).intercept(e)}(t,e)}function Le(t,e){if(null==t)return!1;if(void 0!==e){if(!1===Ln(t))return!1;if(!t[w].values.has(e))return!1;var n=Rn(t,e);return kt(n)}return kt(t)}function Re(t){return arguments.length>1?s(!1):Le(t)}function Ie(t,e){return"string"!=typeof e?s(!1):Le(t,e)}function Ne(t,e){return null!=t&&(void 0!==e?!!Ln(t)&&t[w].values.has(e):Ln(t)||!!t[w]||M(t)||Qt(t)||kt(t))}function De(t){return 1!==arguments.length&&s(!1),Ne(t)}function ze(t,e){return"string"!=typeof e?s(!1):Ne(t,e)}function je(t){return Ln(t)?t[w].getKeys():wn(t)||En(t)?Array.from(t.keys()):yn(t)?t.map((function(t,e){return e})):s(!1)}function Fe(t){return Ln(t)?je(t).map((function(e){return t[e]})):wn(t)?je(t).map((function(e){return t.get(e)})):En(t)?Array.from(t.values()):yn(t)?t.slice():s(!1)}function Be(t){return Ln(t)?je(t).map((function(e){return[e,t[e]]})):wn(t)?je(t).map((function(e){return[e,t.get(e)]})):En(t)?Array.from(t.entries()):yn(t)?t.map((function(t,e){return[e,t]})):s(!1)}function Ue(t,e,n){if(2!==arguments.length||En(t))if(Ln(t)){var r=t[w],i=r.values.get(e);i?r.write(e,n):r.addObservableProp(e,n,r.defaultEnhancer)}else if(wn(t))t.set(e,n);else if(En(t))t.add(e);else{if(!yn(t))return s(!1);"number"!=typeof e&&(e=parseInt(e,10)),c(e>=0,"Not a valid index: '"+e+"'"),Gt(),e>=t.length&&(t.length=e+1),t[e]=n,Wt()}else{Gt();var o=e;try{for(var a in o)Ue(t,a,o[a])}finally{Wt()}}}function He(t,e){if(Ln(t))t[w].remove(e);else if(wn(t))t.delete(e);else if(En(t))t.delete(e);else{if(!yn(t))return s(!1);"number"!=typeof e&&(e=parseInt(e,10)),c(e>=0,"Not a valid index: '"+e+"'"),t.splice(e,1)}}function Ve(t,e){return Ln(t)?In(t).has(e):wn(t)||En(t)?t.has(e):yn(t)?e>=0&&e<t.length:s(!1)}function Ge(t,e){if(Ve(t,e))return Ln(t)?t[e]:wn(t)?t.get(e):yn(t)?t[e]:s(!1)}function We(t,e,n,r){return"function"==typeof n?function(t,e,n,r){return In(t,e).observe(n,r)}(t,e,n,r):function(t,e,n){return In(t).observe(e,n)}(t,e,n)}Te.prototype=Object.create(Error.prototype);var $e={detectCycles:!0,exportMapsAsObjects:!0,recurseEverything:!1};function qe(t,e,n,r){return r.detectCycles&&t.set(e,n),n}function Xe(t,e){var n;return"boolean"==typeof e&&(e={detectCycles:e}),e||(e=$e),e.detectCycles=void 0===e.detectCycles?!0===e.recurseEverything:!0===e.detectCycles,e.detectCycles&&(n=new Map),function t(e,n,r){if(!n.recurseEverything&&!De(e))return e;if("object"!=typeof e)return e;if(null===e)return null;if(e instanceof Date)return e;if(Pt(e))return t(e.get(),n,r);if(De(e)&&je(e),!0===n.detectCycles&&null!==e&&r.has(e))return r.get(e);if(yn(e)||Array.isArray(e)){var i=qe(r,e,[],n),o=e.map((function(e){return t(e,n,r)}));i.length=o.length;for(var a=0,s=o.length;a<s;a++)i[a]=o[a];return i}if(En(e)||Object.getPrototypeOf(e)===Set.prototype){if(!1===n.exportMapsAsObjects){var c=qe(r,e,new Set,n);return e.forEach((function(e){c.add(t(e,n,r))})),c}var l=qe(r,e,[],n);return e.forEach((function(e){l.push(t(e,n,r))})),l}if(wn(e)||Object.getPrototypeOf(e)===Map.prototype){if(!1===n.exportMapsAsObjects){var u=qe(r,e,new Map,n);return e.forEach((function(e,i){u.set(i,t(e,n,r))})),u}var d=qe(r,e,{},n);return e.forEach((function(e,i){d[i]=t(e,n,r)})),d}var h=qe(r,e,{},n);return y(e).forEach((function(i){h[i]=t(e[i],n,r)})),h}(t,e,n)}function Ye(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=!1;"boolean"==typeof t[t.length-1]&&(n=t.pop());var r=Ke(t);if(!r)return s(!1);r.isTracing===tt.NONE&&console.log("[mobx.trace] '"+r.name+"' tracing enabled"),r.isTracing=n?tt.BREAK:tt.LOG}function Ke(t){switch(t.length){case 0:return jt.trackingDerivation;case 1:return Rn(t[0]);case 2:return Rn(t[0],t[1])}}function Ze(t,e){void 0===e&&(e=void 0),Gt();try{return t.apply(e)}finally{Wt()}}function Je(t,e,n){return 1===arguments.length||e&&"object"==typeof e?tn(t,e):Qe(t,e,n||{})}function Qe(t,e,n){var r;"number"==typeof n.timeout&&(r=setTimeout((function(){if(!o[w].isDisposed){o();var t=new Error("WHEN_TIMEOUT");if(!n.onError)throw t;n.onError(t)}}),n.timeout)),n.name=n.name||"When@"+a();var i=xt(n.name+"-effect",e),o=le((function(e){t()&&(e.dispose(),r&&clearTimeout(r),i())}),n);return o}function tn(t,e){var n;var r=new Promise((function(r,i){var o=Qe(t,r,C(C({},e),{onError:i}));n=function(){o(),i("WHEN_CANCELLED")}}));return r.cancel=n,r}function en(t){return t[w]}function nn(t){return"string"==typeof t||"number"==typeof t||"symbol"==typeof t}var rn={has:function(t,e){if(e===w||"constructor"===e||e===L)return!0;var n=en(t);return nn(e)?n.has(e):e in t},get:function(t,e){if(e===w||"constructor"===e||e===L)return t[e];var n=en(t),r=n.values.get(e);if(r instanceof S){var i=r.get();return void 0===i&&n.has(e),i}return nn(e)&&n.has(e),t[e]},set:function(t,e,n){return!!nn(e)&&(Ue(t,e,n),!0)},deleteProperty:function(t,e){return!!nn(e)&&(en(t).remove(e),!0)},ownKeys:function(t){return en(t).keysAtom.reportObserved(),Reflect.ownKeys(t)},preventExtensions:function(t){return s("Dynamic observable objects cannot be frozen"),!1}};function on(t){var e=new Proxy(t,rn);return t[w].proxy=e,e}function an(t){return void 0!==t.interceptors&&t.interceptors.length>0}function sn(t,e){var n=t.interceptors||(t.interceptors=[]);return n.push(e),l((function(){var t=n.indexOf(e);-1!==t&&n.splice(t,1)}))}function cn(t,e){var n=ht();try{for(var r=k(t.interceptors||[]),i=0,o=r.length;i<o&&(c(!(e=r[i](e))||e.type,"Intercept handlers should return nothing or a change object"),e);i++);return e}finally{ft(n)}}function ln(t){return void 0!==t.changeListeners&&t.changeListeners.length>0}function un(t,e){var n=t.changeListeners||(t.changeListeners=[]);return n.push(e),l((function(){var t=n.indexOf(e);-1!==t&&n.splice(t,1)}))}function dn(t,e){var n=ht(),r=t.changeListeners;if(r){for(var i=0,o=(r=r.slice()).length;i<o;i++)r[i](e);ft(n)}}var hn={get:function(t,e){return e===w?t[w]:"length"===e?t[w].getArrayLength():"number"==typeof e?mn.get.call(t,e):"string"!=typeof e||isNaN(e)?mn.hasOwnProperty(e)?mn[e]:t[e]:mn.get.call(t,parseInt(e))},set:function(t,e,n){return"length"===e&&t[w].setArrayLength(n),"number"==typeof e&&mn.set.call(t,e,n),"symbol"==typeof e||isNaN(e)?t[e]=n:mn.set.call(t,parseInt(e),n),!0},preventExtensions:function(t){return s("Observable arrays cannot be frozen"),!1}};function fn(t,e,n,r){void 0===n&&(n="ObservableArray@"+a()),void 0===r&&(r=!1);var i,o,s,c=new pn(n,e,r);i=c.values,o=w,s=c,Object.defineProperty(i,o,{enumerable:!1,writable:!1,configurable:!0,value:s});var l=new Proxy(c.values,hn);if(c.proxy=l,t&&t.length){var u=Et(!0);c.spliceWithArray(0,0,t),Tt(u)}return l}var pn=function(){function t(t,e,n){this.owned=n,this.values=[],this.proxy=void 0,this.lastKnownLength=0,this.atom=new S(t||"ObservableArray@"+a()),this.enhancer=function(n,r){return e(n,r,t+"[..]")}}return t.prototype.dehanceValue=function(t){return void 0!==this.dehancer?this.dehancer(t):t},t.prototype.dehanceValues=function(t){return void 0!==this.dehancer&&t.length>0?t.map(this.dehancer):t},t.prototype.intercept=function(t){return sn(this,t)},t.prototype.observe=function(t,e){return void 0===e&&(e=!1),e&&t({object:this.proxy,type:"splice",index:0,added:this.values.slice(),addedCount:this.values.length,removed:[],removedCount:0}),un(this,t)},t.prototype.getArrayLength=function(){return this.atom.reportObserved(),this.values.length},t.prototype.setArrayLength=function(t){if("number"!=typeof t||t<0)throw new Error("[mobx.array] Out of range: "+t);var e=this.values.length;if(t!==e)if(t>e){for(var n=new Array(t-e),r=0;r<t-e;r++)n[r]=void 0;this.spliceWithArray(e,0,n)}else this.spliceWithArray(t,e-t)},t.prototype.updateArrayLength=function(t,e){if(t!==this.lastKnownLength)throw new Error("[mobx] Modification exception: the internal structure of an observable array was changed.");this.lastKnownLength+=e},t.prototype.spliceWithArray=function(t,e,n){var r=this;ct(this.atom);var o=this.values.length;if(void 0===t?t=0:t>o?t=o:t<0&&(t=Math.max(0,o+t)),e=1===arguments.length?o-t:null==e?0:Math.max(0,Math.min(e,o-t)),void 0===n&&(n=i),an(this)){var a=cn(this,{object:this.proxy,type:"splice",index:t,removedCount:e,added:n});if(!a)return i;e=a.removedCount,n=a.added}n=0===n.length?n:n.map((function(t){return r.enhancer(t,void 0)}));var s=this.spliceItemsIntoValues(t,e,n);return 0===e&&0===n.length||this.notifyArraySplice(t,n,s),this.dehanceValues(s)},t.prototype.spliceItemsIntoValues=function(t,e,n){var r;if(n.length<1e4)return(r=this.values).splice.apply(r,k([t,e],n));var i=this.values.slice(t,t+e);return this.values=this.values.slice(0,t).concat(n,this.values.slice(t+e)),i},t.prototype.notifyArrayChildUpdate=function(t,e,n){var r=!this.owned&&!1,i=ln(this),o=i||r?{object:this.proxy,type:"update",index:t,newValue:e,oldValue:n}:null;this.atom.reportChanged(),i&&dn(this,o)},t.prototype.notifyArraySplice=function(t,e,n){var r=!this.owned&&!1,i=ln(this),o=i||r?{object:this.proxy,type:"splice",index:t,removed:n,added:e,removedCount:n.length,addedCount:e.length}:null;this.atom.reportChanged(),i&&dn(this,o)},t}(),mn={intercept:function(t){return this[w].intercept(t)},observe:function(t,e){return void 0===e&&(e=!1),this[w].observe(t,e)},clear:function(){return this.splice(0)},replace:function(t){var e=this[w];return e.spliceWithArray(0,e.values.length,t)},toJS:function(){return this.slice()},toJSON:function(){return this.toJS()},splice:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=this[w];switch(arguments.length){case 0:return[];case 1:return i.spliceWithArray(t);case 2:return i.spliceWithArray(t,e)}return i.spliceWithArray(t,e,n)},spliceWithArray:function(t,e,n){return this[w].spliceWithArray(t,e,n)},push:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this[w];return n.spliceWithArray(n.values.length,0,t),n.values.length},pop:function(){return this.splice(Math.max(this[w].values.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this[w];return n.spliceWithArray(0,0,t),n.values.length},reverse:function(){var t=this.slice();return t.reverse.apply(t,arguments)},sort:function(t){var e=this.slice();return e.sort.apply(e,arguments)},remove:function(t){var e=this[w],n=e.dehanceValues(e.values).indexOf(t);return n>-1&&(this.splice(n,1),!0)},get:function(t){var e=this[w];if(e){if(t<e.values.length)return e.atom.reportObserved(),e.dehanceValue(e.values[t]);console.warn("[mobx.array] Attempt to read an array index ("+t+") that is out of bounds ("+e.values.length+"). Please check length first. Out of bound indices will not be tracked by MobX")}},set:function(t,e){var n=this[w],r=n.values;if(t<r.length){ct(n.atom);var i=r[t];if(an(n)){var o=cn(n,{type:"update",object:n.proxy,index:t,newValue:e});if(!o)return;e=o.newValue}(e=n.enhancer(e,i))!==i&&(r[t]=e,n.notifyArrayChildUpdate(t,e,i))}else{if(t!==r.length)throw new Error("[mobx.array] Index out of bounds, "+t+" is larger than "+r.length);n.spliceWithArray(t,0,[e])}}};["concat","flat","includes","indexOf","join","lastIndexOf","slice","toString","toLocaleString"].forEach((function(t){"function"==typeof Array.prototype[t]&&(mn[t]=function(){var e=this[w];e.atom.reportObserved();var n=e.dehanceValues(e.values);return n[t].apply(n,arguments)})})),["every","filter","find","findIndex","flatMap","forEach","map","some"].forEach((function(t){"function"==typeof Array.prototype[t]&&(mn[t]=function(e,n){var r=this,i=this[w];return i.atom.reportObserved(),i.values[t]((function(t,o){return t=i.dehanceValue(t),e.call(n,t,o,r)}),n)})})),["reduce","reduceRight"].forEach((function(t){mn[t]=function(e,n){var r=this,i=this[w];return i.atom.reportObserved(),i.values[t]((function(t,n,o){return n=i.dehanceValue(n),e(t,n,o,r)}),n)}}));var gn,vn=p("ObservableArrayAdministration",pn);function yn(t){return d(t)&&vn(t[w])}var bn,xn={},_n=function(){function t(t,e,n){if(void 0===e&&(e=B),void 0===n&&(n="ObservableMap@"+a()),this.enhancer=e,this.name=n,this[gn]=xn,this._keysAtom=E(this.name+".keys()"),this[Symbol.toStringTag]="Map","function"!=typeof Map)throw new Error("mobx.map requires Map polyfill for the current browser. Check babel-polyfill or core-js/es6/map.js");this._data=new Map,this._hasMap=new Map,this.merge(t)}return t.prototype._has=function(t){return this._data.has(t)},t.prototype.has=function(t){var e=this;if(!jt.trackingDerivation)return this._has(t);var n=this._hasMap.get(t);if(!n){var r=n=new Ct(this._has(t),U,this.name+"."+b(t)+"?",!1);this._hasMap.set(t,r),pe(r,(function(){return e._hasMap.delete(t)}))}return n.get()},t.prototype.set=function(t,e){var n=this._has(t);if(an(this)){var r=cn(this,{type:n?"update":"add",object:this,newValue:e,name:t});if(!r)return this;e=r.newValue}return n?this._updateValue(t,e):this._addValue(t,e),this},t.prototype.delete=function(t){var e=this;if((ct(this._keysAtom),an(this))&&!(r=cn(this,{type:"delete",object:this,name:t})))return!1;if(this._has(t)){var n=ln(this),r=n?{type:"delete",object:this,oldValue:this._data.get(t).value,name:t}:null;return Ze((function(){e._keysAtom.reportChanged(),e._updateHasMapEntry(t,!1),e._data.get(t).setNewValue(void 0),e._data.delete(t)})),n&&dn(this,r),!0}return!1},t.prototype._updateHasMapEntry=function(t,e){var n=this._hasMap.get(t);n&&n.setNewValue(e)},t.prototype._updateValue=function(t,e){var n=this._data.get(t);if((e=n.prepareNewValue(e))!==jt.UNCHANGED){var r=ln(this),i=r?{type:"update",object:this,oldValue:n.value,name:t,newValue:e}:null;0,n.setNewValue(e),r&&dn(this,i)}},t.prototype._addValue=function(t,e){var n=this;ct(this._keysAtom),Ze((function(){var r=new Ct(e,n.enhancer,n.name+"."+b(t),!1);n._data.set(t,r),e=r.value,n._updateHasMapEntry(t,!0),n._keysAtom.reportChanged()}));var r=ln(this),i=r?{type:"add",object:this,name:t,newValue:e}:null;r&&dn(this,i)},t.prototype.get=function(t){return this.has(t)?this.dehanceValue(this._data.get(t).get()):this.dehanceValue(void 0)},t.prototype.dehanceValue=function(t){return void 0!==this.dehancer?this.dehancer(t):t},t.prototype.keys=function(){return this._keysAtom.reportObserved(),this._data.keys()},t.prototype.values=function(){var t=this,e=this.keys();return Bn({next:function(){var n=e.next(),r=n.done,i=n.value;return{done:r,value:r?void 0:t.get(i)}}})},t.prototype.entries=function(){var t=this,e=this.keys();return Bn({next:function(){var n=e.next(),r=n.done,i=n.value;return{done:r,value:r?void 0:[i,t.get(i)]}}})},t.prototype[(gn=w,Symbol.iterator)]=function(){return this.entries()},t.prototype.forEach=function(t,e){var n,r;try{for(var i=P(this),o=i.next();!o.done;o=i.next()){var a=O(o.value,2),s=a[0],c=a[1];t.call(e,c,s,this)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype.merge=function(t){var e=this;return wn(t)&&(t=t.toJS()),Ze((function(){h(t)?y(t).forEach((function(n){return e.set(n,t[n])})):Array.isArray(t)?t.forEach((function(t){var n=O(t,2),r=n[0],i=n[1];return e.set(r,i)})):g(t)?(t.constructor!==Map&&s("Cannot initialize from classes that inherit from Map: "+t.constructor.name),t.forEach((function(t,n){return e.set(n,t)}))):null!=t&&s("Cannot initialize map from "+t)})),this},t.prototype.clear=function(){var t=this;Ze((function(){dt((function(){var e,n;try{for(var r=P(t.keys()),i=r.next();!i.done;i=r.next()){var o=i.value;t.delete(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}))}))},t.prototype.replace=function(t){var e=this;return Ze((function(){var n,r,i,o,a=function(t){if(g(t)||wn(t))return t;if(Array.isArray(t))return new Map(t);if(h(t)){var e=new Map;for(var n in t)e.set(n,t[n]);return e}return s("Cannot convert to map from '"+t+"'")}(t),c=new Map,l=!1;try{for(var u=P(e._data.keys()),d=u.next();!d.done;d=u.next()){var f=d.value;if(!a.has(f))if(e.delete(f))l=!0;else{var p=e._data.get(f);c.set(f,p)}}}catch(t){n={error:t}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}try{for(var m=P(a.entries()),v=m.next();!v.done;v=m.next()){var y=O(v.value,2),b=(f=y[0],p=y[1],e._data.has(f));if(e.set(f,p),e._data.has(f)){var x=e._data.get(f);c.set(f,x),b||(l=!0)}}}catch(t){i={error:t}}finally{try{v&&!v.done&&(o=m.return)&&o.call(m)}finally{if(i)throw i.error}}if(!l)if(e._data.size!==c.size)e._keysAtom.reportChanged();else for(var _=e._data.keys(),w=c.keys(),S=_.next(),M=w.next();!S.done;){if(S.value!==M.value){e._keysAtom.reportChanged();break}S=_.next(),M=w.next()}e._data=c})),this},Object.defineProperty(t.prototype,"size",{get:function(){return this._keysAtom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),t.prototype.toPOJO=function(){var t,e,n={};try{for(var r=P(this),i=r.next();!i.done;i=r.next()){var o=O(i.value,2),a=o[0],s=o[1];n["symbol"==typeof a?a:b(a)]=s}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},t.prototype.toJS=function(){return new Map(this)},t.prototype.toJSON=function(){return this.toPOJO()},t.prototype.toString=function(){var t=this;return this.name+"[{ "+Array.from(this.keys()).map((function(e){return b(e)+": "+t.get(e)})).join(", ")+" }]"},t.prototype.observe=function(t,e){return un(this,t)},t.prototype.intercept=function(t){return sn(this,t)},t}(),wn=p("ObservableMap",_n),Sn={},Mn=function(){function t(t,e,n){if(void 0===e&&(e=B),void 0===n&&(n="ObservableSet@"+a()),this.name=n,this[bn]=Sn,this._data=new Set,this._atom=E(this.name),this[Symbol.toStringTag]="Set","function"!=typeof Set)throw new Error("mobx.set requires Set polyfill for the current browser. Check babel-polyfill or core-js/es6/set.js");this.enhancer=function(t,r){return e(t,r,n)},t&&this.replace(t)}return t.prototype.dehanceValue=function(t){return void 0!==this.dehancer?this.dehancer(t):t},t.prototype.clear=function(){var t=this;Ze((function(){dt((function(){var e,n;try{for(var r=P(t._data.values()),i=r.next();!i.done;i=r.next()){var o=i.value;t.delete(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}))}))},t.prototype.forEach=function(t,e){var n,r;try{for(var i=P(this),o=i.next();!o.done;o=i.next()){var a=o.value;t.call(e,a,a,this)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},Object.defineProperty(t.prototype,"size",{get:function(){return this._atom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),t.prototype.add=function(t){var e=this;if((ct(this._atom),an(this))&&!(r=cn(this,{type:"add",object:this,newValue:t})))return this;if(!this.has(t)){Ze((function(){e._data.add(e.enhancer(t,void 0)),e._atom.reportChanged()}));var n=ln(this),r=n?{type:"add",object:this,newValue:t}:null;0,n&&dn(this,r)}return this},t.prototype.delete=function(t){var e=this;if(an(this)&&!(r=cn(this,{type:"delete",object:this,oldValue:t})))return!1;if(this.has(t)){var n=ln(this),r=n?{type:"delete",object:this,oldValue:t}:null;return Ze((function(){e._atom.reportChanged(),e._data.delete(t)})),n&&dn(this,r),!0}return!1},t.prototype.has=function(t){return this._atom.reportObserved(),this._data.has(this.dehanceValue(t))},t.prototype.entries=function(){var t=0,e=Array.from(this.keys()),n=Array.from(this.values());return Bn({next:function(){var r=t;return t+=1,r<n.length?{value:[e[r],n[r]],done:!1}:{done:!0}}})},t.prototype.keys=function(){return this.values()},t.prototype.values=function(){this._atom.reportObserved();var t=this,e=0,n=Array.from(this._data.values());return Bn({next:function(){return e<n.length?{value:t.dehanceValue(n[e++]),done:!1}:{done:!0}}})},t.prototype.replace=function(t){var e=this;return En(t)&&(t=t.toJS()),Ze((function(){Array.isArray(t)||v(t)?(e.clear(),t.forEach((function(t){return e.add(t)}))):null!=t&&s("Cannot initialize set from "+t)})),this},t.prototype.observe=function(t,e){return un(this,t)},t.prototype.intercept=function(t){return sn(this,t)},t.prototype.toJS=function(){return new Set(this)},t.prototype.toString=function(){return this.name+"[ "+Array.from(this).join(", ")+" ]"},t.prototype[(bn=w,Symbol.iterator)]=function(){return this.values()},t}(),En=p("ObservableSet",Mn),Tn=function(){function t(t,e,n,r){void 0===e&&(e=new Map),this.target=t,this.values=e,this.name=n,this.defaultEnhancer=r,this.keysAtom=new S(n+".keys")}return t.prototype.read=function(t){return this.values.get(t).get()},t.prototype.write=function(t,e){var n=this.target,r=this.values.get(t);if(r instanceof Ot)r.set(e);else{if(an(this)){if(!(o=cn(this,{type:"update",object:this.proxy||n,name:t,newValue:e})))return;e=o.newValue}if((e=r.prepareNewValue(e))!==jt.UNCHANGED){var i=ln(this),o=i?{type:"update",object:this.proxy||n,oldValue:r.value,name:t,newValue:e}:null;0,r.setNewValue(e),i&&dn(this,o)}}},t.prototype.has=function(t){var e=this.pendingKeys||(this.pendingKeys=new Map),n=e.get(t);if(n)return n.get();var r=!!this.values.get(t);return n=new Ct(r,U,this.name+"."+b(t)+"?",!1),e.set(t,n),n.get()},t.prototype.addObservableProp=function(t,e,n){void 0===n&&(n=this.defaultEnhancer);var r=this.target;if(an(this)){var i=cn(this,{object:this.proxy||r,name:t,type:"add",newValue:e});if(!i)return;e=i.newValue}var o=new Ct(e,n,this.name+"."+b(t),!1);this.values.set(t,o),e=o.value,Object.defineProperty(r,t,function(t){return Cn[t]||(Cn[t]={configurable:!0,enumerable:!0,get:function(){return this[w].read(t)},set:function(e){this[w].write(t,e)}})}(t)),this.notifyPropertyAddition(t,e)},t.prototype.addComputedProp=function(t,e,n){var r,i,o,a=this.target;n.name=n.name||this.name+"."+b(e),this.values.set(e,new Ot(n)),(t===a||(r=t,i=e,!(o=Object.getOwnPropertyDescriptor(r,i))||!1!==o.configurable&&!1!==o.writable))&&Object.defineProperty(t,e,function(t){return Pn[t]||(Pn[t]={configurable:jt.computedConfigurable,enumerable:!1,get:function(){return On(this).read(t)},set:function(e){On(this).write(t,e)}})}(e))},t.prototype.remove=function(t){if(this.values.has(t)){var e=this.target;if(an(this))if(!(a=cn(this,{object:this.proxy||e,name:t,type:"remove"})))return;try{Gt();var n=ln(this),r=this.values.get(t),i=r&&r.get();if(r&&r.set(void 0),this.keysAtom.reportChanged(),this.values.delete(t),this.pendingKeys){var o=this.pendingKeys.get(t);o&&o.set(!1)}delete this.target[t];var a=n?{type:"remove",object:this.proxy||e,oldValue:i,name:t}:null;0,n&&dn(this,a)}finally{Wt()}}},t.prototype.illegalAccess=function(t,e){console.warn("Property '"+e+"' of '"+t+"' was accessed through the prototype chain. Use 'decorate' instead to declare the prop or access it statically through it's owner")},t.prototype.observe=function(t,e){return un(this,t)},t.prototype.intercept=function(t){return sn(this,t)},t.prototype.notifyPropertyAddition=function(t,e){var n=ln(this),r=n?{type:"add",object:this.proxy||this.target,name:t,newValue:e}:null;if(n&&dn(this,r),this.pendingKeys){var i=this.pendingKeys.get(t);i&&i.set(!0)}this.keysAtom.reportChanged()},t.prototype.getKeys=function(){var t,e;this.keysAtom.reportObserved();var n=[];try{for(var r=P(this.values),i=r.next();!i.done;i=r.next()){var o=O(i.value,2),a=o[0];o[1]instanceof Ct&&n.push(a)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},t}();function An(t,e,n){if(void 0===e&&(e=""),void 0===n&&(n=B),Object.prototype.hasOwnProperty.call(t,w))return t[w];h(t)||(e=(t.constructor.name||"ObservableObject")+"@"+a()),e||(e="ObservableObject@"+a());var r=new Tn(t,new Map,b(e),n);return f(t,w,r),r}var Cn=Object.create(null),Pn=Object.create(null);function On(t){var e=t[w];return e||(z(t),t[w])}var kn=p("ObservableObjectAdministration",Tn);function Ln(t){return!!d(t)&&(z(t),kn(t[w]))}function Rn(t,e){if("object"==typeof t&&null!==t){if(yn(t))return void 0!==e&&s(!1),t[w].atom;if(En(t))return t[w];if(wn(t)){var n=t;return void 0===e?n._keysAtom:((r=n._data.get(e)||n._hasMap.get(e))||s(!1),r)}var r;if(z(t),e&&!t[w]&&t[e],Ln(t))return e?((r=t[w].values.get(e))||s(!1),r):s(!1);if(M(t)||kt(t)||Qt(t))return t}else if("function"==typeof t&&Qt(t[w]))return t[w];return s(!1)}function In(t,e){return t||s("Expecting some object"),void 0!==e?In(Rn(t,e)):M(t)||kt(t)||Qt(t)||wn(t)||En(t)?t:(z(t),t[w]?t[w]:void s(!1))}function Nn(t,e){return(void 0!==e?Rn(t,e):Ln(t)||wn(t)||En(t)?In(t):Rn(t)).name}var Dn=Object.prototype.toString;function zn(t,e,n){return void 0===n&&(n=-1),function t(e,n,r,i,o){if(e===n)return 0!==e||1/e==1/n;if(null==e||null==n)return!1;if(e!=e)return n!=n;var a=typeof e;if("function"!==a&&"object"!==a&&"object"!=typeof n)return!1;var s=Dn.call(e);if(s!==Dn.call(n))return!1;switch(s){case"[object RegExp]":case"[object String]":return""+e==""+n;case"[object Number]":return+e!=+e?+n!=+n:0==+e?1/+e==1/n:+e==+n;case"[object Date]":case"[object Boolean]":return+e==+n;case"[object Symbol]":return"undefined"!=typeof Symbol&&Symbol.valueOf.call(e)===Symbol.valueOf.call(n);case"[object Map]":case"[object Set]":r>=0&&r++}e=jn(e),n=jn(n);var c="[object Array]"===s;if(!c){if("object"!=typeof e||"object"!=typeof n)return!1;var l=e.constructor,u=n.constructor;if(l!==u&&!("function"==typeof l&&l instanceof l&&"function"==typeof u&&u instanceof u)&&"constructor"in e&&"constructor"in n)return!1}if(0===r)return!1;r<0&&(r=-1);o=o||[];var d=(i=i||[]).length;for(;d--;)if(i[d]===e)return o[d]===n;if(i.push(e),o.push(n),c){if((d=e.length)!==n.length)return!1;for(;d--;)if(!t(e[d],n[d],r-1,i,o))return!1}else{var h=Object.keys(e),f=void 0;if(d=h.length,Object.keys(n).length!==d)return!1;for(;d--;)if(f=h[d],!Fn(n,f)||!t(e[f],n[f],r-1,i,o))return!1}return i.pop(),o.pop(),!0}(t,e,n)}function jn(t){return yn(t)?t.slice():g(t)||wn(t)||v(t)||En(t)?Array.from(t.entries()):t}function Fn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Bn(t){return t[Symbol.iterator]=Un,t}function Un(){return this}if("undefined"==typeof Proxy||"undefined"==typeof Symbol)throw new Error("[mobx] MobX 5+ requires Proxy and Symbol objects. If your environment doesn't support Symbol or Proxy objects, please downgrade to MobX 4. For React Native Android, consider upgrading JSCore.");"object"==typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:ee,extras:{getDebugName:Nn},$mobx:w})}.call(this,n(53),n(54))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n(20),n(3)},function(t,e,n){"use strict";n.d(e,"f",(function(){return r})),n.d(e,"g",(function(){return i})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return s})),n.d(e,"d",(function(){return l})),n.d(e,"c",(function(){return u})),n.d(e,"e",(function(){return d}));
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const r=`{{lit-${String(Math.random()).slice(2)}}}`,i=`\x3c!--${r}--\x3e`,o=new RegExp(`${r}|${i}`),a="$lit$";class s{constructor(t,e){this.parts=[],this.element=e;const n=[],i=[],s=document.createTreeWalker(e.content,133,null,!1);let l=0,h=-1,f=0;const{strings:p,values:{length:m}}=t;for(;f<m;){const t=s.nextNode();if(null!==t){if(h++,1===t.nodeType){if(t.hasAttributes()){const e=t.attributes,{length:n}=e;let r=0;for(let t=0;t<n;t++)c(e[t].name,a)&&r++;for(;r-- >0;){const e=p[f],n=d.exec(e)[2],r=n.toLowerCase()+a,i=t.getAttribute(r);t.removeAttribute(r);const s=i.split(o);this.parts.push({type:"attribute",index:h,name:n,strings:s}),f+=s.length-1}}"TEMPLATE"===t.tagName&&(i.push(t),s.currentNode=t.content)}else if(3===t.nodeType){const e=t.data;if(e.indexOf(r)>=0){const r=t.parentNode,i=e.split(o),s=i.length-1;for(let e=0;e<s;e++){let n,o=i[e];if(""===o)n=u();else{const t=d.exec(o);null!==t&&c(t[2],a)&&(o=o.slice(0,t.index)+t[1]+t[2].slice(0,-a.length)+t[3]),n=document.createTextNode(o)}r.insertBefore(n,t),this.parts.push({type:"node",index:++h})}""===i[s]?(r.insertBefore(u(),t),n.push(t)):t.data=i[s],f+=s}}else if(8===t.nodeType)if(t.data===r){const e=t.parentNode;null!==t.previousSibling&&h!==l||(h++,e.insertBefore(u(),t)),l=h,this.parts.push({type:"node",index:h}),null===t.nextSibling?t.data="":(n.push(t),h--),f++}else{let e=-1;for(;-1!==(e=t.data.indexOf(r,e+1));)this.parts.push({type:"node",index:-1}),f++}}else s.currentNode=i.pop()}for(const t of n)t.parentNode.removeChild(t)}}const c=(t,e)=>{const n=t.length-e.length;return n>=0&&t.slice(n)===e},l=t=>-1!==t.index,u=()=>document.createComment(""),d=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.app=e.LITApp=void 0;const i=n(4);n(5);const o=n(49),a=n(31),s=n(55),c=n(29);n(18);const l=n(38),u=n(42),d=n(56),h=n(57),f=n(51),p=n(41),m=n(50),g=n(37);class v{constructor(){this.services=new Map,this.buildServices()}initialize(t){return r(this,void 0,void 0,(function*(){const e=this.getService(p.AppState),n=this.getService(l.ModulesService);yield e.initialize();const r=t[e.layoutName];n.initializeLayout(r,e.currentModelSpecs,e.currentDatasetSpec,e.compareExamplesEnabled);const o=n.numberOfSelectionServices,a=this.getServiceArray(d.SelectionService);for(let t=0;t<o-1;t++){const t=new d.SelectionService;t.setAppState(e),a.push(t)}i.reaction(()=>e.compareExamplesEnabled,t=>{this.syncSelectionServices()},{fireImmediately:!0})}))}syncSelectionServices(){const t=this.getServiceArray(d.SelectionService);t.slice(1).forEach(e=>{e.syncFrom(t[0])})}getService(t){let e=this.services.get(t);if(Array.isArray(e)&&(e=e[0]),void 0===e)throw new Error("Service is undefined: "+t.name);return e}getServiceArray(t){const e=this.services.get(t);if(void 0===e)throw new Error("Service is undefined: "+t.name);return e}buildServices(){const t=new m.StatusService,e=new o.ApiService(t),n=new l.ModulesService,r=new d.SelectionService,i=new g.UrlService,v=new p.AppState(e,t),y=new f.SliceService(r,v),b=new a.ClassificationService(e,v),x=new u.RegressionService(e,v),_=new h.SettingsService(v,n,r),w=new c.GroupService(v),S=new s.ColorService(v,w,b,x);r.setAppState(v),i.syncStateToUrl(v,r,n),this.services.set(o.ApiService,e),this.services.set(p.AppState,v),this.services.set(a.ClassificationService,b),this.services.set(s.ColorService,S),this.services.set(c.GroupService,w),this.services.set(l.ModulesService,n),this.services.set(u.RegressionService,x),this.services.set(d.SelectionService,[r]),this.services.set(h.SettingsService,_),this.services.set(f.SliceService,y),this.services.set(m.StatusService,t),this.services.set(g.UrlService,i)}}e.LITApp=v,e.app=new v},function(t,e,n){"use strict";n.r(e),n.d(e,"classMap",(function(){return a}));var r=n(3);
/**
 * @license
 * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */class i{constructor(t){this.classes=new Set,this.changed=!1,this.element=t;const e=(t.getAttribute("class")||"").split(/\s+/);for(const t of e)this.classes.add(t)}add(t){this.classes.add(t),this.changed=!0}remove(t){this.classes.delete(t),this.changed=!0}commit(){if(this.changed){let t="";this.classes.forEach(e=>t+=e+" "),this.element.setAttribute("class",t)}}}const o=new WeakMap,a=Object(r.directive)(t=>e=>{if(!(e instanceof r.AttributePart)||e instanceof r.PropertyPart||"class"!==e.committer.name||e.committer.parts.length>1)throw new Error("The `classMap` directive must be used in the `class` attribute and must be the only part in the attribute.");const{committer:n}=e,{element:a}=n;let s=o.get(e);void 0===s&&(a.setAttribute("class",n.strings.join(" ")),o.set(e,s=new Set));const c=a.classList||new i(a);s.forEach(e=>{e in t||(c.remove(e),s.delete(e))});for(const e in t){const n=t[e];n!=s.has(e)&&(n?(c.add(e),s.add(e)):(c.remove(e),s.delete(e)))}"function"==typeof c.commit&&c.commit()})},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.copyToClipboard=e.roundToDecimalPlaces=e.objToDictKey=e.doesOutputSpecContain=e.compareArrays=e.cumSumArray=e.sumArray=e.range=e.isNumber=e.shortenId=e.getThresholdFromMargin=e.handleEnterKey=e.permute=e.flatten=e.findSpecKeys=e.isLitSubtype=e.arrayContainsSame=e.setEquals=e.randInt=void 0;const a=o(n(20));function s(t,e){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}function c(t,e){if(null==t)return!1;"string"==typeof e&&(e=[e]);for(const n of e)if(t.__mro__.includes(n))return!0;return!1}function l(t,e){return"string"==typeof e&&(e=[e]),Object.keys(t).filter(n=>c(t[n],e))}n(5),e.randInt=function(t,e){return Math.floor(t+Math.random()*(e-t))},e.setEquals=s,e.arrayContainsSame=function(t,e){return s(new Set(t),new Set(e))},e.isLitSubtype=c,e.findSpecKeys=l,e.flatten=function(t){return a.merge(t)},e.permute=function(t,e){const n=[];for(let r=0;r<t.length;r++)n.push(t[e[r]]);return n},e.handleEnterKey=function(t,e){"Enter"===t.key&&e()},e.getThresholdFromMargin=function(t){return null==t||0===t?.5:1/(1+Math.exp(-t))},e.shortenId=function(t){if(null!=t)return t.substring(0,6)},e.isNumber=function(t){return"number"==typeof t?t-t==0:"string"==typeof t&&""!==t.trim()&&Number.isFinite(+t)},e.range=function(t){return[...Array.from({length:t}).keys()]},e.sumArray=function(t){return t.reduce((t,e)=>t+e,0)},e.cumSumArray=function(t){const e=[];return t.reduce((t,n,r)=>e[r]=t+n,0),e},e.compareArrays=function t(e,n){if(0===e.length||0===n.length)return a.ascending(e.length,n.length);const r=a.ascending(e[0],n[0]);return 0!==r?r:t(e.slice(1),n.slice(1))},e.doesOutputSpecContain=function(t,e){const n=Object.keys(t);for(let r=0;r<n.length;r++){if(l(t[n[r]].spec.output,e).length)return!0}return!1},e.objToDictKey=function(t){return Object.keys(t).sort().map(e=>`${e}:${t[e]}`).join("/")},e.roundToDecimalPlaces=function(t,e){if(e<0)return t;const n=Math.pow(10,e);return Math.round((t+Number.EPSILON)*n)/n},e.copyToClipboard=function(t){const e=document.createElement("input");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(49);Object.defineProperty(e,"ApiService",{enumerable:!0,get:function(){return r.ApiService}});var i=n(31);Object.defineProperty(e,"ClassificationService",{enumerable:!0,get:function(){return i.ClassificationService}});var o=n(55);Object.defineProperty(e,"ColorService",{enumerable:!0,get:function(){return o.ColorService}});var a=n(38);Object.defineProperty(e,"ModulesService",{enumerable:!0,get:function(){return a.ModulesService}});var s=n(42);Object.defineProperty(e,"RegressionService",{enumerable:!0,get:function(){return s.RegressionService}});var c=n(56);Object.defineProperty(e,"SelectionService",{enumerable:!0,get:function(){return c.SelectionService}});var l=n(57);Object.defineProperty(e,"SettingsService",{enumerable:!0,get:function(){return l.SettingsService}});var u=n(51);Object.defineProperty(e,"SliceService",{enumerable:!0,get:function(){return u.SliceService}});var d=n(41);Object.defineProperty(e,"AppState",{enumerable:!0,get:function(){return d.AppState}});var h=n(50);Object.defineProperty(e,"StatusService",{enumerable:!0,get:function(){return h.StatusService}});var f=n(37);Object.defineProperty(e,"UrlService",{enumerable:!0,get:function(){return f.UrlService}})},function(t,e,n){"use strict";n.r(e),n.d(e,"styles",(function(){return r}));const r=n(0).css`/**
 * Shared styles for all modules.
 */
button {
  width: fit-content;
  max-height: 100%;
  background: lightgrey;
  pointer-events: auto;
  cursor: pointer;
  border: 1px solid darkgrey;
  margin: 5px;
  text-align: center;
  padding: 5px 10px;
  font-size: 10pt;
  border-radius: 3px;
}

button:hover {
  background: #faf49f;
}

button:disabled {
  background: darkgrey;
  color: lightgrey;
  pointer-events: none;
  cursor: auto;
}

.dropdown-label {
  font-weight: regular;
  font-size: 9pt;
  letter-spacing: +0.3pt;
  line-height: 12pt;
  margin-left: 4pt;
  margin-right: 4pt;
  color: #3c4043;
}

.dropdown {
  border: none;
  outline: none;
  border-bottom: 1px solid lightgrey;
  border-radius: 0;
  padding: 4pt;
  appearance: none;
  -webkit-appearance: none;
  padding-right: 8pt;
  margin-right: 8pt;
  max-width: 80%;
  background-color: transparent;
  background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23007CB2%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');
  background-size: .65em auto, 100%;
  background-position: right 50%;
  background-repeat: no-repeat;
}

.monospace {
  font-family: 'Share Tech Mono', monospace;
}

mwc-textfield {
  --mdc-theme-primary: #2f8c9b;
}

.lit-img{
  height: 15pt;
  width: 15pt;
  padding: 2pt;
}
`},function(t,e,n){"use strict";n.d(e,"i",(function(){return l})),n.d(e,"h",(function(){return u})),n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return h})),n.d(e,"e",(function(){return f})),n.d(e,"c",(function(){return p})),n.d(e,"f",(function(){return m})),n.d(e,"g",(function(){return g})),n.d(e,"d",(function(){return y}));var r=n(27),i=n(16),o=n(14),a=n(30),s=n(28),c=n(6);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const l=t=>null===t||!("object"==typeof t||"function"==typeof t),u=t=>Array.isArray(t)||!(!t||!t[Symbol.iterator]);class d{constructor(t,e,n){this.dirty=!0,this.element=t,this.name=e,this.strings=n,this.parts=[];for(let t=0;t<n.length-1;t++)this.parts[t]=this._createPart()}_createPart(){return new h(this)}_getValue(){const t=this.strings,e=t.length-1;let n="";for(let r=0;r<e;r++){n+=t[r];const e=this.parts[r];if(void 0!==e){const t=e.value;if(l(t)||!u(t))n+="string"==typeof t?t:String(t);else for(const e of t)n+="string"==typeof e?e:String(e)}}return n+=t[e],n}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class h{constructor(t){this.value=void 0,this.committer=t}setValue(t){t===o.a||l(t)&&t===this.value||(this.value=t,Object(r.b)(t)||(this.committer.dirty=!0))}commit(){for(;Object(r.b)(this.value);){const t=this.value;this.value=o.a,t(this)}this.value!==o.a&&this.committer.commit()}}class f{constructor(t){this.value=void 0,this.__pendingValue=void 0,this.options=t}appendInto(t){this.startNode=t.appendChild(Object(c.c)()),this.endNode=t.appendChild(Object(c.c)())}insertAfterNode(t){this.startNode=t,this.endNode=t.nextSibling}appendIntoPart(t){t.__insert(this.startNode=Object(c.c)()),t.__insert(this.endNode=Object(c.c)())}insertAfterPart(t){t.__insert(this.startNode=Object(c.c)()),this.endNode=t.endNode,t.endNode=this.startNode}setValue(t){this.__pendingValue=t}commit(){if(null===this.startNode.parentNode)return;for(;Object(r.b)(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=o.a,t(this)}const t=this.__pendingValue;t!==o.a&&(l(t)?t!==this.value&&this.__commitText(t):t instanceof s.b?this.__commitTemplateResult(t):t instanceof Node?this.__commitNode(t):u(t)?this.__commitIterable(t):t===o.b?(this.value=o.b,this.clear()):this.__commitText(t))}__insert(t){this.endNode.parentNode.insertBefore(t,this.endNode)}__commitNode(t){this.value!==t&&(this.clear(),this.__insert(t),this.value=t)}__commitText(t){const e=this.startNode.nextSibling,n="string"==typeof(t=null==t?"":t)?t:String(t);e===this.endNode.previousSibling&&3===e.nodeType?e.data=n:this.__commitNode(document.createTextNode(n)),this.value=t}__commitTemplateResult(t){const e=this.options.templateFactory(t);if(this.value instanceof a.a&&this.value.template===e)this.value.update(t.values);else{const n=new a.a(e,t.processor,this.options),r=n._clone();n.update(t.values),this.__commitNode(r),this.value=n}}__commitIterable(t){Array.isArray(this.value)||(this.value=[],this.clear());const e=this.value;let n,r=0;for(const i of t)n=e[r],void 0===n&&(n=new f(this.options),e.push(n),0===r?n.appendIntoPart(this):n.insertAfterPart(e[r-1])),n.setValue(i),n.commit(),r++;r<e.length&&(e.length=r,this.clear(n&&n.endNode))}clear(t=this.startNode){Object(i.b)(this.startNode.parentNode,t.nextSibling,this.endNode)}}class p{constructor(t,e,n){if(this.value=void 0,this.__pendingValue=void 0,2!==n.length||""!==n[0]||""!==n[1])throw new Error("Boolean attributes can only contain a single expression");this.element=t,this.name=e,this.strings=n}setValue(t){this.__pendingValue=t}commit(){for(;Object(r.b)(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=o.a,t(this)}if(this.__pendingValue===o.a)return;const t=!!this.__pendingValue;this.value!==t&&(t?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=t),this.__pendingValue=o.a}}class m extends d{constructor(t,e,n){super(t,e,n),this.single=2===n.length&&""===n[0]&&""===n[1]}_createPart(){return new g(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class g extends h{}let v=!1;(()=>{try{const t={get capture(){return v=!0,!1}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){}})();class y{constructor(t,e,n){this.value=void 0,this.__pendingValue=void 0,this.element=t,this.eventName=e,this.eventContext=n,this.__boundHandleEvent=t=>this.handleEvent(t)}setValue(t){this.__pendingValue=t}commit(){for(;Object(r.b)(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=o.a,t(this)}if(this.__pendingValue===o.a)return;const t=this.__pendingValue,e=this.value,n=null==t||null!=e&&(t.capture!==e.capture||t.once!==e.once||t.passive!==e.passive),i=null!=t&&(null==e||n);n&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),i&&(this.__options=b(t),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=t,this.__pendingValue=o.a}handleEvent(t){"function"==typeof this.value?this.value.call(this.eventContext||this.element,t):this.value.handleEvent(t)}}const b=t=>t&&(v?{capture:t.capture,passive:t.passive,once:t.once}:t.capture)},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.LitModule=void 0;const o=n(0),a=n(4),s=n(4),c=n(59);n(5);const l=n(10),u=n(7);class d extends c.ReactiveElement{constructor(){super(...arguments),this.setIsLoading=t=>{},this.model="",this.selectionServiceIndex=0,this.latestLoadPromises=new Map,this.apiService=u.app.getService(l.ApiService),this.appState=u.app.getService(l.AppState)}get selectionService(){return u.app.getServiceArray(l.SelectionService)[this.selectionServiceIndex]}loadLatest(t,e){return i(this,void 0,void 0,(function*(){this.latestLoadPromises.set(t,e),this.setIsLoading(!0);const n=yield e;return this.latestLoadPromises.get(t)===e?(this.setIsLoading(!1),this.latestLoadPromises.delete(t),n):null}))}}d.numCols=4,d.duplicateForExampleComparison=!1,d.duplicateForModelComparison=!0,d.duplicateAsRow=!1,r([o.property({type:Object})],d.prototype,"setIsLoading",void 0),r([o.property({type:String})],d.prototype,"model",void 0),r([s.observable,o.property({type:Number})],d.prototype,"selectionServiceIndex",void 0),r([a.computed],d.prototype,"selectionService",null),e.LitModule=d},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));
/**
 * @license
 * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const r={},i={}},function(t,e,n){"use strict";n.r(e),n.d(e,"styleMap",(function(){return o}));var r=n(3);
/**
 * @license
 * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const i=new WeakMap,o=Object(r.directive)(t=>e=>{if(!(e instanceof r.AttributePart)||e instanceof r.PropertyPart||"style"!==e.committer.name||e.committer.parts.length>1)throw new Error("The `styleMap` directive must be used in the style attribute and must be the only part in the attribute.");const{committer:n}=e,{style:o}=n.element;let a=i.get(e);void 0===a&&(o.cssText=n.strings.join(" "),i.set(e,a=new Set)),a.forEach(e=>{e in t||(a.delete(e),-1===e.indexOf("-")?o[e]=null:o.removeProperty(e))});for(const e in t)a.add(e),-1===e.indexOf("-")?o[e]=t[e]:o.setProperty(e,t[e])})},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return o}));
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const r="undefined"!=typeof window&&null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,i=(t,e,n=null,r=null)=>{for(;e!==n;){const n=e.nextSibling;t.insertBefore(e,r),e=n}},o=(t,e,n=null)=>{for(;e!==n;){const n=e.nextSibling;t.removeChild(e),e=n}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));
/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
var r=function(){function t(t){void 0===t&&(t={}),this.adapter_=t}return Object.defineProperty(t,"cssClasses",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{}},enumerable:!0,configurable:!0}),t.prototype.init=function(){},t.prototype.destroy=function(){},t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LitService=void 0;e.LitService=class{}},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e,n){"use strict";n.r(e),n.d(e,"version",(function(){return r})),n.d(e,"bisect",(function(){return l})),n.d(e,"bisectRight",(function(){return s})),n.d(e,"bisectLeft",(function(){return c})),n.d(e,"ascending",(function(){return i})),n.d(e,"bisector",(function(){return o})),n.d(e,"cross",(function(){return h})),n.d(e,"descending",(function(){return f})),n.d(e,"deviation",(function(){return g})),n.d(e,"extent",(function(){return v})),n.d(e,"histogram",(function(){return k})),n.d(e,"thresholdFreedmanDiaconis",(function(){return R})),n.d(e,"thresholdScott",(function(){return I})),n.d(e,"thresholdSturges",(function(){return O})),n.d(e,"max",(function(){return N})),n.d(e,"mean",(function(){return D})),n.d(e,"median",(function(){return z})),n.d(e,"merge",(function(){return j})),n.d(e,"min",(function(){return F})),n.d(e,"pairs",(function(){return u})),n.d(e,"permute",(function(){return B})),n.d(e,"quantile",(function(){return L})),n.d(e,"range",(function(){return S})),n.d(e,"scan",(function(){return U})),n.d(e,"shuffle",(function(){return H})),n.d(e,"sum",(function(){return V})),n.d(e,"ticks",(function(){return A})),n.d(e,"tickIncrement",(function(){return C})),n.d(e,"tickStep",(function(){return P})),n.d(e,"transpose",(function(){return G})),n.d(e,"variance",(function(){return m})),n.d(e,"zip",(function(){return $})),n.d(e,"axisTop",(function(){return et})),n.d(e,"axisRight",(function(){return nt})),n.d(e,"axisBottom",(function(){return rt})),n.d(e,"axisLeft",(function(){return it})),n.d(e,"brush",(function(){return Ti})),n.d(e,"brushX",(function(){return Mi})),n.d(e,"brushY",(function(){return Ei})),n.d(e,"brushSelection",(function(){return Si})),n.d(e,"chord",(function(){return Ni})),n.d(e,"ribbon",(function(){return Yi})),n.d(e,"nest",(function(){return Qi})),n.d(e,"set",(function(){return so})),n.d(e,"map",(function(){return Ji})),n.d(e,"keys",(function(){return co})),n.d(e,"values",(function(){return lo})),n.d(e,"entries",(function(){return uo})),n.d(e,"color",(function(){return Ge})),n.d(e,"rgb",(function(){return Xe})),n.d(e,"hsl",(function(){return en})),n.d(e,"lab",(function(){return go})),n.d(e,"hcl",(function(){return Mo})),n.d(e,"lch",(function(){return So})),n.d(e,"gray",(function(){return mo})),n.d(e,"cubehelix",(function(){return Lo})),n.d(e,"contours",(function(){return Ho})),n.d(e,"contourDensity",(function(){return Xo})),n.d(e,"dispatch",(function(){return dt})),n.d(e,"drag",(function(){return ea})),n.d(e,"dragDisable",(function(){return Te})),n.d(e,"dragEnable",(function(){return Ae})),n.d(e,"dsvFormat",(function(){return ca})),n.d(e,"csvParse",(function(){return ua})),n.d(e,"csvParseRows",(function(){return da})),n.d(e,"csvFormat",(function(){return ha})),n.d(e,"csvFormatBody",(function(){return fa})),n.d(e,"csvFormatRows",(function(){return pa})),n.d(e,"csvFormatRow",(function(){return ma})),n.d(e,"csvFormatValue",(function(){return ga})),n.d(e,"tsvParse",(function(){return ya})),n.d(e,"tsvParseRows",(function(){return ba})),n.d(e,"tsvFormat",(function(){return xa})),n.d(e,"tsvFormatBody",(function(){return _a})),n.d(e,"tsvFormatRows",(function(){return wa})),n.d(e,"tsvFormatRow",(function(){return Sa})),n.d(e,"tsvFormatValue",(function(){return Ma})),n.d(e,"autoType",(function(){return Ea})),n.d(e,"easeLinear",(function(){return Aa})),n.d(e,"easeQuad",(function(){return Oa})),n.d(e,"easeQuadIn",(function(){return Ca})),n.d(e,"easeQuadOut",(function(){return Pa})),n.d(e,"easeQuadInOut",(function(){return Oa})),n.d(e,"easeCubic",(function(){return qr})),n.d(e,"easeCubicIn",(function(){return Wr})),n.d(e,"easeCubicOut",(function(){return $r})),n.d(e,"easeCubicInOut",(function(){return qr})),n.d(e,"easePoly",(function(){return Ra})),n.d(e,"easePolyIn",(function(){return ka})),n.d(e,"easePolyOut",(function(){return La})),n.d(e,"easePolyInOut",(function(){return Ra})),n.d(e,"easeSin",(function(){return ja})),n.d(e,"easeSinIn",(function(){return Da})),n.d(e,"easeSinOut",(function(){return za})),n.d(e,"easeSinInOut",(function(){return ja})),n.d(e,"easeExp",(function(){return Ua})),n.d(e,"easeExpIn",(function(){return Fa})),n.d(e,"easeExpOut",(function(){return Ba})),n.d(e,"easeExpInOut",(function(){return Ua})),n.d(e,"easeCircle",(function(){return Ga})),n.d(e,"easeCircleIn",(function(){return Ha})),n.d(e,"easeCircleOut",(function(){return Va})),n.d(e,"easeCircleInOut",(function(){return Ga})),n.d(e,"easeBounce",(function(){return $a})),n.d(e,"easeBounceIn",(function(){return Wa})),n.d(e,"easeBounceOut",(function(){return $a})),n.d(e,"easeBounceInOut",(function(){return qa})),n.d(e,"easeBack",(function(){return Ka})),n.d(e,"easeBackIn",(function(){return Xa})),n.d(e,"easeBackOut",(function(){return Ya})),n.d(e,"easeBackInOut",(function(){return Ka})),n.d(e,"easeElastic",(function(){return Qa})),n.d(e,"easeElasticIn",(function(){return Ja})),n.d(e,"easeElasticOut",(function(){return Qa})),n.d(e,"easeElasticInOut",(function(){return ts})),n.d(e,"blob",(function(){return ns})),n.d(e,"buffer",(function(){return is})),n.d(e,"dsv",(function(){return cs})),n.d(e,"csv",(function(){return ls})),n.d(e,"tsv",(function(){return us})),n.d(e,"image",(function(){return ds})),n.d(e,"json",(function(){return fs})),n.d(e,"text",(function(){return as})),n.d(e,"xml",(function(){return ms})),n.d(e,"html",(function(){return gs})),n.d(e,"svg",(function(){return vs})),n.d(e,"forceCenter",(function(){return ys})),n.d(e,"forceCollide",(function(){return ks})),n.d(e,"forceLink",(function(){return Is})),n.d(e,"forceManyBody",(function(){return Fs})),n.d(e,"forceRadial",(function(){return Bs})),n.d(e,"forceSimulation",(function(){return js})),n.d(e,"forceX",(function(){return Us})),n.d(e,"forceY",(function(){return Hs})),n.d(e,"formatDefaultLocale",(function(){return ic})),n.d(e,"format",(function(){return Ks})),n.d(e,"formatPrefix",(function(){return Zs})),n.d(e,"formatLocale",(function(){return rc})),n.d(e,"formatSpecifier",(function(){return $s})),n.d(e,"FormatSpecifier",(function(){return qs})),n.d(e,"precisionFixed",(function(){return oc})),n.d(e,"precisionPrefix",(function(){return ac})),n.d(e,"precisionRound",(function(){return sc})),n.d(e,"geoArea",(function(){return Jc})),n.d(e,"geoBounds",(function(){return Gl})),n.d(e,"geoCentroid",(function(){return nu})),n.d(e,"geoCircle",(function(){return fu})),n.d(e,"geoClipAntimeridian",(function(){return Eu})),n.d(e,"geoClipCircle",(function(){return Tu})),n.d(e,"geoClipExtent",(function(){return ku})),n.d(e,"geoClipRectangle",(function(){return Au})),n.d(e,"geoContains",(function(){return Yu})),n.d(e,"geoDistance",(function(){return Bu})),n.d(e,"geoGraticule",(function(){return Ju})),n.d(e,"geoGraticule10",(function(){return Qu})),n.d(e,"geoInterpolate",(function(){return id})),n.d(e,"geoLength",(function(){return zu})),n.d(e,"geoPath",(function(){return nh})),n.d(e,"geoAlbers",(function(){return _h})),n.d(e,"geoAlbersUsa",(function(){return wh})),n.d(e,"geoAzimuthalEqualArea",(function(){return Th})),n.d(e,"geoAzimuthalEqualAreaRaw",(function(){return Eh})),n.d(e,"geoAzimuthalEquidistant",(function(){return Ch})),n.d(e,"geoAzimuthalEquidistantRaw",(function(){return Ah})),n.d(e,"geoConicConformal",(function(){return Ih})),n.d(e,"geoConicConformalRaw",(function(){return Rh})),n.d(e,"geoConicEqualArea",(function(){return xh})),n.d(e,"geoConicEqualAreaRaw",(function(){return bh})),n.d(e,"geoConicEquidistant",(function(){return jh})),n.d(e,"geoConicEquidistantRaw",(function(){return zh})),n.d(e,"geoEqualEarth",(function(){return Wh})),n.d(e,"geoEqualEarthRaw",(function(){return Gh})),n.d(e,"geoEquirectangular",(function(){return Dh})),n.d(e,"geoEquirectangularRaw",(function(){return Nh})),n.d(e,"geoGnomonic",(function(){return qh})),n.d(e,"geoGnomonicRaw",(function(){return $h})),n.d(e,"geoIdentity",(function(){return Xh})),n.d(e,"geoProjection",(function(){return gh})),n.d(e,"geoProjectionMutator",(function(){return vh})),n.d(e,"geoMercator",(function(){return Oh})),n.d(e,"geoMercatorRaw",(function(){return Ph})),n.d(e,"geoNaturalEarth1",(function(){return Kh})),n.d(e,"geoNaturalEarth1Raw",(function(){return Yh})),n.d(e,"geoOrthographic",(function(){return Jh})),n.d(e,"geoOrthographicRaw",(function(){return Zh})),n.d(e,"geoStereographic",(function(){return tf})),n.d(e,"geoStereographicRaw",(function(){return Qh})),n.d(e,"geoTransverseMercator",(function(){return nf})),n.d(e,"geoTransverseMercatorRaw",(function(){return ef})),n.d(e,"geoRotation",(function(){return uu})),n.d(e,"geoStream",(function(){return Gc})),n.d(e,"geoTransform",(function(){return rh})),n.d(e,"cluster",(function(){return sf})),n.d(e,"hierarchy",(function(){return lf})),n.d(e,"pack",(function(){return If})),n.d(e,"packSiblings",(function(){return Cf})),n.d(e,"packEnclose",(function(){return mf})),n.d(e,"partition",(function(){return Bf})),n.d(e,"stratify",(function(){return Wf})),n.d(e,"tree",(function(){return Jf})),n.d(e,"treemap",(function(){return rp})),n.d(e,"treemapBinary",(function(){return ip})),n.d(e,"treemapDice",(function(){return Ff})),n.d(e,"treemapSlice",(function(){return Qf})),n.d(e,"treemapSliceDice",(function(){return op})),n.d(e,"treemapSquarify",(function(){return np})),n.d(e,"treemapResquarify",(function(){return ap})),n.d(e,"interpolate",(function(){return Pn})),n.d(e,"interpolateArray",(function(){return bn})),n.d(e,"interpolateBasis",(function(){return an})),n.d(e,"interpolateBasisClosed",(function(){return sn})),n.d(e,"interpolateDate",(function(){return _n})),n.d(e,"interpolateDiscrete",(function(){return sp})),n.d(e,"interpolateHue",(function(){return cp})),n.d(e,"interpolateNumber",(function(){return wn})),n.d(e,"interpolateNumberArray",(function(){return vn})),n.d(e,"interpolateObject",(function(){return Sn})),n.d(e,"interpolateRound",(function(){return lp})),n.d(e,"interpolateString",(function(){return Cn})),n.d(e,"interpolateTransformCss",(function(){return hr})),n.d(e,"interpolateTransformSvg",(function(){return fr})),n.d(e,"interpolateZoom",(function(){return hp})),n.d(e,"interpolateRgb",(function(){return fn})),n.d(e,"interpolateRgbBasis",(function(){return mn})),n.d(e,"interpolateRgbBasisClosed",(function(){return gn})),n.d(e,"interpolateHsl",(function(){return pp})),n.d(e,"interpolateHslLong",(function(){return mp})),n.d(e,"interpolateLab",(function(){return gp})),n.d(e,"interpolateHcl",(function(){return yp})),n.d(e,"interpolateHclLong",(function(){return bp})),n.d(e,"interpolateCubehelix",(function(){return _p})),n.d(e,"interpolateCubehelixLong",(function(){return wp})),n.d(e,"piecewise",(function(){return Sp})),n.d(e,"quantize",(function(){return Mp})),n.d(e,"path",(function(){return Vi})),n.d(e,"polygonArea",(function(){return Ep})),n.d(e,"polygonCentroid",(function(){return Tp})),n.d(e,"polygonHull",(function(){return Pp})),n.d(e,"polygonContains",(function(){return Op})),n.d(e,"polygonLength",(function(){return kp})),n.d(e,"quadtree",(function(){return Es})),n.d(e,"randomUniform",(function(){return Rp})),n.d(e,"randomNormal",(function(){return Ip})),n.d(e,"randomLogNormal",(function(){return Np})),n.d(e,"randomBates",(function(){return zp})),n.d(e,"randomIrwinHall",(function(){return Dp})),n.d(e,"randomExponential",(function(){return jp})),n.d(e,"scaleBand",(function(){return $p})),n.d(e,"scalePoint",(function(){return Xp})),n.d(e,"scaleIdentity",(function(){return cm})),n.d(e,"scaleLinear",(function(){return sm})),n.d(e,"scaleLog",(function(){return vm})),n.d(e,"scaleSymlog",(function(){return _m})),n.d(e,"scaleOrdinal",(function(){return Wp})),n.d(e,"scaleImplicit",(function(){return Gp})),n.d(e,"scalePow",(function(){return Tm})),n.d(e,"scaleSqrt",(function(){return Am})),n.d(e,"scaleQuantile",(function(){return Cm})),n.d(e,"scaleQuantize",(function(){return Pm})),n.d(e,"scaleThreshold",(function(){return Om})),n.d(e,"scaleTime",(function(){return sy})),n.d(e,"scaleUtc",(function(){return vy})),n.d(e,"scaleSequential",(function(){return xy})),n.d(e,"scaleSequentialLog",(function(){return _y})),n.d(e,"scaleSequentialPow",(function(){return Sy})),n.d(e,"scaleSequentialSqrt",(function(){return My})),n.d(e,"scaleSequentialSymlog",(function(){return wy})),n.d(e,"scaleSequentialQuantile",(function(){return Ey})),n.d(e,"scaleDiverging",(function(){return Ay})),n.d(e,"scaleDivergingLog",(function(){return Cy})),n.d(e,"scaleDivergingPow",(function(){return Oy})),n.d(e,"scaleDivergingSqrt",(function(){return ky})),n.d(e,"scaleDivergingSymlog",(function(){return Py})),n.d(e,"tickFormat",(function(){return om})),n.d(e,"schemeCategory10",(function(){return Ry})),n.d(e,"schemeAccent",(function(){return Iy})),n.d(e,"schemeDark2",(function(){return Ny})),n.d(e,"schemePaired",(function(){return Dy})),n.d(e,"schemePastel1",(function(){return zy})),n.d(e,"schemePastel2",(function(){return jy})),n.d(e,"schemeSet1",(function(){return Fy})),n.d(e,"schemeSet2",(function(){return By})),n.d(e,"schemeSet3",(function(){return Uy})),n.d(e,"schemeTableau10",(function(){return Hy})),n.d(e,"interpolateBrBG",(function(){return Wy})),n.d(e,"schemeBrBG",(function(){return Gy})),n.d(e,"interpolatePRGn",(function(){return qy})),n.d(e,"schemePRGn",(function(){return $y})),n.d(e,"interpolatePiYG",(function(){return Yy})),n.d(e,"schemePiYG",(function(){return Xy})),n.d(e,"interpolatePuOr",(function(){return Zy})),n.d(e,"schemePuOr",(function(){return Ky})),n.d(e,"interpolateRdBu",(function(){return Qy})),n.d(e,"schemeRdBu",(function(){return Jy})),n.d(e,"interpolateRdGy",(function(){return eb})),n.d(e,"schemeRdGy",(function(){return tb})),n.d(e,"interpolateRdYlBu",(function(){return rb})),n.d(e,"schemeRdYlBu",(function(){return nb})),n.d(e,"interpolateRdYlGn",(function(){return ob})),n.d(e,"schemeRdYlGn",(function(){return ib})),n.d(e,"interpolateSpectral",(function(){return sb})),n.d(e,"schemeSpectral",(function(){return ab})),n.d(e,"interpolateBuGn",(function(){return lb})),n.d(e,"schemeBuGn",(function(){return cb})),n.d(e,"interpolateBuPu",(function(){return db})),n.d(e,"schemeBuPu",(function(){return ub})),n.d(e,"interpolateGnBu",(function(){return fb})),n.d(e,"schemeGnBu",(function(){return hb})),n.d(e,"interpolateOrRd",(function(){return mb})),n.d(e,"schemeOrRd",(function(){return pb})),n.d(e,"interpolatePuBuGn",(function(){return vb})),n.d(e,"schemePuBuGn",(function(){return gb})),n.d(e,"interpolatePuBu",(function(){return bb})),n.d(e,"schemePuBu",(function(){return yb})),n.d(e,"interpolatePuRd",(function(){return _b})),n.d(e,"schemePuRd",(function(){return xb})),n.d(e,"interpolateRdPu",(function(){return Sb})),n.d(e,"schemeRdPu",(function(){return wb})),n.d(e,"interpolateYlGnBu",(function(){return Eb})),n.d(e,"schemeYlGnBu",(function(){return Mb})),n.d(e,"interpolateYlGn",(function(){return Ab})),n.d(e,"schemeYlGn",(function(){return Tb})),n.d(e,"interpolateYlOrBr",(function(){return Pb})),n.d(e,"schemeYlOrBr",(function(){return Cb})),n.d(e,"interpolateYlOrRd",(function(){return kb})),n.d(e,"schemeYlOrRd",(function(){return Ob})),n.d(e,"interpolateBlues",(function(){return Rb})),n.d(e,"schemeBlues",(function(){return Lb})),n.d(e,"interpolateGreens",(function(){return Nb})),n.d(e,"schemeGreens",(function(){return Ib})),n.d(e,"interpolateGreys",(function(){return zb})),n.d(e,"schemeGreys",(function(){return Db})),n.d(e,"interpolatePurples",(function(){return Fb})),n.d(e,"schemePurples",(function(){return jb})),n.d(e,"interpolateReds",(function(){return Ub})),n.d(e,"schemeReds",(function(){return Bb})),n.d(e,"interpolateOranges",(function(){return Vb})),n.d(e,"schemeOranges",(function(){return Hb})),n.d(e,"interpolateCividis",(function(){return Gb})),n.d(e,"interpolateCubehelixDefault",(function(){return Wb})),n.d(e,"interpolateRainbow",(function(){return Yb})),n.d(e,"interpolateWarm",(function(){return $b})),n.d(e,"interpolateCool",(function(){return qb})),n.d(e,"interpolateSinebow",(function(){return Qb})),n.d(e,"interpolateTurbo",(function(){return tx})),n.d(e,"interpolateViridis",(function(){return nx})),n.d(e,"interpolateMagma",(function(){return rx})),n.d(e,"interpolateInferno",(function(){return ix})),n.d(e,"interpolatePlasma",(function(){return ox})),n.d(e,"create",(function(){return ax})),n.d(e,"creator",(function(){return re})),n.d(e,"local",(function(){return cx})),n.d(e,"matcher",(function(){return gt})),n.d(e,"mouse",(function(){return Rn})),n.d(e,"namespace",(function(){return Mt})),n.d(e,"namespaces",(function(){return St})),n.d(e,"clientPoint",(function(){return kn})),n.d(e,"select",(function(){return Se})),n.d(e,"selectAll",(function(){return ux})),n.d(e,"selection",(function(){return we})),n.d(e,"selector",(function(){return ft})),n.d(e,"selectorAll",(function(){return mt})),n.d(e,"style",(function(){return Nt})),n.d(e,"touch",(function(){return Ln})),n.d(e,"touches",(function(){return dx})),n.d(e,"window",(function(){return kt})),n.d(e,"event",(function(){return le})),n.d(e,"customEvent",(function(){return me})),n.d(e,"arc",(function(){return Lx})),n.d(e,"area",(function(){return jx})),n.d(e,"line",(function(){return zx})),n.d(e,"pie",(function(){return Ux})),n.d(e,"areaRadial",(function(){return qx})),n.d(e,"radialArea",(function(){return qx})),n.d(e,"lineRadial",(function(){return $x})),n.d(e,"radialLine",(function(){return $x})),n.d(e,"pointRadial",(function(){return Xx})),n.d(e,"linkHorizontal",(function(){return n_})),n.d(e,"linkVertical",(function(){return r_})),n.d(e,"linkRadial",(function(){return i_})),n.d(e,"symbol",(function(){return w_})),n.d(e,"symbols",(function(){return __})),n.d(e,"symbolCircle",(function(){return o_})),n.d(e,"symbolCross",(function(){return a_})),n.d(e,"symbolDiamond",(function(){return l_})),n.d(e,"symbolSquare",(function(){return p_})),n.d(e,"symbolStar",(function(){return f_})),n.d(e,"symbolTriangle",(function(){return g_})),n.d(e,"symbolWye",(function(){return x_})),n.d(e,"curveBasisClosed",(function(){return C_})),n.d(e,"curveBasisOpen",(function(){return O_})),n.d(e,"curveBasis",(function(){return T_})),n.d(e,"curveBundle",(function(){return L_})),n.d(e,"curveCardinalClosed",(function(){return z_})),n.d(e,"curveCardinalOpen",(function(){return F_})),n.d(e,"curveCardinal",(function(){return N_})),n.d(e,"curveCatmullRomClosed",(function(){return G_})),n.d(e,"curveCatmullRomOpen",(function(){return $_})),n.d(e,"curveCatmullRom",(function(){return H_})),n.d(e,"curveLinearClosed",(function(){return X_})),n.d(e,"curveLinear",(function(){return Ix})),n.d(e,"curveMonotoneX",(function(){return nw})),n.d(e,"curveMonotoneY",(function(){return rw})),n.d(e,"curveNatural",(function(){return aw})),n.d(e,"curveStep",(function(){return cw})),n.d(e,"curveStepAfter",(function(){return uw})),n.d(e,"curveStepBefore",(function(){return lw})),n.d(e,"stack",(function(){return pw})),n.d(e,"stackOffsetExpand",(function(){return mw})),n.d(e,"stackOffsetDiverging",(function(){return gw})),n.d(e,"stackOffsetNone",(function(){return dw})),n.d(e,"stackOffsetSilhouette",(function(){return vw})),n.d(e,"stackOffsetWiggle",(function(){return yw})),n.d(e,"stackOrderAppearance",(function(){return bw})),n.d(e,"stackOrderAscending",(function(){return _w})),n.d(e,"stackOrderDescending",(function(){return Sw})),n.d(e,"stackOrderInsideOut",(function(){return Mw})),n.d(e,"stackOrderNone",(function(){return hw})),n.d(e,"stackOrderReverse",(function(){return Ew})),n.d(e,"timeInterval",(function(){return Rm})),n.d(e,"timeMillisecond",(function(){return pg})),n.d(e,"timeMilliseconds",(function(){return mg})),n.d(e,"utcMillisecond",(function(){return pg})),n.d(e,"utcMilliseconds",(function(){return mg})),n.d(e,"timeSecond",(function(){return dg})),n.d(e,"timeSeconds",(function(){return hg})),n.d(e,"utcSecond",(function(){return dg})),n.d(e,"utcSeconds",(function(){return hg})),n.d(e,"timeMinute",(function(){return cg})),n.d(e,"timeMinutes",(function(){return lg})),n.d(e,"timeHour",(function(){return og})),n.d(e,"timeHours",(function(){return ag})),n.d(e,"timeDay",(function(){return ng})),n.d(e,"timeDays",(function(){return rg})),n.d(e,"timeWeek",(function(){return Um})),n.d(e,"timeWeeks",(function(){return Xm})),n.d(e,"timeSunday",(function(){return Um})),n.d(e,"timeSundays",(function(){return Xm})),n.d(e,"timeMonday",(function(){return Hm})),n.d(e,"timeMondays",(function(){return Ym})),n.d(e,"timeTuesday",(function(){return Vm})),n.d(e,"timeTuesdays",(function(){return Km})),n.d(e,"timeWednesday",(function(){return Gm})),n.d(e,"timeWednesdays",(function(){return Zm})),n.d(e,"timeThursday",(function(){return Wm})),n.d(e,"timeThursdays",(function(){return Jm})),n.d(e,"timeFriday",(function(){return $m})),n.d(e,"timeFridays",(function(){return Qm})),n.d(e,"timeSaturday",(function(){return qm})),n.d(e,"timeSaturdays",(function(){return tg})),n.d(e,"timeMonth",(function(){return jm})),n.d(e,"timeMonths",(function(){return Fm})),n.d(e,"timeYear",(function(){return Nm})),n.d(e,"timeYears",(function(){return Dm})),n.d(e,"utcMinute",(function(){return my})),n.d(e,"utcMinutes",(function(){return gy})),n.d(e,"utcHour",(function(){return hy})),n.d(e,"utcHours",(function(){return fy})),n.d(e,"utcDay",(function(){return Lg})),n.d(e,"utcDays",(function(){return Rg})),n.d(e,"utcWeek",(function(){return vg})),n.d(e,"utcWeeks",(function(){return Mg})),n.d(e,"utcSunday",(function(){return vg})),n.d(e,"utcSundays",(function(){return Mg})),n.d(e,"utcMonday",(function(){return yg})),n.d(e,"utcMondays",(function(){return Eg})),n.d(e,"utcTuesday",(function(){return bg})),n.d(e,"utcTuesdays",(function(){return Tg})),n.d(e,"utcWednesday",(function(){return xg})),n.d(e,"utcWednesdays",(function(){return Ag})),n.d(e,"utcThursday",(function(){return _g})),n.d(e,"utcThursdays",(function(){return Cg})),n.d(e,"utcFriday",(function(){return wg})),n.d(e,"utcFridays",(function(){return Pg})),n.d(e,"utcSaturday",(function(){return Sg})),n.d(e,"utcSaturdays",(function(){return Og})),n.d(e,"utcMonth",(function(){return ly})),n.d(e,"utcMonths",(function(){return uy})),n.d(e,"utcYear",(function(){return Ng})),n.d(e,"utcYears",(function(){return Dg})),n.d(e,"timeFormatDefaultLocale",(function(){return ry})),n.d(e,"timeFormat",(function(){return Hg})),n.d(e,"timeParse",(function(){return Vg})),n.d(e,"utcFormat",(function(){return Gg})),n.d(e,"utcParse",(function(){return Wg})),n.d(e,"timeFormatLocale",(function(){return Bg})),n.d(e,"isoFormat",(function(){return Tw})),n.d(e,"isoParse",(function(){return Aw})),n.d(e,"now",(function(){return Hn})),n.d(e,"timer",(function(){return Wn})),n.d(e,"timerFlush",(function(){return $n})),n.d(e,"timeout",(function(){return Kn})),n.d(e,"interval",(function(){return Cw})),n.d(e,"transition",(function(){return Hr})),n.d(e,"active",(function(){return Zr})),n.d(e,"interrupt",(function(){return sr})),n.d(e,"voronoi",(function(){return fS})),n.d(e,"zoom",(function(){return AS})),n.d(e,"zoomTransform",(function(){return yS})),n.d(e,"zoomIdentity",(function(){return vS}));var r="5.16.0",i=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},o=function(t){var e;return 1===t.length&&(e=t,t=function(t,n){return i(e(t),n)}),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}};var a=o(i),s=a.right,c=a.left,l=s,u=function(t,e){null==e&&(e=d);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return o};function d(t,e){return[t,e]}var h=function(t,e,n){var r,i,o,a,s=t.length,c=e.length,l=new Array(s*c);for(null==n&&(n=d),r=o=0;r<s;++r)for(a=t[r],i=0;i<c;++i,++o)l[o]=n(a,e[i]);return l},f=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},p=function(t){return null===t?NaN:+t},m=function(t,e){var n,r,i=t.length,o=0,a=-1,s=0,c=0;if(null==e)for(;++a<i;)isNaN(n=p(t[a]))||(c+=(r=n-s)*(n-(s+=r/++o)));else for(;++a<i;)isNaN(n=p(e(t[a],a,t)))||(c+=(r=n-s)*(n-(s+=r/++o)));if(o>1)return c/(o-1)},g=function(t,e){var n=m(t,e);return n?Math.sqrt(n):n},v=function(t,e){var n,r,i,o=t.length,a=-1;if(null==e){for(;++a<o;)if(null!=(n=t[a])&&n>=n)for(r=i=n;++a<o;)null!=(n=t[a])&&(r>n&&(r=n),i<n&&(i=n))}else for(;++a<o;)if(null!=(n=e(t[a],a,t))&&n>=n)for(r=i=n;++a<o;)null!=(n=e(t[a],a,t))&&(r>n&&(r=n),i<n&&(i=n));return[r,i]},y=Array.prototype,b=y.slice,x=y.map,_=function(t){return function(){return t}},w=function(t){return t},S=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o},M=Math.sqrt(50),E=Math.sqrt(10),T=Math.sqrt(2),A=function(t,e,n){var r,i,o,a,s=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(a=C(t,e,n))||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),e=Math.floor(e/a),o=new Array(i=Math.ceil(e-t+1));++s<i;)o[s]=(t+s)*a;else for(t=Math.floor(t*a),e=Math.ceil(e*a),o=new Array(i=Math.ceil(t-e+1));++s<i;)o[s]=(t-s)/a;return r&&o.reverse(),o};function C(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=M?10:o>=E?5:o>=T?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=M?10:o>=E?5:o>=T?2:1)}function P(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=M?i*=10:o>=E?i*=5:o>=T&&(i*=2),e<t?-i:i}var O=function(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1},k=function(){var t=w,e=v,n=O;function r(r){var i,o,a=r.length,s=new Array(a);for(i=0;i<a;++i)s[i]=t(r[i],i,r);var c=e(s),u=c[0],d=c[1],h=n(s,u,d);Array.isArray(h)||(h=P(u,d,h),h=S(Math.ceil(u/h)*h,d,h));for(var f=h.length;h[0]<=u;)h.shift(),--f;for(;h[f-1]>d;)h.pop(),--f;var p,m=new Array(f+1);for(i=0;i<=f;++i)(p=m[i]=[]).x0=i>0?h[i-1]:u,p.x1=i<f?h[i]:d;for(i=0;i<a;++i)u<=(o=s[i])&&o<=d&&m[l(h,o,0,f)].push(r[i]);return m}return r.value=function(e){return arguments.length?(t="function"==typeof e?e:_(e),r):t},r.domain=function(t){return arguments.length?(e="function"==typeof t?t:_([t[0],t[1]]),r):e},r.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?_(b.call(t)):_(t),r):n},r},L=function(t,e,n){if(null==n&&(n=p),r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,o=Math.floor(i),a=+n(t[o],o,t);return a+(+n(t[o+1],o+1,t)-a)*(i-o)}},R=function(t,e,n){return t=x.call(t,p).sort(i),Math.ceil((n-e)/(2*(L(t,.75)-L(t,.25))*Math.pow(t.length,-1/3)))},I=function(t,e,n){return Math.ceil((n-e)/(3.5*g(t)*Math.pow(t.length,-1/3)))},N=function(t,e){var n,r,i=t.length,o=-1;if(null==e){for(;++o<i;)if(null!=(n=t[o])&&n>=n)for(r=n;++o<i;)null!=(n=t[o])&&n>r&&(r=n)}else for(;++o<i;)if(null!=(n=e(t[o],o,t))&&n>=n)for(r=n;++o<i;)null!=(n=e(t[o],o,t))&&n>r&&(r=n);return r},D=function(t,e){var n,r=t.length,i=r,o=-1,a=0;if(null==e)for(;++o<r;)isNaN(n=p(t[o]))?--i:a+=n;else for(;++o<r;)isNaN(n=p(e(t[o],o,t)))?--i:a+=n;if(i)return a/i},z=function(t,e){var n,r=t.length,o=-1,a=[];if(null==e)for(;++o<r;)isNaN(n=p(t[o]))||a.push(n);else for(;++o<r;)isNaN(n=p(e(t[o],o,t)))||a.push(n);return L(a.sort(i),.5)},j=function(t){for(var e,n,r,i=t.length,o=-1,a=0;++o<i;)a+=t[o].length;for(n=new Array(a);--i>=0;)for(e=(r=t[i]).length;--e>=0;)n[--a]=r[e];return n},F=function(t,e){var n,r,i=t.length,o=-1;if(null==e){for(;++o<i;)if(null!=(n=t[o])&&n>=n)for(r=n;++o<i;)null!=(n=t[o])&&r>n&&(r=n)}else for(;++o<i;)if(null!=(n=e(t[o],o,t))&&n>=n)for(r=n;++o<i;)null!=(n=e(t[o],o,t))&&r>n&&(r=n);return r},B=function(t,e){for(var n=e.length,r=new Array(n);n--;)r[n]=t[e[n]];return r},U=function(t,e){if(n=t.length){var n,r,o=0,a=0,s=t[a];for(null==e&&(e=i);++o<n;)(e(r=t[o],s)<0||0!==e(s,s))&&(s=r,a=o);return 0===e(s,s)?a:void 0}},H=function(t,e,n){for(var r,i,o=(null==n?t.length:n)-(e=null==e?0:+e);o;)i=Math.random()*o--|0,r=t[o+e],t[o+e]=t[i+e],t[i+e]=r;return t},V=function(t,e){var n,r=t.length,i=-1,o=0;if(null==e)for(;++i<r;)(n=+t[i])&&(o+=n);else for(;++i<r;)(n=+e(t[i],i,t))&&(o+=n);return o},G=function(t){if(!(i=t.length))return[];for(var e=-1,n=F(t,W),r=new Array(n);++e<n;)for(var i,o=-1,a=r[e]=new Array(i);++o<i;)a[o]=t[o][e];return r};function W(t){return t.length}var $=function(){return G(arguments)},q=Array.prototype.slice,X=function(t){return t};function Y(t){return"translate("+(t+.5)+",0)"}function K(t){return"translate(0,"+(t+.5)+")"}function Z(t){return function(e){return+t(e)}}function J(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}function Q(){return!this.__axis}function tt(t,e){var n=[],r=null,i=null,o=6,a=6,s=3,c=1===t||4===t?-1:1,l=4===t||2===t?"x":"y",u=1===t||3===t?Y:K;function d(d){var h=null==r?e.ticks?e.ticks.apply(e,n):e.domain():r,f=null==i?e.tickFormat?e.tickFormat.apply(e,n):X:i,p=Math.max(o,0)+s,m=e.range(),g=+m[0]+.5,v=+m[m.length-1]+.5,y=(e.bandwidth?J:Z)(e.copy()),b=d.selection?d.selection():d,x=b.selectAll(".domain").data([null]),_=b.selectAll(".tick").data(h,e).order(),w=_.exit(),S=_.enter().append("g").attr("class","tick"),M=_.select("line"),E=_.select("text");x=x.merge(x.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),_=_.merge(S),M=M.merge(S.append("line").attr("stroke","currentColor").attr(l+"2",c*o)),E=E.merge(S.append("text").attr("fill","currentColor").attr(l,c*p).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),d!==b&&(x=x.transition(d),_=_.transition(d),M=M.transition(d),E=E.transition(d),w=w.transition(d).attr("opacity",1e-6).attr("transform",(function(t){return isFinite(t=y(t))?u(t):this.getAttribute("transform")})),S.attr("opacity",1e-6).attr("transform",(function(t){var e=this.parentNode.__axis;return u(e&&isFinite(e=e(t))?e:y(t))}))),w.remove(),x.attr("d",4===t||2==t?a?"M"+c*a+","+g+"H0.5V"+v+"H"+c*a:"M0.5,"+g+"V"+v:a?"M"+g+","+c*a+"V0.5H"+v+"V"+c*a:"M"+g+",0.5H"+v),_.attr("opacity",1).attr("transform",(function(t){return u(y(t))})),M.attr(l+"2",c*o),E.attr(l,c*p).text(f),b.filter(Q).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),b.each((function(){this.__axis=y}))}return d.scale=function(t){return arguments.length?(e=t,d):e},d.ticks=function(){return n=q.call(arguments),d},d.tickArguments=function(t){return arguments.length?(n=null==t?[]:q.call(t),d):n.slice()},d.tickValues=function(t){return arguments.length?(r=null==t?null:q.call(t),d):r&&r.slice()},d.tickFormat=function(t){return arguments.length?(i=t,d):i},d.tickSize=function(t){return arguments.length?(o=a=+t,d):o},d.tickSizeInner=function(t){return arguments.length?(o=+t,d):o},d.tickSizeOuter=function(t){return arguments.length?(a=+t,d):a},d.tickPadding=function(t){return arguments.length?(s=+t,d):s},d}function et(t){return tt(1,t)}function nt(t){return tt(2,t)}function rt(t){return tt(3,t)}function it(t){return tt(4,t)}var ot={value:function(){}};function at(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new st(r)}function st(t){this._=t}function ct(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function lt(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function ut(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=ot,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}st.prototype=at.prototype={constructor:st,on:function(t,e){var n,r=this._,i=ct(t+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(n=(t=i[o]).type)r[n]=ut(r[n],t.name,e);else if(null==e)for(n in r)r[n]=ut(r[n],t.name,null);return this}for(;++o<a;)if((n=(t=i[o]).type)&&(n=lt(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new st(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var dt=at;function ht(){}var ft=function(t){return null==t?ht:function(){return this.querySelector(t)}};function pt(){return[]}var mt=function(t){return null==t?pt:function(){return this.querySelectorAll(t)}},gt=function(t){return function(){return this.matches(t)}},vt=function(t){return new Array(t.length)};function yt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}yt.prototype={constructor:yt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function bt(t,e,n,r,i,o){for(var a,s=0,c=e.length,l=o.length;s<l;++s)(a=e[s])?(a.__data__=o[s],r[s]=a):n[s]=new yt(t,o[s]);for(;s<c;++s)(a=e[s])&&(i[s]=a)}function xt(t,e,n,r,i,o,a){var s,c,l,u={},d=e.length,h=o.length,f=new Array(d);for(s=0;s<d;++s)(c=e[s])&&(f[s]=l="$"+a.call(c,c.__data__,s,e),l in u?i[s]=c:u[l]=c);for(s=0;s<h;++s)(c=u[l="$"+a.call(t,o[s],s,o)])?(r[s]=c,c.__data__=o[s],u[l]=null):n[s]=new yt(t,o[s]);for(s=0;s<d;++s)(c=e[s])&&u[f[s]]===c&&(i[s]=c)}function _t(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var wt="http://www.w3.org/1999/xhtml",St={svg:"http://www.w3.org/2000/svg",xhtml:wt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Mt=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),St.hasOwnProperty(e)?{space:St[e],local:t}:t};function Et(t){return function(){this.removeAttribute(t)}}function Tt(t){return function(){this.removeAttributeNS(t.space,t.local)}}function At(t,e){return function(){this.setAttribute(t,e)}}function Ct(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Pt(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function Ot(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}var kt=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function Lt(t){return function(){this.style.removeProperty(t)}}function Rt(t,e,n){return function(){this.style.setProperty(t,e,n)}}function It(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Nt(t,e){return t.style.getPropertyValue(e)||kt(t).getComputedStyle(t,null).getPropertyValue(e)}function Dt(t){return function(){delete this[t]}}function zt(t,e){return function(){this[t]=e}}function jt(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function Ft(t){return t.trim().split(/^|\s+/)}function Bt(t){return t.classList||new Ut(t)}function Ut(t){this._node=t,this._names=Ft(t.getAttribute("class")||"")}function Ht(t,e){for(var n=Bt(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Vt(t,e){for(var n=Bt(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Gt(t){return function(){Ht(this,t)}}function Wt(t){return function(){Vt(this,t)}}function $t(t,e){return function(){(e.apply(this,arguments)?Ht:Vt)(this,t)}}Ut.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function qt(){this.textContent=""}function Xt(t){return function(){this.textContent=t}}function Yt(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Kt(){this.innerHTML=""}function Zt(t){return function(){this.innerHTML=t}}function Jt(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Qt(){this.nextSibling&&this.parentNode.appendChild(this)}function te(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ee(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===wt&&e.documentElement.namespaceURI===wt?e.createElement(t):e.createElementNS(n,t)}}function ne(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}var re=function(t){var e=Mt(t);return(e.local?ne:ee)(e)};function ie(){return null}function oe(){var t=this.parentNode;t&&t.removeChild(this)}function ae(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function se(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}var ce={},le=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(ce={mouseenter:"mouseover",mouseleave:"mouseout"}));function ue(t,e,n){return t=de(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function de(t,e,n){return function(r){var i=le;le=r;try{t.call(this,this.__data__,e,n)}finally{le=i}}}function he(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function fe(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function pe(t,e,n){var r=ce.hasOwnProperty(t.type)?ue:de;return function(i,o,a){var s,c=this.__on,l=r(e,o,a);if(c)for(var u=0,d=c.length;u<d;++u)if((s=c[u]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=l,s.capture=n),void(s.value=e);this.addEventListener(t.type,l,n),s={type:t.type,name:t.name,value:e,listener:l,capture:n},c?c.push(s):this.__on=[s]}}function me(t,e,n,r){var i=le;t.sourceEvent=le,le=t;try{return e.apply(n,r)}finally{le=i}}function ge(t,e,n){var r=kt(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function ve(t,e){return function(){return ge(this,t,e)}}function ye(t,e){return function(){return ge(this,t,e.apply(this,arguments))}}var be=[null];function xe(t,e){this._groups=t,this._parents=e}function _e(){return new xe([[document.documentElement]],be)}xe.prototype=_e.prototype={constructor:xe,select:function(t){"function"!=typeof t&&(t=ft(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a,s=e[i],c=s.length,l=r[i]=new Array(c),u=0;u<c;++u)(o=s[u])&&(a=t.call(o,o.__data__,u,s))&&("__data__"in o&&(a.__data__=o.__data__),l[u]=a);return new xe(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=mt(t));for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var a,s=e[o],c=s.length,l=0;l<c;++l)(a=s[l])&&(r.push(t.call(a,a.__data__,l,s)),i.push(a));return new xe(r,i)},filter:function(t){"function"!=typeof t&&(t=gt(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,c=r[i]=[],l=0;l<s;++l)(o=a[l])&&t.call(o,o.__data__,l,a)&&c.push(o);return new xe(r,this._parents)},data:function(t,e){if(!t)return p=new Array(this.size()),u=-1,this.each((function(t){p[++u]=t})),p;var n,r=e?xt:bt,i=this._parents,o=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var a=o.length,s=new Array(a),c=new Array(a),l=new Array(a),u=0;u<a;++u){var d=i[u],h=o[u],f=h.length,p=t.call(d,d&&d.__data__,u,i),m=p.length,g=c[u]=new Array(m),v=s[u]=new Array(m);r(d,h,g,v,l[u]=new Array(f),p,e);for(var y,b,x=0,_=0;x<m;++x)if(y=g[x]){for(x>=_&&(_=x+1);!(b=v[_])&&++_<m;);y._next=b||null}}return(s=new xe(s,i))._enter=c,s._exit=l,s},enter:function(){return new xe(this._enter||this._groups.map(vt),this._parents)},exit:function(){return new xe(this._exit||this._groups.map(vt),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,o=this.exit();return r="function"==typeof t?t(r):r.append(t+""),null!=e&&(i=e(i)),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var c,l=e[s],u=n[s],d=l.length,h=a[s]=new Array(d),f=0;f<d;++f)(c=l[f]||u[f])&&(h[f]=c);for(;s<r;++s)a[s]=e[s];return new xe(a,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=_t);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,s=n[o],c=s.length,l=i[o]=new Array(c),u=0;u<c;++u)(a=s[u])&&(l[u]=a);l.sort(e)}return new xe(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],a=0,s=o.length;a<s;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,e){var n=Mt(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?Tt:Et:"function"==typeof e?n.local?Ot:Pt:n.local?Ct:At)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?Lt:"function"==typeof e?It:Rt)(t,e,null==n?"":n)):Nt(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?Dt:"function"==typeof e?jt:zt)(t,e)):this.node()[t]},classed:function(t,e){var n=Ft(t+"");if(arguments.length<2){for(var r=Bt(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?$t:e?Gt:Wt)(n,e))},text:function(t){return arguments.length?this.each(null==t?qt:("function"==typeof t?Yt:Xt)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Kt:("function"==typeof t?Jt:Zt)(t)):this.node().innerHTML},raise:function(){return this.each(Qt)},lower:function(){return this.each(te)},append:function(t){var e="function"==typeof t?t:re(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:re(t),r=null==e?ie:"function"==typeof e?e:ft(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(oe)},clone:function(t){return this.select(t?se:ae)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=he(t+""),a=o.length;if(!(arguments.length<2)){for(s=e?pe:fe,null==n&&(n=!1),r=0;r<a;++r)this.each(s(o[r],e,n));return this}var s=this.node().__on;if(s)for(var c,l=0,u=s.length;l<u;++l)for(r=0,c=s[l];r<a;++r)if((i=o[r]).type===c.type&&i.name===c.name)return c.value},dispatch:function(t,e){return this.each(("function"==typeof e?ye:ve)(t,e))}};var we=_e,Se=function(t){return"string"==typeof t?new xe([[document.querySelector(t)]],[document.documentElement]):new xe([[t]],be)};function Me(){le.stopImmediatePropagation()}var Ee=function(){le.preventDefault(),le.stopImmediatePropagation()},Te=function(t){var e=t.document.documentElement,n=Se(t).on("dragstart.drag",Ee,!0);"onselectstart"in e?n.on("selectstart.drag",Ee,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")};function Ae(t,e){var n=t.document.documentElement,r=Se(t).on("dragstart.drag",null);e&&(r.on("click.drag",Ee,!0),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var Ce=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function Pe(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Oe(){}var ke="\\s*([+-]?\\d+)\\s*",Le="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Re="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ie=/^#([0-9a-f]{3,8})$/,Ne=new RegExp("^rgb\\("+[ke,ke,ke]+"\\)$"),De=new RegExp("^rgb\\("+[Re,Re,Re]+"\\)$"),ze=new RegExp("^rgba\\("+[ke,ke,ke,Le]+"\\)$"),je=new RegExp("^rgba\\("+[Re,Re,Re,Le]+"\\)$"),Fe=new RegExp("^hsl\\("+[Le,Re,Re]+"\\)$"),Be=new RegExp("^hsla\\("+[Le,Re,Re,Le]+"\\)$"),Ue={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function He(){return this.rgb().formatHex()}function Ve(){return this.rgb().formatRgb()}function Ge(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Ie.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?We(e):3===n?new Ye(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?$e(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?$e(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Ne.exec(t))?new Ye(e[1],e[2],e[3],1):(e=De.exec(t))?new Ye(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=ze.exec(t))?$e(e[1],e[2],e[3],e[4]):(e=je.exec(t))?$e(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Fe.exec(t))?Qe(e[1],e[2]/100,e[3]/100,1):(e=Be.exec(t))?Qe(e[1],e[2]/100,e[3]/100,e[4]):Ue.hasOwnProperty(t)?We(Ue[t]):"transparent"===t?new Ye(NaN,NaN,NaN,0):null}function We(t){return new Ye(t>>16&255,t>>8&255,255&t,1)}function $e(t,e,n,r){return r<=0&&(t=e=n=NaN),new Ye(t,e,n,r)}function qe(t){return t instanceof Oe||(t=Ge(t)),t?new Ye((t=t.rgb()).r,t.g,t.b,t.opacity):new Ye}function Xe(t,e,n,r){return 1===arguments.length?qe(t):new Ye(t,e,n,null==r?1:r)}function Ye(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Ke(){return"#"+Je(this.r)+Je(this.g)+Je(this.b)}function Ze(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Je(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Qe(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new nn(t,e,n,r)}function tn(t){if(t instanceof nn)return new nn(t.h,t.s,t.l,t.opacity);if(t instanceof Oe||(t=Ge(t)),!t)return new nn;if(t instanceof nn)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,c=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=c<.5?o+i:2-o-i,a*=60):s=c>0&&c<1?0:a,new nn(a,s,c,t.opacity)}function en(t,e,n,r){return 1===arguments.length?tn(t):new nn(t,e,n,null==r?1:r)}function nn(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function rn(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function on(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}Ce(Oe,Ge,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:He,formatHex:He,formatHsl:function(){return tn(this).formatHsl()},formatRgb:Ve,toString:Ve}),Ce(Ye,Xe,Pe(Oe,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Ye(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Ye(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ke,formatHex:Ke,formatRgb:Ze,toString:Ze})),Ce(nn,en,Pe(Oe,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new nn(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new nn(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Ye(rn(t>=240?t-240:t+120,i,r),rn(t,i,r),rn(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var an=function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,s=r<e-1?t[r+2]:2*o-i;return on((n-r/e)*e,a,i,o,s)}},sn=function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],o=t[r%e],a=t[(r+1)%e],s=t[(r+2)%e];return on((n-r/e)*e,i,o,a,s)}},cn=function(t){return function(){return t}};function ln(t,e){return function(n){return t+n*e}}function un(t,e){var n=e-t;return n?ln(t,n>180||n<-180?n-360*Math.round(n/360):n):cn(isNaN(t)?e:t)}function dn(t){return 1==(t=+t)?hn:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):cn(isNaN(e)?n:e)}}function hn(t,e){var n=e-t;return n?ln(t,n):cn(isNaN(t)?e:t)}var fn=function t(e){var n=dn(e);function r(t,e){var r=n((t=Xe(t)).r,(e=Xe(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=hn(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function pn(t){return function(e){var n,r,i=e.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=Xe(e[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=t(o),a=t(a),s=t(s),r.opacity=1,function(t){return r.r=o(t),r.g=a(t),r.b=s(t),r+""}}}var mn=pn(an),gn=pn(sn),vn=function(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(n=0;n<r;++n)i[n]=t[n]*(1-o)+e[n]*o;return i}};function yn(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}var bn=function(t,e){return(yn(e)?vn:xn)(t,e)};function xn(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=Pn(t[n],e[n]);for(;n<r;++n)a[n]=e[n];return function(t){for(n=0;n<i;++n)a[n]=o[n](t);return a}}var _n=function(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}},wn=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},Sn=function(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=Pn(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}},Mn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,En=new RegExp(Mn.source,"g");var Tn,An,Cn=function(t,e){var n,r,i,o=Mn.lastIndex=En.lastIndex=0,a=-1,s=[],c=[];for(t+="",e+="";(n=Mn.exec(t))&&(r=En.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,c.push({i:a,x:wn(n,r)})),o=En.lastIndex;return o<e.length&&(i=e.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?c[0]?function(t){return function(e){return t(e)+""}}(c[0].x):function(t){return function(){return t}}(e):(e=c.length,function(t){for(var n,r=0;r<e;++r)s[(n=c[r]).i]=n.x(t);return s.join("")})},Pn=function(t,e){var n,r=typeof e;return null==e||"boolean"===r?cn(e):("number"===r?wn:"string"===r?(n=Ge(e))?(e=n,fn):Cn:e instanceof Ge?fn:e instanceof Date?_n:yn(e)?vn:Array.isArray(e)?xn:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Sn:wn)(t,e)},On=function(){for(var t,e=le;t=e.sourceEvent;)e=t;return e},kn=function(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]},Ln=function(t,e,n){arguments.length<3&&(n=e,e=On().changedTouches);for(var r,i=0,o=e?e.length:0;i<o;++i)if((r=e[i]).identifier===n)return kn(t,r);return null},Rn=function(t){var e=On();return e.changedTouches&&(e=e.changedTouches[0]),kn(t,e)},In=0,Nn=0,Dn=0,zn=0,jn=0,Fn=0,Bn="object"==typeof performance&&performance.now?performance:Date,Un="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Hn(){return jn||(Un(Vn),jn=Bn.now()+Fn)}function Vn(){jn=0}function Gn(){this._call=this._time=this._next=null}function Wn(t,e,n){var r=new Gn;return r.restart(t,e,n),r}function $n(){Hn(),++In;for(var t,e=Tn;e;)(t=jn-e._time)>=0&&e._call.call(null,t),e=e._next;--In}function qn(){jn=(zn=Bn.now())+Fn,In=Nn=0;try{$n()}finally{In=0,function(){var t,e,n=Tn,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Tn=e);An=t,Yn(r)}(),jn=0}}function Xn(){var t=Bn.now(),e=t-zn;e>1e3&&(Fn-=e,zn=t)}function Yn(t){In||(Nn&&(Nn=clearTimeout(Nn)),t-jn>24?(t<1/0&&(Nn=setTimeout(qn,t-Bn.now()-Fn)),Dn&&(Dn=clearInterval(Dn))):(Dn||(zn=Bn.now(),Dn=setInterval(Xn,1e3)),In=1,Un(qn)))}Gn.prototype=Wn.prototype={constructor:Gn,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Hn():+n)+(null==e?0:+e),this._next||An===this||(An?An._next=this:Tn=this,An=this),this._call=t,this._time=n,Yn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Yn())}};var Kn=function(t,e,n){var r=new Gn;return e=null==e?0:+e,r.restart((function(n){r.stop(),t(n+e)}),e,n),r},Zn=dt("start","end","cancel","interrupt"),Jn=[],Qn=function(t,e,n,r,i,o){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function o(c){var l,u,d,h;if(1!==n.state)return s();for(l in i)if((h=i[l]).name===n.name){if(3===h.state)return Kn(o);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete i[l]):+l<e&&(h.state=6,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete i[l])}if(Kn((function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(c))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(d=n.tween.length),l=0,u=-1;l<d;++l)(h=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(r[++u]=h);r.length=u+1}}function a(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(s),n.state=5,1),o=-1,a=r.length;++o<a;)r[o].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),s())}function s(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=Wn((function(t){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}),0,n.time)}(t,n,{name:e,index:r,group:i,on:Zn,tween:Jn,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})};function tr(t,e){var n=nr(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function er(t,e){var n=nr(t,e);if(n.state>3)throw new Error("too late; already running");return n}function nr(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}var rr,ir,or,ar,sr=function(t,e){var n,r,i,o=t.__transition,a=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[i]):a=!1;a&&delete t.__transition}},cr=180/Math.PI,lr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},ur=function(t,e,n,r,i,o){var a,s,c;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),t*r<e*n&&(t=-t,e=-e,c=-c,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*cr,skewX:Math.atan(c)*cr,scaleX:a,scaleY:s}};function dr(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var s=[],c=[];return o=t(o),a=t(a),function(t,r,i,o,a,s){if(t!==i||r!==o){var c=a.push("translate(",null,e,null,n);s.push({i:c-4,x:wn(t,i)},{i:c-2,x:wn(r,o)})}else(i||o)&&a.push("translate("+i+e+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,c),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:wn(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,a.rotate,s,c),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:wn(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,a.skewX,s,c),function(t,e,n,r,o,a){if(t!==n||e!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:wn(t,n)},{i:s-2,x:wn(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,c),o=a=null,function(t){for(var e,n=-1,r=c.length;++n<r;)s[(e=c[n]).i]=e.x(t);return s.join("")}}}var hr=dr((function(t){return"none"===t?lr:(rr||(rr=document.createElement("DIV"),ir=document.documentElement,or=document.defaultView),rr.style.transform=t,t=or.getComputedStyle(ir.appendChild(rr),null).getPropertyValue("transform"),ir.removeChild(rr),t=t.slice(7,-1).split(","),ur(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}),"px, ","px)","deg)"),fr=dr((function(t){return null==t?lr:(ar||(ar=document.createElementNS("http://www.w3.org/2000/svg","g")),ar.setAttribute("transform",t),(t=ar.transform.baseVal.consolidate())?(t=t.matrix,ur(t.a,t.b,t.c,t.d,t.e,t.f)):lr)}),", ",")",")");function pr(t,e){var n,r;return function(){var i=er(this,t),o=i.tween;if(o!==n)for(var a=0,s=(r=n=o).length;a<s;++a)if(r[a].name===e){(r=r.slice()).splice(a,1);break}i.tween=r}}function mr(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=er(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:e,value:n},c=0,l=i.length;c<l;++c)if(i[c].name===e){i[c]=s;break}c===l&&i.push(s)}o.tween=i}}function gr(t,e,n){var r=t._id;return t.each((function(){var t=er(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return nr(t,r).value[e]}}var vr=function(t,e){var n;return("number"==typeof e?wn:e instanceof Ge?fn:(n=Ge(e))?(e=n,fn):Cn)(t,e)};function yr(t){return function(){this.removeAttribute(t)}}function br(t){return function(){this.removeAttributeNS(t.space,t.local)}}function xr(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttribute(t);return a===o?null:a===r?i:i=e(r=a,n)}}function _r(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===r?i:i=e(r=a,n)}}function wr(t,e,n){var r,i,o;return function(){var a,s,c=n(this);if(null!=c)return(a=this.getAttribute(t))===(s=c+"")?null:a===r&&s===i?o:(i=s,o=e(r=a,c));this.removeAttribute(t)}}function Sr(t,e,n){var r,i,o;return function(){var a,s,c=n(this);if(null!=c)return(a=this.getAttributeNS(t.space,t.local))===(s=c+"")?null:a===r&&s===i?o:(i=s,o=e(r=a,c));this.removeAttributeNS(t.space,t.local)}}function Mr(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Er(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Tr(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&Er(t,i)),n}return i._value=e,i}function Ar(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&Mr(t,i)),n}return i._value=e,i}function Cr(t,e){return function(){tr(this,t).delay=+e.apply(this,arguments)}}function Pr(t,e){return e=+e,function(){tr(this,t).delay=e}}function Or(t,e){return function(){er(this,t).duration=+e.apply(this,arguments)}}function kr(t,e){return e=+e,function(){er(this,t).duration=e}}function Lr(t,e){if("function"!=typeof e)throw new Error;return function(){er(this,t).ease=e}}function Rr(t,e,n){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?tr:er;return function(){var a=o(this,t),s=a.on;s!==r&&(i=(r=s).copy()).on(e,n),a.on=i}}var Ir=we.prototype.constructor;function Nr(t){return function(){this.style.removeProperty(t)}}function Dr(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function zr(t,e,n){var r,i;function o(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&Dr(t,o,n)),r}return o._value=e,o}function jr(t){return function(e){this.textContent=t.call(this,e)}}function Fr(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&jr(r)),e}return r._value=t,r}var Br=0;function Ur(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Hr(t){return we().transition(t)}function Vr(){return++Br}var Gr=we.prototype;function Wr(t){return t*t*t}function $r(t){return--t*t*t+1}function qr(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}Ur.prototype=Hr.prototype={constructor:Ur,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=ft(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s,c,l=r[a],u=l.length,d=o[a]=new Array(u),h=0;h<u;++h)(s=l[h])&&(c=t.call(s,s.__data__,h,l))&&("__data__"in s&&(c.__data__=s.__data__),d[h]=c,Qn(d[h],e,n,h,d,nr(s,n)));return new Ur(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=mt(t));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var c,l=r[s],u=l.length,d=0;d<u;++d)if(c=l[d]){for(var h,f=t.call(c,c.__data__,d,l),p=nr(c,n),m=0,g=f.length;m<g;++m)(h=f[m])&&Qn(h,e,n,m,f,p);o.push(f),a.push(c)}return new Ur(o,a,e,n)},filter:function(t){"function"!=typeof t&&(t=gt(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,c=r[i]=[],l=0;l<s;++l)(o=a[l])&&t.call(o,o.__data__,l,a)&&c.push(o);return new Ur(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var c,l=e[s],u=n[s],d=l.length,h=a[s]=new Array(d),f=0;f<d;++f)(c=l[f]||u[f])&&(h[f]=c);for(;s<r;++s)a[s]=e[s];return new Ur(a,this._parents,this._name,this._id)},selection:function(){return new Ir(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=Vr(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],c=s.length,l=0;l<c;++l)if(a=s[l]){var u=nr(a,e);Qn(a,t,n,l,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Ur(r,this._parents,t,n)},call:Gr.call,nodes:Gr.nodes,node:Gr.node,size:Gr.size,empty:Gr.empty,each:Gr.each,on:function(t,e){var n=this._id;return arguments.length<2?nr(this.node(),n).on.on(t):this.each(Rr(n,t,e))},attr:function(t,e){var n=Mt(t),r="transform"===n?fr:vr;return this.attrTween(t,"function"==typeof e?(n.local?Sr:wr)(n,r,gr(this,"attr."+t,e)):null==e?(n.local?br:yr)(n):(n.local?_r:xr)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=Mt(t);return this.tween(n,(r.local?Tr:Ar)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?hr:vr;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var o=Nt(this,t),a=(this.style.removeProperty(t),Nt(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}(t,r)).on("end.style."+t,Nr(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,o;return function(){var a=Nt(this,t),s=n(this),c=s+"";return null==s&&(this.style.removeProperty(t),c=s=Nt(this,t)),a===c?null:a===r&&c===i?o:(i=c,o=e(r=a,s))}}(t,r,gr(this,"style."+t,e))).each(function(t,e){var n,r,i,o,a="style."+e,s="end."+a;return function(){var c=er(this,t),l=c.on,u=null==c.value[a]?o||(o=Nr(e)):void 0;l===n&&i===u||(r=(n=l).copy()).on(s,i=u),c.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,o=n+"";return function(){var a=Nt(this,t);return a===o?null:a===r?i:i=e(r=a,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,zr(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(gr(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,Fr(t))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=nr(this.node(),n).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?pr:mr)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Cr:Pr)(e,t)):nr(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Or:kr)(e,t)):nr(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(Lr(e,t)):nr(this.node(),e).ease},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(o,a){var s={value:a},c={value:function(){0==--i&&o()}};n.each((function(){var n=er(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(c)),n.on=e}))}))}};var Xr={time:null,delay:0,duration:250,ease:qr};function Yr(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return Xr.time=Hn(),Xr;return n}we.prototype.interrupt=function(t){return this.each((function(){sr(this,t)}))},we.prototype.transition=function(t){var e,n;t instanceof Ur?(e=t._id,t=t._name):(e=Vr(),(n=Xr).time=Hn(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],c=s.length,l=0;l<c;++l)(a=s[l])&&Qn(a,t,e,l,s,n||Yr(a,e));return new Ur(r,this._parents,t,e)};var Kr=[null],Zr=function(t,e){var n,r,i=t.__transition;if(i)for(r in e=null==e?null:e+"",i)if((n=i[r]).state>1&&n.name===e)return new Ur([[t]],Kr,e,+r);return null},Jr=function(t){return function(){return t}},Qr=function(t,e,n){this.target=t,this.type=e,this.selection=n};function ti(){le.stopImmediatePropagation()}var ei=function(){le.preventDefault(),le.stopImmediatePropagation()},ni={name:"drag"},ri={name:"space"},ii={name:"handle"},oi={name:"center"};function ai(t){return[+t[0],+t[1]]}function si(t){return[ai(t[0]),ai(t[1])]}function ci(t){return function(e){return Ln(e,le.touches,t)}}var li={name:"x",handles:["w","e"].map(vi),input:function(t,e){return null==t?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},ui={name:"y",handles:["n","s"].map(vi),input:function(t,e){return null==t?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},di={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(vi),input:function(t){return null==t?null:si(t)},output:function(t){return t}},hi={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},fi={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},pi={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},mi={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},gi={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function vi(t){return{type:t}}function yi(){return!le.ctrlKey&&!le.button}function bi(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function xi(){return navigator.maxTouchPoints||"ontouchstart"in this}function _i(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function wi(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function Si(t){var e=t.__brush;return e?e.dim.output(e.selection):null}function Mi(){return Ai(li)}function Ei(){return Ai(ui)}var Ti=function(){return Ai(di)};function Ai(t){var e,n=bi,r=yi,i=xi,o=!0,a=dt("start","brush","end"),s=6;function c(e){var n=e.property("__brush",m).selectAll(".overlay").data([vi("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",hi.overlay).merge(n).each((function(){var t=_i(this).extent;Se(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])})),e.selectAll(".selection").data([vi("selection")]).enter().append("rect").attr("class","selection").attr("cursor",hi.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var r=e.selectAll(".handle").data(t.handles,(function(t){return t.type}));r.exit().remove(),r.enter().append("rect").attr("class",(function(t){return"handle handle--"+t.type})).attr("cursor",(function(t){return hi[t.type]})),e.each(l).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",h).filter(i).on("touchstart.brush",h).on("touchmove.brush",f).on("touchend.brush touchcancel.brush",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function l(){var t=Se(this),e=_i(this).selection;e?(t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]),t.selectAll(".handle").style("display",null).attr("x",(function(t){return"e"===t.type[t.type.length-1]?e[1][0]-s/2:e[0][0]-s/2})).attr("y",(function(t){return"s"===t.type[0]?e[1][1]-s/2:e[0][1]-s/2})).attr("width",(function(t){return"n"===t.type||"s"===t.type?e[1][0]-e[0][0]+s:s})).attr("height",(function(t){return"e"===t.type||"w"===t.type?e[1][1]-e[0][1]+s:s}))):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function u(t,e,n){return!n&&t.__brush.emitter||new d(t,e)}function d(t,e){this.that=t,this.args=e,this.state=t.__brush,this.active=0}function h(){if((!e||le.touches)&&r.apply(this,arguments)){var n,i,a,s,c,d,h,f,p,m,g,v=this,y=le.target.__data__.type,b="selection"===(o&&le.metaKey?y="overlay":y)?ni:o&&le.altKey?oi:ii,x=t===ui?null:mi[y],_=t===li?null:gi[y],w=_i(v),S=w.extent,M=w.selection,E=S[0][0],T=S[0][1],A=S[1][0],C=S[1][1],P=0,O=0,k=x&&_&&o&&le.shiftKey,L=le.touches?ci(le.changedTouches[0].identifier):Rn,R=L(v),I=R,N=u(v,arguments,!0).beforestart();"overlay"===y?(M&&(p=!0),w.selection=M=[[n=t===ui?E:R[0],a=t===li?T:R[1]],[c=t===ui?A:n,h=t===li?C:a]]):(n=M[0][0],a=M[0][1],c=M[1][0],h=M[1][1]),i=n,s=a,d=c,f=h;var D=Se(v).attr("pointer-events","none"),z=D.selectAll(".overlay").attr("cursor",hi[y]);if(le.touches)N.moved=F,N.ended=U;else{var j=Se(le.view).on("mousemove.brush",F,!0).on("mouseup.brush",U,!0);o&&j.on("keydown.brush",H,!0).on("keyup.brush",V,!0),Te(le.view)}ti(),sr(v),l.call(v),N.start()}function F(){var t=L(v);!k||m||g||(Math.abs(t[0]-I[0])>Math.abs(t[1]-I[1])?g=!0:m=!0),I=t,p=!0,ei(),B()}function B(){var t;switch(P=I[0]-R[0],O=I[1]-R[1],b){case ri:case ni:x&&(P=Math.max(E-n,Math.min(A-c,P)),i=n+P,d=c+P),_&&(O=Math.max(T-a,Math.min(C-h,O)),s=a+O,f=h+O);break;case ii:x<0?(P=Math.max(E-n,Math.min(A-n,P)),i=n+P,d=c):x>0&&(P=Math.max(E-c,Math.min(A-c,P)),i=n,d=c+P),_<0?(O=Math.max(T-a,Math.min(C-a,O)),s=a+O,f=h):_>0&&(O=Math.max(T-h,Math.min(C-h,O)),s=a,f=h+O);break;case oi:x&&(i=Math.max(E,Math.min(A,n-P*x)),d=Math.max(E,Math.min(A,c+P*x))),_&&(s=Math.max(T,Math.min(C,a-O*_)),f=Math.max(T,Math.min(C,h+O*_)))}d<i&&(x*=-1,t=n,n=c,c=t,t=i,i=d,d=t,y in fi&&z.attr("cursor",hi[y=fi[y]])),f<s&&(_*=-1,t=a,a=h,h=t,t=s,s=f,f=t,y in pi&&z.attr("cursor",hi[y=pi[y]])),w.selection&&(M=w.selection),m&&(i=M[0][0],d=M[1][0]),g&&(s=M[0][1],f=M[1][1]),M[0][0]===i&&M[0][1]===s&&M[1][0]===d&&M[1][1]===f||(w.selection=[[i,s],[d,f]],l.call(v),N.brush())}function U(){if(ti(),le.touches){if(le.touches.length)return;e&&clearTimeout(e),e=setTimeout((function(){e=null}),500)}else Ae(le.view,p),j.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);D.attr("pointer-events","all"),z.attr("cursor",hi.overlay),w.selection&&(M=w.selection),wi(M)&&(w.selection=null,l.call(v)),N.end()}function H(){switch(le.keyCode){case 16:k=x&&_;break;case 18:b===ii&&(x&&(c=d-P*x,n=i+P*x),_&&(h=f-O*_,a=s+O*_),b=oi,B());break;case 32:b!==ii&&b!==oi||(x<0?c=d-P:x>0&&(n=i-P),_<0?h=f-O:_>0&&(a=s-O),b=ri,z.attr("cursor",hi.selection),B());break;default:return}ei()}function V(){switch(le.keyCode){case 16:k&&(m=g=k=!1,B());break;case 18:b===oi&&(x<0?c=d:x>0&&(n=i),_<0?h=f:_>0&&(a=s),b=ii,B());break;case 32:b===ri&&(le.altKey?(x&&(c=d-P*x,n=i+P*x),_&&(h=f-O*_,a=s+O*_),b=oi):(x<0?c=d:x>0&&(n=i),_<0?h=f:_>0&&(a=s),b=ii),z.attr("cursor",hi[y]),B());break;default:return}ei()}}function f(){u(this,arguments).moved()}function p(){u(this,arguments).ended()}function m(){var e=this.__brush||{selection:null};return e.extent=si(n.apply(this,arguments)),e.dim=t,e}return c.move=function(e,n){e.selection?e.on("start.brush",(function(){u(this,arguments).beforestart().start()})).on("interrupt.brush end.brush",(function(){u(this,arguments).end()})).tween("brush",(function(){var e=this,r=e.__brush,i=u(e,arguments),o=r.selection,a=t.input("function"==typeof n?n.apply(this,arguments):n,r.extent),s=Pn(o,a);function c(t){r.selection=1===t&&null===a?null:s(t),l.call(e),i.brush()}return null!==o&&null!==a?c:c(1)})):e.each((function(){var e=this,r=arguments,i=e.__brush,o=t.input("function"==typeof n?n.apply(e,r):n,i.extent),a=u(e,r).beforestart();sr(e),i.selection=null===o?null:o,l.call(e),a.start().brush().end()}))},c.clear=function(t){c.move(t,null)},d.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting?(this.starting=!1,this.emit("start")):this.emit("brush"),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(e){me(new Qr(c,e,t.output(this.state.selection)),a.apply,a,[e,this.that,this.args])}},c.extent=function(t){return arguments.length?(n="function"==typeof t?t:Jr(si(t)),c):n},c.filter=function(t){return arguments.length?(r="function"==typeof t?t:Jr(!!t),c):r},c.touchable=function(t){return arguments.length?(i="function"==typeof t?t:Jr(!!t),c):i},c.handleSize=function(t){return arguments.length?(s=+t,c):s},c.keyModifiers=function(t){return arguments.length?(o=!!t,c):o},c.on=function(){var t=a.on.apply(a,arguments);return t===a?c:t},c}var Ci=Math.cos,Pi=Math.sin,Oi=Math.PI,ki=Oi/2,Li=2*Oi,Ri=Math.max;function Ii(t){return function(e,n){return t(e.source.value+e.target.value,n.source.value+n.target.value)}}var Ni=function(){var t=0,e=null,n=null,r=null;function i(i){var o,a,s,c,l,u,d=i.length,h=[],f=S(d),p=[],m=[],g=m.groups=new Array(d),v=new Array(d*d);for(o=0,l=-1;++l<d;){for(a=0,u=-1;++u<d;)a+=i[l][u];h.push(a),p.push(S(d)),o+=a}for(e&&f.sort((function(t,n){return e(h[t],h[n])})),n&&p.forEach((function(t,e){t.sort((function(t,r){return n(i[e][t],i[e][r])}))})),c=(o=Ri(0,Li-t*d)/o)?t:Li/d,a=0,l=-1;++l<d;){for(s=a,u=-1;++u<d;){var y=f[l],b=p[y][u],x=i[y][b],_=a,w=a+=x*o;v[b*d+y]={index:y,subindex:b,startAngle:_,endAngle:w,value:x}}g[y]={index:y,startAngle:s,endAngle:a,value:h[y]},a+=c}for(l=-1;++l<d;)for(u=l-1;++u<d;){var M=v[u*d+l],E=v[l*d+u];(M.value||E.value)&&m.push(M.value<E.value?{source:E,target:M}:{source:M,target:E})}return r?m.sort(r):m}return i.padAngle=function(e){return arguments.length?(t=Ri(0,e),i):t},i.sortGroups=function(t){return arguments.length?(e=t,i):e},i.sortSubgroups=function(t){return arguments.length?(n=t,i):n},i.sortChords=function(t){return arguments.length?(null==t?r=null:(r=Ii(t))._=t,i):r&&r._},i},Di=Array.prototype.slice,zi=function(t){return function(){return t}},ji=Math.PI,Fi=2*ji,Bi=Fi-1e-6;function Ui(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Hi(){return new Ui}Ui.prototype=Hi.prototype={constructor:Ui,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var o=this._x1,a=this._y1,s=n-t,c=r-e,l=o-t,u=a-e,d=l*l+u*u;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(d>1e-6)if(Math.abs(u*s-c*l)>1e-6&&i){var h=n-o,f=r-a,p=s*s+c*c,m=h*h+f*f,g=Math.sqrt(p),v=Math.sqrt(d),y=i*Math.tan((ji-Math.acos((p+d-m)/(2*g*v)))/2),b=y/v,x=y/g;Math.abs(b-1)>1e-6&&(this._+="L"+(t+b*l)+","+(e+b*u)),this._+="A"+i+","+i+",0,0,"+ +(u*h>l*f)+","+(this._x1=t+x*s)+","+(this._y1=e+x*c)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,r,i,o){t=+t,e=+e,o=!!o;var a=(n=+n)*Math.cos(r),s=n*Math.sin(r),c=t+a,l=e+s,u=1^o,d=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+c+","+l:(Math.abs(this._x1-c)>1e-6||Math.abs(this._y1-l)>1e-6)&&(this._+="L"+c+","+l),n&&(d<0&&(d=d%Fi+Fi),d>Bi?this._+="A"+n+","+n+",0,1,"+u+","+(t-a)+","+(e-s)+"A"+n+","+n+",0,1,"+u+","+(this._x1=c)+","+(this._y1=l):d>1e-6&&(this._+="A"+n+","+n+",0,"+ +(d>=ji)+","+u+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var Vi=Hi;function Gi(t){return t.source}function Wi(t){return t.target}function $i(t){return t.radius}function qi(t){return t.startAngle}function Xi(t){return t.endAngle}var Yi=function(){var t=Gi,e=Wi,n=$i,r=qi,i=Xi,o=null;function a(){var a,s=Di.call(arguments),c=t.apply(this,s),l=e.apply(this,s),u=+n.apply(this,(s[0]=c,s)),d=r.apply(this,s)-ki,h=i.apply(this,s)-ki,f=u*Ci(d),p=u*Pi(d),m=+n.apply(this,(s[0]=l,s)),g=r.apply(this,s)-ki,v=i.apply(this,s)-ki;if(o||(o=a=Vi()),o.moveTo(f,p),o.arc(0,0,u,d,h),d===g&&h===v||(o.quadraticCurveTo(0,0,m*Ci(g),m*Pi(g)),o.arc(0,0,m,g,v)),o.quadraticCurveTo(0,0,f,p),o.closePath(),a)return o=null,a+""||null}return a.radius=function(t){return arguments.length?(n="function"==typeof t?t:zi(+t),a):n},a.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:zi(+t),a):r},a.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:zi(+t),a):i},a.source=function(e){return arguments.length?(t=e,a):t},a.target=function(t){return arguments.length?(e=t,a):e},a.context=function(t){return arguments.length?(o=null==t?null:t,a):o},a};function Ki(){}function Zi(t,e){var n=new Ki;if(t instanceof Ki)t.each((function(t,e){n.set(e,t)}));else if(Array.isArray(t)){var r,i=-1,o=t.length;if(null==e)for(;++i<o;)n.set(i,t[i]);else for(;++i<o;)n.set(e(r=t[i],i,t),r)}else if(t)for(var a in t)n.set(a,t[a]);return n}Ki.prototype=Zi.prototype={constructor:Ki,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,e){return this["$"+t]=e,this},remove:function(t){var e="$"+t;return e in this&&delete this[e]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)"$"===e[0]&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)"$"===e[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var e in this)"$"===e[0]&&t(this[e],e.slice(1),this)}};var Ji=Zi,Qi=function(){var t,e,n,r=[],i=[];function o(n,i,a,s){if(i>=r.length)return null!=t&&n.sort(t),null!=e?e(n):n;for(var c,l,u,d=-1,h=n.length,f=r[i++],p=Ji(),m=a();++d<h;)(u=p.get(c=f(l=n[d])+""))?u.push(l):p.set(c,[l]);return p.each((function(t,e){s(m,e,o(t,i,a,s))})),m}return n={object:function(t){return o(t,0,to,eo)},map:function(t){return o(t,0,no,ro)},entries:function(t){return function t(n,o){if(++o>r.length)return n;var a,s=i[o-1];return null!=e&&o>=r.length?a=n.entries():(a=[],n.each((function(e,n){a.push({key:n,values:t(e,o)})}))),null!=s?a.sort((function(t,e){return s(t.key,e.key)})):a}(o(t,0,no,ro),0)},key:function(t){return r.push(t),n},sortKeys:function(t){return i[r.length-1]=t,n},sortValues:function(e){return t=e,n},rollup:function(t){return e=t,n}}};function to(){return{}}function eo(t,e,n){t[e]=n}function no(){return Ji()}function ro(t,e,n){t.set(e,n)}function io(){}var oo=Ji.prototype;function ao(t,e){var n=new io;if(t instanceof io)t.each((function(t){n.add(t)}));else if(t){var r=-1,i=t.length;if(null==e)for(;++r<i;)n.add(t[r]);else for(;++r<i;)n.add(e(t[r],r,t))}return n}io.prototype=ao.prototype={constructor:io,has:oo.has,add:function(t){return this["$"+(t+="")]=t,this},remove:oo.remove,clear:oo.clear,values:oo.keys,size:oo.size,empty:oo.empty,each:oo.each};var so=ao,co=function(t){var e=[];for(var n in t)e.push(n);return e},lo=function(t){var e=[];for(var n in t)e.push(t[n]);return e},uo=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},ho=Math.PI/180,fo=180/Math.PI;function po(t){if(t instanceof vo)return new vo(t.l,t.a,t.b,t.opacity);if(t instanceof Eo)return To(t);t instanceof Ye||(t=qe(t));var e,n,r=_o(t.r),i=_o(t.g),o=_o(t.b),a=yo((.2225045*r+.7168786*i+.0606169*o)/1);return r===i&&i===o?e=n=a:(e=yo((.4360747*r+.3850649*i+.1430804*o)/.96422),n=yo((.0139322*r+.0971045*i+.7141733*o)/.82521)),new vo(116*a-16,500*(e-a),200*(a-n),t.opacity)}function mo(t,e){return new vo(t,0,0,null==e?1:e)}function go(t,e,n,r){return 1===arguments.length?po(t):new vo(t,e,n,null==r?1:r)}function vo(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function yo(t){return t>6/29*(6/29)*(6/29)?Math.pow(t,1/3):t/(6/29*3*(6/29))+4/29}function bo(t){return t>6/29?t*t*t:6/29*3*(6/29)*(t-4/29)}function xo(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function _o(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function wo(t){if(t instanceof Eo)return new Eo(t.h,t.c,t.l,t.opacity);if(t instanceof vo||(t=po(t)),0===t.a&&0===t.b)return new Eo(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*fo;return new Eo(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function So(t,e,n,r){return 1===arguments.length?wo(t):new Eo(n,e,t,null==r?1:r)}function Mo(t,e,n,r){return 1===arguments.length?wo(t):new Eo(t,e,n,null==r?1:r)}function Eo(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function To(t){if(isNaN(t.h))return new vo(t.l,0,0,t.opacity);var e=t.h*ho;return new vo(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}Ce(vo,go,Pe(Oe,{brighter:function(t){return new vo(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new vo(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new Ye(xo(3.1338561*(e=.96422*bo(e))-1.6168667*(t=1*bo(t))-.4906146*(n=.82521*bo(n))),xo(-.9787684*e+1.9161415*t+.033454*n),xo(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),Ce(Eo,Mo,Pe(Oe,{brighter:function(t){return new Eo(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new Eo(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return To(this).rgb()}}));var Ao=-.29227,Co=-1.7884503806,Po=3.5172982438,Oo=-.6557636667999999;function ko(t){if(t instanceof Ro)return new Ro(t.h,t.s,t.l,t.opacity);t instanceof Ye||(t=qe(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(Oo*r+Co*e-Po*n)/(Oo+Co-Po),o=r-i,a=(1.97294*(n-i)-Ao*o)/-.90649,s=Math.sqrt(a*a+o*o)/(1.97294*i*(1-i)),c=s?Math.atan2(a,o)*fo-120:NaN;return new Ro(c<0?c+360:c,s,i,t.opacity)}function Lo(t,e,n,r){return 1===arguments.length?ko(t):new Ro(t,e,n,null==r?1:r)}function Ro(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Ce(Ro,Lo,Pe(Oe,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Ro(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Ro(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*ho,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new Ye(255*(e+n*(-.14861*r+1.78277*i)),255*(e+n*(Ao*r+-.90649*i)),255*(e+n*(1.97294*r)),this.opacity)}}));var Io=Array.prototype.slice,No=function(t,e){return t-e},Do=function(t){return function(){return t}},zo=function(t,e){for(var n,r=-1,i=e.length;++r<i;)if(n=jo(t,e[r]))return n;return 0};function jo(t,e){for(var n=e[0],r=e[1],i=-1,o=0,a=t.length,s=a-1;o<a;s=o++){var c=t[o],l=c[0],u=c[1],d=t[s],h=d[0],f=d[1];if(Fo(c,d,e))return 0;u>r!=f>r&&n<(h-l)*(r-u)/(f-u)+l&&(i=-i)}return i}function Fo(t,e,n){var r,i,o,a;return function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])==(n[0]-t[0])*(e[1]-t[1])}(t,e,n)&&(i=t[r=+(t[0]===e[0])],o=n[r],a=e[r],i<=o&&o<=a||a<=o&&o<=i)}var Bo=function(){},Uo=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]],Ho=function(){var t=1,e=1,n=O,r=s;function i(t){var e=n(t);if(Array.isArray(e))e=e.slice().sort(No);else{var r=v(t),i=r[0],a=r[1];e=P(i,a,e),e=S(Math.floor(i/e)*e,Math.floor(a/e)*e,e)}return e.map((function(e){return o(t,e)}))}function o(n,i){var o=[],s=[];return function(n,r,i){var o,s,c,l,u,d,h=new Array,f=new Array;o=s=-1,l=n[0]>=r,Uo[l<<1].forEach(p);for(;++o<t-1;)c=l,l=n[o+1]>=r,Uo[c|l<<1].forEach(p);Uo[l<<0].forEach(p);for(;++s<e-1;){for(o=-1,l=n[s*t+t]>=r,u=n[s*t]>=r,Uo[l<<1|u<<2].forEach(p);++o<t-1;)c=l,l=n[s*t+t+o+1]>=r,d=u,u=n[s*t+o+1]>=r,Uo[c|l<<1|u<<2|d<<3].forEach(p);Uo[l|u<<3].forEach(p)}o=-1,u=n[s*t]>=r,Uo[u<<2].forEach(p);for(;++o<t-1;)d=u,u=n[s*t+o+1]>=r,Uo[u<<2|d<<3].forEach(p);function p(t){var e,n,r=[t[0][0]+o,t[0][1]+s],c=[t[1][0]+o,t[1][1]+s],l=a(r),u=a(c);(e=f[l])?(n=h[u])?(delete f[e.end],delete h[n.start],e===n?(e.ring.push(c),i(e.ring)):h[e.start]=f[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete f[e.end],e.ring.push(c),f[e.end=u]=e):(e=h[u])?(n=f[l])?(delete h[e.start],delete f[n.end],e===n?(e.ring.push(c),i(e.ring)):h[n.start]=f[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete h[e.start],e.ring.unshift(r),h[e.start=l]=e):h[l]=f[u]={start:l,end:u,ring:[r,c]}}Uo[u<<3].forEach(p)}(n,i,(function(t){r(t,n,i),function(t){for(var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r}(t)>0?o.push([t]):s.push(t)})),s.forEach((function(t){for(var e,n=0,r=o.length;n<r;++n)if(-1!==zo((e=o[n])[0],t))return void e.push(t)})),{type:"MultiPolygon",value:i,coordinates:o}}function a(e){return 2*e[0]+e[1]*(t+1)*4}function s(n,r,i){n.forEach((function(n){var o,a=n[0],s=n[1],c=0|a,l=0|s,u=r[l*t+c];a>0&&a<t&&c===a&&(o=r[l*t+c-1],n[0]=a+(i-o)/(u-o)-.5),s>0&&s<e&&l===s&&(o=r[(l-1)*t+c],n[1]=s+(i-o)/(u-o)-.5)}))}return i.contour=o,i.size=function(n){if(!arguments.length)return[t,e];var r=Math.ceil(n[0]),o=Math.ceil(n[1]);if(!(r>0&&o>0))throw new Error("invalid size");return t=r,e=o,i},i.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?Do(Io.call(t)):Do(t),i):n},i.smooth=function(t){return arguments.length?(r=t?s:Bo,i):r===s},i};function Vo(t,e,n){for(var r=t.width,i=t.height,o=1+(n<<1),a=0;a<i;++a)for(var s=0,c=0;s<r+n;++s)s<r&&(c+=t.data[s+a*r]),s>=n&&(s>=o&&(c-=t.data[s-o+a*r]),e.data[s-n+a*r]=c/Math.min(s+1,r-1+o-s,o))}function Go(t,e,n){for(var r=t.width,i=t.height,o=1+(n<<1),a=0;a<r;++a)for(var s=0,c=0;s<i+n;++s)s<i&&(c+=t.data[a+s*r]),s>=n&&(s>=o&&(c-=t.data[a+(s-o)*r]),e.data[a+(s-n)*r]=c/Math.min(s+1,i-1+o-s,o))}function Wo(t){return t[0]}function $o(t){return t[1]}function qo(){return 1}var Xo=function(){var t=Wo,e=$o,n=qo,r=960,i=500,o=20,a=2,s=3*o,c=r+2*s>>a,l=i+2*s>>a,u=Do(20);function d(r){var i=new Float32Array(c*l),d=new Float32Array(c*l);r.forEach((function(r,o,u){var d=+t(r,o,u)+s>>a,h=+e(r,o,u)+s>>a,f=+n(r,o,u);d>=0&&d<c&&h>=0&&h<l&&(i[d+h*c]+=f)})),Vo({width:c,height:l,data:i},{width:c,height:l,data:d},o>>a),Go({width:c,height:l,data:d},{width:c,height:l,data:i},o>>a),Vo({width:c,height:l,data:i},{width:c,height:l,data:d},o>>a),Go({width:c,height:l,data:d},{width:c,height:l,data:i},o>>a),Vo({width:c,height:l,data:i},{width:c,height:l,data:d},o>>a),Go({width:c,height:l,data:d},{width:c,height:l,data:i},o>>a);var f=u(i);if(!Array.isArray(f)){var p=N(i);f=P(0,p,f),(f=S(0,Math.floor(p/f)*f,f)).shift()}return Ho().thresholds(f).size([c,l])(i).map(h)}function h(t){return t.value*=Math.pow(2,-2*a),t.coordinates.forEach(f),t}function f(t){t.forEach(p)}function p(t){t.forEach(m)}function m(t){t[0]=t[0]*Math.pow(2,a)-s,t[1]=t[1]*Math.pow(2,a)-s}function g(){return c=r+2*(s=3*o)>>a,l=i+2*s>>a,d}return d.x=function(e){return arguments.length?(t="function"==typeof e?e:Do(+e),d):t},d.y=function(t){return arguments.length?(e="function"==typeof t?t:Do(+t),d):e},d.weight=function(t){return arguments.length?(n="function"==typeof t?t:Do(+t),d):n},d.size=function(t){if(!arguments.length)return[r,i];var e=Math.ceil(t[0]),n=Math.ceil(t[1]);if(!(e>=0||e>=0))throw new Error("invalid size");return r=e,i=n,g()},d.cellSize=function(t){if(!arguments.length)return 1<<a;if(!((t=+t)>=1))throw new Error("invalid cell size");return a=Math.floor(Math.log(t)/Math.LN2),g()},d.thresholds=function(t){return arguments.length?(u="function"==typeof t?t:Array.isArray(t)?Do(Io.call(t)):Do(t),d):u},d.bandwidth=function(t){if(!arguments.length)return Math.sqrt(o*(o+1));if(!((t=+t)>=0))throw new Error("invalid bandwidth");return o=Math.round((Math.sqrt(4*t*t+1)-1)/2),g()},d},Yo=function(t){return function(){return t}};function Ko(t,e,n,r,i,o,a,s,c,l){this.target=t,this.type=e,this.subject=n,this.identifier=r,this.active=i,this.x=o,this.y=a,this.dx=s,this.dy=c,this._=l}function Zo(){return!le.ctrlKey&&!le.button}function Jo(){return this.parentNode}function Qo(t){return null==t?{x:le.x,y:le.y}:t}function ta(){return navigator.maxTouchPoints||"ontouchstart"in this}Ko.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var ea=function(){var t,e,n,r,i=Zo,o=Jo,a=Qo,s=ta,c={},l=dt("start","drag","end"),u=0,d=0;function h(t){t.on("mousedown.drag",f).filter(s).on("touchstart.drag",g).on("touchmove.drag",v).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(){if(!r&&i.apply(this,arguments)){var a=b("mouse",o.apply(this,arguments),Rn,this,arguments);a&&(Se(le.view).on("mousemove.drag",p,!0).on("mouseup.drag",m,!0),Te(le.view),Me(),n=!1,t=le.clientX,e=le.clientY,a("start"))}}function p(){if(Ee(),!n){var r=le.clientX-t,i=le.clientY-e;n=r*r+i*i>d}c.mouse("drag")}function m(){Se(le.view).on("mousemove.drag mouseup.drag",null),Ae(le.view,n),Ee(),c.mouse("end")}function g(){if(i.apply(this,arguments)){var t,e,n=le.changedTouches,r=o.apply(this,arguments),a=n.length;for(t=0;t<a;++t)(e=b(n[t].identifier,r,Ln,this,arguments))&&(Me(),e("start"))}}function v(){var t,e,n=le.changedTouches,r=n.length;for(t=0;t<r;++t)(e=c[n[t].identifier])&&(Ee(),e("drag"))}function y(){var t,e,n=le.changedTouches,i=n.length;for(r&&clearTimeout(r),r=setTimeout((function(){r=null}),500),t=0;t<i;++t)(e=c[n[t].identifier])&&(Me(),e("end"))}function b(t,e,n,r,i){var o,s,d,f=n(e,t),p=l.copy();if(me(new Ko(h,"beforestart",o,t,u,f[0],f[1],0,0,p),(function(){return null!=(le.subject=o=a.apply(r,i))&&(s=o.x-f[0]||0,d=o.y-f[1]||0,!0)})))return function a(l){var m,g=f;switch(l){case"start":c[t]=a,m=u++;break;case"end":delete c[t],--u;case"drag":f=n(e,t),m=u}me(new Ko(h,l,o,t,m,f[0]+s,f[1]+d,f[0]-g[0],f[1]-g[1],p),p.apply,p,[l,r,i])}}return h.filter=function(t){return arguments.length?(i="function"==typeof t?t:Yo(!!t),h):i},h.container=function(t){return arguments.length?(o="function"==typeof t?t:Yo(t),h):o},h.subject=function(t){return arguments.length?(a="function"==typeof t?t:Yo(t),h):a},h.touchable=function(t){return arguments.length?(s="function"==typeof t?t:Yo(!!t),h):s},h.on=function(){var t=l.on.apply(l,arguments);return t===l?h:t},h.clickDistance=function(t){return arguments.length?(d=(t=+t)*t,h):Math.sqrt(d)},h},na={},ra={};function ia(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function oa(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function aa(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function sa(t){var e,n=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),o=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+aa(-e,6):e>9999?"+"+aa(e,6):aa(e,4))+"-"+aa(t.getUTCMonth()+1,2)+"-"+aa(t.getUTCDate(),2)+(o?"T"+aa(n,2)+":"+aa(r,2)+":"+aa(i,2)+"."+aa(o,3)+"Z":i?"T"+aa(n,2)+":"+aa(r,2)+":"+aa(i,2)+"Z":r||n?"T"+aa(n,2)+":"+aa(r,2)+"Z":"")}var ca=function(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],o=t.length,a=0,s=0,c=o<=0,l=!1;function u(){if(c)return ra;if(l)return l=!1,na;var e,r,i=a;if(34===t.charCodeAt(i)){for(;a++<o&&34!==t.charCodeAt(a)||34===t.charCodeAt(++a););return(e=a)>=o?c=!0:10===(r=t.charCodeAt(a++))?l=!0:13===r&&(l=!0,10===t.charCodeAt(a)&&++a),t.slice(i+1,e-1).replace(/""/g,'"')}for(;a<o;){if(10===(r=t.charCodeAt(e=a++)))l=!0;else if(13===r)l=!0,10===t.charCodeAt(a)&&++a;else if(r!==n)continue;return t.slice(i,e)}return c=!0,t.slice(i,o)}for(10===t.charCodeAt(o-1)&&--o,13===t.charCodeAt(o-1)&&--o;(r=u())!==ra;){for(var d=[];r!==na&&r!==ra;)d.push(r),r=u();e&&null==(d=e(d,s++))||i.push(d)}return i}function i(e,n){return e.map((function(e){return n.map((function(t){return a(e[t])})).join(t)}))}function o(e){return e.map(a).join(t)}function a(t){return null==t?"":t instanceof Date?sa(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,i,o=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=ia(t);return function(r,i){return e(n(r),i,t)}}(t,e):ia(t)}));return o.columns=i||[],o},parseRows:r,format:function(e,n){return null==n&&(n=oa(e)),[n.map(a).join(t)].concat(i(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=oa(t)),i(t,e).join("\n")},formatRows:function(t){return t.map(o).join("\n")},formatRow:o,formatValue:a}},la=ca(","),ua=la.parse,da=la.parseRows,ha=la.format,fa=la.formatBody,pa=la.formatRows,ma=la.formatRow,ga=la.formatValue,va=ca("\t"),ya=va.parse,ba=va.parseRows,xa=va.format,_a=va.formatBody,wa=va.formatRows,Sa=va.formatRow,Ma=va.formatValue;function Ea(t){for(var e in t){var n,r,i=t[e].trim();if(i)if("true"===i)i=!0;else if("false"===i)i=!1;else if("NaN"===i)i=NaN;else if(isNaN(n=+i)){if(!(r=i.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/)))continue;Ta&&r[4]&&!r[7]&&(i=i.replace(/-/g,"/").replace(/T/," ")),i=new Date(i)}else i=n;else i=null;t[e]=i}return t}var Ta=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();function Aa(t){return+t}function Ca(t){return t*t}function Pa(t){return t*(2-t)}function Oa(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}var ka=function t(e){function n(t){return Math.pow(t,e)}return e=+e,n.exponent=t,n}(3),La=function t(e){function n(t){return 1-Math.pow(1-t,e)}return e=+e,n.exponent=t,n}(3),Ra=function t(e){function n(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,n.exponent=t,n}(3),Ia=Math.PI,Na=Ia/2;function Da(t){return 1-Math.cos(t*Na)}function za(t){return Math.sin(t*Na)}function ja(t){return(1-Math.cos(Ia*t))/2}function Fa(t){return Math.pow(2,10*t-10)}function Ba(t){return 1-Math.pow(2,-10*t)}function Ua(t){return((t*=2)<=1?Math.pow(2,10*t-10):2-Math.pow(2,10-10*t))/2}function Ha(t){return 1-Math.sqrt(1-t*t)}function Va(t){return Math.sqrt(1- --t*t)}function Ga(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}function Wa(t){return 1-$a(1-t)}function $a(t){return(t=+t)<4/11?7.5625*t*t:t<8/11?7.5625*(t-=6/11)*t+3/4:t<10/11?7.5625*(t-=9/11)*t+15/16:7.5625*(t-=21/22)*t+63/64}function qa(t){return((t*=2)<=1?1-$a(1-t):$a(t-1)+1)/2}var Xa=function t(e){function n(t){return t*t*((e+1)*t-e)}return e=+e,n.overshoot=t,n}(1.70158),Ya=function t(e){function n(t){return--t*t*((e+1)*t+e)+1}return e=+e,n.overshoot=t,n}(1.70158),Ka=function t(e){function n(t){return((t*=2)<1?t*t*((e+1)*t-e):(t-=2)*t*((e+1)*t+e)+2)/2}return e=+e,n.overshoot=t,n}(1.70158),Za=2*Math.PI,Ja=function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Za);function i(t){return e*Math.pow(2,10*--t)*Math.sin((r-t)/n)}return i.amplitude=function(e){return t(e,n*Za)},i.period=function(n){return t(e,n)},i}(1,.3),Qa=function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Za);function i(t){return 1-e*Math.pow(2,-10*(t=+t))*Math.sin((t+r)/n)}return i.amplitude=function(e){return t(e,n*Za)},i.period=function(n){return t(e,n)},i}(1,.3),ts=function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Za);function i(t){return((t=2*t-1)<0?e*Math.pow(2,10*t)*Math.sin((r-t)/n):2-e*Math.pow(2,-10*t)*Math.sin((r+t)/n))/2}return i.amplitude=function(e){return t(e,n*Za)},i.period=function(n){return t(e,n)},i}(1,.3);function es(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.blob()}var ns=function(t,e){return fetch(t,e).then(es)};function rs(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.arrayBuffer()}var is=function(t,e){return fetch(t,e).then(rs)};function os(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}var as=function(t,e){return fetch(t,e).then(os)};function ss(t){return function(e,n,r){return 2===arguments.length&&"function"==typeof n&&(r=n,n=void 0),as(e,n).then((function(e){return t(e,r)}))}}function cs(t,e,n,r){3===arguments.length&&"function"==typeof n&&(r=n,n=void 0);var i=ca(t);return as(e,n).then((function(t){return i.parse(t,r)}))}var ls=ss(ua),us=ss(ya),ds=function(t,e){return new Promise((function(n,r){var i=new Image;for(var o in e)i[o]=e[o];i.onerror=r,i.onload=function(){n(i)},i.src=t}))};function hs(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(204!==t.status&&205!==t.status)return t.json()}var fs=function(t,e){return fetch(t,e).then(hs)};function ps(t){return function(e,n){return as(e,n).then((function(e){return(new DOMParser).parseFromString(e,t)}))}}var ms=ps("application/xml"),gs=ps("text/html"),vs=ps("image/svg+xml"),ys=function(t,e){var n;function r(){var r,i,o=n.length,a=0,s=0;for(r=0;r<o;++r)a+=(i=n[r]).x,s+=i.y;for(a=a/o-t,s=s/o-e,r=0;r<o;++r)(i=n[r]).x-=a,i.y-=s}return null==t&&(t=0),null==e&&(e=0),r.initialize=function(t){n=t},r.x=function(e){return arguments.length?(t=+e,r):t},r.y=function(t){return arguments.length?(e=+t,r):e},r},bs=function(t){return function(){return t}},xs=function(){return 1e-6*(Math.random()-.5)};function _s(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o,a,s,c,l,u,d,h,f=t._root,p={data:r},m=t._x0,g=t._y0,v=t._x1,y=t._y1;if(!f)return t._root=p,t;for(;f.length;)if((l=e>=(o=(m+v)/2))?m=o:v=o,(u=n>=(a=(g+y)/2))?g=a:y=a,i=f,!(f=f[d=u<<1|l]))return i[d]=p,t;if(s=+t._x.call(null,f.data),c=+t._y.call(null,f.data),e===s&&n===c)return p.next=f,i?i[d]=p:t._root=p,t;do{i=i?i[d]=new Array(4):t._root=new Array(4),(l=e>=(o=(m+v)/2))?m=o:v=o,(u=n>=(a=(g+y)/2))?g=a:y=a}while((d=u<<1|l)==(h=(c>=a)<<1|s>=o));return i[h]=f,i[d]=p,t}var ws=function(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i};function Ss(t){return t[0]}function Ms(t){return t[1]}function Es(t,e,n){var r=new Ts(null==e?Ss:e,null==n?Ms:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function Ts(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function As(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var Cs=Es.prototype=Ts.prototype;function Ps(t){return t.x+t.vx}function Os(t){return t.y+t.vy}Cs.copy=function(){var t,e,n=new Ts(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=As(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=As(e));return n},Cs.add=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return _s(this.cover(e,n),e,n,t)},Cs.addAll=function(t){var e,n,r,i,o=t.length,a=new Array(o),s=new Array(o),c=1/0,l=1/0,u=-1/0,d=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(a[n]=r,s[n]=i,r<c&&(c=r),r>u&&(u=r),i<l&&(l=i),i>d&&(d=i));if(c>u||l>d)return this;for(this.cover(c,l).cover(u,d),n=0;n<o;++n)_s(this,a[n],s[n],t[n]);return this},Cs.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{for(var a,s,c=i-n,l=this._root;n>t||t>=i||r>e||e>=o;)switch(s=(e<r)<<1|t<n,(a=new Array(4))[s]=l,l=a,c*=2,s){case 0:i=n+c,o=r+c;break;case 1:n=i-c,o=r+c;break;case 2:i=n+c,r=o-c;break;case 3:n=i-c,r=o-c}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},Cs.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},Cs.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Cs.find=function(t,e,n){var r,i,o,a,s,c,l,u=this._x0,d=this._y0,h=this._x1,f=this._y1,p=[],m=this._root;for(m&&p.push(new ws(m,u,d,h,f)),null==n?n=1/0:(u=t-n,d=e-n,h=t+n,f=e+n,n*=n);c=p.pop();)if(!(!(m=c.node)||(i=c.x0)>h||(o=c.y0)>f||(a=c.x1)<u||(s=c.y1)<d))if(m.length){var g=(i+a)/2,v=(o+s)/2;p.push(new ws(m[3],g,v,a,s),new ws(m[2],i,v,g,s),new ws(m[1],g,o,a,v),new ws(m[0],i,o,g,v)),(l=(e>=v)<<1|t>=g)&&(c=p[p.length-1],p[p.length-1]=p[p.length-1-l],p[p.length-1-l]=c)}else{var y=t-+this._x.call(null,m.data),b=e-+this._y.call(null,m.data),x=y*y+b*b;if(x<n){var _=Math.sqrt(n=x);u=t-_,d=e-_,h=t+_,f=e+_,r=m.data}}return r},Cs.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,n,r,i,o,a,s,c,l,u,d,h,f=this._root,p=this._x0,m=this._y0,g=this._x1,v=this._y1;if(!f)return this;if(f.length)for(;;){if((l=o>=(s=(p+g)/2))?p=s:g=s,(u=a>=(c=(m+v)/2))?m=c:v=c,e=f,!(f=f[d=u<<1|l]))return this;if(!f.length)break;(e[d+1&3]||e[d+2&3]||e[d+3&3])&&(n=e,h=d)}for(;f.data!==t;)if(r=f,!(f=f.next))return this;return(i=f.next)&&delete f.next,r?(i?r.next=i:delete r.next,this):e?(i?e[d]=i:delete e[d],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(n?n[h]=f:this._root=f),this):(this._root=i,this)},Cs.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},Cs.root=function(){return this._root},Cs.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},Cs.visit=function(t){var e,n,r,i,o,a,s=[],c=this._root;for(c&&s.push(new ws(c,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(c=e.node,r=e.x0,i=e.y0,o=e.x1,a=e.y1)&&c.length){var l=(r+o)/2,u=(i+a)/2;(n=c[3])&&s.push(new ws(n,l,u,o,a)),(n=c[2])&&s.push(new ws(n,r,u,l,a)),(n=c[1])&&s.push(new ws(n,l,i,o,u)),(n=c[0])&&s.push(new ws(n,r,i,l,u))}return this},Cs.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new ws(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var o,a=e.x0,s=e.y0,c=e.x1,l=e.y1,u=(a+c)/2,d=(s+l)/2;(o=i[0])&&n.push(new ws(o,a,s,u,d)),(o=i[1])&&n.push(new ws(o,u,s,c,d)),(o=i[2])&&n.push(new ws(o,a,d,u,l)),(o=i[3])&&n.push(new ws(o,u,d,c,l))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},Cs.x=function(t){return arguments.length?(this._x=t,this):this._x},Cs.y=function(t){return arguments.length?(this._y=t,this):this._y};var ks=function(t){var e,n,r=1,i=1;function o(){for(var t,o,s,c,l,u,d,h=e.length,f=0;f<i;++f)for(o=Es(e,Ps,Os).visitAfter(a),t=0;t<h;++t)s=e[t],u=n[s.index],d=u*u,c=s.x+s.vx,l=s.y+s.vy,o.visit(p);function p(t,e,n,i,o){var a=t.data,h=t.r,f=u+h;if(!a)return e>c+f||i<c-f||n>l+f||o<l-f;if(a.index>s.index){var p=c-a.x-a.vx,m=l-a.y-a.vy,g=p*p+m*m;g<f*f&&(0===p&&(g+=(p=xs())*p),0===m&&(g+=(m=xs())*m),g=(f-(g=Math.sqrt(g)))/g*r,s.vx+=(p*=g)*(f=(h*=h)/(d+h)),s.vy+=(m*=g)*f,a.vx-=p*(f=1-f),a.vy-=m*f)}}}function a(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function s(){if(e){var r,i,o=e.length;for(n=new Array(o),r=0;r<o;++r)i=e[r],n[i.index]=+t(i,r,e)}}return"function"!=typeof t&&(t=bs(null==t?1:+t)),o.initialize=function(t){e=t,s()},o.iterations=function(t){return arguments.length?(i=+t,o):i},o.strength=function(t){return arguments.length?(r=+t,o):r},o.radius=function(e){return arguments.length?(t="function"==typeof e?e:bs(+e),s(),o):t},o};function Ls(t){return t.index}function Rs(t,e){var n=t.get(e);if(!n)throw new Error("missing: "+e);return n}var Is=function(t){var e,n,r,i,o,a=Ls,s=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},c=bs(30),l=1;function u(r){for(var i=0,a=t.length;i<l;++i)for(var s,c,u,d,h,f,p,m=0;m<a;++m)c=(s=t[m]).source,d=(u=s.target).x+u.vx-c.x-c.vx||xs(),h=u.y+u.vy-c.y-c.vy||xs(),d*=f=((f=Math.sqrt(d*d+h*h))-n[m])/f*r*e[m],h*=f,u.vx-=d*(p=o[m]),u.vy-=h*p,c.vx+=d*(p=1-p),c.vy+=h*p}function d(){if(r){var s,c,l=r.length,u=t.length,d=Ji(r,a);for(s=0,i=new Array(l);s<u;++s)(c=t[s]).index=s,"object"!=typeof c.source&&(c.source=Rs(d,c.source)),"object"!=typeof c.target&&(c.target=Rs(d,c.target)),i[c.source.index]=(i[c.source.index]||0)+1,i[c.target.index]=(i[c.target.index]||0)+1;for(s=0,o=new Array(u);s<u;++s)c=t[s],o[s]=i[c.source.index]/(i[c.source.index]+i[c.target.index]);e=new Array(u),h(),n=new Array(u),f()}}function h(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+s(t[n],n,t)}function f(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+c(t[e],e,t)}return null==t&&(t=[]),u.initialize=function(t){r=t,d()},u.links=function(e){return arguments.length?(t=e,d(),u):t},u.id=function(t){return arguments.length?(a=t,u):a},u.iterations=function(t){return arguments.length?(l=+t,u):l},u.strength=function(t){return arguments.length?(s="function"==typeof t?t:bs(+t),h(),u):s},u.distance=function(t){return arguments.length?(c="function"==typeof t?t:bs(+t),f(),u):c},u};function Ns(t){return t.x}function Ds(t){return t.y}var zs=Math.PI*(3-Math.sqrt(5)),js=function(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=Ji(),c=Wn(u),l=dt("tick","end");function u(){d(),l.call("tick",e),n<r&&(c.stop(),l.call("end",e))}function d(r){var c,l,u=t.length;void 0===r&&(r=1);for(var d=0;d<r;++d)for(n+=(o-n)*i,s.each((function(t){t(n)})),c=0;c<u;++c)null==(l=t[c]).fx?l.x+=l.vx*=a:(l.x=l.fx,l.vx=0),null==l.fy?l.y+=l.vy*=a:(l.y=l.fy,l.vy=0);return e}function h(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=10*Math.sqrt(n),o=n*zs;e.x=i*Math.cos(o),e.y=i*Math.sin(o)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function f(e){return e.initialize&&e.initialize(t),e}return null==t&&(t=[]),h(),e={tick:d,restart:function(){return c.restart(u),e},stop:function(){return c.stop(),e},nodes:function(n){return arguments.length?(t=n,h(),s.each(f),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(o=+t,e):o},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},force:function(t,n){return arguments.length>1?(null==n?s.remove(t):s.set(t,f(n)),e):s.get(t)},find:function(e,n,r){var i,o,a,s,c,l=0,u=t.length;for(null==r?r=1/0:r*=r,l=0;l<u;++l)(a=(i=e-(s=t[l]).x)*i+(o=n-s.y)*o)<r&&(c=s,r=a);return c},on:function(t,n){return arguments.length>1?(l.on(t,n),e):l.on(t)}}},Fs=function(){var t,e,n,r,i=bs(-30),o=1,a=1/0,s=.81;function c(r){var i,o=t.length,a=Es(t,Ns,Ds).visitAfter(u);for(n=r,i=0;i<o;++i)e=t[i],a.visit(d)}function l(){if(t){var e,n,o=t.length;for(r=new Array(o),e=0;e<o;++e)n=t[e],r[n.index]=+i(n,e,t)}}function u(t){var e,n,i,o,a,s=0,c=0;if(t.length){for(i=o=a=0;a<4;++a)(e=t[a])&&(n=Math.abs(e.value))&&(s+=e.value,c+=n,i+=n*e.x,o+=n*e.y);t.x=i/c,t.y=o/c}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=r[e.data.index]}while(e=e.next)}t.value=s}function d(t,i,c,l){if(!t.value)return!0;var u=t.x-e.x,d=t.y-e.y,h=l-i,f=u*u+d*d;if(h*h/s<f)return f<a&&(0===u&&(f+=(u=xs())*u),0===d&&(f+=(d=xs())*d),f<o&&(f=Math.sqrt(o*f)),e.vx+=u*t.value*n/f,e.vy+=d*t.value*n/f),!0;if(!(t.length||f>=a)){(t.data!==e||t.next)&&(0===u&&(f+=(u=xs())*u),0===d&&(f+=(d=xs())*d),f<o&&(f=Math.sqrt(o*f)));do{t.data!==e&&(h=r[t.data.index]*n/f,e.vx+=u*h,e.vy+=d*h)}while(t=t.next)}}return c.initialize=function(e){t=e,l()},c.strength=function(t){return arguments.length?(i="function"==typeof t?t:bs(+t),l(),c):i},c.distanceMin=function(t){return arguments.length?(o=t*t,c):Math.sqrt(o)},c.distanceMax=function(t){return arguments.length?(a=t*t,c):Math.sqrt(a)},c.theta=function(t){return arguments.length?(s=t*t,c):Math.sqrt(s)},c},Bs=function(t,e,n){var r,i,o,a=bs(.1);function s(t){for(var a=0,s=r.length;a<s;++a){var c=r[a],l=c.x-e||1e-6,u=c.y-n||1e-6,d=Math.sqrt(l*l+u*u),h=(o[a]-d)*i[a]*t/d;c.vx+=l*h,c.vy+=u*h}}function c(){if(r){var e,n=r.length;for(i=new Array(n),o=new Array(n),e=0;e<n;++e)o[e]=+t(r[e],e,r),i[e]=isNaN(o[e])?0:+a(r[e],e,r)}}return"function"!=typeof t&&(t=bs(+t)),null==e&&(e=0),null==n&&(n=0),s.initialize=function(t){r=t,c()},s.strength=function(t){return arguments.length?(a="function"==typeof t?t:bs(+t),c(),s):a},s.radius=function(e){return arguments.length?(t="function"==typeof e?e:bs(+e),c(),s):t},s.x=function(t){return arguments.length?(e=+t,s):e},s.y=function(t){return arguments.length?(n=+t,s):n},s},Us=function(t){var e,n,r,i=bs(.1);function o(t){for(var i,o=0,a=e.length;o<a;++o)(i=e[o]).vx+=(r[o]-i.x)*n[o]*t}function a(){if(e){var o,a=e.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!=typeof t&&(t=bs(null==t?0:+t)),o.initialize=function(t){e=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:bs(+t),a(),o):i},o.x=function(e){return arguments.length?(t="function"==typeof e?e:bs(+e),a(),o):t},o},Hs=function(t){var e,n,r,i=bs(.1);function o(t){for(var i,o=0,a=e.length;o<a;++o)(i=e[o]).vy+=(r[o]-i.y)*n[o]*t}function a(){if(e){var o,a=e.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!=typeof t&&(t=bs(null==t?0:+t)),o.initialize=function(t){e=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:bs(+t),a(),o):i},o.y=function(e){return arguments.length?(t="function"==typeof e?e:bs(+e),a(),o):t},o},Vs=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]},Gs=function(t){return(t=Vs(Math.abs(t)))?t[1]:NaN},Ws=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function $s(t){if(!(e=Ws.exec(t)))throw new Error("invalid format: "+t);var e;return new qs({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function qs(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}$s.prototype=qs.prototype,qs.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Xs,Ys,Ks,Zs,Js=function(t,e){var n=Vs(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},Qs={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return Js(100*t,e)},r:Js,s:function(t,e){var n=Vs(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(Xs=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Vs(t,Math.max(0,e+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},tc=function(t){return t},ec=Array.prototype.map,nc=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"],rc=function(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?tc:(e=ec.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],a=0,s=e[0],c=0;i>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),o.push(t.substring(i-=s,i+s)),!((c+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?tc:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(ec.call(t.numerals,String)),c=void 0===t.percent?"%":t.percent+"",l=void 0===t.minus?"-":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function d(t){var e=(t=$s(t)).fill,n=t.align,d=t.sign,h=t.symbol,f=t.zero,p=t.width,m=t.comma,g=t.precision,v=t.trim,y=t.type;"n"===y?(m=!0,y="g"):Qs[y]||(void 0===g&&(g=12),v=!0,y="g"),(f||"0"===e&&"="===n)&&(f=!0,e="0",n="=");var b="$"===h?i:"#"===h&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x="$"===h?o:/[%p]/.test(y)?c:"",_=Qs[y],w=/[defgprs%]/.test(y);function S(t){var i,o,c,h=b,S=x;if("c"===y)S=_(t)+S,t="";else{var M=(t=+t)<0||1/t<0;if(t=isNaN(t)?u:_(Math.abs(t),g),v&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),M&&0==+t&&"+"!==d&&(M=!1),h=(M?"("===d?d:l:"-"===d||"("===d?"":d)+h,S=("s"===y?nc[8+Xs/3]:"")+S+(M&&"("===d?")":""),w)for(i=-1,o=t.length;++i<o;)if(48>(c=t.charCodeAt(i))||c>57){S=(46===c?a+t.slice(i+1):t.slice(i))+S,t=t.slice(0,i);break}}m&&!f&&(t=r(t,1/0));var E=h.length+t.length+S.length,T=E<p?new Array(p-E+1).join(e):"";switch(m&&f&&(t=r(T+t,T.length?p-S.length:1/0),T=""),n){case"<":t=h+t+S+T;break;case"=":t=h+T+t+S;break;case"^":t=T.slice(0,E=T.length>>1)+h+t+S+T.slice(E);break;default:t=T+h+t+S}return s(t)}return g=void 0===g?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),S.toString=function(){return t+""},S}return{format:d,formatPrefix:function(t,e){var n=d(((t=$s(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Gs(e)/3))),i=Math.pow(10,-r),o=nc[8+r/3];return function(t){return n(i*t)+o}}}};function ic(t){return Ys=rc(t),Ks=Ys.format,Zs=Ys.formatPrefix,Ys}ic({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});var oc=function(t){return Math.max(0,-Gs(Math.abs(t)))},ac=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Gs(e)/3)))-Gs(Math.abs(t)))},sc=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Gs(e)-Gs(t))+1},cc=function(){return new lc};function lc(){this.reset()}lc.prototype={constructor:lc,reset:function(){this.s=this.t=0},add:function(t){dc(uc,t,this.t),dc(this,uc.s,this.s),this.s?this.t+=uc.t:this.s=uc.t},valueOf:function(){return this.s}};var uc=new lc;function dc(t,e,n){var r=t.s=e+n,i=r-e,o=r-i;t.t=e-o+(n-i)}var hc=Math.PI,fc=hc/2,pc=hc/4,mc=2*hc,gc=180/hc,vc=hc/180,yc=Math.abs,bc=Math.atan,xc=Math.atan2,_c=Math.cos,wc=Math.ceil,Sc=Math.exp,Mc=(Math.floor,Math.log),Ec=Math.pow,Tc=Math.sin,Ac=Math.sign||function(t){return t>0?1:t<0?-1:0},Cc=Math.sqrt,Pc=Math.tan;function Oc(t){return t>1?0:t<-1?hc:Math.acos(t)}function kc(t){return t>1?fc:t<-1?-fc:Math.asin(t)}function Lc(t){return(t=Tc(t/2))*t}function Rc(){}function Ic(t,e){t&&Dc.hasOwnProperty(t.type)&&Dc[t.type](t,e)}var Nc={Feature:function(t,e){Ic(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)Ic(n[r].geometry,e)}},Dc={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){zc(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)zc(n[r],e,0)},Polygon:function(t,e){jc(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)jc(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)Ic(n[r],e)}};function zc(t,e,n){var r,i=-1,o=t.length-n;for(e.lineStart();++i<o;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function jc(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)zc(t[n],e,1);e.polygonEnd()}var Fc,Bc,Uc,Hc,Vc,Gc=function(t,e){t&&Nc.hasOwnProperty(t.type)?Nc[t.type](t,e):Ic(t,e)},Wc=cc(),$c=cc(),qc={point:Rc,lineStart:Rc,lineEnd:Rc,polygonStart:function(){Wc.reset(),qc.lineStart=Xc,qc.lineEnd=Yc},polygonEnd:function(){var t=+Wc;$c.add(t<0?mc+t:t),this.lineStart=this.lineEnd=this.point=Rc},sphere:function(){$c.add(mc)}};function Xc(){qc.point=Kc}function Yc(){Zc(Fc,Bc)}function Kc(t,e){qc.point=Zc,Fc=t,Bc=e,Uc=t*=vc,Hc=_c(e=(e*=vc)/2+pc),Vc=Tc(e)}function Zc(t,e){var n=(t*=vc)-Uc,r=n>=0?1:-1,i=r*n,o=_c(e=(e*=vc)/2+pc),a=Tc(e),s=Vc*a,c=Hc*o+s*_c(i),l=s*r*Tc(i);Wc.add(xc(l,c)),Uc=t,Hc=o,Vc=a}var Jc=function(t){return $c.reset(),Gc(t,qc),2*$c};function Qc(t){return[xc(t[1],t[0]),kc(t[2])]}function tl(t){var e=t[0],n=t[1],r=_c(n);return[r*_c(e),r*Tc(e),Tc(n)]}function el(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function nl(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function rl(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function il(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function ol(t){var e=Cc(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var al,sl,cl,ll,ul,dl,hl,fl,pl,ml,gl=cc(),vl={point:yl,lineStart:xl,lineEnd:_l,polygonStart:function(){vl.point=wl,vl.lineStart=Sl,vl.lineEnd=Ml,gl.reset(),qc.polygonStart()},polygonEnd:function(){qc.polygonEnd(),vl.point=yl,vl.lineStart=xl,vl.lineEnd=_l,Wc<0?(al=-(cl=180),sl=-(ll=90)):gl>1e-6?ll=90:gl<-1e-6&&(sl=-90),ml[0]=al,ml[1]=cl},sphere:function(){al=-(cl=180),sl=-(ll=90)}};function yl(t,e){pl.push(ml=[al=t,cl=t]),e<sl&&(sl=e),e>ll&&(ll=e)}function bl(t,e){var n=tl([t*vc,e*vc]);if(fl){var r=nl(fl,n),i=nl([r[1],-r[0],0],r);ol(i),i=Qc(i);var o,a=t-ul,s=a>0?1:-1,c=i[0]*gc*s,l=yc(a)>180;l^(s*ul<c&&c<s*t)?(o=i[1]*gc)>ll&&(ll=o):l^(s*ul<(c=(c+360)%360-180)&&c<s*t)?(o=-i[1]*gc)<sl&&(sl=o):(e<sl&&(sl=e),e>ll&&(ll=e)),l?t<ul?El(al,t)>El(al,cl)&&(cl=t):El(t,cl)>El(al,cl)&&(al=t):cl>=al?(t<al&&(al=t),t>cl&&(cl=t)):t>ul?El(al,t)>El(al,cl)&&(cl=t):El(t,cl)>El(al,cl)&&(al=t)}else pl.push(ml=[al=t,cl=t]);e<sl&&(sl=e),e>ll&&(ll=e),fl=n,ul=t}function xl(){vl.point=bl}function _l(){ml[0]=al,ml[1]=cl,vl.point=yl,fl=null}function wl(t,e){if(fl){var n=t-ul;gl.add(yc(n)>180?n+(n>0?360:-360):n)}else dl=t,hl=e;qc.point(t,e),bl(t,e)}function Sl(){qc.lineStart()}function Ml(){wl(dl,hl),qc.lineEnd(),yc(gl)>1e-6&&(al=-(cl=180)),ml[0]=al,ml[1]=cl,fl=null}function El(t,e){return(e-=t)<0?e+360:e}function Tl(t,e){return t[0]-e[0]}function Al(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var Cl,Pl,Ol,kl,Ll,Rl,Il,Nl,Dl,zl,jl,Fl,Bl,Ul,Hl,Vl,Gl=function(t){var e,n,r,i,o,a,s;if(ll=cl=-(al=sl=1/0),pl=[],Gc(t,vl),n=pl.length){for(pl.sort(Tl),e=1,o=[r=pl[0]];e<n;++e)Al(r,(i=pl[e])[0])||Al(r,i[1])?(El(r[0],i[1])>El(r[0],r[1])&&(r[1]=i[1]),El(i[0],r[1])>El(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(a=-1/0,e=0,r=o[n=o.length-1];e<=n;r=i,++e)i=o[e],(s=El(r[1],i[0]))>a&&(a=s,al=i[0],cl=r[1])}return pl=ml=null,al===1/0||sl===1/0?[[NaN,NaN],[NaN,NaN]]:[[al,sl],[cl,ll]]},Wl={sphere:Rc,point:$l,lineStart:Xl,lineEnd:Zl,polygonStart:function(){Wl.lineStart=Jl,Wl.lineEnd=Ql},polygonEnd:function(){Wl.lineStart=Xl,Wl.lineEnd=Zl}};function $l(t,e){t*=vc;var n=_c(e*=vc);ql(n*_c(t),n*Tc(t),Tc(e))}function ql(t,e,n){++Cl,Ol+=(t-Ol)/Cl,kl+=(e-kl)/Cl,Ll+=(n-Ll)/Cl}function Xl(){Wl.point=Yl}function Yl(t,e){t*=vc;var n=_c(e*=vc);Ul=n*_c(t),Hl=n*Tc(t),Vl=Tc(e),Wl.point=Kl,ql(Ul,Hl,Vl)}function Kl(t,e){t*=vc;var n=_c(e*=vc),r=n*_c(t),i=n*Tc(t),o=Tc(e),a=xc(Cc((a=Hl*o-Vl*i)*a+(a=Vl*r-Ul*o)*a+(a=Ul*i-Hl*r)*a),Ul*r+Hl*i+Vl*o);Pl+=a,Rl+=a*(Ul+(Ul=r)),Il+=a*(Hl+(Hl=i)),Nl+=a*(Vl+(Vl=o)),ql(Ul,Hl,Vl)}function Zl(){Wl.point=$l}function Jl(){Wl.point=tu}function Ql(){eu(Fl,Bl),Wl.point=$l}function tu(t,e){Fl=t,Bl=e,t*=vc,e*=vc,Wl.point=eu;var n=_c(e);Ul=n*_c(t),Hl=n*Tc(t),Vl=Tc(e),ql(Ul,Hl,Vl)}function eu(t,e){t*=vc;var n=_c(e*=vc),r=n*_c(t),i=n*Tc(t),o=Tc(e),a=Hl*o-Vl*i,s=Vl*r-Ul*o,c=Ul*i-Hl*r,l=Cc(a*a+s*s+c*c),u=kc(l),d=l&&-u/l;Dl+=d*a,zl+=d*s,jl+=d*c,Pl+=u,Rl+=u*(Ul+(Ul=r)),Il+=u*(Hl+(Hl=i)),Nl+=u*(Vl+(Vl=o)),ql(Ul,Hl,Vl)}var nu=function(t){Cl=Pl=Ol=kl=Ll=Rl=Il=Nl=Dl=zl=jl=0,Gc(t,Wl);var e=Dl,n=zl,r=jl,i=e*e+n*n+r*r;return i<1e-12&&(e=Rl,n=Il,r=Nl,Pl<1e-6&&(e=Ol,n=kl,r=Ll),(i=e*e+n*n+r*r)<1e-12)?[NaN,NaN]:[xc(n,e)*gc,kc(r/Cc(i))*gc]},ru=function(t){return function(){return t}},iu=function(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n};function ou(t,e){return[yc(t)>hc?t+Math.round(-t/mc)*mc:t,e]}function au(t,e,n){return(t%=mc)?e||n?iu(cu(t),lu(e,n)):cu(t):e||n?lu(e,n):ou}function su(t){return function(e,n){return[(e+=t)>hc?e-mc:e<-hc?e+mc:e,n]}}function cu(t){var e=su(t);return e.invert=su(-t),e}function lu(t,e){var n=_c(t),r=Tc(t),i=_c(e),o=Tc(e);function a(t,e){var a=_c(e),s=_c(t)*a,c=Tc(t)*a,l=Tc(e),u=l*n+s*r;return[xc(c*i-u*o,s*n-l*r),kc(u*i+c*o)]}return a.invert=function(t,e){var a=_c(e),s=_c(t)*a,c=Tc(t)*a,l=Tc(e),u=l*i-c*o;return[xc(c*i+l*o,s*n+u*r),kc(u*n-s*r)]},a}ou.invert=ou;var uu=function(t){function e(e){return(e=t(e[0]*vc,e[1]*vc))[0]*=gc,e[1]*=gc,e}return t=au(t[0]*vc,t[1]*vc,t.length>2?t[2]*vc:0),e.invert=function(e){return(e=t.invert(e[0]*vc,e[1]*vc))[0]*=gc,e[1]*=gc,e},e};function du(t,e,n,r,i,o){if(n){var a=_c(e),s=Tc(e),c=r*n;null==i?(i=e+r*mc,o=e-c/2):(i=hu(a,i),o=hu(a,o),(r>0?i<o:i>o)&&(i+=r*mc));for(var l,u=i;r>0?u>o:u<o;u-=c)l=Qc([a,-s*_c(u),-s*Tc(u)]),t.point(l[0],l[1])}}function hu(t,e){(e=tl(e))[0]-=t,ol(e);var n=Oc(-e[1]);return((-e[2]<0?-n:n)+mc-1e-6)%mc}var fu=function(){var t,e,n=ru([0,0]),r=ru(90),i=ru(6),o={point:function(n,r){t.push(n=e(n,r)),n[0]*=gc,n[1]*=gc}};function a(){var a=n.apply(this,arguments),s=r.apply(this,arguments)*vc,c=i.apply(this,arguments)*vc;return t=[],e=au(-a[0]*vc,-a[1]*vc,0).invert,du(o,s,c,1),a={type:"Polygon",coordinates:[t]},t=e=null,a}return a.center=function(t){return arguments.length?(n="function"==typeof t?t:ru([+t[0],+t[1]]),a):n},a.radius=function(t){return arguments.length?(r="function"==typeof t?t:ru(+t),a):r},a.precision=function(t){return arguments.length?(i="function"==typeof t?t:ru(+t),a):i},a},pu=function(){var t,e=[];return{point:function(e,n,r){t.push([e,n,r])},lineStart:function(){e.push(t=[])},lineEnd:Rc,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}},mu=function(t,e){return yc(t[0]-e[0])<1e-6&&yc(t[1]-e[1])<1e-6};function gu(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}var vu=function(t,e,n,r,i){var o,a,s=[],c=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],a=t[e];if(mu(r,a)){if(!r[2]&&!a[2]){for(i.lineStart(),o=0;o<e;++o)i.point((r=t[o])[0],r[1]);return void i.lineEnd()}a[0]+=2e-6}s.push(n=new gu(r,t,null,!0)),c.push(n.o=new gu(r,null,n,!1)),s.push(n=new gu(a,t,null,!1)),c.push(n.o=new gu(a,null,n,!0))}})),s.length){for(c.sort(e),yu(s),yu(c),o=0,a=c.length;o<a;++o)c[o].e=n=!n;for(var l,u,d=s[0];;){for(var h=d,f=!0;h.v;)if((h=h.n)===d)return;l=h.z,i.lineStart();do{if(h.v=h.o.v=!0,h.e){if(f)for(o=0,a=l.length;o<a;++o)i.point((u=l[o])[0],u[1]);else r(h.x,h.n.x,1,i);h=h.n}else{if(f)for(l=h.p.z,o=l.length-1;o>=0;--o)i.point((u=l[o])[0],u[1]);else r(h.x,h.p.x,-1,i);h=h.p}l=(h=h.o).z,f=!f}while(!h.v);i.lineEnd()}}};function yu(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}var bu=cc();function xu(t){return yc(t[0])<=hc?t[0]:Ac(t[0])*((yc(t[0])+hc)%mc-hc)}var _u=function(t,e){var n=xu(e),r=e[1],i=Tc(r),o=[Tc(n),-_c(n),0],a=0,s=0;bu.reset(),1===i?r=fc+1e-6:-1===i&&(r=-fc-1e-6);for(var c=0,l=t.length;c<l;++c)if(d=(u=t[c]).length)for(var u,d,h=u[d-1],f=xu(h),p=h[1]/2+pc,m=Tc(p),g=_c(p),v=0;v<d;++v,f=b,m=_,g=w,h=y){var y=u[v],b=xu(y),x=y[1]/2+pc,_=Tc(x),w=_c(x),S=b-f,M=S>=0?1:-1,E=M*S,T=E>hc,A=m*_;if(bu.add(xc(A*M*Tc(E),g*w+A*_c(E))),a+=T?S+M*mc:S,T^f>=n^b>=n){var C=nl(tl(h),tl(y));ol(C);var P=nl(o,C);ol(P);var O=(T^S>=0?-1:1)*kc(P[2]);(r>O||r===O&&(C[0]||C[1]))&&(s+=T^S>=0?1:-1)}}return(a<-1e-6||a<1e-6&&bu<-1e-6)^1&s},wu=function(t,e,n,r){return function(i){var o,a,s,c=e(i),l=pu(),u=e(l),d=!1,h={point:f,lineStart:m,lineEnd:g,polygonStart:function(){h.point=v,h.lineStart=y,h.lineEnd=b,a=[],o=[]},polygonEnd:function(){h.point=f,h.lineStart=m,h.lineEnd=g,a=j(a);var t=_u(o,r);a.length?(d||(i.polygonStart(),d=!0),vu(a,Mu,t,n,i)):t&&(d||(i.polygonStart(),d=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),d&&(i.polygonEnd(),d=!1),a=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function f(e,n){t(e,n)&&i.point(e,n)}function p(t,e){c.point(t,e)}function m(){h.point=p,c.lineStart()}function g(){h.point=f,c.lineEnd()}function v(t,e){s.push([t,e]),u.point(t,e)}function y(){u.lineStart(),s=[]}function b(){v(s[0][0],s[0][1]),u.lineEnd();var t,e,n,r,c=u.clean(),h=l.result(),f=h.length;if(s.pop(),o.push(s),s=null,f)if(1&c){if((e=(n=h[0]).length-1)>0){for(d||(i.polygonStart(),d=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else f>1&&2&c&&h.push(h.pop().concat(h.shift())),a.push(h.filter(Su))}return h}};function Su(t){return t.length>1}function Mu(t,e){return((t=t.x)[0]<0?t[1]-fc-1e-6:fc-t[1])-((e=e.x)[0]<0?e[1]-fc-1e-6:fc-e[1])}var Eu=wu((function(){return!0}),(function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var s=o>0?hc:-hc,c=yc(o-n);yc(c-hc)<1e-6?(t.point(n,r=(r+a)/2>0?fc:-fc),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(o,r),e=0):i!==s&&c>=hc&&(yc(n-i)<1e-6&&(n-=1e-6*i),yc(o-s)<1e-6&&(o-=1e-6*s),r=function(t,e,n,r){var i,o,a=Tc(t-n);return yc(a)>1e-6?bc((Tc(e)*(o=_c(r))*Tc(n)-Tc(r)*(i=_c(e))*Tc(t))/(i*o*a)):(e+r)/2}(n,r,o,a),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=o,r=a),i=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}),(function(t,e,n,r){var i;if(null==t)i=n*fc,r.point(-hc,i),r.point(0,i),r.point(hc,i),r.point(hc,0),r.point(hc,-i),r.point(0,-i),r.point(-hc,-i),r.point(-hc,0),r.point(-hc,i);else if(yc(t[0]-e[0])>1e-6){var o=t[0]<e[0]?hc:-hc;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])}),[-hc,-fc]);var Tu=function(t){var e=_c(t),n=6*vc,r=e>0,i=yc(e)>1e-6;function o(t,n){return _c(t)*_c(n)>e}function a(t,n,r){var i=[1,0,0],o=nl(tl(t),tl(n)),a=el(o,o),s=o[0],c=a-s*s;if(!c)return!r&&t;var l=e*a/c,u=-e*s/c,d=nl(i,o),h=il(i,l);rl(h,il(o,u));var f=d,p=el(h,f),m=el(f,f),g=p*p-m*(el(h,h)-1);if(!(g<0)){var v=Cc(g),y=il(f,(-p-v)/m);if(rl(y,h),y=Qc(y),!r)return y;var b,x=t[0],_=n[0],w=t[1],S=n[1];_<x&&(b=x,x=_,_=b);var M=_-x,E=yc(M-hc)<1e-6;if(!E&&S<w&&(b=w,w=S,S=b),E||M<1e-6?E?w+S>0^y[1]<(yc(y[0]-x)<1e-6?w:S):w<=y[1]&&y[1]<=S:M>hc^(x<=y[0]&&y[0]<=_)){var T=il(f,(-p+v)/m);return rl(T,h),[y,Qc(T)]}}}function s(e,n){var i=r?t:hc-t,o=0;return e<-i?o|=1:e>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return wu(o,(function(t){var e,n,c,l,u;return{lineStart:function(){l=c=!1,u=1},point:function(d,h){var f,p=[d,h],m=o(d,h),g=r?m?0:s(d,h):m?s(d+(d<0?hc:-hc),h):0;if(!e&&(l=c=m)&&t.lineStart(),m!==c&&(!(f=a(e,p))||mu(e,f)||mu(p,f))&&(p[2]=1),m!==c)u=0,m?(t.lineStart(),f=a(p,e),t.point(f[0],f[1])):(f=a(e,p),t.point(f[0],f[1],2),t.lineEnd()),e=f;else if(i&&e&&r^m){var v;g&n||!(v=a(p,e,!0))||(u=0,r?(t.lineStart(),t.point(v[0][0],v[0][1]),t.point(v[1][0],v[1][1]),t.lineEnd()):(t.point(v[1][0],v[1][1]),t.lineEnd(),t.lineStart(),t.point(v[0][0],v[0][1],3)))}!m||e&&mu(e,p)||t.point(p[0],p[1]),e=p,c=m,n=g},lineEnd:function(){c&&t.lineEnd(),e=null},clean:function(){return u|(l&&c)<<1}}}),(function(e,r,i,o){du(o,t,n,i,e,r)}),r?[0,-t]:[-hc,t-hc])};function Au(t,e,n,r){function i(i,o){return t<=i&&i<=n&&e<=o&&o<=r}function o(i,o,s,l){var u=0,d=0;if(null==i||(u=a(i,s))!==(d=a(o,s))||c(i,o)<0^s>0)do{l.point(0===u||3===u?t:n,u>1?r:e)}while((u=(u+s+4)%4)!==d);else l.point(o[0],o[1])}function a(r,i){return yc(r[0]-t)<1e-6?i>0?0:3:yc(r[0]-n)<1e-6?i>0?2:1:yc(r[1]-e)<1e-6?i>0?1:0:i>0?3:2}function s(t,e){return c(t.x,e.x)}function c(t,e){var n=a(t,1),r=a(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(a){var c,l,u,d,h,f,p,m,g,v,y,b=a,x=pu(),_={point:w,lineStart:function(){_.point=S,l&&l.push(u=[]);v=!0,g=!1,p=m=NaN},lineEnd:function(){c&&(S(d,h),f&&g&&x.rejoin(),c.push(x.result()));_.point=w,g&&b.lineEnd()},polygonStart:function(){b=x,c=[],l=[],y=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=l.length;n<i;++n)for(var o,a,s=l[n],c=1,u=s.length,d=s[0],h=d[0],f=d[1];c<u;++c)o=h,a=f,d=s[c],h=d[0],f=d[1],a<=r?f>r&&(h-o)*(r-a)>(f-a)*(t-o)&&++e:f<=r&&(h-o)*(r-a)<(f-a)*(t-o)&&--e;return e}(),n=y&&e,i=(c=j(c)).length;(n||i)&&(a.polygonStart(),n&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),i&&vu(c,s,e,o,a),a.polygonEnd());b=a,c=l=u=null}};function w(t,e){i(t,e)&&b.point(t,e)}function S(o,a){var s=i(o,a);if(l&&u.push([o,a]),v)d=o,h=a,f=s,v=!1,s&&(b.lineStart(),b.point(o,a));else if(s&&g)b.point(o,a);else{var c=[p=Math.max(-1e9,Math.min(1e9,p)),m=Math.max(-1e9,Math.min(1e9,m))],x=[o=Math.max(-1e9,Math.min(1e9,o)),a=Math.max(-1e9,Math.min(1e9,a))];!function(t,e,n,r,i,o){var a,s=t[0],c=t[1],l=0,u=1,d=e[0]-s,h=e[1]-c;if(a=n-s,d||!(a>0)){if(a/=d,d<0){if(a<l)return;a<u&&(u=a)}else if(d>0){if(a>u)return;a>l&&(l=a)}if(a=i-s,d||!(a<0)){if(a/=d,d<0){if(a>u)return;a>l&&(l=a)}else if(d>0){if(a<l)return;a<u&&(u=a)}if(a=r-c,h||!(a>0)){if(a/=h,h<0){if(a<l)return;a<u&&(u=a)}else if(h>0){if(a>u)return;a>l&&(l=a)}if(a=o-c,h||!(a<0)){if(a/=h,h<0){if(a>u)return;a>l&&(l=a)}else if(h>0){if(a<l)return;a<u&&(u=a)}return l>0&&(t[0]=s+l*d,t[1]=c+l*h),u<1&&(e[0]=s+u*d,e[1]=c+u*h),!0}}}}}(c,x,t,e,n,r)?s&&(b.lineStart(),b.point(o,a),y=!1):(g||(b.lineStart(),b.point(c[0],c[1])),b.point(x[0],x[1]),s||b.lineEnd(),y=!1)}p=o,m=a,g=s}return _}}var Cu,Pu,Ou,ku=function(){var t,e,n,r=0,i=0,o=960,a=500;return n={stream:function(n){return t&&e===n?t:t=Au(r,i,o,a)(e=n)},extent:function(s){return arguments.length?(r=+s[0][0],i=+s[0][1],o=+s[1][0],a=+s[1][1],t=e=null,n):[[r,i],[o,a]]}}},Lu=cc(),Ru={sphere:Rc,point:Rc,lineStart:function(){Ru.point=Nu,Ru.lineEnd=Iu},lineEnd:Rc,polygonStart:Rc,polygonEnd:Rc};function Iu(){Ru.point=Ru.lineEnd=Rc}function Nu(t,e){Cu=t*=vc,Pu=Tc(e*=vc),Ou=_c(e),Ru.point=Du}function Du(t,e){t*=vc;var n=Tc(e*=vc),r=_c(e),i=yc(t-Cu),o=_c(i),a=r*Tc(i),s=Ou*n-Pu*r*o,c=Pu*n+Ou*r*o;Lu.add(xc(Cc(a*a+s*s),c)),Cu=t,Pu=n,Ou=r}var zu=function(t){return Lu.reset(),Gc(t,Ru),+Lu},ju=[null,null],Fu={type:"LineString",coordinates:ju},Bu=function(t,e){return ju[0]=t,ju[1]=e,zu(Fu)},Uu={Feature:function(t,e){return Vu(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)if(Vu(n[r].geometry,e))return!0;return!1}},Hu={Sphere:function(){return!0},Point:function(t,e){return Gu(t.coordinates,e)},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(Gu(n[r],e))return!0;return!1},LineString:function(t,e){return Wu(t.coordinates,e)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(Wu(n[r],e))return!0;return!1},Polygon:function(t,e){return $u(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if($u(n[r],e))return!0;return!1},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)if(Vu(n[r],e))return!0;return!1}};function Vu(t,e){return!(!t||!Hu.hasOwnProperty(t.type))&&Hu[t.type](t,e)}function Gu(t,e){return 0===Bu(t,e)}function Wu(t,e){for(var n,r,i,o=0,a=t.length;o<a;o++){if(0===(r=Bu(t[o],e)))return!0;if(o>0&&(i=Bu(t[o],t[o-1]))>0&&n<=i&&r<=i&&(n+r-i)*(1-Math.pow((n-r)/i,2))<1e-12*i)return!0;n=r}return!1}function $u(t,e){return!!_u(t.map(qu),Xu(e))}function qu(t){return(t=t.map(Xu)).pop(),t}function Xu(t){return[t[0]*vc,t[1]*vc]}var Yu=function(t,e){return(t&&Uu.hasOwnProperty(t.type)?Uu[t.type]:Vu)(t,e)};function Ku(t,e,n){var r=S(t,e-1e-6,n).concat(e);return function(t){return r.map((function(e){return[t,e]}))}}function Zu(t,e,n){var r=S(t,e-1e-6,n).concat(e);return function(t){return r.map((function(e){return[e,t]}))}}function Ju(){var t,e,n,r,i,o,a,s,c,l,u,d,h=10,f=h,p=90,m=360,g=2.5;function v(){return{type:"MultiLineString",coordinates:y()}}function y(){return S(wc(r/p)*p,n,p).map(u).concat(S(wc(s/m)*m,a,m).map(d)).concat(S(wc(e/h)*h,t,h).filter((function(t){return yc(t%p)>1e-6})).map(c)).concat(S(wc(o/f)*f,i,f).filter((function(t){return yc(t%m)>1e-6})).map(l))}return v.lines=function(){return y().map((function(t){return{type:"LineString",coordinates:t}}))},v.outline=function(){return{type:"Polygon",coordinates:[u(r).concat(d(a).slice(1),u(n).reverse().slice(1),d(s).reverse().slice(1))]}},v.extent=function(t){return arguments.length?v.extentMajor(t).extentMinor(t):v.extentMinor()},v.extentMajor=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],s=+t[0][1],a=+t[1][1],r>n&&(t=r,r=n,n=t),s>a&&(t=s,s=a,a=t),v.precision(g)):[[r,s],[n,a]]},v.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],o=+n[0][1],i=+n[1][1],e>t&&(n=e,e=t,t=n),o>i&&(n=o,o=i,i=n),v.precision(g)):[[e,o],[t,i]]},v.step=function(t){return arguments.length?v.stepMajor(t).stepMinor(t):v.stepMinor()},v.stepMajor=function(t){return arguments.length?(p=+t[0],m=+t[1],v):[p,m]},v.stepMinor=function(t){return arguments.length?(h=+t[0],f=+t[1],v):[h,f]},v.precision=function(h){return arguments.length?(g=+h,c=Ku(o,i,90),l=Zu(e,t,g),u=Ku(s,a,90),d=Zu(r,n,g),v):g},v.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}function Qu(){return Ju()()}var td,ed,nd,rd,id=function(t,e){var n=t[0]*vc,r=t[1]*vc,i=e[0]*vc,o=e[1]*vc,a=_c(r),s=Tc(r),c=_c(o),l=Tc(o),u=a*_c(n),d=a*Tc(n),h=c*_c(i),f=c*Tc(i),p=2*kc(Cc(Lc(o-r)+a*c*Lc(i-n))),m=Tc(p),g=p?function(t){var e=Tc(t*=p)/m,n=Tc(p-t)/m,r=n*u+e*h,i=n*d+e*f,o=n*s+e*l;return[xc(i,r)*gc,xc(o,Cc(r*r+i*i))*gc]}:function(){return[n*gc,r*gc]};return g.distance=p,g},od=function(t){return t},ad=cc(),sd=cc(),cd={point:Rc,lineStart:Rc,lineEnd:Rc,polygonStart:function(){cd.lineStart=ld,cd.lineEnd=hd},polygonEnd:function(){cd.lineStart=cd.lineEnd=cd.point=Rc,ad.add(yc(sd)),sd.reset()},result:function(){var t=ad/2;return ad.reset(),t}};function ld(){cd.point=ud}function ud(t,e){cd.point=dd,td=nd=t,ed=rd=e}function dd(t,e){sd.add(rd*t-nd*e),nd=t,rd=e}function hd(){dd(td,ed)}var fd=cd,pd=1/0,md=pd,gd=-pd,vd=gd;var yd,bd,xd,_d,wd={point:function(t,e){t<pd&&(pd=t);t>gd&&(gd=t);e<md&&(md=e);e>vd&&(vd=e)},lineStart:Rc,lineEnd:Rc,polygonStart:Rc,polygonEnd:Rc,result:function(){var t=[[pd,md],[gd,vd]];return gd=vd=-(md=pd=1/0),t}},Sd=0,Md=0,Ed=0,Td=0,Ad=0,Cd=0,Pd=0,Od=0,kd=0,Ld={point:Rd,lineStart:Id,lineEnd:zd,polygonStart:function(){Ld.lineStart=jd,Ld.lineEnd=Fd},polygonEnd:function(){Ld.point=Rd,Ld.lineStart=Id,Ld.lineEnd=zd},result:function(){var t=kd?[Pd/kd,Od/kd]:Cd?[Td/Cd,Ad/Cd]:Ed?[Sd/Ed,Md/Ed]:[NaN,NaN];return Sd=Md=Ed=Td=Ad=Cd=Pd=Od=kd=0,t}};function Rd(t,e){Sd+=t,Md+=e,++Ed}function Id(){Ld.point=Nd}function Nd(t,e){Ld.point=Dd,Rd(xd=t,_d=e)}function Dd(t,e){var n=t-xd,r=e-_d,i=Cc(n*n+r*r);Td+=i*(xd+t)/2,Ad+=i*(_d+e)/2,Cd+=i,Rd(xd=t,_d=e)}function zd(){Ld.point=Rd}function jd(){Ld.point=Bd}function Fd(){Ud(yd,bd)}function Bd(t,e){Ld.point=Ud,Rd(yd=xd=t,bd=_d=e)}function Ud(t,e){var n=t-xd,r=e-_d,i=Cc(n*n+r*r);Td+=i*(xd+t)/2,Ad+=i*(_d+e)/2,Cd+=i,Pd+=(i=_d*t-xd*e)*(xd+t),Od+=i*(_d+e),kd+=3*i,Rd(xd=t,_d=e)}var Hd=Ld;function Vd(t){this._context=t}Vd.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,mc)}},result:Rc};var Gd,Wd,$d,qd,Xd,Yd=cc(),Kd={point:Rc,lineStart:function(){Kd.point=Zd},lineEnd:function(){Gd&&Jd(Wd,$d),Kd.point=Rc},polygonStart:function(){Gd=!0},polygonEnd:function(){Gd=null},result:function(){var t=+Yd;return Yd.reset(),t}};function Zd(t,e){Kd.point=Jd,Wd=qd=t,$d=Xd=e}function Jd(t,e){qd-=t,Xd-=e,Yd.add(Cc(qd*qd+Xd*Xd)),qd=t,Xd=e}var Qd=Kd;function th(){this._string=[]}function eh(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}th.prototype={_radius:4.5,_circle:eh(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=eh(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}};var nh=function(t,e){var n,r,i=4.5;function o(t){return t&&("function"==typeof i&&r.pointRadius(+i.apply(this,arguments)),Gc(t,n(r))),r.result()}return o.area=function(t){return Gc(t,n(fd)),fd.result()},o.measure=function(t){return Gc(t,n(Qd)),Qd.result()},o.bounds=function(t){return Gc(t,n(wd)),wd.result()},o.centroid=function(t){return Gc(t,n(Hd)),Hd.result()},o.projection=function(e){return arguments.length?(n=null==e?(t=null,od):(t=e).stream,o):t},o.context=function(t){return arguments.length?(r=null==t?(e=null,new th):new Vd(e=t),"function"!=typeof i&&r.pointRadius(i),o):e},o.pointRadius=function(t){return arguments.length?(i="function"==typeof t?t:(r.pointRadius(+t),+t),o):i},o.projection(t).context(e)},rh=function(t){return{stream:ih(t)}};function ih(t){return function(e){var n=new oh;for(var r in t)n[r]=t[r];return n.stream=e,n}}function oh(){}function ah(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),Gc(n,t.stream(wd)),e(wd.result()),null!=r&&t.clipExtent(r),t}function sh(t,e,n){return ah(t,(function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),a=+e[0][0]+(r-o*(n[1][0]+n[0][0]))/2,s=+e[0][1]+(i-o*(n[1][1]+n[0][1]))/2;t.scale(150*o).translate([a,s])}),n)}function ch(t,e,n){return sh(t,[[0,0],e],n)}function lh(t,e,n){return ah(t,(function(n){var r=+e,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,a=-i*n[0][1];t.scale(150*i).translate([o,a])}),n)}function uh(t,e,n){return ah(t,(function(n){var r=+e,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],a=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([o,a])}),n)}oh.prototype={constructor:oh,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var dh=_c(30*vc),hh=function(t,e){return+e?function(t,e){function n(r,i,o,a,s,c,l,u,d,h,f,p,m,g){var v=l-r,y=u-i,b=v*v+y*y;if(b>4*e&&m--){var x=a+h,_=s+f,w=c+p,S=Cc(x*x+_*_+w*w),M=kc(w/=S),E=yc(yc(w)-1)<1e-6||yc(o-d)<1e-6?(o+d)/2:xc(_,x),T=t(E,M),A=T[0],C=T[1],P=A-r,O=C-i,k=y*P-v*O;(k*k/b>e||yc((v*P+y*O)/b-.5)>.3||a*h+s*f+c*p<dh)&&(n(r,i,o,a,s,c,A,C,E,x/=S,_/=S,w,m,g),g.point(A,C),n(A,C,E,x,_,w,l,u,d,h,f,p,m,g))}}return function(e){var r,i,o,a,s,c,l,u,d,h,f,p,m={point:g,lineStart:v,lineEnd:b,polygonStart:function(){e.polygonStart(),m.lineStart=x},polygonEnd:function(){e.polygonEnd(),m.lineStart=v}};function g(n,r){n=t(n,r),e.point(n[0],n[1])}function v(){u=NaN,m.point=y,e.lineStart()}function y(r,i){var o=tl([r,i]),a=t(r,i);n(u,d,l,h,f,p,u=a[0],d=a[1],l=r,h=o[0],f=o[1],p=o[2],16,e),e.point(u,d)}function b(){m.point=g,e.lineEnd()}function x(){v(),m.point=_,m.lineEnd=w}function _(t,e){y(r=t,e),i=u,o=d,a=h,s=f,c=p,m.point=y}function w(){n(u,d,l,h,f,p,i,o,r,a,s,c,16,e),m.lineEnd=b,b()}return m}}(t,e):function(t){return ih({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)};var fh=ih({point:function(t,e){this.stream.point(t*vc,e*vc)}});function ph(t,e,n,r,i){function o(o,a){return[e+t*(o*=r),n-t*(a*=i)]}return o.invert=function(o,a){return[(o-e)/t*r,(n-a)/t*i]},o}function mh(t,e,n,r,i,o){var a=_c(o),s=Tc(o),c=a*t,l=s*t,u=a/t,d=s/t,h=(s*n-a*e)/t,f=(s*e+a*n)/t;function p(t,o){return[c*(t*=r)-l*(o*=i)+e,n-l*t-c*o]}return p.invert=function(t,e){return[r*(u*t-d*e+h),i*(f-d*t-u*e)]},p}function gh(t){return vh((function(){return t}))()}function vh(t){var e,n,r,i,o,a,s,c,l,u,d=150,h=480,f=250,p=0,m=0,g=0,v=0,y=0,b=0,x=1,_=1,w=null,S=Eu,M=null,E=od,T=.5;function A(t){return c(t[0]*vc,t[1]*vc)}function C(t){return(t=c.invert(t[0],t[1]))&&[t[0]*gc,t[1]*gc]}function P(){var t=mh(d,0,0,x,_,b).apply(null,e(p,m)),r=(b?mh:ph)(d,h-t[0],f-t[1],x,_,b);return n=au(g,v,y),s=iu(e,r),c=iu(n,s),a=hh(s,T),O()}function O(){return l=u=null,A}return A.stream=function(t){return l&&u===t?l:l=fh(function(t){return ih({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}(n)(S(a(E(u=t)))))},A.preclip=function(t){return arguments.length?(S=t,w=void 0,O()):S},A.postclip=function(t){return arguments.length?(E=t,M=r=i=o=null,O()):E},A.clipAngle=function(t){return arguments.length?(S=+t?Tu(w=t*vc):(w=null,Eu),O()):w*gc},A.clipExtent=function(t){return arguments.length?(E=null==t?(M=r=i=o=null,od):Au(M=+t[0][0],r=+t[0][1],i=+t[1][0],o=+t[1][1]),O()):null==M?null:[[M,r],[i,o]]},A.scale=function(t){return arguments.length?(d=+t,P()):d},A.translate=function(t){return arguments.length?(h=+t[0],f=+t[1],P()):[h,f]},A.center=function(t){return arguments.length?(p=t[0]%360*vc,m=t[1]%360*vc,P()):[p*gc,m*gc]},A.rotate=function(t){return arguments.length?(g=t[0]%360*vc,v=t[1]%360*vc,y=t.length>2?t[2]%360*vc:0,P()):[g*gc,v*gc,y*gc]},A.angle=function(t){return arguments.length?(b=t%360*vc,P()):b*gc},A.reflectX=function(t){return arguments.length?(x=t?-1:1,P()):x<0},A.reflectY=function(t){return arguments.length?(_=t?-1:1,P()):_<0},A.precision=function(t){return arguments.length?(a=hh(s,T=t*t),O()):Cc(T)},A.fitExtent=function(t,e){return sh(A,t,e)},A.fitSize=function(t,e){return ch(A,t,e)},A.fitWidth=function(t,e){return lh(A,t,e)},A.fitHeight=function(t,e){return uh(A,t,e)},function(){return e=t.apply(this,arguments),A.invert=e.invert&&C,P()}}function yh(t){var e=0,n=hc/3,r=vh(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*vc,n=t[1]*vc):[e*gc,n*gc]},i}function bh(t,e){var n=Tc(t),r=(n+Tc(e))/2;if(yc(r)<1e-6)return function(t){var e=_c(t);function n(t,n){return[t*e,Tc(n)/e]}return n.invert=function(t,n){return[t/e,kc(n*e)]},n}(t);var i=1+n*(2*r-n),o=Cc(i)/r;function a(t,e){var n=Cc(i-2*r*Tc(e))/r;return[n*Tc(t*=r),o-n*_c(t)]}return a.invert=function(t,e){var n=o-e,a=xc(t,yc(n))*Ac(n);return n*r<0&&(a-=hc*Ac(t)*Ac(n)),[a/r,kc((i-(t*t+n*n)*r*r)/(2*r))]},a}var xh=function(){return yh(bh).scale(155.424).center([0,33.6442])},_h=function(){return xh().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])};var wh=function(){var t,e,n,r,i,o,a=_h(),s=xh().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=xh().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(t,e){o=[t,e]}};function u(t){var e=t[0],a=t[1];return o=null,n.point(e,a),o||(r.point(e,a),o)||(i.point(e,a),o)}function d(){return t=e=null,u}return u.invert=function(t){var e=a.scale(),n=a.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?c:a).invert(t)},u.stream=function(n){return t&&e===n?t:(r=[a.stream(e=n),s.stream(n),c.stream(n)],i=r.length,t={point:function(t,e){for(var n=-1;++n<i;)r[n].point(t,e)},sphere:function(){for(var t=-1;++t<i;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<i;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<i;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<i;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<i;)r[t].polygonEnd()}});var r,i},u.precision=function(t){return arguments.length?(a.precision(t),s.precision(t),c.precision(t),d()):a.precision()},u.scale=function(t){return arguments.length?(a.scale(t),s.scale(.35*t),c.scale(t),u.translate(a.translate())):a.scale()},u.translate=function(t){if(!arguments.length)return a.translate();var e=a.scale(),o=+t[0],u=+t[1];return n=a.translate(t).clipExtent([[o-.455*e,u-.238*e],[o+.455*e,u+.238*e]]).stream(l),r=s.translate([o-.307*e,u+.201*e]).clipExtent([[o-.425*e+1e-6,u+.12*e+1e-6],[o-.214*e-1e-6,u+.234*e-1e-6]]).stream(l),i=c.translate([o-.205*e,u+.212*e]).clipExtent([[o-.214*e+1e-6,u+.166*e+1e-6],[o-.115*e-1e-6,u+.234*e-1e-6]]).stream(l),d()},u.fitExtent=function(t,e){return sh(u,t,e)},u.fitSize=function(t,e){return ch(u,t,e)},u.fitWidth=function(t,e){return lh(u,t,e)},u.fitHeight=function(t,e){return uh(u,t,e)},u.scale(1070)};function Sh(t){return function(e,n){var r=_c(e),i=_c(n),o=t(r*i);return[o*i*Tc(e),o*Tc(n)]}}function Mh(t){return function(e,n){var r=Cc(e*e+n*n),i=t(r),o=Tc(i),a=_c(i);return[xc(e*o,r*a),kc(r&&n*o/r)]}}var Eh=Sh((function(t){return Cc(2/(1+t))}));Eh.invert=Mh((function(t){return 2*kc(t/2)}));var Th=function(){return gh(Eh).scale(124.75).clipAngle(179.999)},Ah=Sh((function(t){return(t=Oc(t))&&t/Tc(t)}));Ah.invert=Mh((function(t){return t}));var Ch=function(){return gh(Ah).scale(79.4188).clipAngle(179.999)};function Ph(t,e){return[t,Mc(Pc((fc+e)/2))]}Ph.invert=function(t,e){return[t,2*bc(Sc(e))-fc]};var Oh=function(){return kh(Ph).scale(961/mc)};function kh(t){var e,n,r,i=gh(t),o=i.center,a=i.scale,s=i.translate,c=i.clipExtent,l=null;function u(){var o=hc*a(),s=i(uu(i.rotate()).invert([0,0]));return c(null==l?[[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]]:t===Ph?[[Math.max(s[0]-o,l),e],[Math.min(s[0]+o,n),r]]:[[l,Math.max(s[1]-o,e)],[n,Math.min(s[1]+o,r)]])}return i.scale=function(t){return arguments.length?(a(t),u()):a()},i.translate=function(t){return arguments.length?(s(t),u()):s()},i.center=function(t){return arguments.length?(o(t),u()):o()},i.clipExtent=function(t){return arguments.length?(null==t?l=e=n=r=null:(l=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),u()):null==l?null:[[l,e],[n,r]]},u()}function Lh(t){return Pc((fc+t)/2)}function Rh(t,e){var n=_c(t),r=t===e?Tc(t):Mc(n/_c(e))/Mc(Lh(e)/Lh(t)),i=n*Ec(Lh(t),r)/r;if(!r)return Ph;function o(t,e){i>0?e<1e-6-fc&&(e=1e-6-fc):e>fc-1e-6&&(e=fc-1e-6);var n=i/Ec(Lh(e),r);return[n*Tc(r*t),i-n*_c(r*t)]}return o.invert=function(t,e){var n=i-e,o=Ac(r)*Cc(t*t+n*n),a=xc(t,yc(n))*Ac(n);return n*r<0&&(a-=hc*Ac(t)*Ac(n)),[a/r,2*bc(Ec(i/o,1/r))-fc]},o}var Ih=function(){return yh(Rh).scale(109.5).parallels([30,30])};function Nh(t,e){return[t,e]}Nh.invert=Nh;var Dh=function(){return gh(Nh).scale(152.63)};function zh(t,e){var n=_c(t),r=t===e?Tc(t):(n-_c(e))/(e-t),i=n/r+t;if(yc(r)<1e-6)return Nh;function o(t,e){var n=i-e,o=r*t;return[n*Tc(o),i-n*_c(o)]}return o.invert=function(t,e){var n=i-e,o=xc(t,yc(n))*Ac(n);return n*r<0&&(o-=hc*Ac(t)*Ac(n)),[o/r,i-Ac(r)*Cc(t*t+n*n)]},o}var jh=function(){return yh(zh).scale(131.154).center([0,13.9389])},Fh=1.340264,Bh=-.081106,Uh=893e-6,Hh=.003796,Vh=Cc(3)/2;function Gh(t,e){var n=kc(Vh*Tc(e)),r=n*n,i=r*r*r;return[t*_c(n)/(Vh*(Fh+3*Bh*r+i*(7*Uh+9*Hh*r))),n*(Fh+Bh*r+i*(Uh+Hh*r))]}Gh.invert=function(t,e){for(var n,r=e,i=r*r,o=i*i*i,a=0;a<12&&(o=(i=(r-=n=(r*(Fh+Bh*i+o*(Uh+Hh*i))-e)/(Fh+3*Bh*i+o*(7*Uh+9*Hh*i)))*r)*i*i,!(yc(n)<1e-12));++a);return[Vh*t*(Fh+3*Bh*i+o*(7*Uh+9*Hh*i))/_c(r),kc(Tc(r)/Vh)]};var Wh=function(){return gh(Gh).scale(177.158)};function $h(t,e){var n=_c(e),r=_c(t)*n;return[n*Tc(t)/r,Tc(e)/r]}$h.invert=Mh(bc);var qh=function(){return gh($h).scale(144.049).clipAngle(60)},Xh=function(){var t,e,n,r,i,o,a,s=1,c=0,l=0,u=1,d=1,h=0,f=null,p=1,m=1,g=ih({point:function(t,e){var n=b([t,e]);this.stream.point(n[0],n[1])}}),v=od;function y(){return p=s*u,m=s*d,o=a=null,b}function b(n){var r=n[0]*p,i=n[1]*m;if(h){var o=i*t-r*e;r=r*t+i*e,i=o}return[r+c,i+l]}return b.invert=function(n){var r=n[0]-c,i=n[1]-l;if(h){var o=i*t+r*e;r=r*t-i*e,i=o}return[r/p,i/m]},b.stream=function(t){return o&&a===t?o:o=g(v(a=t))},b.postclip=function(t){return arguments.length?(v=t,f=n=r=i=null,y()):v},b.clipExtent=function(t){return arguments.length?(v=null==t?(f=n=r=i=null,od):Au(f=+t[0][0],n=+t[0][1],r=+t[1][0],i=+t[1][1]),y()):null==f?null:[[f,n],[r,i]]},b.scale=function(t){return arguments.length?(s=+t,y()):s},b.translate=function(t){return arguments.length?(c=+t[0],l=+t[1],y()):[c,l]},b.angle=function(n){return arguments.length?(e=Tc(h=n%360*vc),t=_c(h),y()):h*gc},b.reflectX=function(t){return arguments.length?(u=t?-1:1,y()):u<0},b.reflectY=function(t){return arguments.length?(d=t?-1:1,y()):d<0},b.fitExtent=function(t,e){return sh(b,t,e)},b.fitSize=function(t,e){return ch(b,t,e)},b.fitWidth=function(t,e){return lh(b,t,e)},b.fitHeight=function(t,e){return uh(b,t,e)},b};function Yh(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}Yh.invert=function(t,e){var n,r=e,i=25;do{var o=r*r,a=o*o;r-=n=(r*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-e)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while(yc(n)>1e-6&&--i>0);return[t/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]};var Kh=function(){return gh(Yh).scale(175.295)};function Zh(t,e){return[_c(e)*Tc(t),Tc(e)]}Zh.invert=Mh(kc);var Jh=function(){return gh(Zh).scale(249.5).clipAngle(90.000001)};function Qh(t,e){var n=_c(e),r=1+_c(t)*n;return[n*Tc(t)/r,Tc(e)/r]}Qh.invert=Mh((function(t){return 2*bc(t)}));var tf=function(){return gh(Qh).scale(250).clipAngle(142)};function ef(t,e){return[Mc(Pc((fc+e)/2)),-t]}ef.invert=function(t,e){return[-e,2*bc(Sc(t))-fc]};var nf=function(){var t=kh(ef),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)};function rf(t,e){return t.parent===e.parent?1:2}function of(t,e){return t+e.x}function af(t,e){return Math.max(t,e.y)}var sf=function(){var t=rf,e=1,n=1,r=!1;function i(i){var o,a=0;i.eachAfter((function(e){var n=e.children;n?(e.x=function(t){return t.reduce(of,0)/t.length}(n),e.y=function(t){return 1+t.reduce(af,0)}(n)):(e.x=o?a+=t(e,o):0,e.y=0,o=e)}));var s=function(t){for(var e;e=t.children;)t=e[0];return t}(i),c=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(i),l=s.x-t(s,c)/2,u=c.x+t(c,s)/2;return i.eachAfter(r?function(t){t.x=(t.x-i.x)*e,t.y=(i.y-t.y)*n}:function(t){t.x=(t.x-l)/(u-l)*e,t.y=(1-(i.y?t.y/i.y:1))*n})}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i};function cf(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function lf(t,e){var n,r,i,o,a,s=new ff(t),c=+t.value&&(s.value=t.value),l=[s];for(null==e&&(e=uf);n=l.pop();)if(c&&(n.value=+n.data.value),(i=e(n.data))&&(a=i.length))for(n.children=new Array(a),o=a-1;o>=0;--o)l.push(r=n.children[o]=new ff(i[o])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(hf)}function uf(t){return t.children}function df(t){t.data=t.data.data}function hf(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function ff(t){this.data=t,this.depth=this.height=0,this.parent=null}ff.prototype=lf.prototype={constructor:ff,count:function(){return this.eachAfter(cf)},each:function(t){var e,n,r,i,o=this,a=[o];do{for(e=a.reverse(),a=[];o=e.pop();)if(t(o),n=o.children)for(r=0,i=n.length;r<i;++r)a.push(n[r])}while(a.length);return this},eachAfter:function(t){for(var e,n,r,i=this,o=[i],a=[];i=o.pop();)if(a.push(i),e=i.children)for(n=0,r=e.length;n<r;++n)o.push(e[n]);for(;i=a.pop();)t(i);return this},eachBefore:function(t){for(var e,n,r=this,i=[r];r=i.pop();)if(t(r),e=r.children)for(n=e.length-1;n>=0;--n)i.push(e[n]);return this},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;t=n.pop(),e=r.pop();for(;t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){var t=[];return this.each((function(e){t.push(e)})),t},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return lf(this).eachBefore(df)}};var pf=Array.prototype.slice;var mf=function(t){for(var e,n,r=0,i=(t=function(t){for(var e,n,r=t.length;r;)n=Math.random()*r--|0,e=t[r],t[r]=t[n],t[n]=e;return t}(pf.call(t))).length,o=[];r<i;)e=t[r],n&&yf(n,e)?++r:(n=xf(o=gf(o,e)),r=0);return n};function gf(t,e){var n,r;if(bf(e,t))return[e];for(n=0;n<t.length;++n)if(vf(e,t[n])&&bf(_f(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(vf(_f(t[n],t[r]),e)&&vf(_f(t[n],e),t[r])&&vf(_f(t[r],e),t[n])&&bf(wf(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function vf(t,e){var n=t.r-e.r,r=e.x-t.x,i=e.y-t.y;return n<0||n*n<r*r+i*i}function yf(t,e){var n=t.r-e.r+1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function bf(t,e){for(var n=0;n<e.length;++n)if(!yf(t,e[n]))return!1;return!0}function xf(t){switch(t.length){case 1:return{x:(e=t[0]).x,y:e.y,r:e.r};case 2:return _f(t[0],t[1]);case 3:return wf(t[0],t[1],t[2])}var e}function _f(t,e){var n=t.x,r=t.y,i=t.r,o=e.x,a=e.y,s=e.r,c=o-n,l=a-r,u=s-i,d=Math.sqrt(c*c+l*l);return{x:(n+o+c/d*u)/2,y:(r+a+l/d*u)/2,r:(d+i+s)/2}}function wf(t,e,n){var r=t.x,i=t.y,o=t.r,a=e.x,s=e.y,c=e.r,l=n.x,u=n.y,d=n.r,h=r-a,f=r-l,p=i-s,m=i-u,g=c-o,v=d-o,y=r*r+i*i-o*o,b=y-a*a-s*s+c*c,x=y-l*l-u*u+d*d,_=f*p-h*m,w=(p*x-m*b)/(2*_)-r,S=(m*g-p*v)/_,M=(f*b-h*x)/(2*_)-i,E=(h*v-f*g)/_,T=S*S+E*E-1,A=2*(o+w*S+M*E),C=w*w+M*M-o*o,P=-(T?(A+Math.sqrt(A*A-4*T*C))/(2*T):C/A);return{x:r+w+S*P,y:i+M+E*P,r:P}}function Sf(t,e,n){var r,i,o,a,s=t.x-e.x,c=t.y-e.y,l=s*s+c*c;l?(i=e.r+n.r,i*=i,a=t.r+n.r,i>(a*=a)?(r=(l+a-i)/(2*l),o=Math.sqrt(Math.max(0,a/l-r*r)),n.x=t.x-r*s-o*c,n.y=t.y-r*c+o*s):(r=(l+i-a)/(2*l),o=Math.sqrt(Math.max(0,i/l-r*r)),n.x=e.x+r*s-o*c,n.y=e.y+r*c+o*s)):(n.x=e.x+n.r,n.y=e.y)}function Mf(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function Ef(t){var e=t._,n=t.next._,r=e.r+n.r,i=(e.x*n.r+n.x*e.r)/r,o=(e.y*n.r+n.y*e.r)/r;return i*i+o*o}function Tf(t){this._=t,this.next=null,this.previous=null}function Af(t){if(!(i=t.length))return 0;var e,n,r,i,o,a,s,c,l,u,d;if((e=t[0]).x=0,e.y=0,!(i>1))return e.r;if(n=t[1],e.x=-n.r,n.x=e.r,n.y=0,!(i>2))return e.r+n.r;Sf(n,e,r=t[2]),e=new Tf(e),n=new Tf(n),r=new Tf(r),e.next=r.previous=n,n.next=e.previous=r,r.next=n.previous=e;t:for(s=3;s<i;++s){Sf(e._,n._,r=t[s]),r=new Tf(r),c=n.next,l=e.previous,u=n._.r,d=e._.r;do{if(u<=d){if(Mf(c._,r._)){n=c,e.next=n,n.previous=e,--s;continue t}u+=c._.r,c=c.next}else{if(Mf(l._,r._)){(e=l).next=n,n.previous=e,--s;continue t}d+=l._.r,l=l.previous}}while(c!==l.next);for(r.previous=e,r.next=n,e.next=n.previous=n=r,o=Ef(e);(r=r.next)!==n;)(a=Ef(r))<o&&(e=r,o=a);n=e.next}for(e=[n._],r=n;(r=r.next)!==n;)e.push(r._);for(r=mf(e),s=0;s<i;++s)(e=t[s]).x-=r.x,e.y-=r.y;return r.r}var Cf=function(t){return Af(t),t};function Pf(t){return null==t?null:Of(t)}function Of(t){if("function"!=typeof t)throw new Error;return t}function kf(){return 0}var Lf=function(t){return function(){return t}};function Rf(t){return Math.sqrt(t.value)}var If=function(){var t=null,e=1,n=1,r=kf;function i(i){return i.x=e/2,i.y=n/2,t?i.eachBefore(Nf(t)).eachAfter(Df(r,.5)).eachBefore(zf(1)):i.eachBefore(Nf(Rf)).eachAfter(Df(kf,1)).eachAfter(Df(r,i.r/Math.min(e,n))).eachBefore(zf(Math.min(e,n)/(2*i.r))),i}return i.radius=function(e){return arguments.length?(t=Pf(e),i):t},i.size=function(t){return arguments.length?(e=+t[0],n=+t[1],i):[e,n]},i.padding=function(t){return arguments.length?(r="function"==typeof t?t:Lf(+t),i):r},i};function Nf(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function Df(t,e){return function(n){if(r=n.children){var r,i,o,a=r.length,s=t(n)*e||0;if(s)for(i=0;i<a;++i)r[i].r+=s;if(o=Af(r),s)for(i=0;i<a;++i)r[i].r-=s;n.r=o+s}}}function zf(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}var jf=function(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)},Ff=function(t,e,n,r,i){for(var o,a=t.children,s=-1,c=a.length,l=t.value&&(r-e)/t.value;++s<c;)(o=a[s]).y0=n,o.y1=i,o.x0=e,o.x1=e+=o.value*l},Bf=function(){var t=1,e=1,n=0,r=!1;function i(i){var o=i.height+1;return i.x0=i.y0=n,i.x1=t,i.y1=e/o,i.eachBefore(function(t,e){return function(r){r.children&&Ff(r,r.x0,t*(r.depth+1)/e,r.x1,t*(r.depth+2)/e);var i=r.x0,o=r.y0,a=r.x1-n,s=r.y1-n;a<i&&(i=a=(i+a)/2),s<o&&(o=s=(o+s)/2),r.x0=i,r.y0=o,r.x1=a,r.y1=s}}(e,o)),r&&i.eachBefore(jf),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(n){return arguments.length?(t=+n[0],e=+n[1],i):[t,e]},i.padding=function(t){return arguments.length?(n=+t,i):n},i},Uf={depth:-1},Hf={};function Vf(t){return t.id}function Gf(t){return t.parentId}var Wf=function(){var t=Vf,e=Gf;function n(n){var r,i,o,a,s,c,l,u=n.length,d=new Array(u),h={};for(i=0;i<u;++i)r=n[i],s=d[i]=new ff(r),null!=(c=t(r,i,n))&&(c+="")&&(h[l="$"+(s.id=c)]=l in h?Hf:s);for(i=0;i<u;++i)if(s=d[i],null!=(c=e(n[i],i,n))&&(c+="")){if(!(a=h["$"+c]))throw new Error("missing: "+c);if(a===Hf)throw new Error("ambiguous: "+c);a.children?a.children.push(s):a.children=[s],s.parent=a}else{if(o)throw new Error("multiple roots");o=s}if(!o)throw new Error("no root");if(o.parent=Uf,o.eachBefore((function(t){t.depth=t.parent.depth+1,--u})).eachBefore(hf),o.parent=null,u>0)throw new Error("cycle");return o}return n.id=function(e){return arguments.length?(t=Of(e),n):t},n.parentId=function(t){return arguments.length?(e=Of(t),n):e},n};function $f(t,e){return t.parent===e.parent?1:2}function qf(t){var e=t.children;return e?e[0]:t.t}function Xf(t){var e=t.children;return e?e[e.length-1]:t.t}function Yf(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function Kf(t,e,n){return t.a.parent===e.parent?t.a:n}function Zf(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}Zf.prototype=Object.create(ff.prototype);var Jf=function(){var t=$f,e=1,n=1,r=null;function i(i){var c=function(t){for(var e,n,r,i,o,a=new Zf(t,0),s=[a];e=s.pop();)if(r=e._.children)for(e.children=new Array(o=r.length),i=o-1;i>=0;--i)s.push(n=e.children[i]=new Zf(r[i],i)),n.parent=e;return(a.parent=new Zf(null,0)).children=[a],a}(i);if(c.eachAfter(o),c.parent.m=-c.z,c.eachBefore(a),r)i.eachBefore(s);else{var l=i,u=i,d=i;i.eachBefore((function(t){t.x<l.x&&(l=t),t.x>u.x&&(u=t),t.depth>d.depth&&(d=t)}));var h=l===u?1:t(l,u)/2,f=h-l.x,p=e/(u.x+h+f),m=n/(d.depth||1);i.eachBefore((function(t){t.x=(t.x+f)*p,t.y=t.depth*m}))}return i}function o(e){var n=e.children,r=e.parent.children,i=e.i?r[e.i-1]:null;if(n){!function(t){for(var e,n=0,r=0,i=t.children,o=i.length;--o>=0;)(e=i[o]).z+=n,e.m+=n,n+=e.s+(r+=e.c)}(e);var o=(n[0].z+n[n.length-1].z)/2;i?(e.z=i.z+t(e._,i._),e.m=e.z-o):e.z=o}else i&&(e.z=i.z+t(e._,i._));e.parent.A=function(e,n,r){if(n){for(var i,o=e,a=e,s=n,c=o.parent.children[0],l=o.m,u=a.m,d=s.m,h=c.m;s=Xf(s),o=qf(o),s&&o;)c=qf(c),(a=Xf(a)).a=e,(i=s.z+d-o.z-l+t(s._,o._))>0&&(Yf(Kf(s,e,r),e,i),l+=i,u+=i),d+=s.m,l+=o.m,h+=c.m,u+=a.m;s&&!Xf(a)&&(a.t=s,a.m+=d-u),o&&!qf(c)&&(c.t=o,c.m+=l-h,r=e)}return r}(e,i,e.parent.A||r[0])}function a(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function s(t){t.x*=e,t.y=t.depth*n}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i},Qf=function(t,e,n,r,i){for(var o,a=t.children,s=-1,c=a.length,l=t.value&&(i-n)/t.value;++s<c;)(o=a[s]).x0=e,o.x1=r,o.y0=n,o.y1=n+=o.value*l},tp=(1+Math.sqrt(5))/2;function ep(t,e,n,r,i,o){for(var a,s,c,l,u,d,h,f,p,m,g,v=[],y=e.children,b=0,x=0,_=y.length,w=e.value;b<_;){c=i-n,l=o-r;do{u=y[x++].value}while(!u&&x<_);for(d=h=u,g=u*u*(m=Math.max(l/c,c/l)/(w*t)),p=Math.max(h/g,g/d);x<_;++x){if(u+=s=y[x].value,s<d&&(d=s),s>h&&(h=s),g=u*u*m,(f=Math.max(h/g,g/d))>p){u-=s;break}p=f}v.push(a={value:u,dice:c<l,children:y.slice(b,x)}),a.dice?Ff(a,n,r,i,w?r+=l*u/w:o):Qf(a,n,r,w?n+=c*u/w:i,o),w-=u,b=x}return v}var np=function t(e){function n(t,n,r,i,o){ep(e,t,n,r,i,o)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(tp),rp=function(){var t=np,e=!1,n=1,r=1,i=[0],o=kf,a=kf,s=kf,c=kf,l=kf;function u(t){return t.x0=t.y0=0,t.x1=n,t.y1=r,t.eachBefore(d),i=[0],e&&t.eachBefore(jf),t}function d(e){var n=i[e.depth],r=e.x0+n,u=e.y0+n,d=e.x1-n,h=e.y1-n;d<r&&(r=d=(r+d)/2),h<u&&(u=h=(u+h)/2),e.x0=r,e.y0=u,e.x1=d,e.y1=h,e.children&&(n=i[e.depth+1]=o(e)/2,r+=l(e)-n,u+=a(e)-n,(d-=s(e)-n)<r&&(r=d=(r+d)/2),(h-=c(e)-n)<u&&(u=h=(u+h)/2),t(e,r,u,d,h))}return u.round=function(t){return arguments.length?(e=!!t,u):e},u.size=function(t){return arguments.length?(n=+t[0],r=+t[1],u):[n,r]},u.tile=function(e){return arguments.length?(t=Of(e),u):t},u.padding=function(t){return arguments.length?u.paddingInner(t).paddingOuter(t):u.paddingInner()},u.paddingInner=function(t){return arguments.length?(o="function"==typeof t?t:Lf(+t),u):o},u.paddingOuter=function(t){return arguments.length?u.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):u.paddingTop()},u.paddingTop=function(t){return arguments.length?(a="function"==typeof t?t:Lf(+t),u):a},u.paddingRight=function(t){return arguments.length?(s="function"==typeof t?t:Lf(+t),u):s},u.paddingBottom=function(t){return arguments.length?(c="function"==typeof t?t:Lf(+t),u):c},u.paddingLeft=function(t){return arguments.length?(l="function"==typeof t?t:Lf(+t),u):l},u},ip=function(t,e,n,r,i){var o,a,s=t.children,c=s.length,l=new Array(c+1);for(l[0]=a=o=0;o<c;++o)l[o+1]=a+=s[o].value;!function t(e,n,r,i,o,a,c){if(e>=n-1){var u=s[e];return u.x0=i,u.y0=o,u.x1=a,void(u.y1=c)}var d=l[e],h=r/2+d,f=e+1,p=n-1;for(;f<p;){var m=f+p>>>1;l[m]<h?f=m+1:p=m}h-l[f-1]<l[f]-h&&e+1<f&&--f;var g=l[f]-d,v=r-g;if(a-i>c-o){var y=(i*v+a*g)/r;t(e,f,g,i,o,y,c),t(f,n,v,y,o,a,c)}else{var b=(o*v+c*g)/r;t(e,f,g,i,o,a,b),t(f,n,v,i,b,a,c)}}(0,c,t.value,e,n,r,i)},op=function(t,e,n,r,i){(1&t.depth?Qf:Ff)(t,e,n,r,i)},ap=function t(e){function n(t,n,r,i,o){if((a=t._squarify)&&a.ratio===e)for(var a,s,c,l,u,d=-1,h=a.length,f=t.value;++d<h;){for(c=(s=a[d]).children,l=s.value=0,u=c.length;l<u;++l)s.value+=c[l].value;s.dice?Ff(s,n,r,i,r+=(o-r)*s.value/f):Qf(s,n,r,n+=(i-n)*s.value/f,o),f-=s.value}else t._squarify=a=ep(e,t,n,r,i,o),a.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(tp),sp=function(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}},cp=function(t,e){var n=un(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}},lp=function(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}},up=Math.SQRT2;function dp(t){return((t=Math.exp(t))+1/t)/2}var hp=function(t,e){var n,r,i=t[0],o=t[1],a=t[2],s=e[0],c=e[1],l=e[2],u=s-i,d=c-o,h=u*u+d*d;if(h<1e-12)r=Math.log(l/a)/up,n=function(t){return[i+t*u,o+t*d,a*Math.exp(up*t*r)]};else{var f=Math.sqrt(h),p=(l*l-a*a+4*h)/(2*a*2*f),m=(l*l-a*a-4*h)/(2*l*2*f),g=Math.log(Math.sqrt(p*p+1)-p),v=Math.log(Math.sqrt(m*m+1)-m);r=(v-g)/up,n=function(t){var e,n=t*r,s=dp(g),c=a/(2*f)*(s*(e=up*n+g,((e=Math.exp(2*e))-1)/(e+1))-function(t){return((t=Math.exp(t))-1/t)/2}(g));return[i+c*u,o+c*d,a*s/dp(up*n+g)]}}return n.duration=1e3*r,n};function fp(t){return function(e,n){var r=t((e=en(e)).h,(n=en(n)).h),i=hn(e.s,n.s),o=hn(e.l,n.l),a=hn(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=o(t),e.opacity=a(t),e+""}}}var pp=fp(un),mp=fp(hn);function gp(t,e){var n=hn((t=go(t)).l,(e=go(e)).l),r=hn(t.a,e.a),i=hn(t.b,e.b),o=hn(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=o(e),t+""}}function vp(t){return function(e,n){var r=t((e=Mo(e)).h,(n=Mo(n)).h),i=hn(e.c,n.c),o=hn(e.l,n.l),a=hn(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=o(t),e.opacity=a(t),e+""}}}var yp=vp(un),bp=vp(hn);function xp(t){return function e(n){function r(e,r){var i=t((e=Lo(e)).h,(r=Lo(r)).h),o=hn(e.s,r.s),a=hn(e.l,r.l),s=hn(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=o(t),e.l=a(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}var _p=xp(un),wp=xp(hn);function Sp(t,e){for(var n=0,r=e.length-1,i=e[0],o=new Array(r<0?0:r);n<r;)o[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return o[e](t-e)}}var Mp=function(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n},Ep=function(t){for(var e,n=-1,r=t.length,i=t[r-1],o=0;++n<r;)e=i,i=t[n],o+=e[1]*i[0]-e[0]*i[1];return o/2},Tp=function(t){for(var e,n,r=-1,i=t.length,o=0,a=0,s=t[i-1],c=0;++r<i;)e=s,s=t[r],c+=n=e[0]*s[1]-s[0]*e[1],o+=(e[0]+s[0])*n,a+=(e[1]+s[1])*n;return[o/(c*=3),a/c]};function Ap(t,e){return t[0]-e[0]||t[1]-e[1]}function Cp(t){for(var e,n,r,i=t.length,o=[0,1],a=2,s=2;s<i;++s){for(;a>1&&(e=t[o[a-2]],n=t[o[a-1]],r=t[s],(n[0]-e[0])*(r[1]-e[1])-(n[1]-e[1])*(r[0]-e[0])<=0);)--a;o[a++]=s}return o.slice(0,a)}var Pp=function(t){if((n=t.length)<3)return null;var e,n,r=new Array(n),i=new Array(n);for(e=0;e<n;++e)r[e]=[+t[e][0],+t[e][1],e];for(r.sort(Ap),e=0;e<n;++e)i[e]=[r[e][0],-r[e][1]];var o=Cp(r),a=Cp(i),s=a[0]===o[0],c=a[a.length-1]===o[o.length-1],l=[];for(e=o.length-1;e>=0;--e)l.push(t[r[o[e]][2]]);for(e=+s;e<a.length-c;++e)l.push(t[r[a[e]][2]]);return l},Op=function(t,e){for(var n,r,i=t.length,o=t[i-1],a=e[0],s=e[1],c=o[0],l=o[1],u=!1,d=0;d<i;++d)n=(o=t[d])[0],(r=o[1])>s!=l>s&&a<(c-n)*(s-r)/(l-r)+n&&(u=!u),c=n,l=r;return u},kp=function(t){for(var e,n,r=-1,i=t.length,o=t[i-1],a=o[0],s=o[1],c=0;++r<i;)e=a,n=s,e-=a=(o=t[r])[0],n-=s=o[1],c+=Math.sqrt(e*e+n*n);return c},Lp=function(){return Math.random()},Rp=function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,1===arguments.length?(n=t,t=0):n-=t,function(){return e()*n+t}}return n.source=t,n}(Lp),Ip=function t(e){function n(t,n){var r,i;return t=null==t?0:+t,n=null==n?1:+n,function(){var o;if(null!=r)o=r,r=null;else do{r=2*e()-1,o=2*e()-1,i=r*r+o*o}while(!i||i>1);return t+n*o*Math.sqrt(-2*Math.log(i)/i)}}return n.source=t,n}(Lp),Np=function t(e){function n(){var t=Ip.source(e).apply(this,arguments);return function(){return Math.exp(t())}}return n.source=t,n}(Lp),Dp=function t(e){function n(t){return function(){for(var n=0,r=0;r<t;++r)n+=e();return n}}return n.source=t,n}(Lp),zp=function t(e){function n(t){var n=Dp.source(e)(t);return function(){return n()/t}}return n.source=t,n}(Lp),jp=function t(e){function n(t){return function(){return-Math.log(1-e())/t}}return n.source=t,n}(Lp);function Fp(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function Bp(t,e){switch(arguments.length){case 0:break;case 1:this.interpolator(t);break;default:this.interpolator(e).domain(t)}return this}var Up=Array.prototype,Hp=Up.map,Vp=Up.slice,Gp={name:"implicit"};function Wp(){var t=Ji(),e=[],n=[],r=Gp;function i(i){var o=i+"",a=t.get(o);if(!a){if(r!==Gp)return r;t.set(o,a=e.push(i))}return n[(a-1)%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=Ji();for(var r,o,a=-1,s=n.length;++a<s;)t.has(o=(r=n[a])+"")||t.set(o,e.push(r));return i},i.range=function(t){return arguments.length?(n=Vp.call(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return Wp(e,n).unknown(r)},Fp.apply(i,arguments),i}function $p(){var t,e,n=Wp().unknown(void 0),r=n.domain,i=n.range,o=[0,1],a=!1,s=0,c=0,l=.5;function u(){var n=r().length,u=o[1]<o[0],d=o[u-0],h=o[1-u];t=(h-d)/Math.max(1,n-s+2*c),a&&(t=Math.floor(t)),d+=(h-d-t*(n-s))*l,e=t*(1-s),a&&(d=Math.round(d),e=Math.round(e));var f=S(n).map((function(e){return d+t*e}));return i(u?f.reverse():f)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),u()):r()},n.range=function(t){return arguments.length?(o=[+t[0],+t[1]],u()):o.slice()},n.rangeRound=function(t){return o=[+t[0],+t[1]],a=!0,u()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(a=!!t,u()):a},n.padding=function(t){return arguments.length?(s=Math.min(1,c=+t),u()):s},n.paddingInner=function(t){return arguments.length?(s=Math.min(1,t),u()):s},n.paddingOuter=function(t){return arguments.length?(c=+t,u()):c},n.align=function(t){return arguments.length?(l=Math.max(0,Math.min(1,t)),u()):l},n.copy=function(){return $p(r(),o).round(a).paddingInner(s).paddingOuter(c).align(l)},Fp.apply(u(),arguments)}function qp(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return qp(e())},t}function Xp(){return qp($p.apply(null,arguments).paddingInner(1))}var Yp=function(t){return+t},Kp=[0,1];function Zp(t){return t}function Jp(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function Qp(t){var e,n=t[0],r=t[t.length-1];return n>r&&(e=n,n=r,r=e),function(t){return Math.max(n,Math.min(r,t))}}function tm(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=Jp(i,r),o=n(a,o)):(r=Jp(r,i),o=n(o,a)),function(t){return o(r(t))}}function em(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=Jp(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(e){var n=l(t,e,1,r)-1;return o[n](i[n](e))}}function nm(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function rm(){var t,e,n,r,i,o,a=Kp,s=Kp,c=Pn,l=Zp;function u(){return r=Math.min(a.length,s.length)>2?em:tm,i=o=null,d}function d(e){return isNaN(e=+e)?n:(i||(i=r(a.map(t),s,c)))(t(l(e)))}return d.invert=function(n){return l(e((o||(o=r(s,a.map(t),wn)))(n)))},d.domain=function(t){return arguments.length?(a=Hp.call(t,Yp),l===Zp||(l=Qp(a)),u()):a.slice()},d.range=function(t){return arguments.length?(s=Vp.call(t),u()):s.slice()},d.rangeRound=function(t){return s=Vp.call(t),c=lp,u()},d.clamp=function(t){return arguments.length?(l=t?Qp(a):Zp,d):l!==Zp},d.interpolate=function(t){return arguments.length?(c=t,u()):c},d.unknown=function(t){return arguments.length?(n=t,d):n},function(n,r){return t=n,e=r,u()}}function im(t,e){return rm()(t,e)}var om=function(t,e,n,r){var i,o=P(t,e,n);switch((r=$s(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=ac(o,a))||(r.precision=i),Zs(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=sc(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=oc(o))||(r.precision=i-2*("%"===r.type))}return Ks(r)};function am(t){var e=t.domain;return t.ticks=function(t){var n=e();return A(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return om(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i=e(),o=0,a=i.length-1,s=i[o],c=i[a];return c<s&&(r=s,s=c,c=r,r=o,o=a,a=r),(r=C(s,c,n))>0?r=C(s=Math.floor(s/r)*r,c=Math.ceil(c/r)*r,n):r<0&&(r=C(s=Math.ceil(s*r)/r,c=Math.floor(c*r)/r,n)),r>0?(i[o]=Math.floor(s/r)*r,i[a]=Math.ceil(c/r)*r,e(i)):r<0&&(i[o]=Math.ceil(s*r)/r,i[a]=Math.floor(c*r)/r,e(i)),t},t}function sm(){var t=im(Zp,Zp);return t.copy=function(){return nm(t,sm())},Fp.apply(t,arguments),am(t)}function cm(t){var e;function n(t){return isNaN(t=+t)?e:t}return n.invert=n,n.domain=n.range=function(e){return arguments.length?(t=Hp.call(e,Yp),n):t.slice()},n.unknown=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return cm(t).unknown(e)},t=arguments.length?Hp.call(t,Yp):[0,1],am(n)}var lm=function(t,e){var n,r=0,i=(t=t.slice()).length-1,o=t[r],a=t[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),t[r]=e.floor(o),t[i]=e.ceil(a),t};function um(t){return Math.log(t)}function dm(t){return Math.exp(t)}function hm(t){return-Math.log(-t)}function fm(t){return-Math.exp(-t)}function pm(t){return isFinite(t)?+("1e"+t):t<0?0:t}function mm(t){return function(e){return-t(-e)}}function gm(t){var e,n,r=t(um,dm),i=r.domain,o=10;function a(){return e=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}(o),n=function(t){return 10===t?pm:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}(o),i()[0]<0?(e=mm(e),n=mm(n),t(hm,fm)):t(um,dm),r}return r.base=function(t){return arguments.length?(o=+t,a()):o},r.domain=function(t){return arguments.length?(i(t),a()):i()},r.ticks=function(t){var r,a=i(),s=a[0],c=a[a.length-1];(r=c<s)&&(h=s,s=c,c=h);var l,u,d,h=e(s),f=e(c),p=null==t?10:+t,m=[];if(!(o%1)&&f-h<p){if(h=Math.round(h)-1,f=Math.round(f)+1,s>0){for(;h<f;++h)for(u=1,l=n(h);u<o;++u)if(!((d=l*u)<s)){if(d>c)break;m.push(d)}}else for(;h<f;++h)for(u=o-1,l=n(h);u>=1;--u)if(!((d=l*u)<s)){if(d>c)break;m.push(d)}}else m=A(h,f,Math.min(f-h,p)).map(n);return r?m.reverse():m},r.tickFormat=function(t,i){if(null==i&&(i=10===o?".0e":","),"function"!=typeof i&&(i=Ks(i)),t===1/0)return i;null==t&&(t=10);var a=Math.max(1,o*t/r.ticks().length);return function(t){var r=t/n(Math.round(e(t)));return r*o<o-.5&&(r*=o),r<=a?i(t):""}},r.nice=function(){return i(lm(i(),{floor:function(t){return n(Math.floor(e(t)))},ceil:function(t){return n(Math.ceil(e(t)))}}))},r}function vm(){var t=gm(rm()).domain([1,10]);return t.copy=function(){return nm(t,vm()).base(t.base())},Fp.apply(t,arguments),t}function ym(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function bm(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function xm(t){var e=1,n=t(ym(e),bm(e));return n.constant=function(n){return arguments.length?t(ym(e=+n),bm(e)):e},am(n)}function _m(){var t=xm(rm());return t.copy=function(){return nm(t,_m()).constant(t.constant())},Fp.apply(t,arguments)}function wm(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Sm(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Mm(t){return t<0?-t*t:t*t}function Em(t){var e=t(Zp,Zp),n=1;function r(){return 1===n?t(Zp,Zp):.5===n?t(Sm,Mm):t(wm(n),wm(1/n))}return e.exponent=function(t){return arguments.length?(n=+t,r()):n},am(e)}function Tm(){var t=Em(rm());return t.copy=function(){return nm(t,Tm()).exponent(t.exponent())},Fp.apply(t,arguments),t}function Am(){return Tm.apply(null,arguments).exponent(.5)}function Cm(){var t,e=[],n=[],r=[];function o(){var t=0,i=Math.max(1,n.length);for(r=new Array(i-1);++t<i;)r[t-1]=L(e,t/i);return a}function a(e){return isNaN(e=+e)?t:n[l(r,e)]}return a.invertExtent=function(t){var i=n.indexOf(t);return i<0?[NaN,NaN]:[i>0?r[i-1]:e[0],i<r.length?r[i]:e[e.length-1]]},a.domain=function(t){if(!arguments.length)return e.slice();e=[];for(var n,r=0,a=t.length;r<a;++r)null==(n=t[r])||isNaN(n=+n)||e.push(n);return e.sort(i),o()},a.range=function(t){return arguments.length?(n=Vp.call(t),o()):n.slice()},a.unknown=function(e){return arguments.length?(t=e,a):t},a.quantiles=function(){return r.slice()},a.copy=function(){return Cm().domain(e).range(n).unknown(t)},Fp.apply(a,arguments)}function Pm(){var t,e=0,n=1,r=1,i=[.5],o=[0,1];function a(e){return e<=e?o[l(i,e,0,r)]:t}function s(){var t=-1;for(i=new Array(r);++t<r;)i[t]=((t+1)*n-(t-r)*e)/(r+1);return a}return a.domain=function(t){return arguments.length?(e=+t[0],n=+t[1],s()):[e,n]},a.range=function(t){return arguments.length?(r=(o=Vp.call(t)).length-1,s()):o.slice()},a.invertExtent=function(t){var a=o.indexOf(t);return a<0?[NaN,NaN]:a<1?[e,i[0]]:a>=r?[i[r-1],n]:[i[a-1],i[a]]},a.unknown=function(e){return arguments.length?(t=e,a):a},a.thresholds=function(){return i.slice()},a.copy=function(){return Pm().domain([e,n]).range(o).unknown(t)},Fp.apply(am(a),arguments)}function Om(){var t,e=[.5],n=[0,1],r=1;function i(i){return i<=i?n[l(e,i,0,r)]:t}return i.domain=function(t){return arguments.length?(e=Vp.call(t),r=Math.min(e.length,n.length-1),i):e.slice()},i.range=function(t){return arguments.length?(n=Vp.call(t),r=Math.min(e.length,n.length-1),i):n.slice()},i.invertExtent=function(t){var r=n.indexOf(t);return[e[r-1],e[r]]},i.unknown=function(e){return arguments.length?(t=e,i):t},i.copy=function(){return Om().domain(e).range(n).unknown(t)},Fp.apply(i,arguments)}var km=new Date,Lm=new Date;function Rm(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,o){var a,s=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return s;do{s.push(a=new Date(+n)),e(n,o),t(n)}while(a<n&&n<r);return s},i.filter=function(n){return Rm((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(i.count=function(e,r){return km.setTime(+e),Lm.setTime(+r),t(km),t(Lm),Math.floor(n(km,Lm))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t==0}:function(e){return i.count(0,e)%t==0}):i:null}),i}var Im=Rm((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));Im.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Rm((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};var Nm=Im,Dm=Im.range,zm=Rm((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()})),jm=zm,Fm=zm.range;function Bm(t){return Rm((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/6048e5}))}var Um=Bm(0),Hm=Bm(1),Vm=Bm(2),Gm=Bm(3),Wm=Bm(4),$m=Bm(5),qm=Bm(6),Xm=Um.range,Ym=Hm.range,Km=Vm.range,Zm=Gm.range,Jm=Wm.range,Qm=$m.range,tg=qm.range,eg=Rm((function(t){t.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5}),(function(t){return t.getDate()-1})),ng=eg,rg=eg.range,ig=Rm((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds()-6e4*t.getMinutes())}),(function(t,e){t.setTime(+t+36e5*e)}),(function(t,e){return(e-t)/36e5}),(function(t){return t.getHours()})),og=ig,ag=ig.range,sg=Rm((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds())}),(function(t,e){t.setTime(+t+6e4*e)}),(function(t,e){return(e-t)/6e4}),(function(t){return t.getMinutes()})),cg=sg,lg=sg.range,ug=Rm((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+1e3*e)}),(function(t,e){return(e-t)/1e3}),(function(t){return t.getUTCSeconds()})),dg=ug,hg=ug.range,fg=Rm((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t}));fg.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Rm((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):fg:null};var pg=fg,mg=fg.range;function gg(t){return Rm((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/6048e5}))}var vg=gg(0),yg=gg(1),bg=gg(2),xg=gg(3),_g=gg(4),wg=gg(5),Sg=gg(6),Mg=vg.range,Eg=yg.range,Tg=bg.range,Ag=xg.range,Cg=_g.range,Pg=wg.range,Og=Sg.range,kg=Rm((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/864e5}),(function(t){return t.getUTCDate()-1})),Lg=kg,Rg=kg.range,Ig=Rm((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));Ig.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Rm((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};var Ng=Ig,Dg=Ig.range;function zg(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function jg(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Fg(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function Bg(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,s=t.months,c=t.shortMonths,l=Jg(i),u=Qg(i),d=Jg(o),h=Qg(o),f=Jg(a),p=Qg(a),m=Jg(s),g=Qg(s),v=Jg(c),y=Qg(c),b={a:function(t){return a[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return c[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:xv,e:xv,f:Ev,H:_v,I:wv,j:Sv,L:Mv,m:Tv,M:Av,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:ey,s:ny,S:Cv,u:Pv,U:Ov,V:kv,w:Lv,W:Rv,x:null,X:null,y:Iv,Y:Nv,Z:Dv,"%":ty},x={a:function(t){return a[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return c[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:zv,e:zv,f:Hv,H:jv,I:Fv,j:Bv,L:Uv,m:Vv,M:Gv,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:ey,s:ny,S:Wv,u:$v,U:qv,V:Xv,w:Yv,W:Kv,x:null,X:null,y:Zv,Y:Jv,Z:Qv,"%":ty},_={a:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.w=p[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=d.exec(e.slice(n));return r?(t.w=h[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=v.exec(e.slice(n));return r?(t.m=y[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=m.exec(e.slice(n));return r?(t.m=g[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,n,r){return M(t,e,n,r)},d:uv,e:uv,f:gv,H:hv,I:hv,j:dv,L:mv,m:lv,M:fv,p:function(t,e,n){var r=l.exec(e.slice(n));return r?(t.p=u[r[0].toLowerCase()],n+r[0].length):-1},q:cv,Q:yv,s:bv,S:pv,u:ev,U:nv,V:rv,w:tv,W:iv,x:function(t,e,r){return M(t,n,e,r)},X:function(t,e,n){return M(t,r,e,n)},y:av,Y:ov,Z:sv,"%":vv};function w(t,e){return function(n){var r,i,o,a=[],s=-1,c=0,l=t.length;for(n instanceof Date||(n=new Date(+n));++s<l;)37===t.charCodeAt(s)&&(a.push(t.slice(c,s)),null!=(i=$g[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(o=e[r])&&(r=o(n,i)),a.push(r),c=s+1);return a.push(t.slice(c,s)),a.join("")}}function S(t,e){return function(n){var r,i,o=Fg(1900,void 0,1);if(M(o,t,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(e&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=jg(Fg(o.y,0,1))).getUTCDay(),r=i>4||0===i?yg.ceil(r):yg(r),r=Lg.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=zg(Fg(o.y,0,1))).getDay(),r=i>4||0===i?Hm.ceil(r):Hm(r),r=ng.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?jg(Fg(o.y,0,1)).getUTCDay():zg(Fg(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,jg(o)):zg(o)}}function M(t,e,n,r){for(var i,o,a=0,s=e.length,c=n.length;a<s;){if(r>=c)return-1;if(37===(i=e.charCodeAt(a++))){if(i=e.charAt(a++),!(o=_[i in $g?e.charAt(a++):i])||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=w(n,b),b.X=w(r,b),b.c=w(e,b),x.x=w(n,x),x.X=w(r,x),x.c=w(e,x),{format:function(t){var e=w(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=S(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=w(t+="",x);return e.toString=function(){return t},e},utcParse:function(t){var e=S(t+="",!0);return e.toString=function(){return t},e}}}var Ug,Hg,Vg,Gg,Wg,$g={"-":"",_:" ",0:"0"},qg=/^\s*\d+/,Xg=/^%/,Yg=/[\\^$*+?|[\]().{}]/g;function Kg(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function Zg(t){return t.replace(Yg,"\\$&")}function Jg(t){return new RegExp("^(?:"+t.map(Zg).join("|")+")","i")}function Qg(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function tv(t,e,n){var r=qg.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function ev(t,e,n){var r=qg.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function nv(t,e,n){var r=qg.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function rv(t,e,n){var r=qg.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function iv(t,e,n){var r=qg.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function ov(t,e,n){var r=qg.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function av(t,e,n){var r=qg.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function sv(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function cv(t,e,n){var r=qg.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function lv(t,e,n){var r=qg.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function uv(t,e,n){var r=qg.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function dv(t,e,n){var r=qg.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function hv(t,e,n){var r=qg.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function fv(t,e,n){var r=qg.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function pv(t,e,n){var r=qg.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function mv(t,e,n){var r=qg.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function gv(t,e,n){var r=qg.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function vv(t,e,n){var r=Xg.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function yv(t,e,n){var r=qg.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function bv(t,e,n){var r=qg.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function xv(t,e){return Kg(t.getDate(),e,2)}function _v(t,e){return Kg(t.getHours(),e,2)}function wv(t,e){return Kg(t.getHours()%12||12,e,2)}function Sv(t,e){return Kg(1+ng.count(Nm(t),t),e,3)}function Mv(t,e){return Kg(t.getMilliseconds(),e,3)}function Ev(t,e){return Mv(t,e)+"000"}function Tv(t,e){return Kg(t.getMonth()+1,e,2)}function Av(t,e){return Kg(t.getMinutes(),e,2)}function Cv(t,e){return Kg(t.getSeconds(),e,2)}function Pv(t){var e=t.getDay();return 0===e?7:e}function Ov(t,e){return Kg(Um.count(Nm(t)-1,t),e,2)}function kv(t,e){var n=t.getDay();return t=n>=4||0===n?Wm(t):Wm.ceil(t),Kg(Wm.count(Nm(t),t)+(4===Nm(t).getDay()),e,2)}function Lv(t){return t.getDay()}function Rv(t,e){return Kg(Hm.count(Nm(t)-1,t),e,2)}function Iv(t,e){return Kg(t.getFullYear()%100,e,2)}function Nv(t,e){return Kg(t.getFullYear()%1e4,e,4)}function Dv(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Kg(e/60|0,"0",2)+Kg(e%60,"0",2)}function zv(t,e){return Kg(t.getUTCDate(),e,2)}function jv(t,e){return Kg(t.getUTCHours(),e,2)}function Fv(t,e){return Kg(t.getUTCHours()%12||12,e,2)}function Bv(t,e){return Kg(1+Lg.count(Ng(t),t),e,3)}function Uv(t,e){return Kg(t.getUTCMilliseconds(),e,3)}function Hv(t,e){return Uv(t,e)+"000"}function Vv(t,e){return Kg(t.getUTCMonth()+1,e,2)}function Gv(t,e){return Kg(t.getUTCMinutes(),e,2)}function Wv(t,e){return Kg(t.getUTCSeconds(),e,2)}function $v(t){var e=t.getUTCDay();return 0===e?7:e}function qv(t,e){return Kg(vg.count(Ng(t)-1,t),e,2)}function Xv(t,e){var n=t.getUTCDay();return t=n>=4||0===n?_g(t):_g.ceil(t),Kg(_g.count(Ng(t),t)+(4===Ng(t).getUTCDay()),e,2)}function Yv(t){return t.getUTCDay()}function Kv(t,e){return Kg(yg.count(Ng(t)-1,t),e,2)}function Zv(t,e){return Kg(t.getUTCFullYear()%100,e,2)}function Jv(t,e){return Kg(t.getUTCFullYear()%1e4,e,4)}function Qv(){return"+0000"}function ty(){return"%"}function ey(t){return+t}function ny(t){return Math.floor(+t/1e3)}function ry(t){return Ug=Bg(t),Hg=Ug.format,Vg=Ug.parse,Gg=Ug.utcFormat,Wg=Ug.utcParse,Ug}ry({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function iy(t){return new Date(t)}function oy(t){return t instanceof Date?+t:+new Date(+t)}function ay(t,e,n,r,i,a,s,c,l){var u=im(Zp,Zp),d=u.invert,h=u.domain,f=l(".%L"),p=l(":%S"),m=l("%I:%M"),g=l("%I %p"),v=l("%a %d"),y=l("%b %d"),b=l("%B"),x=l("%Y"),_=[[s,1,1e3],[s,5,5e3],[s,15,15e3],[s,30,3e4],[a,1,6e4],[a,5,3e5],[a,15,9e5],[a,30,18e5],[i,1,36e5],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,864e5],[r,2,1728e5],[n,1,6048e5],[e,1,2592e6],[e,3,7776e6],[t,1,31536e6]];function w(o){return(s(o)<o?f:a(o)<o?p:i(o)<o?m:r(o)<o?g:e(o)<o?n(o)<o?v:y:t(o)<o?b:x)(o)}function S(e,n,r,i){if(null==e&&(e=10),"number"==typeof e){var a=Math.abs(r-n)/e,s=o((function(t){return t[2]})).right(_,a);s===_.length?(i=P(n/31536e6,r/31536e6,e),e=t):s?(i=(s=_[a/_[s-1][2]<_[s][2]/a?s-1:s])[1],e=s[0]):(i=Math.max(P(n,r,e),1),e=c)}return null==i?e:e.every(i)}return u.invert=function(t){return new Date(d(t))},u.domain=function(t){return arguments.length?h(Hp.call(t,oy)):h().map(iy)},u.ticks=function(t,e){var n,r=h(),i=r[0],o=r[r.length-1],a=o<i;return a&&(n=i,i=o,o=n),n=(n=S(t,i,o,e))?n.range(i,o+1):[],a?n.reverse():n},u.tickFormat=function(t,e){return null==e?w:l(e)},u.nice=function(t,e){var n=h();return(t=S(t,n[0],n[n.length-1],e))?h(lm(n,t)):u},u.copy=function(){return nm(u,ay(t,e,n,r,i,a,s,c,l))},u}var sy=function(){return Fp.apply(ay(Nm,jm,Um,ng,og,cg,dg,pg,Hg).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},cy=Rm((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})),ly=cy,uy=cy.range,dy=Rm((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+36e5*e)}),(function(t,e){return(e-t)/36e5}),(function(t){return t.getUTCHours()})),hy=dy,fy=dy.range,py=Rm((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+6e4*e)}),(function(t,e){return(e-t)/6e4}),(function(t){return t.getUTCMinutes()})),my=py,gy=py.range,vy=function(){return Fp.apply(ay(Ng,ly,vg,Lg,hy,my,dg,pg,Gg).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)};function yy(){var t,e,n,r,i,o=0,a=1,s=Zp,c=!1;function l(e){return isNaN(e=+e)?i:s(0===n?.5:(e=(r(e)-t)*n,c?Math.max(0,Math.min(1,e)):e))}return l.domain=function(i){return arguments.length?(t=r(o=+i[0]),e=r(a=+i[1]),n=t===e?0:1/(e-t),l):[o,a]},l.clamp=function(t){return arguments.length?(c=!!t,l):c},l.interpolator=function(t){return arguments.length?(s=t,l):s},l.unknown=function(t){return arguments.length?(i=t,l):i},function(i){return r=i,t=i(o),e=i(a),n=t===e?0:1/(e-t),l}}function by(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function xy(){var t=am(yy()(Zp));return t.copy=function(){return by(t,xy())},Bp.apply(t,arguments)}function _y(){var t=gm(yy()).domain([1,10]);return t.copy=function(){return by(t,_y()).base(t.base())},Bp.apply(t,arguments)}function wy(){var t=xm(yy());return t.copy=function(){return by(t,wy()).constant(t.constant())},Bp.apply(t,arguments)}function Sy(){var t=Em(yy());return t.copy=function(){return by(t,Sy()).exponent(t.exponent())},Bp.apply(t,arguments)}function My(){return Sy.apply(null,arguments).exponent(.5)}function Ey(){var t=[],e=Zp;function n(n){if(!isNaN(n=+n))return e((l(t,n)-1)/(t.length-1))}return n.domain=function(e){if(!arguments.length)return t.slice();t=[];for(var r,o=0,a=e.length;o<a;++o)null==(r=e[o])||isNaN(r=+r)||t.push(r);return t.sort(i),n},n.interpolator=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return Ey(e).domain(t)},Bp.apply(n,arguments)}function Ty(){var t,e,n,r,i,o,a,s=0,c=.5,l=1,u=Zp,d=!1;function h(t){return isNaN(t=+t)?a:(t=.5+((t=+o(t))-e)*(t<e?r:i),u(d?Math.max(0,Math.min(1,t)):t))}return h.domain=function(a){return arguments.length?(t=o(s=+a[0]),e=o(c=+a[1]),n=o(l=+a[2]),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),h):[s,c,l]},h.clamp=function(t){return arguments.length?(d=!!t,h):d},h.interpolator=function(t){return arguments.length?(u=t,h):u},h.unknown=function(t){return arguments.length?(a=t,h):a},function(a){return o=a,t=a(s),e=a(c),n=a(l),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),h}}function Ay(){var t=am(Ty()(Zp));return t.copy=function(){return by(t,Ay())},Bp.apply(t,arguments)}function Cy(){var t=gm(Ty()).domain([.1,1,10]);return t.copy=function(){return by(t,Cy()).base(t.base())},Bp.apply(t,arguments)}function Py(){var t=xm(Ty());return t.copy=function(){return by(t,Py()).constant(t.constant())},Bp.apply(t,arguments)}function Oy(){var t=Em(Ty());return t.copy=function(){return by(t,Oy()).exponent(t.exponent())},Bp.apply(t,arguments)}function ky(){return Oy.apply(null,arguments).exponent(.5)}var Ly=function(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n},Ry=Ly("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Iy=Ly("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),Ny=Ly("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Dy=Ly("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),zy=Ly("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),jy=Ly("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),Fy=Ly("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),By=Ly("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),Uy=Ly("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),Hy=Ly("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),Vy=function(t){return mn(t[t.length-1])},Gy=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Ly),Wy=Vy(Gy),$y=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Ly),qy=Vy($y),Xy=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Ly),Yy=Vy(Xy),Ky=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Ly),Zy=Vy(Ky),Jy=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Ly),Qy=Vy(Jy),tb=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Ly),eb=Vy(tb),nb=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Ly),rb=Vy(nb),ib=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Ly),ob=Vy(ib),ab=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Ly),sb=Vy(ab),cb=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Ly),lb=Vy(cb),ub=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Ly),db=Vy(ub),hb=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Ly),fb=Vy(hb),pb=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Ly),mb=Vy(pb),gb=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Ly),vb=Vy(gb),yb=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Ly),bb=Vy(yb),xb=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Ly),_b=Vy(xb),wb=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Ly),Sb=Vy(wb),Mb=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Ly),Eb=Vy(Mb),Tb=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Ly),Ab=Vy(Tb),Cb=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Ly),Pb=Vy(Cb),Ob=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Ly),kb=Vy(Ob),Lb=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Ly),Rb=Vy(Lb),Ib=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Ly),Nb=Vy(Ib),Db=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Ly),zb=Vy(Db),jb=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Ly),Fb=Vy(jb),Bb=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Ly),Ub=Vy(Bb),Hb=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Ly),Vb=Vy(Hb),Gb=function(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-2710.57*t)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-67.37*t)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-2475.67*t)))))))+")"},Wb=wp(Lo(300,.5,0),Lo(-240,.5,1)),$b=wp(Lo(-100,.75,.35),Lo(80,1.5,.8)),qb=wp(Lo(260,.75,.35),Lo(80,1.5,.8)),Xb=Lo(),Yb=function(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return Xb.h=360*t-100,Xb.s=1.5-1.5*e,Xb.l=.8-.9*e,Xb+""},Kb=Xe(),Zb=Math.PI/3,Jb=2*Math.PI/3,Qb=function(t){var e;return t=(.5-t)*Math.PI,Kb.r=255*(e=Math.sin(t))*e,Kb.g=255*(e=Math.sin(t+Zb))*e,Kb.b=255*(e=Math.sin(t+Jb))*e,Kb+""},tx=function(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-14825.05*t)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+707.56*t)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-6838.66*t)))))))+")"};function ex(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}var nx=ex(Ly("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),rx=ex(Ly("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),ix=ex(Ly("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),ox=ex(Ly("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),ax=function(t){return Se(re(t).call(document.documentElement))},sx=0;function cx(){return new lx}function lx(){this._="@"+(++sx).toString(36)}lx.prototype=cx.prototype={constructor:lx,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var ux=function(t){return"string"==typeof t?new xe([document.querySelectorAll(t)],[document.documentElement]):new xe([null==t?[]:t],be)},dx=function(t,e){null==e&&(e=On().touches);for(var n=0,r=e?e.length:0,i=new Array(r);n<r;++n)i[n]=kn(t,e[n]);return i},hx=function(t){return function(){return t}},fx=Math.abs,px=Math.atan2,mx=Math.cos,gx=Math.max,vx=Math.min,yx=Math.sin,bx=Math.sqrt,xx=Math.PI,_x=xx/2,wx=2*xx;function Sx(t){return t>1?0:t<-1?xx:Math.acos(t)}function Mx(t){return t>=1?_x:t<=-1?-_x:Math.asin(t)}function Ex(t){return t.innerRadius}function Tx(t){return t.outerRadius}function Ax(t){return t.startAngle}function Cx(t){return t.endAngle}function Px(t){return t&&t.padAngle}function Ox(t,e,n,r,i,o,a,s){var c=n-t,l=r-e,u=a-i,d=s-o,h=d*c-u*l;if(!(h*h<1e-12))return[t+(h=(u*(e-o)-d*(t-i))/h)*c,e+h*l]}function kx(t,e,n,r,i,o,a){var s=t-n,c=e-r,l=(a?o:-o)/bx(s*s+c*c),u=l*c,d=-l*s,h=t+u,f=e+d,p=n+u,m=r+d,g=(h+p)/2,v=(f+m)/2,y=p-h,b=m-f,x=y*y+b*b,_=i-o,w=h*m-p*f,S=(b<0?-1:1)*bx(gx(0,_*_*x-w*w)),M=(w*b-y*S)/x,E=(-w*y-b*S)/x,T=(w*b+y*S)/x,A=(-w*y+b*S)/x,C=M-g,P=E-v,O=T-g,k=A-v;return C*C+P*P>O*O+k*k&&(M=T,E=A),{cx:M,cy:E,x01:-u,y01:-d,x11:M*(i/_-1),y11:E*(i/_-1)}}var Lx=function(){var t=Ex,e=Tx,n=hx(0),r=null,i=Ax,o=Cx,a=Px,s=null;function c(){var c,l,u=+t.apply(this,arguments),d=+e.apply(this,arguments),h=i.apply(this,arguments)-_x,f=o.apply(this,arguments)-_x,p=fx(f-h),m=f>h;if(s||(s=c=Vi()),d<u&&(l=d,d=u,u=l),d>1e-12)if(p>wx-1e-12)s.moveTo(d*mx(h),d*yx(h)),s.arc(0,0,d,h,f,!m),u>1e-12&&(s.moveTo(u*mx(f),u*yx(f)),s.arc(0,0,u,f,h,m));else{var g,v,y=h,b=f,x=h,_=f,w=p,S=p,M=a.apply(this,arguments)/2,E=M>1e-12&&(r?+r.apply(this,arguments):bx(u*u+d*d)),T=vx(fx(d-u)/2,+n.apply(this,arguments)),A=T,C=T;if(E>1e-12){var P=Mx(E/u*yx(M)),O=Mx(E/d*yx(M));(w-=2*P)>1e-12?(x+=P*=m?1:-1,_-=P):(w=0,x=_=(h+f)/2),(S-=2*O)>1e-12?(y+=O*=m?1:-1,b-=O):(S=0,y=b=(h+f)/2)}var k=d*mx(y),L=d*yx(y),R=u*mx(_),I=u*yx(_);if(T>1e-12){var N,D=d*mx(b),z=d*yx(b),j=u*mx(x),F=u*yx(x);if(p<xx&&(N=Ox(k,L,j,F,D,z,R,I))){var B=k-N[0],U=L-N[1],H=D-N[0],V=z-N[1],G=1/yx(Sx((B*H+U*V)/(bx(B*B+U*U)*bx(H*H+V*V)))/2),W=bx(N[0]*N[0]+N[1]*N[1]);A=vx(T,(u-W)/(G-1)),C=vx(T,(d-W)/(G+1))}}S>1e-12?C>1e-12?(g=kx(j,F,k,L,d,C,m),v=kx(D,z,R,I,d,C,m),s.moveTo(g.cx+g.x01,g.cy+g.y01),C<T?s.arc(g.cx,g.cy,C,px(g.y01,g.x01),px(v.y01,v.x01),!m):(s.arc(g.cx,g.cy,C,px(g.y01,g.x01),px(g.y11,g.x11),!m),s.arc(0,0,d,px(g.cy+g.y11,g.cx+g.x11),px(v.cy+v.y11,v.cx+v.x11),!m),s.arc(v.cx,v.cy,C,px(v.y11,v.x11),px(v.y01,v.x01),!m))):(s.moveTo(k,L),s.arc(0,0,d,y,b,!m)):s.moveTo(k,L),u>1e-12&&w>1e-12?A>1e-12?(g=kx(R,I,D,z,u,-A,m),v=kx(k,L,j,F,u,-A,m),s.lineTo(g.cx+g.x01,g.cy+g.y01),A<T?s.arc(g.cx,g.cy,A,px(g.y01,g.x01),px(v.y01,v.x01),!m):(s.arc(g.cx,g.cy,A,px(g.y01,g.x01),px(g.y11,g.x11),!m),s.arc(0,0,u,px(g.cy+g.y11,g.cx+g.x11),px(v.cy+v.y11,v.cx+v.x11),m),s.arc(v.cx,v.cy,A,px(v.y11,v.x11),px(v.y01,v.x01),!m))):s.arc(0,0,u,_,x,m):s.lineTo(R,I)}else s.moveTo(0,0);if(s.closePath(),c)return s=null,c+""||null}return c.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-xx/2;return[mx(r)*n,yx(r)*n]},c.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:hx(+e),c):t},c.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:hx(+t),c):e},c.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:hx(+t),c):n},c.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:hx(+t),c):r},c.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:hx(+t),c):i},c.endAngle=function(t){return arguments.length?(o="function"==typeof t?t:hx(+t),c):o},c.padAngle=function(t){return arguments.length?(a="function"==typeof t?t:hx(+t),c):a},c.context=function(t){return arguments.length?(s=null==t?null:t,c):s},c};function Rx(t){this._context=t}Rx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var Ix=function(t){return new Rx(t)};function Nx(t){return t[0]}function Dx(t){return t[1]}var zx=function(){var t=Nx,e=Dx,n=hx(!0),r=null,i=Ix,o=null;function a(a){var s,c,l,u=a.length,d=!1;for(null==r&&(o=i(l=Vi())),s=0;s<=u;++s)!(s<u&&n(c=a[s],s,a))===d&&((d=!d)?o.lineStart():o.lineEnd()),d&&o.point(+t(c,s,a),+e(c,s,a));if(l)return o=null,l+""||null}return a.x=function(e){return arguments.length?(t="function"==typeof e?e:hx(+e),a):t},a.y=function(t){return arguments.length?(e="function"==typeof t?t:hx(+t),a):e},a.defined=function(t){return arguments.length?(n="function"==typeof t?t:hx(!!t),a):n},a.curve=function(t){return arguments.length?(i=t,null!=r&&(o=i(r)),a):i},a.context=function(t){return arguments.length?(null==t?r=o=null:o=i(r=t),a):r},a},jx=function(){var t=Nx,e=null,n=hx(0),r=Dx,i=hx(!0),o=null,a=Ix,s=null;function c(c){var l,u,d,h,f,p=c.length,m=!1,g=new Array(p),v=new Array(p);for(null==o&&(s=a(f=Vi())),l=0;l<=p;++l){if(!(l<p&&i(h=c[l],l,c))===m)if(m=!m)u=l,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),d=l-1;d>=u;--d)s.point(g[d],v[d]);s.lineEnd(),s.areaEnd()}m&&(g[l]=+t(h,l,c),v[l]=+n(h,l,c),s.point(e?+e(h,l,c):g[l],r?+r(h,l,c):v[l]))}if(f)return s=null,f+""||null}function l(){return zx().defined(i).curve(a).context(o)}return c.x=function(n){return arguments.length?(t="function"==typeof n?n:hx(+n),e=null,c):t},c.x0=function(e){return arguments.length?(t="function"==typeof e?e:hx(+e),c):t},c.x1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:hx(+t),c):e},c.y=function(t){return arguments.length?(n="function"==typeof t?t:hx(+t),r=null,c):n},c.y0=function(t){return arguments.length?(n="function"==typeof t?t:hx(+t),c):n},c.y1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:hx(+t),c):r},c.lineX0=c.lineY0=function(){return l().x(t).y(n)},c.lineY1=function(){return l().x(t).y(r)},c.lineX1=function(){return l().x(e).y(n)},c.defined=function(t){return arguments.length?(i="function"==typeof t?t:hx(!!t),c):i},c.curve=function(t){return arguments.length?(a=t,null!=o&&(s=a(o)),c):a},c.context=function(t){return arguments.length?(null==t?o=s=null:s=a(o=t),c):o},c},Fx=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},Bx=function(t){return t},Ux=function(){var t=Bx,e=Fx,n=null,r=hx(0),i=hx(wx),o=hx(0);function a(a){var s,c,l,u,d,h=a.length,f=0,p=new Array(h),m=new Array(h),g=+r.apply(this,arguments),v=Math.min(wx,Math.max(-wx,i.apply(this,arguments)-g)),y=Math.min(Math.abs(v)/h,o.apply(this,arguments)),b=y*(v<0?-1:1);for(s=0;s<h;++s)(d=m[p[s]=s]=+t(a[s],s,a))>0&&(f+=d);for(null!=e?p.sort((function(t,n){return e(m[t],m[n])})):null!=n&&p.sort((function(t,e){return n(a[t],a[e])})),s=0,l=f?(v-h*b)/f:0;s<h;++s,g=u)c=p[s],u=g+((d=m[c])>0?d*l:0)+b,m[c]={data:a[c],index:s,value:d,startAngle:g,endAngle:u,padAngle:y};return m}return a.value=function(e){return arguments.length?(t="function"==typeof e?e:hx(+e),a):t},a.sortValues=function(t){return arguments.length?(e=t,n=null,a):e},a.sort=function(t){return arguments.length?(n=t,e=null,a):n},a.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:hx(+t),a):r},a.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:hx(+t),a):i},a.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:hx(+t),a):o},a},Hx=Gx(Ix);function Vx(t){this._curve=t}function Gx(t){function e(e){return new Vx(t(e))}return e._curve=t,e}function Wx(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(Gx(t)):e()._curve},t}Vx.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};var $x=function(){return Wx(zx().curve(Hx))},qx=function(){var t=jx().curve(Hx),e=t.curve,n=t.lineX0,r=t.lineX1,i=t.lineY0,o=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return Wx(n())},delete t.lineX0,t.lineEndAngle=function(){return Wx(r())},delete t.lineX1,t.lineInnerRadius=function(){return Wx(i())},delete t.lineY0,t.lineOuterRadius=function(){return Wx(o())},delete t.lineY1,t.curve=function(t){return arguments.length?e(Gx(t)):e()._curve},t},Xx=function(t,e){return[(e=+e)*Math.cos(t-=Math.PI/2),e*Math.sin(t)]},Yx=Array.prototype.slice;function Kx(t){return t.source}function Zx(t){return t.target}function Jx(t){var e=Kx,n=Zx,r=Nx,i=Dx,o=null;function a(){var a,s=Yx.call(arguments),c=e.apply(this,s),l=n.apply(this,s);if(o||(o=a=Vi()),t(o,+r.apply(this,(s[0]=c,s)),+i.apply(this,s),+r.apply(this,(s[0]=l,s)),+i.apply(this,s)),a)return o=null,a+""||null}return a.source=function(t){return arguments.length?(e=t,a):e},a.target=function(t){return arguments.length?(n=t,a):n},a.x=function(t){return arguments.length?(r="function"==typeof t?t:hx(+t),a):r},a.y=function(t){return arguments.length?(i="function"==typeof t?t:hx(+t),a):i},a.context=function(t){return arguments.length?(o=null==t?null:t,a):o},a}function Qx(t,e,n,r,i){t.moveTo(e,n),t.bezierCurveTo(e=(e+r)/2,n,e,i,r,i)}function t_(t,e,n,r,i){t.moveTo(e,n),t.bezierCurveTo(e,n=(n+i)/2,r,n,r,i)}function e_(t,e,n,r,i){var o=Xx(e,n),a=Xx(e,n=(n+i)/2),s=Xx(r,n),c=Xx(r,i);t.moveTo(o[0],o[1]),t.bezierCurveTo(a[0],a[1],s[0],s[1],c[0],c[1])}function n_(){return Jx(Qx)}function r_(){return Jx(t_)}function i_(){var t=Jx(e_);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t}var o_={draw:function(t,e){var n=Math.sqrt(e/xx);t.moveTo(n,0),t.arc(0,0,n,0,wx)}},a_={draw:function(t,e){var n=Math.sqrt(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},s_=Math.sqrt(1/3),c_=2*s_,l_={draw:function(t,e){var n=Math.sqrt(e/c_),r=n*s_;t.moveTo(0,-n),t.lineTo(r,0),t.lineTo(0,n),t.lineTo(-r,0),t.closePath()}},u_=Math.sin(xx/10)/Math.sin(7*xx/10),d_=Math.sin(wx/10)*u_,h_=-Math.cos(wx/10)*u_,f_={draw:function(t,e){var n=Math.sqrt(.8908130915292852*e),r=d_*n,i=h_*n;t.moveTo(0,-n),t.lineTo(r,i);for(var o=1;o<5;++o){var a=wx*o/5,s=Math.cos(a),c=Math.sin(a);t.lineTo(c*n,-s*n),t.lineTo(s*r-c*i,c*r+s*i)}t.closePath()}},p_={draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},m_=Math.sqrt(3),g_={draw:function(t,e){var n=-Math.sqrt(e/(3*m_));t.moveTo(0,2*n),t.lineTo(-m_*n,-n),t.lineTo(m_*n,-n),t.closePath()}},v_=Math.sqrt(3)/2,y_=1/Math.sqrt(12),b_=3*(y_/2+1),x_={draw:function(t,e){var n=Math.sqrt(e/b_),r=n/2,i=n*y_,o=r,a=n*y_+n,s=-o,c=a;t.moveTo(r,i),t.lineTo(o,a),t.lineTo(s,c),t.lineTo(-.5*r-v_*i,v_*r+-.5*i),t.lineTo(-.5*o-v_*a,v_*o+-.5*a),t.lineTo(-.5*s-v_*c,v_*s+-.5*c),t.lineTo(-.5*r+v_*i,-.5*i-v_*r),t.lineTo(-.5*o+v_*a,-.5*a-v_*o),t.lineTo(-.5*s+v_*c,-.5*c-v_*s),t.closePath()}},__=[o_,a_,l_,p_,f_,g_,x_],w_=function(){var t=hx(o_),e=hx(64),n=null;function r(){var r;if(n||(n=r=Vi()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),r)return n=null,r+""||null}return r.type=function(e){return arguments.length?(t="function"==typeof e?e:hx(e),r):t},r.size=function(t){return arguments.length?(e="function"==typeof t?t:hx(+t),r):e},r.context=function(t){return arguments.length?(n=null==t?null:t,r):n},r},S_=function(){};function M_(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function E_(t){this._context=t}E_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:M_(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:M_(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var T_=function(t){return new E_(t)};function A_(t){this._context=t}A_.prototype={areaStart:S_,areaEnd:S_,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:M_(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var C_=function(t){return new A_(t)};function P_(t){this._context=t}P_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:M_(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var O_=function(t){return new P_(t)};function k_(t,e){this._basis=new E_(t),this._beta=e}k_.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],o=e[0],a=t[n]-i,s=e[n]-o,c=-1;++c<=n;)r=c/n,this._basis.point(this._beta*t[c]+(1-this._beta)*(i+r*a),this._beta*e[c]+(1-this._beta)*(o+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var L_=function t(e){function n(t){return 1===e?new E_(t):new k_(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function R_(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function I_(t,e){this._context=t,this._k=(1-e)/6}I_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:R_(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:R_(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var N_=function t(e){function n(t){return new I_(t,e)}return n.tension=function(e){return t(+e)},n}(0);function D_(t,e){this._context=t,this._k=(1-e)/6}D_.prototype={areaStart:S_,areaEnd:S_,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:R_(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var z_=function t(e){function n(t){return new D_(t,e)}return n.tension=function(e){return t(+e)},n}(0);function j_(t,e){this._context=t,this._k=(1-e)/6}j_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:R_(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var F_=function t(e){function n(t){return new j_(t,e)}return n.tension=function(e){return t(+e)},n}(0);function B_(t,e,n){var r=t._x1,i=t._y1,o=t._x2,a=t._y2;if(t._l01_a>1e-12){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>1e-12){var l=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,u=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*l+t._x1*t._l23_2a-e*t._l12_2a)/u,a=(a*l+t._y1*t._l23_2a-n*t._l12_2a)/u}t._context.bezierCurveTo(r,i,o,a,t._x2,t._y2)}function U_(t,e){this._context=t,this._alpha=e}U_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:B_(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var H_=function t(e){function n(t){return e?new U_(t,e):new I_(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function V_(t,e){this._context=t,this._alpha=e}V_.prototype={areaStart:S_,areaEnd:S_,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:B_(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var G_=function t(e){function n(t){return e?new V_(t,e):new D_(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function W_(t,e){this._context=t,this._alpha=e}W_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:B_(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var $_=function t(e){function n(t){return e?new W_(t,e):new j_(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function q_(t){this._context=t}q_.prototype={areaStart:S_,areaEnd:S_,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};var X_=function(t){return new q_(t)};function Y_(t){return t<0?-1:1}function K_(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),a=(n-t._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(Y_(o)+Y_(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function Z_(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function J_(t,e,n){var r=t._x0,i=t._y0,o=t._x1,a=t._y1,s=(o-r)/3;t._context.bezierCurveTo(r+s,i+s*e,o-s,a-s*n,o,a)}function Q_(t){this._context=t}function tw(t){this._context=new ew(t)}function ew(t){this._context=t}function nw(t){return new Q_(t)}function rw(t){return new tw(t)}function iw(t){this._context=t}function ow(t){var e,n,r=t.length-1,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,o[e]=4,a[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/o[e-1],o[e]-=n,a[e]-=n*a[e-1];for(i[r-1]=a[r-1]/o[r-1],e=r-2;e>=0;--e)i[e]=(a[e]-i[e+1])/o[e];for(o[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)o[e]=2*t[e+1]-i[e+1];return[i,o]}Q_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:J_(this,this._t0,Z_(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,J_(this,Z_(this,n=K_(this,t,e)),n);break;default:J_(this,this._t0,n=K_(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(tw.prototype=Object.create(Q_.prototype)).point=function(t,e){Q_.prototype.point.call(this,e,t)},ew.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,o){this._context.bezierCurveTo(e,t,r,n,o,i)}},iw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=ow(t),i=ow(e),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],t[a],e[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var aw=function(t){return new iw(t)};function sw(t,e){this._context=t,this._t=e}sw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var cw=function(t){return new sw(t,.5)};function lw(t){return new sw(t,0)}function uw(t){return new sw(t,1)}var dw=function(t,e){if((i=t.length)>1)for(var n,r,i,o=1,a=t[e[0]],s=a.length;o<i;++o)for(r=a,a=t[e[o]],n=0;n<s;++n)a[n][1]+=a[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]},hw=function(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n};function fw(t,e){return t[e]}var pw=function(){var t=hx([]),e=hw,n=dw,r=fw;function i(i){var o,a,s=t.apply(this,arguments),c=i.length,l=s.length,u=new Array(l);for(o=0;o<l;++o){for(var d,h=s[o],f=u[o]=new Array(c),p=0;p<c;++p)f[p]=d=[0,+r(i[p],h,p,i)],d.data=i[p];f.key=h}for(o=0,a=e(u);o<l;++o)u[a[o]].index=o;return n(u,a),u}return i.keys=function(e){return arguments.length?(t="function"==typeof e?e:hx(Yx.call(e)),i):t},i.value=function(t){return arguments.length?(r="function"==typeof t?t:hx(+t),i):r},i.order=function(t){return arguments.length?(e=null==t?hw:"function"==typeof t?t:hx(Yx.call(t)),i):e},i.offset=function(t){return arguments.length?(n=null==t?dw:t,i):n},i},mw=function(t,e){if((r=t.length)>0){for(var n,r,i,o=0,a=t[0].length;o<a;++o){for(i=n=0;n<r;++n)i+=t[n][o][1]||0;if(i)for(n=0;n<r;++n)t[n][o][1]/=i}dw(t,e)}},gw=function(t,e){if((s=t.length)>0)for(var n,r,i,o,a,s,c=0,l=t[e[0]].length;c<l;++c)for(o=a=0,n=0;n<s;++n)(i=(r=t[e[n]][c])[1]-r[0])>0?(r[0]=o,r[1]=o+=i):i<0?(r[1]=a,r[0]=a+=i):(r[0]=0,r[1]=i)},vw=function(t,e){if((n=t.length)>0){for(var n,r=0,i=t[e[0]],o=i.length;r<o;++r){for(var a=0,s=0;a<n;++a)s+=t[a][r][1]||0;i[r][1]+=i[r][0]=-s/2}dw(t,e)}},yw=function(t,e){if((i=t.length)>0&&(r=(n=t[e[0]]).length)>0){for(var n,r,i,o=0,a=1;a<r;++a){for(var s=0,c=0,l=0;s<i;++s){for(var u=t[e[s]],d=u[a][1]||0,h=(d-(u[a-1][1]||0))/2,f=0;f<s;++f){var p=t[e[f]];h+=(p[a][1]||0)-(p[a-1][1]||0)}c+=d,l+=h*d}n[a-1][1]+=n[a-1][0]=o,c&&(o-=l/c)}n[a-1][1]+=n[a-1][0]=o,dw(t,e)}},bw=function(t){var e=t.map(xw);return hw(t).sort((function(t,n){return e[t]-e[n]}))};function xw(t){for(var e,n=-1,r=0,i=t.length,o=-1/0;++n<i;)(e=+t[n][1])>o&&(o=e,r=n);return r}var _w=function(t){var e=t.map(ww);return hw(t).sort((function(t,n){return e[t]-e[n]}))};function ww(t){for(var e,n=0,r=-1,i=t.length;++r<i;)(e=+t[r][1])&&(n+=e);return n}var Sw=function(t){return _w(t).reverse()},Mw=function(t){var e,n,r=t.length,i=t.map(ww),o=bw(t),a=0,s=0,c=[],l=[];for(e=0;e<r;++e)n=o[e],a<s?(a+=i[n],c.push(n)):(s+=i[n],l.push(n));return l.reverse().concat(c)},Ew=function(t){return hw(t).reverse()};var Tw=Date.prototype.toISOString?function(t){return t.toISOString()}:Gg("%Y-%m-%dT%H:%M:%S.%LZ");var Aw=+new Date("2000-01-01T00:00:00.000Z")?function(t){var e=new Date(t);return isNaN(e)?null:e}:Wg("%Y-%m-%dT%H:%M:%S.%LZ"),Cw=function(t,e,n){var r=new Gn,i=e;return null==e?(r.restart(t,e,n),r):(e=+e,n=null==n?Hn():+n,r.restart((function o(a){a+=i,r.restart(o,i+=e,n),t(a)}),e,n),r)},Pw=function(t){return function(){return t}};function Ow(t){return t[0]}function kw(t){return t[1]}function Lw(){this._=null}function Rw(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Iw(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function Nw(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function Dw(t){for(;t.L;)t=t.L;return t}Lw.prototype={constructor:Lw,insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Dw(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(r=n.U).L?(i=r.R)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(Iw(this,n),n=(t=n).U),n.C=!1,r.C=!0,Nw(this,r)):(i=r.L)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(Nw(this,n),n=(t=n).U),n.C=!1,r.C=!0,Iw(this,r)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,i=t.U,o=t.L,a=t.R;if(n=o?a?Dw(a):o:a,i?i.L===t?i.L=n:i.R=n:this._=n,o&&a?(r=n.C,n.C=t.C,n.L=o,o.U=n,n!==a?(i=n.U,n.U=t.U,t=n.R,i.L=t,n.R=a,a.U=n):(n.U=i,i=n,t=n.R)):(r=t.C,t=n),t&&(t.U=i),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if((e=i.R).C&&(e.C=!1,i.C=!0,Iw(this,i),e=i.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Nw(this,e),e=i.R),e.C=i.C,i.C=e.R.C=!1,Iw(this,i),t=this._;break}}else if((e=i.L).C&&(e.C=!1,i.C=!0,Nw(this,i),e=i.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,Iw(this,e),e=i.L),e.C=i.C,i.C=e.L.C=!1,Nw(this,i),t=this._;break}e.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}};var zw=Lw;function jw(t,e,n,r){var i=[null,null],o=cS.push(i)-1;return i.left=t,i.right=e,n&&Bw(i,t,e,n),r&&Bw(i,e,t,r),aS[t.index].halfedges.push(o),aS[e.index].halfedges.push(o),i}function Fw(t,e,n){var r=[e,n];return r.left=t,r}function Bw(t,e,n,r){t[0]||t[1]?t.left===n?t[1]=r:t[0]=r:(t[0]=r,t.left=e,t.right=n)}function Uw(t,e,n,r,i){var o,a=t[0],s=t[1],c=a[0],l=a[1],u=0,d=1,h=s[0]-c,f=s[1]-l;if(o=e-c,h||!(o>0)){if(o/=h,h<0){if(o<u)return;o<d&&(d=o)}else if(h>0){if(o>d)return;o>u&&(u=o)}if(o=r-c,h||!(o<0)){if(o/=h,h<0){if(o>d)return;o>u&&(u=o)}else if(h>0){if(o<u)return;o<d&&(d=o)}if(o=n-l,f||!(o>0)){if(o/=f,f<0){if(o<u)return;o<d&&(d=o)}else if(f>0){if(o>d)return;o>u&&(u=o)}if(o=i-l,f||!(o<0)){if(o/=f,f<0){if(o>d)return;o>u&&(u=o)}else if(f>0){if(o<u)return;o<d&&(d=o)}return!(u>0||d<1)||(u>0&&(t[0]=[c+u*h,l+u*f]),d<1&&(t[1]=[c+d*h,l+d*f]),!0)}}}}}function Hw(t,e,n,r,i){var o=t[1];if(o)return!0;var a,s,c=t[0],l=t.left,u=t.right,d=l[0],h=l[1],f=u[0],p=u[1],m=(d+f)/2,g=(h+p)/2;if(p===h){if(m<e||m>=r)return;if(d>f){if(c){if(c[1]>=i)return}else c=[m,n];o=[m,i]}else{if(c){if(c[1]<n)return}else c=[m,i];o=[m,n]}}else if(s=g-(a=(d-f)/(p-h))*m,a<-1||a>1)if(d>f){if(c){if(c[1]>=i)return}else c=[(n-s)/a,n];o=[(i-s)/a,i]}else{if(c){if(c[1]<n)return}else c=[(i-s)/a,i];o=[(n-s)/a,n]}else if(h<p){if(c){if(c[0]>=r)return}else c=[e,a*e+s];o=[r,a*r+s]}else{if(c){if(c[0]<e)return}else c=[r,a*r+s];o=[e,a*e+s]}return t[0]=c,t[1]=o,!0}function Vw(t,e){var n=t.site,r=e.left,i=e.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=e[1],i=e[0]):(r=e[0],i=e[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function Gw(t,e){return e[+(e.left!==t.site)]}function Ww(t,e){return e[+(e.left===t.site)]}var $w,qw=[];function Xw(){Rw(this),this.x=this.y=this.arc=this.site=this.cy=null}function Yw(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,i=t.site,o=n.site;if(r!==o){var a=i[0],s=i[1],c=r[0]-a,l=r[1]-s,u=o[0]-a,d=o[1]-s,h=2*(c*d-l*u);if(!(h>=-uS)){var f=c*c+l*l,p=u*u+d*d,m=(d*f-l*p)/h,g=(c*p-u*f)/h,v=qw.pop()||new Xw;v.arc=t,v.site=i,v.x=m+a,v.y=(v.cy=g+s)+Math.sqrt(m*m+g*g),t.circle=v;for(var y=null,b=sS._;b;)if(v.y<b.y||v.y===b.y&&v.x<=b.x){if(!b.L){y=b.P;break}b=b.L}else{if(!b.R){y=b;break}b=b.R}sS.insert(y,v),y||($w=v)}}}}function Kw(t){var e=t.circle;e&&(e.P||($w=e.N),sS.remove(e),qw.push(e),Rw(e),t.circle=null)}var Zw=[];function Jw(){Rw(this),this.edge=this.site=this.circle=null}function Qw(t){var e=Zw.pop()||new Jw;return e.site=t,e}function tS(t){Kw(t),oS.remove(t),Zw.push(t),Rw(t)}function eS(t){var e=t.circle,n=e.x,r=e.cy,i=[n,r],o=t.P,a=t.N,s=[t];tS(t);for(var c=o;c.circle&&Math.abs(n-c.circle.x)<lS&&Math.abs(r-c.circle.cy)<lS;)o=c.P,s.unshift(c),tS(c),c=o;s.unshift(c),Kw(c);for(var l=a;l.circle&&Math.abs(n-l.circle.x)<lS&&Math.abs(r-l.circle.cy)<lS;)a=l.N,s.push(l),tS(l),l=a;s.push(l),Kw(l);var u,d=s.length;for(u=1;u<d;++u)l=s[u],c=s[u-1],Bw(l.edge,c.site,l.site,i);c=s[0],(l=s[d-1]).edge=jw(c.site,l.site,null,i),Yw(c),Yw(l)}function nS(t){for(var e,n,r,i,o=t[0],a=t[1],s=oS._;s;)if((r=rS(s,a)-o)>lS)s=s.L;else{if(!((i=o-iS(s,a))>lS)){r>-lS?(e=s.P,n=s):i>-lS?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}!function(t){aS[t.index]={site:t,halfedges:[]}}(t);var c=Qw(t);if(oS.insert(e,c),e||n){if(e===n)return Kw(e),n=Qw(e.site),oS.insert(c,n),c.edge=n.edge=jw(e.site,c.site),Yw(e),void Yw(n);if(n){Kw(e),Kw(n);var l=e.site,u=l[0],d=l[1],h=t[0]-u,f=t[1]-d,p=n.site,m=p[0]-u,g=p[1]-d,v=2*(h*g-f*m),y=h*h+f*f,b=m*m+g*g,x=[(g*y-f*b)/v+u,(h*b-m*y)/v+d];Bw(n.edge,l,p,x),c.edge=jw(l,t,null,x),n.edge=jw(t,p,null,x),Yw(e),Yw(n)}else c.edge=jw(e.site,c.site)}}function rS(t,e){var n=t.site,r=n[0],i=n[1],o=i-e;if(!o)return r;var a=t.P;if(!a)return-1/0;var s=(n=a.site)[0],c=n[1],l=c-e;if(!l)return s;var u=s-r,d=1/o-1/l,h=u/l;return d?(-h+Math.sqrt(h*h-2*d*(u*u/(-2*l)-c+l/2+i-o/2)))/d+r:(r+s)/2}function iS(t,e){var n=t.N;if(n)return rS(n,e);var r=t.site;return r[1]===e?r[0]:1/0}var oS,aS,sS,cS,lS=1e-6,uS=1e-12;function dS(t,e){return e[1]-t[1]||e[0]-t[0]}function hS(t,e){var n,r,i,o=t.sort(dS).pop();for(cS=[],aS=new Array(t.length),oS=new zw,sS=new zw;;)if(i=$w,o&&(!i||o[1]<i.y||o[1]===i.y&&o[0]<i.x))o[0]===n&&o[1]===r||(nS(o),n=o[0],r=o[1]),o=t.pop();else{if(!i)break;eS(i.arc)}if(function(){for(var t,e,n,r,i=0,o=aS.length;i<o;++i)if((t=aS[i])&&(r=(e=t.halfedges).length)){var a=new Array(r),s=new Array(r);for(n=0;n<r;++n)a[n]=n,s[n]=Vw(t,cS[e[n]]);for(a.sort((function(t,e){return s[e]-s[t]})),n=0;n<r;++n)s[n]=e[a[n]];for(n=0;n<r;++n)e[n]=s[n]}}(),e){var a=+e[0][0],s=+e[0][1],c=+e[1][0],l=+e[1][1];!function(t,e,n,r){for(var i,o=cS.length;o--;)Hw(i=cS[o],t,e,n,r)&&Uw(i,t,e,n,r)&&(Math.abs(i[0][0]-i[1][0])>lS||Math.abs(i[0][1]-i[1][1])>lS)||delete cS[o]}(a,s,c,l),function(t,e,n,r){var i,o,a,s,c,l,u,d,h,f,p,m,g=aS.length,v=!0;for(i=0;i<g;++i)if(o=aS[i]){for(a=o.site,s=(c=o.halfedges).length;s--;)cS[c[s]]||c.splice(s,1);for(s=0,l=c.length;s<l;)p=(f=Ww(o,cS[c[s]]))[0],m=f[1],d=(u=Gw(o,cS[c[++s%l]]))[0],h=u[1],(Math.abs(p-d)>lS||Math.abs(m-h)>lS)&&(c.splice(s,0,cS.push(Fw(a,f,Math.abs(p-t)<lS&&r-m>lS?[t,Math.abs(d-t)<lS?h:r]:Math.abs(m-r)<lS&&n-p>lS?[Math.abs(h-r)<lS?d:n,r]:Math.abs(p-n)<lS&&m-e>lS?[n,Math.abs(d-n)<lS?h:e]:Math.abs(m-e)<lS&&p-t>lS?[Math.abs(h-e)<lS?d:t,e]:null))-1),++l);l&&(v=!1)}if(v){var y,b,x,_=1/0;for(i=0,v=null;i<g;++i)(o=aS[i])&&(x=(y=(a=o.site)[0]-t)*y+(b=a[1]-e)*b)<_&&(_=x,v=o);if(v){var w=[t,e],S=[t,r],M=[n,r],E=[n,e];v.halfedges.push(cS.push(Fw(a=v.site,w,S))-1,cS.push(Fw(a,S,M))-1,cS.push(Fw(a,M,E))-1,cS.push(Fw(a,E,w))-1)}}for(i=0;i<g;++i)(o=aS[i])&&(o.halfedges.length||delete aS[i])}(a,s,c,l)}this.edges=cS,this.cells=aS,oS=sS=cS=aS=null}hS.prototype={constructor:hS,polygons:function(){var t=this.edges;return this.cells.map((function(e){var n=e.halfedges.map((function(n){return Gw(e,t[n])}));return n.data=e.site.data,n}))},triangles:function(){var t=[],e=this.edges;return this.cells.forEach((function(n,r){if(o=(i=n.halfedges).length)for(var i,o,a,s,c,l,u=n.site,d=-1,h=e[i[o-1]],f=h.left===u?h.right:h.left;++d<o;)a=f,f=(h=e[i[d]]).left===u?h.right:h.left,a&&f&&r<a.index&&r<f.index&&(c=a,l=f,((s=u)[0]-l[0])*(c[1]-s[1])-(s[0]-c[0])*(l[1]-s[1])<0)&&t.push([u.data,a.data,f.data])})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,e,n){for(var r,i,o=this,a=o._found||0,s=o.cells.length;!(i=o.cells[a]);)if(++a>=s)return null;var c=t-i.site[0],l=e-i.site[1],u=c*c+l*l;do{i=o.cells[r=a],a=null,i.halfedges.forEach((function(n){var r=o.edges[n],s=r.left;if(s!==i.site&&s||(s=r.right)){var c=t-s[0],l=e-s[1],d=c*c+l*l;d<u&&(u=d,a=s.index)}}))}while(null!==a);return o._found=r,null==n||u<=n*n?i.site:null}};var fS=function(){var t=Ow,e=kw,n=null;function r(r){return new hS(r.map((function(n,i){var o=[Math.round(t(n,i,r)/lS)*lS,Math.round(e(n,i,r)/lS)*lS];return o.index=i,o.data=n,o})),n)}return r.polygons=function(t){return r(t).polygons()},r.links=function(t){return r(t).links()},r.triangles=function(t){return r(t).triangles()},r.x=function(e){return arguments.length?(t="function"==typeof e?e:Pw(+e),r):t},r.y=function(t){return arguments.length?(e="function"==typeof t?t:Pw(+t),r):e},r.extent=function(t){return arguments.length?(n=null==t?null:[[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]],r):n&&[[n[0][0],n[0][1]],[n[1][0],n[1][1]]]},r.size=function(t){return arguments.length?(n=null==t?null:[[0,0],[+t[0],+t[1]]],r):n&&[n[1][0]-n[0][0],n[1][1]-n[0][1]]},r},pS=function(t){return function(){return t}};function mS(t,e,n){this.target=t,this.type=e,this.transform=n}function gS(t,e,n){this.k=t,this.x=e,this.y=n}gS.prototype={constructor:gS,scale:function(t){return 1===t?this:new gS(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new gS(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var vS=new gS(1,0,0);function yS(t){for(;!t.__zoom;)if(!(t=t.parentNode))return vS;return t.__zoom}function bS(){le.stopImmediatePropagation()}yS.prototype=gS.prototype;var xS=function(){le.preventDefault(),le.stopImmediatePropagation()};function _S(){return!le.ctrlKey&&!le.button}function wS(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function SS(){return this.__zoom||vS}function MS(){return-le.deltaY*(1===le.deltaMode?.05:le.deltaMode?1:.002)}function ES(){return navigator.maxTouchPoints||"ontouchstart"in this}function TS(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],o=t.invertY(e[0][1])-n[0][1],a=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}var AS=function(){var t,e,n=_S,r=wS,i=TS,o=MS,a=ES,s=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],l=250,u=hp,d=dt("start","zoom","end"),h=0;function f(t){t.property("__zoom",SS).on("wheel.zoom",x).on("mousedown.zoom",_).on("dblclick.zoom",w).filter(a).on("touchstart.zoom",S).on("touchmove.zoom",M).on("touchend.zoom touchcancel.zoom",E).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(t,e){return(e=Math.max(s[0],Math.min(s[1],e)))===t.k?t:new gS(e,t.x,t.y)}function m(t,e,n){var r=e[0]-n[0]*t.k,i=e[1]-n[1]*t.k;return r===t.x&&i===t.y?t:new gS(t.k,r,i)}function g(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function v(t,e,n){t.on("start.zoom",(function(){y(this,arguments).start()})).on("interrupt.zoom end.zoom",(function(){y(this,arguments).end()})).tween("zoom",(function(){var t=this,i=arguments,o=y(t,i),a=r.apply(t,i),s=null==n?g(a):"function"==typeof n?n.apply(t,i):n,c=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),l=t.__zoom,d="function"==typeof e?e.apply(t,i):e,h=u(l.invert(s).concat(c/l.k),d.invert(s).concat(c/d.k));return function(t){if(1===t)t=d;else{var e=h(t),n=c/e[2];t=new gS(n,s[0]-e[0]*n,s[1]-e[1]*n)}o.zoom(null,t)}}))}function y(t,e,n){return!n&&t.__zooming||new b(t,e)}function b(t,e){this.that=t,this.args=e,this.active=0,this.extent=r.apply(t,e),this.taps=0}function x(){if(n.apply(this,arguments)){var t=y(this,arguments),e=this.__zoom,r=Math.max(s[0],Math.min(s[1],e.k*Math.pow(2,o.apply(this,arguments)))),a=Rn(this);if(t.wheel)t.mouse[0][0]===a[0]&&t.mouse[0][1]===a[1]||(t.mouse[1]=e.invert(t.mouse[0]=a)),clearTimeout(t.wheel);else{if(e.k===r)return;t.mouse=[a,e.invert(a)],sr(this),t.start()}xS(),t.wheel=setTimeout(l,150),t.zoom("mouse",i(m(p(e,r),t.mouse[0],t.mouse[1]),t.extent,c))}function l(){t.wheel=null,t.end()}}function _(){if(!e&&n.apply(this,arguments)){var t=y(this,arguments,!0),r=Se(le.view).on("mousemove.zoom",l,!0).on("mouseup.zoom",u,!0),o=Rn(this),a=le.clientX,s=le.clientY;Te(le.view),bS(),t.mouse=[o,this.__zoom.invert(o)],sr(this),t.start()}function l(){if(xS(),!t.moved){var e=le.clientX-a,n=le.clientY-s;t.moved=e*e+n*n>h}t.zoom("mouse",i(m(t.that.__zoom,t.mouse[0]=Rn(t.that),t.mouse[1]),t.extent,c))}function u(){r.on("mousemove.zoom mouseup.zoom",null),Ae(le.view,t.moved),xS(),t.end()}}function w(){if(n.apply(this,arguments)){var t=this.__zoom,e=Rn(this),o=t.invert(e),a=t.k*(le.shiftKey?.5:2),s=i(m(p(t,a),e,o),r.apply(this,arguments),c);xS(),l>0?Se(this).transition().duration(l).call(v,s,e):Se(this).call(f.transform,s)}}function S(){if(n.apply(this,arguments)){var e,r,i,o,a=le.touches,s=a.length,c=y(this,arguments,le.changedTouches.length===s);for(bS(),r=0;r<s;++r)i=a[r],o=[o=Ln(this,a,i.identifier),this.__zoom.invert(o),i.identifier],c.touch0?c.touch1||c.touch0[2]===o[2]||(c.touch1=o,c.taps=0):(c.touch0=o,e=!0,c.taps=1+!!t);t&&(t=clearTimeout(t)),e&&(c.taps<2&&(t=setTimeout((function(){t=null}),500)),sr(this),c.start())}}function M(){if(this.__zooming){var e,n,r,o,a=y(this,arguments),s=le.changedTouches,l=s.length;for(xS(),t&&(t=clearTimeout(t)),a.taps=0,e=0;e<l;++e)n=s[e],r=Ln(this,s,n.identifier),a.touch0&&a.touch0[2]===n.identifier?a.touch0[0]=r:a.touch1&&a.touch1[2]===n.identifier&&(a.touch1[0]=r);if(n=a.that.__zoom,a.touch1){var u=a.touch0[0],d=a.touch0[1],h=a.touch1[0],f=a.touch1[1],g=(g=h[0]-u[0])*g+(g=h[1]-u[1])*g,v=(v=f[0]-d[0])*v+(v=f[1]-d[1])*v;n=p(n,Math.sqrt(g/v)),r=[(u[0]+h[0])/2,(u[1]+h[1])/2],o=[(d[0]+f[0])/2,(d[1]+f[1])/2]}else{if(!a.touch0)return;r=a.touch0[0],o=a.touch0[1]}a.zoom("touch",i(m(n,r,o),a.extent,c))}}function E(){if(this.__zooming){var t,n,r=y(this,arguments),i=le.changedTouches,o=i.length;for(bS(),e&&clearTimeout(e),e=setTimeout((function(){e=null}),500),t=0;t<o;++t)n=i[t],r.touch0&&r.touch0[2]===n.identifier?delete r.touch0:r.touch1&&r.touch1[2]===n.identifier&&delete r.touch1;if(r.touch1&&!r.touch0&&(r.touch0=r.touch1,delete r.touch1),r.touch0)r.touch0[1]=this.__zoom.invert(r.touch0[0]);else if(r.end(),2===r.taps){var a=Se(this).on("dblclick.zoom");a&&a.apply(this,arguments)}}}return f.transform=function(t,e,n){var r=t.selection?t.selection():t;r.property("__zoom",SS),t!==r?v(t,e,n):r.interrupt().each((function(){y(this,arguments).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},f.scaleBy=function(t,e,n){f.scaleTo(t,(function(){var t=this.__zoom.k,n="function"==typeof e?e.apply(this,arguments):e;return t*n}),n)},f.scaleTo=function(t,e,n){f.transform(t,(function(){var t=r.apply(this,arguments),o=this.__zoom,a=null==n?g(t):"function"==typeof n?n.apply(this,arguments):n,s=o.invert(a),l="function"==typeof e?e.apply(this,arguments):e;return i(m(p(o,l),a,s),t,c)}),n)},f.translateBy=function(t,e,n){f.transform(t,(function(){return i(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),r.apply(this,arguments),c)}))},f.translateTo=function(t,e,n,o){f.transform(t,(function(){var t=r.apply(this,arguments),a=this.__zoom,s=null==o?g(t):"function"==typeof o?o.apply(this,arguments):o;return i(vS.translate(s[0],s[1]).scale(a.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,c)}),o)},b.prototype={start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){me(new mS(f,t,this.that.__zoom),d.apply,d,[t,this.that,this.args])}},f.wheelDelta=function(t){return arguments.length?(o="function"==typeof t?t:pS(+t),f):o},f.filter=function(t){return arguments.length?(n="function"==typeof t?t:pS(!!t),f):n},f.touchable=function(t){return arguments.length?(a="function"==typeof t?t:pS(!!t),f):a},f.extent=function(t){return arguments.length?(r="function"==typeof t?t:pS([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),f):r},f.scaleExtent=function(t){return arguments.length?(s[0]=+t[0],s[1]=+t[1],f):[s[0],s[1]]},f.translateExtent=function(t){return arguments.length?(c[0][0]=+t[0][0],c[1][0]=+t[1][0],c[0][1]=+t[0][1],c[1][1]=+t[1][1],f):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},f.constrain=function(t){return arguments.length?(i=t,f):i},f.duration=function(t){return arguments.length?(l=+t,f):l},f.interpolate=function(t){return arguments.length?(u=t,f):u},f.on=function(){var t=d.on.apply(d,arguments);return t===d?f:t},f.clickDistance=function(t){return arguments.length?(h=(t=+t)*t,f):Math.sqrt(h)},f}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(23);n.d(e,"b",(function(){return r.b}));
/**
@license
Copyright 2018 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
class i extends r.a{createRenderRoot(){return this.attachShadow({mode:"open",delegatesFocus:!0})}click(){this.formElement&&(this.formElement.focus(),this.formElement.click())}setAriaLabel(t){this.formElement&&this.formElement.setAttribute("aria-label",t)}firstUpdated(){super.firstUpdated(),this.mdcRoot.addEventListener("change",t=>{this.dispatchEvent(new Event("change",t))})}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(3);
/**
 * @license
 * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const i=new WeakMap,o=Object(r.directive)(t=>e=>{const n=i.get(e);if(void 0===t&&e instanceof r.AttributePart){if(void 0!==n||!i.has(e)){const t=e.committer.name;e.committer.element.removeAttribute(t)}}else t!==n&&e.setValue(t);i.set(e,t)})},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0),i=n(45);n.d(e,"b",(function(){return i.a}));
/**
@license
Copyright 2018 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
class o extends r.LitElement{createFoundation(){void 0!==this.mdcFoundation&&this.mdcFoundation.destroy(),this.mdcFoundationClass&&(this.mdcFoundation=new this.mdcFoundationClass(this.createAdapter()),this.mdcFoundation.init())}firstUpdated(){this.createFoundation()}}},function(t,e,n){"use strict";n.r(e),n.d(e,"MobxReactionUpdate",(function(){return a})),n.d(e,"MobxLitElement",(function(){return c}));var r=n(4);const i=Symbol("LitMobxRenderReaction"),o=Symbol("LitMobxRequestUpdate");function a(t){var e,n;return n=class extends t{constructor(){super(...arguments),this[e]=()=>{this.requestUpdate()}}connectedCallback(){super.connectedCallback();const t=this.constructor.name||this.nodeName;this[i]=new r.Reaction(t+".update()",this[o]),this.hasUpdated&&this.requestUpdate()}disconnectedCallback(){super.disconnectedCallback(),this[i]&&(this[i].dispose(),this[i]=void 0)}update(t){this[i]?this[i].track(super.update.bind(this,t)):super.update(t)}},e=o,n}var s=n(0);class c extends(a(s.LitElement)){}},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o}));var r=n(6);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */function i(t){let e=o.get(t.type);void 0===e&&(e={stringsArray:new WeakMap,keyString:new Map},o.set(t.type,e));let n=e.stringsArray.get(t.strings);if(void 0!==n)return n;const i=t.strings.join(r.f);return n=e.keyString.get(i),void 0===n&&(n=new r.a(t,t.getTemplateElement()),e.keyString.set(i,n)),e.stringsArray.set(t.strings,n),n}const o=new Map},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return s}));var r=n(16),i=n(12),o=n(25);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const a=new WeakMap,s=(t,e,n)=>{let s=a.get(e);void 0===s&&(Object(r.b)(e,e.firstChild),a.set(e,s=new i.e(Object.assign({templateFactory:o.b},n))),s.appendInto(e)),s.setValue(t),s.commit()}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const r=new WeakMap,i=t=>(...e)=>{const n=t(...e);return r.set(n,!0),n},o=t=>"function"==typeof t&&r.has(t)},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return s}));var r=n(16),i=n(6);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const o=` ${i.f} `;class a{constructor(t,e,n,r){this.strings=t,this.values=e,this.type=n,this.processor=r}getHTML(){const t=this.strings.length-1;let e="",n=!1;for(let r=0;r<t;r++){const t=this.strings[r],a=t.lastIndexOf("\x3c!--");n=(a>-1||n)&&-1===t.indexOf("--\x3e",a+1);const s=i.e.exec(t);e+=null===s?t+(n?o:i.g):t.substr(0,s.index)+s[1]+s[2]+i.b+s[3]+i.f}return e+=this.strings[t],e}getTemplateElement(){const t=document.createElement("template");return t.innerHTML=this.getHTML(),t}}class s extends a{getHTML(){return`<svg>${super.getHTML()}</svg>`}getTemplateElement(){const t=super.getTemplateElement(),e=t.content,n=e.firstChild;return e.removeChild(n),Object(r.c)(e,n.firstChild),t}}},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.GroupService=void 0;const s=a(n(20)),c=n(4);n(5);const l=n(9),u=n(18);n(41);class d extends u.LitService{constructor(t){super(),this.appState=t}get categoricalFeatureNames(){const t=this.appState.currentDatasetSpec;return l.findSpecKeys(t,"CategoryLabel")}get numericalFeatureNames(){const t=this.appState.currentDatasetSpec;return l.findSpecKeys(t,"Scalar")}get categoricalAndNumericalFeatureNames(){return[...this.categoricalFeatureNames,...this.numericalFeatureNames]}get categoricalFeatures(){const t={};for(const e of this.categoricalFeatureNames){const n=this.appState.currentDatasetSpec[e].vocab;if(null!=n)t[e]=[...n];else{const n=new Set(this.appState.currentInputData.map(t=>t.data[e]));t[e]=[...n]}}return t}get numericalFeatureRanges(){const t={};return this.numericalFeatureNames.forEach(e=>{const n=this.appState.currentInputData.map(t=>t.data[e]),r=Math.min(...n),i=Math.max(...n);t[e]=[r,i]}),t}get numericalFeatureBins(){const t={};return this.numericalFeatureNames.forEach(e=>{const n=this.appState.currentInputData.map(t=>t.data[e]),r=this.numericalFeatureRanges[e][0],i=this.numericalFeatureRanges[e][1],o=s.histogram().domain([r,i]).thresholds(s.thresholdFreedmanDiaconis(n,r,i))(n),a={};o.forEach((t,e)=>{const n=l.roundToDecimalPlaces(t.x0,3),r=l.roundToDecimalPlaces(t.x1,3);if(null==n||null==r)return;let i=[n,r],s=`[${n}, ${r})`;e===o.length-1&&(i=[n,r+1e-6],s=`[${n}, ${r}]`),a[s]=i}),t[e]=a}),t}getNumericalBinKeyForExample(t,e){const n=this.numericalFeatureBins[e];for(const r of Object.keys(n)){const i=n[r][0],o=n[r][1],a=t.data[e];if(a>=i&&a<o)return r}return null}numIntersectionsLabel(t){const e=t.map(t=>this.categoricalFeatureNames.includes(t)?this.categoricalFeatures[t].length:this.numericalFeatureNames.includes(t)?Object.keys(this.numericalFeatureBins[t]).length:0),n=e.reduce((t,e)=>t*e);return e.length>1?`${e.join("x")} = ${n}`:e[0].toString()}groupExamplesByFeatures(t,e,n=((t,e,n)=>this.getFeatureValForInput(t,e,n))){const r={};return t.forEach((t,i)=>{const o={};e.forEach(e=>{const r=n(t,i,e);r&&(o[e]=r)});const a=l.objToDictKey(o);r.hasOwnProperty(a)||(r[a]={displayName:a,data:[],facets:o}),r[a].data.push(t)}),r}getFeatureValForInput(t,e,n){if(n in t.data){return this.numericalFeatureNames.includes(n)?this.getNumericalBinKeyForExample(t,n):t.data[n]}return null}}o([c.computed],d.prototype,"categoricalFeatureNames",null),o([c.computed],d.prototype,"numericalFeatureNames",null),o([c.computed],d.prototype,"categoricalAndNumericalFeatureNames",null),o([c.computed],d.prototype,"categoricalFeatures",null),o([c.computed],d.prototype,"numericalFeatureRanges",null),o([c.computed],d.prototype,"numericalFeatureBins",null),e.GroupService=d},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(16),i=n(6);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
class o{constructor(t,e,n){this.__parts=[],this.template=t,this.processor=e,this.options=n}update(t){let e=0;for(const n of this.__parts)void 0!==n&&n.setValue(t[e]),e++;for(const t of this.__parts)void 0!==t&&t.commit()}_clone(){const t=r.a?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),e=[],n=this.template.parts,o=document.createTreeWalker(t,133,null,!1);let a,s=0,c=0,l=o.nextNode();for(;s<n.length;)if(a=n[s],Object(i.d)(a)){for(;c<a.index;)c++,"TEMPLATE"===l.nodeName&&(e.push(l),o.currentNode=l.content),null===(l=o.nextNode())&&(o.currentNode=e.pop(),l=o.nextNode());if("node"===a.type){const t=this.processor.handleTextExpression(this.options);t.insertAfterNode(l.previousSibling),this.__parts.push(t)}else this.__parts.push(...this.processor.handleAttributeExpressions(l,a.name,a.strings,this.options));s++}else this.__parts.push(void 0),s++;return r.a&&(document.adoptNode(t),customElements.upgrade(t)),t}}},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e},s=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.ClassificationService=e.getPredictionClass=void 0;const c=a(n(20)),l=n(4);n(5);const u=n(9),d=n(18);n(10);const h=new Map([["predictions","predictions"],["predictedClassIdx","predicted class index"],["predictionCorrect","prediction correct"]]);function f(t,e,n,r){const i=null==(null==r?void 0:r[e])?0:r[e],o=n[e].null_idx;let a=-1/0,s=0;for(let e=0;e<t.length;e++){let n=Math.log(t[e]);o===e&&(n+=i),a<n&&(a=n,s=e)}return s}e.getPredictionClass=f;class p extends d.LitService{constructor(t,e){super(),this.apiService=t,this.appState=e,this.classificationInfo={},this.marginSettings={},this.labelNames={},l.reaction(()=>this.allMarginSettings,t=>{this.updateClassifications()}),l.reaction(()=>e.currentModels,t=>{this.reset()})}get allMarginSettings(){return Object.values(this.marginSettings).flatMap(t=>Object.values(t))}setMargin(t,e,n){null==this.marginSettings[t]&&(this.marginSettings[t]={}),this.marginSettings[t][e]=n}getClassificationPreds(t,e,n){return s(this,void 0,void 0,(function*(){const r=this.apiService.getPreds(t,e,n,["MulticlassPreds"]),i=yield r;return null!=i&&i.length>0&&this.processNewPreds(t,e,i),r}))}getLabelNames(t,e){return this.labelNames[`${t}:${e}`]}getInfoFields(){return Array.from(h.keys())}getDisplayNames(){return Array.from(h.values())}updateClassifications(){for(const t of this.appState.currentInputData){const e=this.classificationInfo[t.id];if(null==e)continue;const n=Object.keys(e);for(const r of n){const n=Object.keys(e[r]);for(const i of n){const n=e[r][i];this.updateClassification(n,t,i,r)}}}}updateClassification(t,e,n,r){const i=this.appState.currentModelSpecs[r].spec.output;this.appState.currentDatasetSpec;t.predictedClassIdx=f(t.predictions,n,i,this.marginSettings[r]);const o=`${r}:${n}`;null==this.labelNames[o]&&(this.labelNames[o]=i[n].vocab||Array.from({length:t.predictions.length},(t,e)=>""+e));const a=i[n].parent;null!=a&&(t.predictionCorrect=e.data[a]===this.labelNames[o][t.predictedClassIdx])}reset(){this.classificationInfo={}}getResults(t,e,n){return s(this,void 0,void 0,(function*(){const r=[];t.forEach(i=>{var o,a;null==(null===(a=null===(o=this.classificationInfo[t[0]])||void 0===o?void 0:o[e])||void 0===a?void 0:a[n])&&r.push(i)}),r.length>0&&(yield this.getClassificationPreds(this.appState.getExamplesById(r),e,this.appState.currentDataset));const i=[];return t.forEach(t=>{var r,o;const a=null===(o=null===(r=this.classificationInfo[t])||void 0===r?void 0:r[e])||void 0===o?void 0:o[n];null!=a&&i.push(a)}),i}))}processNewPreds(t,e,n){const r=this.appState.currentModelSpecs[e].spec.output,i=u.findSpecKeys(r,"MulticlassPreds"),o=Object.keys(n[0]);for(let r=0;r<n.length;r++){const a=t[r],s=n[r];null==this.classificationInfo[a.id]&&(this.classificationInfo[a.id]={}),null==this.classificationInfo[a.id][e]&&(this.classificationInfo[a.id][e]={});for(let t=0;t<o.length;t++){const n=o[t];if(!i.includes(n))continue;const r={};r.predictions=s[n],this.updateClassification(r,a,n,e),null==this.classificationInfo[a.id][e][n]&&(this.classificationInfo[a.id][e][n]=r)}}}get colorOptions(){const t=Object.keys(this.classificationInfo);if(0===t.length)return[];const e=[],n=this.classificationInfo[t[0]],r=Object.keys(n);for(const t of r){const r=Object.keys(n[t]);for(const i of r)e.push({name:`${t}:${i} class`,getValue:e=>this.labelNames[`${t}:${i}`][this.classificationInfo[e.id][t][i].predictedClassIdx],scale:c.scaleOrdinal(c.schemeCategory10).domain(this.labelNames[`${t}:${i}`])}),null!=n[t][i].predictionCorrect&&e.push({name:`${t}:${i} correct`,getValue:e=>this.classificationInfo[e.id][t][i].predictionCorrect?"correct":"incorrect",scale:c.scaleOrdinal(c.schemeSet1).domain(["incorrect","correct"])})}return e}}o([l.observable],p.prototype,"classificationInfo",void 0),o([l.observable],p.prototype,"marginSettings",void 0),o([l.observable],p.prototype,"labelNames",void 0),o([l.computed],p.prototype,"allMarginSettings",null),o([l.action],p.prototype,"setMargin",null),o([l.computed],p.prototype,"colorOptions",null),e.ClassificationService=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2);function i(t,e){return void 0===e&&(e=!0),t.needsUpdate=e,t.minFilter=r.LinearFilter,t.generateMipmaps=!1,t.flipY=!1,t}e.vector3DToScreenCoords=function(t,e,n,i){var o=window.devicePixelRatio,a=(new r.Vector3).copy(i).project(t);return[(a.x+1)/2*e*o,-(a.y-1)/2*n*o]},e.vector3FromPackedArray=function(t,e){var n=3*e;return new r.Vector3(t[n],t[n+1],t[n+2])},e.getNearFarPoints=function(t,e,n){for(var i=1/0,o=0,a=(new r.Vector3).copy(n).sub(e),s=(new r.Vector3).copy(a).normalize(),c=t.length/3,l=0,u=new r.Vector3,d=new r.Vector3,h=0;h<c;h++){u.x=t[l],u.y=t[l+1],u.z=t[l+2],l+=3,d.copy(u).sub(e);var f=s.dot(d);f<0||(o=f>o?f:o,i=f<i?f:i)}return[i,o]},e.createTextureFromCanvas=function(t){return i(new r.Texture(t))},e.createTextureFromImage=function(t,e){var n=new r.Texture(t);return t.onload=function(){n.needsUpdate=!0,e()},i(n,!1)},e.hasWebGLSupport=function(){try{var t=document.createElement("canvas");return null!=(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch(t){return!1}},e.extent=function(t){for(var e=1/0,n=-1/0,r=0;r<t.length;r++){var i=t[r];i<e&&(e=i),i>n&&(n=i)}return[e,n]},e.scaleLinear=function(t,e,n){var r=e[1]-e[0],i=n[1]-n[0];return(t-e[0])/r*i+n[0]},e.scaleExponential=function(t,e,n){var r=Math.pow(e[1],Math.E)-Math.pow(e[0],Math.E),i=n[1]-n[0];return(Math.pow(t,Math.E)-e[0])/r*i+n[0]},e.packRgbIntoUint8Array=function(t,e,n,r,i){t[3*e]=n,t[3*e+1]=r,t[3*e+2]=i},e.styleRgbFromHexColor=function(t){var e=new r.Color(t);return[255*e.r|0,255*e.g|0,255*e.b|0]};var o=function(t){return 100*t+"%"};e.getDefaultPointInPolylineColor=function(t,e,n,i,a,s){var c="hsl("+(n+(i-n)*t/e)+", "+o(a)+", "+o(s)+")";return new r.Color(c)}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){(function(e){t.exports=e}).call(this,{})},function(t,e,n){"use strict";n.r(e),n.d(e,"Icon",(function(){return a}));var r=n(1),i=n(0);
/**
@license
Copyright 2018 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
const o=i.css`:host{font-family:var(--mdc-icon-font, "Material Icons");font-weight:normal;font-style:normal;font-size:var(--mdc-icon-size, 24px);line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;font-feature-settings:"liga"}`;
/**
@license
Copyright 2018 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/let a=class extends i.LitElement{render(){return i.html`<slot></slot>`}};a.styles=o,a=Object(r.b)([Object(i.customElement)("mwc-icon")],a)},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0}),e.LitCheckbox=void 0;const i=n(143),o=n(0),a=n(8);let s=class extends o.LitElement{constructor(){super(...arguments),this.label="",this.checked=!1,this.indeterminate=!1,this.disabled=!1,this.value=""}static get styles(){return o.css`
      :host {
        outline: none;
      }

      .wrapper {
        display: flex;
        align-items: center;
        font-size: 10pt;
        height: 28px;
        margin-left: -12px;
      }

      .wrapper.disabled {
        opacity: 0.2;
      }

      lit-mwc-checkbox-internal {
        transform: scale(0.7);
        margin-right: -8px;
      }
    `}render(){const t=a.classMap({wrapper:!0,disabled:this.disabled});return o.html`
      <div class=${t}>
        <lit-mwc-checkbox-internal
          ?checked=${this.checked}
          ?indeterminate=${this.indeterminate}
          ?disabled=${this.disabled}
          value=${this.value}
          @change=${t=>{this.checked=t.target.checked;const e=new Event("change");this.dispatchEvent(e)}}
        >
        </lit-mwc-checkbox-internal>
        ${this.label}
      </div>
    `}};r([o.property({type:String})],s.prototype,"label",void 0),r([o.property({type:Boolean})],s.prototype,"checked",void 0),r([o.property({type:Boolean})],s.prototype,"indeterminate",void 0),r([o.property({type:Boolean})],s.prototype,"disabled",void 0),r([o.property({type:String})],s.prototype,"value",void 0),s=r([o.customElement("lit-checkbox")],s),e.LitCheckbox=s;class c extends i.Checkbox{constructor(){super(),Object.defineProperty(this,"shouldRenderRipple",{get:()=>!1,set:()=>{}})}}customElements.define("lit-mwc-checkbox-internal",c)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.UrlService=e.UrlConfiguration=void 0;const r=n(4),i=n(18);class o{constructor(){this.selectedModels=[],this.selectedData=[],this.hiddenModules=[]}}e.UrlConfiguration=o;class a extends i.LitService{urlParseArray(t){return t.split(",").filter(t=>""!==t)}urlParseString(t){return t||void 0}urlParseBoolean(t){return"true"===t}getConfigurationFromUrl(){const t=new o;return new URLSearchParams(window.location.search).forEach((e,n)=>{"models"===n?t.selectedModels=this.urlParseArray(e):"selection"===n?t.selectedData=this.urlParseArray(e):"primary"===n?t.primarySelectedData=this.urlParseString(e):"dataset"===n?t.selectedDataset=this.urlParseString(e):"hidden_modules"===n?t.hiddenModules=this.urlParseArray(e):"compare_data_mode"===n?t.compareExamplesEnabled=this.urlParseBoolean(e):"tab"===n?t.selectedTab=this.urlParseString(e):"layout"===n&&(t.layout=this.urlParseString(e))}),t}setUrlParam(t,e,n){const r=n instanceof Array?n.join(","):n;""!==r&&null!=r&&t.set(e,r)}syncStateToUrl(t,e,n){const i=this.getConfigurationFromUrl();t.setUrlConfiguration(i),n.setUrlConfiguration(i);const o=i.selectedData||[];e.selectIds(o),null!=i.primarySelectedData&&e.setPrimarySelection(i.primarySelectedData),e.selectedIds.length>0&&i.compareExamplesEnabled&&(t.compareExamplesEnabled=!0),r.autorun(()=>{const r=new URLSearchParams;if(this.setUrlParam(r,"models",t.currentModels),e.selectedIds.length<=100&&(this.setUrlParam(r,"selection",e.selectedIds),null!=e.primarySelectedId&&this.setUrlParam(r,"primary",e.primarySelectedId)),this.setUrlParam(r,"dataset",t.currentDataset),this.setUrlParam(r,"compare_data_mode",t.compareExamplesEnabled?"true":"false"),this.setUrlParam(r,"hidden_modules",[...n.hiddenModuleKeys]),this.setUrlParam(r,"layout",t.layoutName),this.setUrlParam(r,"tab",n.selectedTab),""!==r.toString()){const t=`${window.location.pathname}?${r.toString()}`;window.history.replaceState({},"",t)}})}}e.UrlService=a},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0}),e.ModulesService=void 0;const i=n(4);n(5);const o=n(18);n(37);class a extends o.LitService{constructor(){super(...arguments),this.declaredLayout={components:{},layoutSettings:{}},this.selectedTab="",this.renderLayout={},this.renderModulesCallback=()=>{},this.hiddenModuleKeys=new Set,this.numberOfSelectionServices=2,this.allModuleKeys=new Set}setRenderModulesCallback(t){this.renderModulesCallback=t}renderModules(){this.renderModulesCallback()}initializeLayout(t,e,n,r){this.setModuleLayout(t),this.declaredLayout.layoutSettings=t.layoutSettings||{},this.computeRenderLayout(e,n,r)}setHiddenModules(t){const e=new Set(t);this.hiddenModuleKeys=e}setUrlConfiguration(t){var e;this.setHiddenModules(t.hiddenModules),this.selectedTab=null!==(e=t.selectedTab)&&void 0!==e?e:""}filterHiddenConfigs(t){return t.map(t=>t.filter(t=>!this.isConfigHidden(t)))}isConfigHidden(t){const e=this.getModuleKey(t.moduleType);return this.hiddenModuleKeys.has(e)}getRenderLayout(){return this.renderLayout}getSetting(t){var e,n;return null===(n=null===(e=this.declaredLayout)||void 0===e?void 0:e.layoutSettings)||void 0===n?void 0:n[t]}computeRenderLayout(t,e,n){const r={},i=new Set;Object.keys(this.declaredLayout.components).forEach(o=>{const a=this.declaredLayout.components[o];let s=this.getRenderConfigs(a,t,e,n);s.forEach(t=>{t.forEach(t=>{const e=this.getModuleKey(t.moduleType);i.add(e)})}),s=this.filterHiddenConfigs(s),r[o]=s}),this.allModuleKeys=i;for(const t of[...this.hiddenModuleKeys])this.allModuleKeys.has(t)||this.hiddenModuleKeys.delete(t);this.renderLayout=r}getRenderConfigs(t,e,n,r){const i=[];return t.forEach(t=>{const o=r&&t.duplicateForExampleComparison;if(t.shouldDisplayModule(e,n))if(t.duplicateForModelComparison){const n=Object.keys(e).reduce((e,n)=>(o?(e.push(this.makeRenderConfig(t,n,1)),e.push(this.makeRenderConfig(t,n,0))):e.push(this.makeRenderConfig(t,n,r?0:void 0)),e),[]);i.push(n)}else{const e=[];o?(e.push(this.makeRenderConfig(t,void 0,1)),e.push(this.makeRenderConfig(t,void 0,0))):e.push(this.makeRenderConfig(t,void 0,r?0:void 0)),i.push(e)}}),i}makeRenderConfig(t,e,n){return{moduleType:t,modelName:e,selectionServiceIndex:n}}getModuleKey(t){return t.title}setModuleLayout(t){this.declaredLayout=t}}r([i.observable],a.prototype,"declaredLayout",void 0),r([i.observable],a.prototype,"selectedTab",void 0),r([i.observable],a.prototype,"hiddenModuleKeys",void 0),r([i.observable],a.prototype,"numberOfSelectionServices",void 0),e.ModulesService=a},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0}),e.SpinnerComponent=void 0;const i=n(0),o=n(15),a=(t,e)=>`solid ${t}px ${e}`;let s=class extends i.LitElement{constructor(){super(...arguments),this.size=16,this.color=""}static get styles(){return[i.css`
        #spinner {
          margin-left: 10px;
          border-radius: 50%;
          width: 16px;
          height: 16px;
          animation: spin 2s linear infinite;
        }

        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
      `]}render(){const t=this.size+"px",e=this.size/8,n=""===this.color?"var(--app-primary-color)":this.color,r=a(e,n),s=a(e,"rgba(0,0,0,0)"),c=o.styleMap({height:t,width:t,border:r,borderTop:s});return i.html`
      <div id="spinner" style=${c}></div>
    `}};r([i.property({type:Number})],s.prototype,"size",void 0),r([i.property({type:String})],s.prototype,"color",void 0),s=r([i.customElement("lit-spinner")],s),e.SpinnerComponent=s},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r=t=>(e,n)=>{if(e.constructor._observers){if(!e.constructor.hasOwnProperty("_observers")){const t=e.constructor._observers;e.constructor._observers=new Map,t.forEach((t,n)=>e.constructor._observers.set(n,t))}}else{e.constructor._observers=new Map;const t=e.updated;e.updated=function(e){t.call(this,e),e.forEach((t,e)=>{const n=this.constructor._observers.get(e);void 0!==n&&n.call(this,this[e],t)})}}e.constructor._observers.set(n,t)}},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.AppState=void 0;const o=n(4);n(5),n(49);const a=n(18);n(10),n(37);class s extends a.LitService{constructor(t,e){super(),this.apiService=t,this.statusService=e,this.initialized=!1,this.currentModels=[],this.compareExamplesEnabled=!1,this.currentDatasetInternal="",this.inputData=new Map}get currentDataset(){return this.currentDatasetInternal}setCurrentDataset(t,e=!1){this.currentDatasetInternal=t,!this.currentInputDataIsLoaded&&e&&this.loadData()}get currentDatasetSpec(){return this.metadata.datasets[this.currentDataset].spec}makeEmptyInputs(){return new Map}get currentInputDataById(){if(!this.currentDataset)return this.makeEmptyInputs();const t=this.inputData.get(this.currentDataset);return t||this.makeEmptyInputs()}get currentInputData(){return[...this.currentInputDataById.values()]}get currentInputDataIsLoaded(){return this.currentInputData.length>0}get currentModelRequiredInputSpecKeys(){const t=new Set;return Object.values(this.currentModelSpecs).forEach(e=>{Object.keys(e.spec.input).forEach(n=>{!0===e.spec.input[n].required&&t.add(n)})}),[...t]}get currentInputDataKeys(){return Object.keys(this.currentDatasetSpec)}get indicesById(){const t=new Map;return this.currentInputData.forEach((e,n)=>{t.set(e.id,n)}),t}getIndexById(t){if(null==t)return-1;const e=this.indicesById.get(t);return null!=e?e:-1}getCurrentInputDataById(t){const e=this.currentInputDataById.get(t);return e||null}getExamplesById(t){const e=[];return t.forEach(t=>{const n=this.currentInputDataById.get(t);n?e.push(n):console.error(`input key ${n} was not found in the currently loaded dataset.`)}),e}getAncestry(t){var e;const n=[];for(;t;)n.push(t),t=null===(e=this.getCurrentInputDataById(t))||void 0===e?void 0:e.meta.parentId;return n}setCurrentModels(t){return i(this,void 0,void 0,(function*(){this.currentModels=t}))}get currentModelSpecs(){const t=this.metadata.models,e={};return Object.keys(t).forEach(n=>{this.currentModels.includes(n)&&(e[n]=t[n])}),e}getModelSpec(t){return this.metadata.models[t].spec}createNewDatapoints(t,e,n){return i(this,void 0,void 0,(function*(){let r=[];for(let i=0;i<t.length;i++)for(let o=0;o<t[i].length;o++){const a={data:t[i][o],id:"",meta:{parentId:e[i],source:n,added:1,isFavorited:!1}};r.push(a)}return r=yield this.apiService.getDatapointIds(r),this.commitNewDatapoints(r),r}))}commitNewDatapoints(t){t.forEach(t=>{this.currentInputDataById.has(t.id)?console.log("Attempted to add existing datapoint, ignoring add request.",t):this.currentInputDataById.set(t.id,t)})}initialize(){return i(this,void 0,void 0,(function*(){const{urlConfiguration:t}=this;console.log("[LIT - url configuration]",t);const e=yield this.apiService.getInfo();console.log("[LIT - metadata]",o.toJS(e)),this.metadata=e,this.layoutName=t.layout||this.metadata.defaultLayout,this.currentModels=this.determineCurrentModelsFromUrl(t),this.setCurrentDataset(this.determineCurrentDatasetFromUrl(t),!1),yield this.loadData(),this.initialized=!0}))}loadData(){return i(this,void 0,void 0,(function*(){if(this.currentDataset){const t=yield this.apiService.getInputs(this.currentDataset);this.updateInputData(this.currentDataset,t)}}))}updateInputData(t,e){const n=new Map;e.forEach(t=>{n.set(t.id,t)}),this.inputData.set(t,n)}determineCurrentModelsFromUrl(t){var e;const n=t.selectedModels,r=Object.keys((null===(e=this.metadata)||void 0===e?void 0:e.models)||{});let i=[];return n.length>0&&(i=n.filter(t=>r.includes(t))),i.length>0?i:r.slice(0,1)}determineCurrentDatasetFromUrl(t){var e,n;const r=t.selectedDataset||"",i=new Set;for(const t of this.currentModels){const r=(null===(n=null===(e=this.metadata)||void 0===e?void 0:e.models)||void 0===n?void 0:n[t].datasets)||[];for(const t of r)i.add(t)}return i.has(r)?r:0===i.size?(this.statusService.addError("No dataset available for loaded models."),""):[...i][0]}setUrlConfiguration(t){this.urlConfiguration=Object.assign({},t)}}r([o.observable],s.prototype,"initialized",void 0),r([o.observable],s.prototype,"metadata",void 0),r([o.observable],s.prototype,"currentModels",void 0),r([o.observable],s.prototype,"compareExamplesEnabled",void 0),r([o.observable],s.prototype,"layoutName",void 0),r([o.observable],s.prototype,"currentDatasetInternal",void 0),r([o.computed],s.prototype,"currentDataset",null),r([o.action],s.prototype,"setCurrentDataset",null),r([o.computed],s.prototype,"currentDatasetSpec",null),r([o.observable],s.prototype,"inputData",void 0),r([o.computed],s.prototype,"currentInputDataById",null),r([o.computed],s.prototype,"currentInputData",null),r([o.computed],s.prototype,"currentInputDataIsLoaded",null),r([o.computed],s.prototype,"currentModelRequiredInputSpecKeys",null),r([o.computed],s.prototype,"currentInputDataKeys",null),r([o.computed],s.prototype,"indicesById",null),r([o.action],s.prototype,"setCurrentModels",null),r([o.computed],s.prototype,"currentModelSpecs",null),r([o.action],s.prototype,"commitNewDatapoints",null),r([o.action],s.prototype,"initialize",null),e.AppState=s},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e},s=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.RegressionService=void 0;const c=a(n(20)),l=n(4);n(5);const u=n(9),d=n(18);n(10);const h=new Map([["prediction","prediction"],["error","error"],["squaredError","squared error"]]);class f extends d.LitService{constructor(t,e){super(),this.apiService=t,this.appState=e,this.regressionInfo={},l.reaction(()=>e.currentModels,t=>{this.reset()})}getRegressionPreds(t,e,n){return s(this,void 0,void 0,(function*(){const r=this.apiService.getPreds(t,e,n,["RegressionScore"]),i=yield r;return null!=i&&i.length>0&&this.processNewPreds(t,e,i),r}))}reset(){this.regressionInfo={}}getResults(t,e,n){return s(this,void 0,void 0,(function*(){const r=[];t.forEach(i=>{var o,a;null==(null===(a=null===(o=this.regressionInfo[t[0]])||void 0===o?void 0:o[e])||void 0===a?void 0:a[n])&&r.push(i)}),r.length>0&&(yield this.getRegressionPreds(this.appState.getExamplesById(r),e,this.appState.currentDataset));const i=[];return t.forEach(t=>{var r,o;const a=null===(o=null===(r=this.regressionInfo[t])||void 0===r?void 0:r[e])||void 0===o?void 0:o[n];null!=a&&i.push(a)}),i}))}processNewPreds(t,e,n){const r=this.appState.currentModelSpecs[e].spec.output,i=u.findSpecKeys(r,"RegressionScore"),o=Object.keys(n[0]);for(let a=0;a<n.length;a++){const s=t[a],c=n[a];null==this.regressionInfo[s.id]&&(this.regressionInfo[s.id]={}),null==this.regressionInfo[s.id][e]&&(this.regressionInfo[s.id][e]={});for(let n=0;n<o.length;n++){const l=o[n];if(!i.includes(l))continue;const u={};u.prediction=c[l];const d=r[l].parent;null!=d&&null!=t[a].data[d]&&(u.error=u.prediction-+t[a].data[d],u.squaredError=u.error*u.error),null==this.regressionInfo[s.id][e][l]&&(this.regressionInfo[s.id][e][l]=u)}}}get ranges(){const t={};return Object.values(this.regressionInfo).forEach(e=>{Object.keys(e).forEach(n=>{Object.keys(e[n]).forEach(r=>{const i=e[n][r],o=`${n}:${r}`;null==t[o]&&(t[o]={prediction:[1/0,-1/0],error:[1/0,-1/0],squaredError:[1/0,-1/0]}),t[o].prediction[0]=Math.min(t[o].prediction[0],i.prediction),t[o].prediction[1]=Math.max(t[o].prediction[1],i.prediction),t[o].error[0]=Math.min(t[o].error[0],i.error),t[o].error[1]=Math.max(t[o].error[1],i.error),t[o].squaredError[0]=Math.min(t[o].squaredError[0],i.squaredError),t[o].squaredError[1]=Math.max(t[o].squaredError[1],i.squaredError),t[o].prediction=this.adjustDomain(...t[o].prediction),t[o].error=this.adjustDomain(...t[o].error),t[o].squaredError=this.adjustDomain(...t[o].squaredError)})})}),t}get colorOptions(){const t=Object.keys(this.regressionInfo);if(0===t.length)return[];const e=[],n=this.regressionInfo[t[0]],r=Object.keys(n);for(const t of r){const r=Object.keys(n[t]);for(const n of r){const r=this.ranges[`${t}:${n}`].prediction;e.push({name:`${t}:${n} prediction`,getValue:e=>this.regressionInfo[e.id][t][n].prediction,scale:c.scaleSequential(c.interpolateViridis).domain(r)});const i=this.ranges[`${t}:${n}`].error;e.push({name:`${t}:${n} error`,getValue:e=>this.regressionInfo[e.id][t][n].error,scale:c.scaleSequential(c.interpolateViridis).domain(i)});const o=this.ranges[`${t}:${n}`].squaredError;e.push({name:`${t}:${n} squared error`,getValue:e=>this.regressionInfo[e.id][t][n].squaredError,scale:c.scaleSequential(c.interpolateViridis).domain(o)})}}return e}getErrorKey(t){return t+":error"}getInfoFields(){return Array.from(h.keys())}getDisplayNames(){return Array.from(h.values())}adjustDomain(t,e){if(t*e>=0)return[t,e];{const n=Math.max(-t,e);return[-n,n]}}}o([l.observable],f.prototype,"regressionInfo",void 0),o([l.computed],f.prototype,"ranges",null),o([l.computed],f.prototype,"colorOptions",null),e.RegressionService=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t,e,n,r,i,o,a){this.pointIndices=t,this.labelStrings=e,this.scaleFactors=n,this.useSceneOpacityFlags=r,this.defaultFontSize=i,this.fillColors=o,this.strokeColors=a};e.LabelRenderParams=r,function(t){t[t.Perspective=0]="Perspective",t[t.Orthographic=1]="Orthographic"}(e.CameraType||(e.CameraType={}));var i=function(t,e,n,r,i,o,a,s,c,l,u,d,h,f){this.camera=t,this.cameraType=e,this.cameraTarget=n,this.screenWidth=r,this.screenHeight=i,this.nearestCameraSpacePointZ=o,this.farthestCameraSpacePointZ=a,this.backgroundColor=s,this.pointColors=c,this.pointScaleFactors=l,this.labels=u,this.polylineColors=d,this.polylineOpacities=h,this.polylineWidths=f};e.RenderContext=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RGB_NUM_ELEMENTS=3,e.RGBA_NUM_ELEMENTS=4,e.XYZ_NUM_ELEMENTS=3,e.UV_NUM_ELEMENTS=2,e.INDEX_NUM_ELEMENTS=1,e.SCATTER_PLOT_CUBE_LENGTH=2},function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return a}));var r=n(46);
/**
@license
Copyright 2018 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/const i=t=>t.nodeType===Node.ELEMENT_NODE;function o(t,e){for(const n of t.assignedNodes({flatten:!0}))if(i(n)){const t=n;if(Object(r.a)(t,e))return t}return null}function a(t){return{addClass:e=>{t.classList.add(e)},removeClass:e=>{t.classList.remove(e)},hasClass:e=>t.classList.contains(e)}}let s=!1;const c=()=>{},l={get passive(){return s=!0,!1}};document.addEventListener("x",c,l),document.removeEventListener("x",c)},function(t,e,n){"use strict";function r(t,e){return(t.matches||t.webkitMatchesSelector||t.msMatchesSelector).call(t,e)}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";var r;function i(t,e){void 0===e&&(e=!1);var n,i=t.CSS;if("boolean"==typeof r&&!e)return r;if(!(i&&"function"==typeof i.supports))return!1;var o=i.supports("--css-vars","yes"),a=i.supports("(--css-vars: yes)")&&i.supports("color","#00000000");return n=o||a,e||(r=n),n}function o(t,e,n){if(!t)return{x:0,y:0};var r,i,o=e.x,a=e.y,s=o+n.left,c=a+n.top;if("touchstart"===t.type){var l=t;r=l.changedTouches[0].pageX-s,i=l.changedTouches[0].pageY-c}else{var u=t;r=u.pageX-s,i=u.pageY-c}return{x:r,y:i}}n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o}))},function(t,e,n){"use strict";var r=n(1),i=n(17),o={BG_FOCUSED:"mdc-ripple-upgraded--background-focused",FG_ACTIVATION:"mdc-ripple-upgraded--foreground-activation",FG_DEACTIVATION:"mdc-ripple-upgraded--foreground-deactivation",ROOT:"mdc-ripple-upgraded",UNBOUNDED:"mdc-ripple-upgraded--unbounded"},a={VAR_FG_SCALE:"--mdc-ripple-fg-scale",VAR_FG_SIZE:"--mdc-ripple-fg-size",VAR_FG_TRANSLATE_END:"--mdc-ripple-fg-translate-end",VAR_FG_TRANSLATE_START:"--mdc-ripple-fg-translate-start",VAR_LEFT:"--mdc-ripple-left",VAR_TOP:"--mdc-ripple-top"},s={DEACTIVATION_TIMEOUT_MS:225,FG_DEACTIVATION_MS:150,INITIAL_ORIGIN_SCALE:.6,PADDING:10,TAP_DELAY_MS:300},c=n(47),l=["touchstart","pointerdown","mousedown","keydown"],u=["touchend","pointerup","mouseup","contextmenu"],d=[],h=function(t){function e(n){var i=t.call(this,Object(r.a)(Object(r.a)({},e.defaultAdapter),n))||this;return i.activationAnimationHasEnded_=!1,i.activationTimer_=0,i.fgDeactivationRemovalTimer_=0,i.fgScale_="0",i.frame_={width:0,height:0},i.initialSize_=0,i.layoutFrame_=0,i.maxRadius_=0,i.unboundedCoords_={left:0,top:0},i.activationState_=i.defaultActivationState_(),i.activationTimerCallback_=function(){i.activationAnimationHasEnded_=!0,i.runDeactivationUXLogicIfReady_()},i.activateHandler_=function(t){return i.activate_(t)},i.deactivateHandler_=function(){return i.deactivate_()},i.focusHandler_=function(){return i.handleFocus()},i.blurHandler_=function(){return i.handleBlur()},i.resizeHandler_=function(){return i.layout()},i}return Object(r.c)(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return o},enumerable:!0,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return a},enumerable:!0,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return s},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},browserSupportsCssVars:function(){return!0},computeBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},containsEventTarget:function(){return!0},deregisterDocumentInteractionHandler:function(){},deregisterInteractionHandler:function(){},deregisterResizeHandler:function(){},getWindowPageOffset:function(){return{x:0,y:0}},isSurfaceActive:function(){return!0},isSurfaceDisabled:function(){return!0},isUnbounded:function(){return!0},registerDocumentInteractionHandler:function(){},registerInteractionHandler:function(){},registerResizeHandler:function(){},removeClass:function(){},updateCssVariable:function(){}}},enumerable:!0,configurable:!0}),e.prototype.init=function(){var t=this,n=this.supportsPressRipple_();if(this.registerRootHandlers_(n),n){var r=e.cssClasses,i=r.ROOT,o=r.UNBOUNDED;requestAnimationFrame((function(){t.adapter_.addClass(i),t.adapter_.isUnbounded()&&(t.adapter_.addClass(o),t.layoutInternal_())}))}},e.prototype.destroy=function(){var t=this;if(this.supportsPressRipple_()){this.activationTimer_&&(clearTimeout(this.activationTimer_),this.activationTimer_=0,this.adapter_.removeClass(e.cssClasses.FG_ACTIVATION)),this.fgDeactivationRemovalTimer_&&(clearTimeout(this.fgDeactivationRemovalTimer_),this.fgDeactivationRemovalTimer_=0,this.adapter_.removeClass(e.cssClasses.FG_DEACTIVATION));var n=e.cssClasses,r=n.ROOT,i=n.UNBOUNDED;requestAnimationFrame((function(){t.adapter_.removeClass(r),t.adapter_.removeClass(i),t.removeCssVars_()}))}this.deregisterRootHandlers_(),this.deregisterDeactivationHandlers_()},e.prototype.activate=function(t){this.activate_(t)},e.prototype.deactivate=function(){this.deactivate_()},e.prototype.layout=function(){var t=this;this.layoutFrame_&&cancelAnimationFrame(this.layoutFrame_),this.layoutFrame_=requestAnimationFrame((function(){t.layoutInternal_(),t.layoutFrame_=0}))},e.prototype.setUnbounded=function(t){var n=e.cssClasses.UNBOUNDED;t?this.adapter_.addClass(n):this.adapter_.removeClass(n)},e.prototype.handleFocus=function(){var t=this;requestAnimationFrame((function(){return t.adapter_.addClass(e.cssClasses.BG_FOCUSED)}))},e.prototype.handleBlur=function(){var t=this;requestAnimationFrame((function(){return t.adapter_.removeClass(e.cssClasses.BG_FOCUSED)}))},e.prototype.supportsPressRipple_=function(){return this.adapter_.browserSupportsCssVars()},e.prototype.defaultActivationState_=function(){return{activationEvent:void 0,hasDeactivationUXRun:!1,isActivated:!1,isProgrammatic:!1,wasActivatedByPointer:!1,wasElementMadeActive:!1}},e.prototype.registerRootHandlers_=function(t){var e=this;t&&(l.forEach((function(t){e.adapter_.registerInteractionHandler(t,e.activateHandler_)})),this.adapter_.isUnbounded()&&this.adapter_.registerResizeHandler(this.resizeHandler_)),this.adapter_.registerInteractionHandler("focus",this.focusHandler_),this.adapter_.registerInteractionHandler("blur",this.blurHandler_)},e.prototype.registerDeactivationHandlers_=function(t){var e=this;"keydown"===t.type?this.adapter_.registerInteractionHandler("keyup",this.deactivateHandler_):u.forEach((function(t){e.adapter_.registerDocumentInteractionHandler(t,e.deactivateHandler_)}))},e.prototype.deregisterRootHandlers_=function(){var t=this;l.forEach((function(e){t.adapter_.deregisterInteractionHandler(e,t.activateHandler_)})),this.adapter_.deregisterInteractionHandler("focus",this.focusHandler_),this.adapter_.deregisterInteractionHandler("blur",this.blurHandler_),this.adapter_.isUnbounded()&&this.adapter_.deregisterResizeHandler(this.resizeHandler_)},e.prototype.deregisterDeactivationHandlers_=function(){var t=this;this.adapter_.deregisterInteractionHandler("keyup",this.deactivateHandler_),u.forEach((function(e){t.adapter_.deregisterDocumentInteractionHandler(e,t.deactivateHandler_)}))},e.prototype.removeCssVars_=function(){var t=this,n=e.strings;Object.keys(n).forEach((function(e){0===e.indexOf("VAR_")&&t.adapter_.updateCssVariable(n[e],null)}))},e.prototype.activate_=function(t){var e=this;if(!this.adapter_.isSurfaceDisabled()){var n=this.activationState_;if(!n.isActivated){var r=this.previousActivationEvent_;if(!(r&&void 0!==t&&r.type!==t.type))n.isActivated=!0,n.isProgrammatic=void 0===t,n.activationEvent=t,n.wasActivatedByPointer=!n.isProgrammatic&&(void 0!==t&&("mousedown"===t.type||"touchstart"===t.type||"pointerdown"===t.type)),void 0!==t&&d.length>0&&d.some((function(t){return e.adapter_.containsEventTarget(t)}))?this.resetActivationState_():(void 0!==t&&(d.push(t.target),this.registerDeactivationHandlers_(t)),n.wasElementMadeActive=this.checkElementMadeActive_(t),n.wasElementMadeActive&&this.animateActivation_(),requestAnimationFrame((function(){d=[],n.wasElementMadeActive||void 0===t||" "!==t.key&&32!==t.keyCode||(n.wasElementMadeActive=e.checkElementMadeActive_(t),n.wasElementMadeActive&&e.animateActivation_()),n.wasElementMadeActive||(e.activationState_=e.defaultActivationState_())})))}}},e.prototype.checkElementMadeActive_=function(t){return void 0===t||"keydown"!==t.type||this.adapter_.isSurfaceActive()},e.prototype.animateActivation_=function(){var t=this,n=e.strings,r=n.VAR_FG_TRANSLATE_START,i=n.VAR_FG_TRANSLATE_END,o=e.cssClasses,a=o.FG_DEACTIVATION,s=o.FG_ACTIVATION,c=e.numbers.DEACTIVATION_TIMEOUT_MS;this.layoutInternal_();var l="",u="";if(!this.adapter_.isUnbounded()){var d=this.getFgTranslationCoordinates_(),h=d.startPoint,f=d.endPoint;l=h.x+"px, "+h.y+"px",u=f.x+"px, "+f.y+"px"}this.adapter_.updateCssVariable(r,l),this.adapter_.updateCssVariable(i,u),clearTimeout(this.activationTimer_),clearTimeout(this.fgDeactivationRemovalTimer_),this.rmBoundedActivationClasses_(),this.adapter_.removeClass(a),this.adapter_.computeBoundingRect(),this.adapter_.addClass(s),this.activationTimer_=setTimeout((function(){return t.activationTimerCallback_()}),c)},e.prototype.getFgTranslationCoordinates_=function(){var t,e=this.activationState_,n=e.activationEvent;return{startPoint:t={x:(t=e.wasActivatedByPointer?Object(c.a)(n,this.adapter_.getWindowPageOffset(),this.adapter_.computeBoundingRect()):{x:this.frame_.width/2,y:this.frame_.height/2}).x-this.initialSize_/2,y:t.y-this.initialSize_/2},endPoint:{x:this.frame_.width/2-this.initialSize_/2,y:this.frame_.height/2-this.initialSize_/2}}},e.prototype.runDeactivationUXLogicIfReady_=function(){var t=this,n=e.cssClasses.FG_DEACTIVATION,r=this.activationState_,i=r.hasDeactivationUXRun,o=r.isActivated;(i||!o)&&this.activationAnimationHasEnded_&&(this.rmBoundedActivationClasses_(),this.adapter_.addClass(n),this.fgDeactivationRemovalTimer_=setTimeout((function(){t.adapter_.removeClass(n)}),s.FG_DEACTIVATION_MS))},e.prototype.rmBoundedActivationClasses_=function(){var t=e.cssClasses.FG_ACTIVATION;this.adapter_.removeClass(t),this.activationAnimationHasEnded_=!1,this.adapter_.computeBoundingRect()},e.prototype.resetActivationState_=function(){var t=this;this.previousActivationEvent_=this.activationState_.activationEvent,this.activationState_=this.defaultActivationState_(),setTimeout((function(){return t.previousActivationEvent_=void 0}),e.numbers.TAP_DELAY_MS)},e.prototype.deactivate_=function(){var t=this,e=this.activationState_;if(e.isActivated){var n=Object(r.a)({},e);e.isProgrammatic?(requestAnimationFrame((function(){return t.animateDeactivation_(n)})),this.resetActivationState_()):(this.deregisterDeactivationHandlers_(),requestAnimationFrame((function(){t.activationState_.hasDeactivationUXRun=!0,t.animateDeactivation_(n),t.resetActivationState_()})))}},e.prototype.animateDeactivation_=function(t){var e=t.wasActivatedByPointer,n=t.wasElementMadeActive;(e||n)&&this.runDeactivationUXLogicIfReady_()},e.prototype.layoutInternal_=function(){var t=this;this.frame_=this.adapter_.computeBoundingRect();var n=Math.max(this.frame_.height,this.frame_.width);this.maxRadius_=this.adapter_.isUnbounded()?n:Math.sqrt(Math.pow(t.frame_.width,2)+Math.pow(t.frame_.height,2))+e.numbers.PADDING;var r=Math.floor(n*e.numbers.INITIAL_ORIGIN_SCALE);this.adapter_.isUnbounded()&&r%2!=0?this.initialSize_=r-1:this.initialSize_=r,this.fgScale_=""+this.maxRadius_/this.initialSize_,this.updateLayoutCssVars_()},e.prototype.updateLayoutCssVars_=function(){var t=e.strings,n=t.VAR_FG_SIZE,r=t.VAR_LEFT,i=t.VAR_TOP,o=t.VAR_FG_SCALE;this.adapter_.updateCssVariable(n,this.initialSize_+"px"),this.adapter_.updateCssVariable(o,this.fgScale_),this.adapter_.isUnbounded()&&(this.unboundedCoords_={left:Math.round(this.frame_.width/2-this.initialSize_/2),top:Math.round(this.frame_.height/2-this.initialSize_/2)},this.adapter_.updateCssVariable(r,this.unboundedCoords_.left+"px"),this.adapter_.updateCssVariable(i,this.unboundedCoords_.top+"px"))},e}(i.a);e.a=h},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.ApiService=void 0,n(5);const i=n(18);n(50);class o extends i.LitService{constructor(t){super(),this.statusService=t,this.getInputs=t=>r(this,void 0,void 0,(function*(){const e=yield this.queryServer("/get_dataset",{dataset_name:t},[],"Loading inputs");var n;return((n=e)&&n instanceof Array?n:[]).map((t,e)=>({data:t.data,id:t.id,meta:{added:0,isFavorited:!1}}))})),this.getInfo=()=>r(this,void 0,void 0,(function*(){return this.queryServer("/get_info",{},[],"Loading metadata")}))}getPreds(t,e,n,r,i){return i=i||"Fetching predictions",this.queryServer("/get_preds",{model:e,dataset_name:n,requested_types:r.join(",")},t,i)}getGenerated(t,e,n,r,i,o){return o=null!=o?o:"Loading generator output",this.queryServer("/get_generated",{model:e,dataset_name:n,generator:r},t,o,i)}getDatapointIds(t){return this.queryServer("/get_datapoint_ids",{},t)}getInterpretations(t,e,n,r,i,o){return o=null!=o?o:"Fetching interpretations",this.queryServer("/get_interpretations",{model:e,dataset_name:n,interpreter:r},t,o,i)}saveDatapoints(t,e,n){return this.queryServer("/save_datapoints",{dataset_name:e,path:n},t,"Saving new datapoints")}loadDatapoints(t,e){return this.queryServer("/load_datapoints",{dataset_name:t,path:e},[],"Loading new datapoints")}queryServer(t,e,n,i="",o){return r(this,void 0,void 0,(function*(){const r=this.statusService.startLoading(i);try{const i=Object.keys(e).map(t=>`${t}=${e[t]}`),a=encodeURI(`${t}?${i.join("&")}`),s=JSON.stringify({inputs:n,config:o}),c=yield fetch(a,{method:"POST",body:s});if(!c.ok){const t=yield c.text();throw new Error(t)}const l=yield c.json();return r(),l}catch(t){r();const e=t.message.match("(?<=<code>).*?(?=<br><br>)");throw e?this.statusService.addError(e[0]):this.statusService.addError("Unknown error"),t}}))}}e.ApiService=o},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0}),e.StatusService=void 0;const i=n(4),o=n(18);class a extends o.LitService{constructor(){super(...arguments),this.loadingId=0,this.errorId=0,this.loadingEvents=new Map,this.errorEvents=new Map}get loadingMessages(){return[...this.loadingEvents.values()]}get errorMessages(){return[...this.errorEvents.values()]}get hasMessage(){return this.isLoading||this.hasError}get isLoading(){return this.loadingMessages.length>0}get hasError(){return this.errorMessages.length>0}get errorMessage(){const t=this.errorMessages.length-1;return this.hasError?`${this.errorMessages[0]} (${t>0?`and ${t} other error${t>1?"s":""}, `:""}see console for more details)`:""}get loadingMessage(){return this.isLoading?this.loadingMessages[0]:""}startLoading(t){const e=this.loadingId;return this.loadingEvents.set(e,t),this.loadingId+=1,()=>{this.endLoading(e)}}endLoading(t){this.loadingEvents.delete(t)}addError(t){const e=this.errorId;this.errorEvents.set(e,t),this.errorId+=1}clearErrors(){this.errorEvents.clear()}}r([i.observable],a.prototype,"loadingEvents",void 0),r([i.observable],a.prototype,"errorEvents",void 0),r([i.computed],a.prototype,"loadingMessages",null),r([i.computed],a.prototype,"errorMessages",null),r([i.computed],a.prototype,"hasMessage",null),r([i.computed],a.prototype,"isLoading",null),r([i.computed],a.prototype,"hasError",null),r([i.computed],a.prototype,"errorMessage",null),r([i.computed],a.prototype,"loadingMessage",null),e.StatusService=a},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0}),e.SliceService=e.FAVORITES_SLICE_NAME=void 0;const i=n(4);n(5);const o=n(9),a=n(18);n(10),e.FAVORITES_SLICE_NAME="favorites";class s extends a.LitService{constructor(t,n){super(),this.selectionService=t,this.appState=n,this.namedSlices=new Map([[e.FAVORITES_SLICE_NAME,[]]]),this.selectedSliceNameInternal="",i.reaction(()=>t.selectedInputData,t=>{this.namedSlices.has(this.selectedSliceName)&&!o.arrayContainsSame(t.map(t=>t.id),this.namedSlices.get(this.selectedSliceName))&&this.setSelectedSliceName("")})}setSelectedSliceName(t){this.selectedSliceNameInternal=t}get selectedSliceName(){return this.selectedSliceNameInternal}selectNamedSlice(t,e=null){if(""===t)return void this.selectionService.selectIds([],e);const n=this.getSliceByName(t);null!==n&&(this.setSelectedSliceName(t),this.selectionService.selectIds(n,e))}addNamedSlice(t,e){this.namedSlices.set(t,e)}addIdsToSlice(t,e){const n=this.namedSlices.get(t);null!=n&&e.forEach(t=>{n.push(t)})}removeIdsFromSlice(t,e){const n=this.namedSlices.get(t);null!=n&&e.forEach(t=>{const e=n.indexOf(t);e>-1&&n.splice(e,1)})}deleteNamedSlice(t){this.namedSlices.delete(t)}get sliceNames(){return[...this.namedSlices.keys()]}getSliceByName(t){const e=this.namedSlices.get(t);return e||null}getSliceDataByName(t){const e=this.getSliceByName(t);return this.appState.getExamplesById(e)}isSliceEmpty(t){const e=this.getSliceByName(t);return null==e||0===e.length}areAllSlicesEmpty(){for(const t of this.sliceNames)if(!this.isSliceEmpty(t))return!1;return!0}}r([i.observable],s.prototype,"namedSlices",void 0),r([i.observable],s.prototype,"selectedSliceNameInternal",void 0),r([i.action],s.prototype,"setSelectedSliceName",null),r([i.computed],s.prototype,"selectedSliceName",null),r([i.action],s.prototype,"selectNamedSlice",null),r([i.action],s.prototype,"addNamedSlice",null),r([i.action],s.prototype,"addIdsToSlice",null),r([i.action],s.prototype,"removeIdsFromSlice",null),r([i.action],s.prototype,"deleteNamedSlice",null),r([i.computed],s.prototype,"sliceNames",null),e.SliceService=s},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalSettingsComponent=void 0,n(144),n(142),n(141),n(36);const o=n(24),a=n(0),s=n(8),c=n(15),l=n(4),u=n(7),d=n(10),h=n(69),f=n(11);let p=class extends o.MobxLitElement{constructor(){super(...arguments),this.isOpen=!1,this.close=()=>{},this.apiService=u.app.getService(d.ApiService),this.appState=u.app.getService(d.AppState),this.modulesService=u.app.getService(d.ModulesService),this.settingsService=u.app.getService(d.SettingsService),this.selectedDataset="",this.modelCheckboxValues=new Map,this.moduleCheckboxValues=new Map,this.pathForDatapoints="",this.datapointsStatus="",this.hoveredModel=""}static get styles(){return[f.styles,h.styles]}get selectedModels(){return[...this.modelCheckboxValues.entries()].filter(([t,e])=>e).map(([t,e])=>t)}updated(t){t.has("isOpen")&&this.isOpen&&(this.initializeLocalState(),this.requestUpdate())}get datapointButtonsDisabled(){return""===this.pathForDatapoints}initializeLocalState(){this.modelCheckboxValues.clear(),Object.keys(this.appState.metadata.models).forEach(t=>{this.modelCheckboxValues.set(t,!1)}),this.appState.currentModels.forEach(t=>{this.modelCheckboxValues.set(t,!0)}),this.selectedDataset=this.appState.currentDataset,this.modulesService.allModuleKeys.forEach(t=>{const e=!this.modulesService.hiddenModuleKeys.has(t);this.moduleCheckboxValues.set(t,e)})}submitSettings(){const t=this.selectedModels,e=this.selectedDataset,n=new Set;this.moduleCheckboxValues.forEach((t,e)=>{t||n.add(e)}),this.settingsService.updateSettings({models:t,dataset:e,hiddenModuleKeys:n})}render(){const t=s.classMap({hide:!this.isOpen});return a.html`
      <div id="global-settings-holder">
        <div id="overlay" class=${t}></div>
        <div id="global-settings" class=${t}>
          <div id="table-holder">
            ${this.renderModelsConfig()}
            ${this.renderDatasetConfig()}
            ${this.renderComponentsConfig()}
            ${this.appState.metadata.demoMode?null:this.renderDatapointsConfig()}
          </div>
          ${this.renderButtons()}
        </div>
      </div>
    `}renderButtons(){const t=0===this.selectedModels.length,e=this.selectedDataset,n=this.settingsService.isDatasetValidForModels(e,this.selectedModels),r=t||!n;let i="";return t?i="No models selected...":n||(i="Selected models incompatible with selected dataset..."),a.html`
      <div id="buttons-container">
        <div id="error-message">${i}</div>
        <div id="buttons">
          <button
            ?disabled=${r}
            @click=${()=>{this.submitSettings(),this.close()}}>Submit
          </button>
          <button @click=${()=>{this.close()}}>Cancel</button>
        </div>
      </div>
    `}renderModelsConfig(){const t=[...this.modelCheckboxValues.keys()],e=t=>{const e=!0===this.modelCheckboxValues.get(t);return a.html`
        <div class="config-line">
          <mwc-formfield
            label=${t}
            @mouseenter=${()=>{this.hoveredModel=t}}
            @mouseleave=${()=>{this.hoveredModel=""}}
          >
            <lit-checkbox ?checked=${e} @change=${e=>{this.modelCheckboxValues.set(t,e.target.checked)}}></lit-checkbox>
          </mwc-formfield>
        </div>
      `};return a.html`
      <div id="models-config">
        <div class="config-title">Models</div>
        <div class="config-models-list">
          ${t.map(t=>e(t))}
        </div>
      </div>
    `}renderDatasetConfig(){const t=Object.keys(this.appState.metadata.datasets);if(!this.settingsService.isDatasetValidForModels(this.selectedDataset,this.selectedModels))for(let e=0;e<t.length;e++){const n=t[e];if(this.settingsService.isDatasetValidForModels(n,this.selectedModels)){this.selectedDataset=n;break}}const e=t=>{const e=this.selectedDataset===t,n=[...this.selectedModels,...this.hoveredModel?[this.hoveredModel]:[]],r=!this.settingsService.isDatasetValidForModels(t,n),i={opacity:r?"0.2":"1"};return a.html`
        <div class="config-line" style=${c.styleMap(i)}>
          <mwc-formfield label=${t}>
            <mwc-radio
              name="dataset"
              class="select-dataset"
              data-dataset=${t}
              ?checked=${e}
              ?disabled=${r}
              @change=${()=>{this.selectedDataset=t}}
            >
            </mwc-radio>
          </mwc-formfield>
        </div>
      `};return a.html`
      <div id="models-config">
        <div class="config-title">Dataset</div>
        <div class="config-datasets-list">
          ${t.map(t=>e(t))}
        </div>
      </div>
    `}renderComponentsConfig(){const t=[...this.modulesService.allModuleKeys],e=t=>{const e=!this.modulesService.hiddenModuleKeys.has(t);return a.html`
        <div class="config-line">
          <mwc-formfield label=${t}>
            <lit-checkbox ?checked=${e} @change=${e=>{this.moduleCheckboxValues.set(t,e.target.checked)}}></lit-checkbox>
          </mwc-formfield>
        </div>
      `};return a.html`
      <div id="models-config">
        <div class="config-title">Components</div>
        <div class="config-components-list">
          ${t.map(t=>e(t))}
        </div>
      </div>
    `}renderDatapointsConfig(){return a.html`
      <div id="datapoints-config">
        <div class="config-title">Generated Datapoints</div>
        <label for="path">Path for new datapoints:</label><br>
        <input type="text" name="path" value=${this.pathForDatapoints} @input=${t=>{const e=t.target;this.pathForDatapoints=e.value}}><br>
        <div>
          <button class="first-button"
            ?disabled=${this.datapointButtonsDisabled}
            @click=${()=>i(this,void 0,void 0,(function*(){const t=this.appState.currentInputData.filter(t=>1===t.meta.added);if(0===t.length)return void(this.datapointsStatus="No new datapoints to save");const e=yield this.apiService.saveDatapoints(t,this.appState.currentDataset,this.pathForDatapoints);for(const e of t)e.meta.added=0;this.datapointsStatus=`Saved ${t.length} datapoints at ${e}`}))}
          >Save new datapoints
          </button>
          <button
            ?disabled=${this.datapointButtonsDisabled}
            @click=${()=>i(this,void 0,void 0,(function*(){const t=this.appState.currentDataset,e=(this.appState.currentModels,yield this.apiService.loadDatapoints(t,this.pathForDatapoints));if(null!=e&&0!==e.length){for(const t of e)t.meta.added=0;e.forEach(t=>{this.appState.currentInputDataById.set(t.id,t)}),this.datapointsStatus=`Loaded ${e.length} datapoints from ${this.pathForDatapoints}`}else this.datapointsStatus="No persisted datapoints found in "+this.pathForDatapoints}))}
          >Load new datapoints
          </button>
        </div>
        <div>${this.datapointsStatus}</div>
        </div>
      </div>
    `}};r([a.property({type:Boolean})],p.prototype,"isOpen",void 0),r([a.property({type:Object})],p.prototype,"close",void 0),r([l.observable],p.prototype,"selectedDataset",void 0),r([l.observable],p.prototype,"modelCheckboxValues",void 0),r([l.observable],p.prototype,"moduleCheckboxValues",void 0),r([l.observable],p.prototype,"pathForDatapoints",void 0),r([l.observable],p.prototype,"datapointsStatus",void 0),r([l.observable],p.prototype,"hoveredModel",void 0),r([l.computed],p.prototype,"selectedModels",null),r([l.computed],p.prototype,"datapointButtonsDisabled",null),r([l.action],p.prototype,"initializeLocalState",null),r([l.action],p.prototype,"submitSettings",null),p=r([a.customElement("lit-global-settings")],p),e.GlobalSettingsComponent=p},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var c,l=[],u=!1,d=-1;function h(){u&&c&&(u=!1,c.length?l=c.concat(l):d=-1,l.length&&f())}function f(){if(!u){var t=s(h);u=!0;for(var e=l.length;e;){for(c=l,l=[];++d<e;)c&&c[d].run();d=-1,e=l.length}c=null,u=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function m(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new p(t,e)),1!==l.length||u||s(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.ColorService=void 0;const s=a(n(20)),c=n(4);n(5),n(31),n(29);const l=n(18);n(42),n(41);class u extends l.LitService{constructor(t,e,n,r){super(),this.appState=t,this.groupService=e,this.classificationService=n,this.regressionService=r,this.defaultColor=s.schemeCategory10[0],this.defaultOption={name:"none",getValue:t=>"all",scale:s.scaleOrdinal([this.defaultColor]).domain(["all"])},this.selectedColorOption=this.defaultOption,c.reaction(()=>t.currentModels,t=>{this.reset()})}get all(){return[this.selectedColorOption,this.classificationService.allMarginSettings]}get colorableOptions(){return[...this.groupService.categoricalFeatureNames.map(t=>({name:t,getValue:e=>e.data[t],scale:s.scaleOrdinal(s.schemeCategory10).domain(this.groupService.categoricalFeatures[t])})),...this.groupService.numericalFeatureNames.map(t=>({name:t,getValue:e=>e.data[t],scale:s.scaleSequential(s.interpolateViridis).domain(this.groupService.numericalFeatureRanges[t])})),...this.classificationService.colorOptions,...this.regressionService.colorOptions,this.defaultOption]}getDatapointColor(t){if(null==this.selectedColorOption||null==t)return this.defaultColor;const e=this.selectedColorOption.getValue(t),n=this.selectedColorOption.scale(e);return null==n?this.defaultColor:n}reset(){this.selectedColorOption=this.defaultOption}}o([c.observable],u.prototype,"selectedColorOption",void 0),o([c.computed],u.prototype,"all",null),o([c.computed],u.prototype,"colorableOptions",null),e.ColorService=u},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionService=void 0;const i=n(4);n(5);const o=n(18);n(37);class a extends o.LitService{constructor(){super(...arguments),this.selectedIdsSet=new Set,this.primarySelectedIdInternal=null,this.lastUserInternal=null}setAppState(t){this.appState=t}get lastUser(){return this.lastUserInternal}get primarySelectedId(){return this.primarySelectedIdInternal}get selectedIds(){return[...this.selectedIdsSet.values()]}get selectedInputData(){return 0===this.selectedIds.length?[]:this.appState.currentInputData.filter(t=>this.selectedIdsSet.has(t.id))}get primarySelectedInputData(){return null!==this.primarySelectedId?this.appState.getCurrentInputDataById(this.primarySelectedId):null}setLastUser(t){this.lastUserInternal=t}setPrimarySelection(t,e=null){null===t||this.selectedIdsSet.has(t)?(this.primarySelectedIdInternal=t,this.setLastUser(e)):this.selectIds([t],e)}selectIds(t,e=null){this.selectedIdsSet.clear(),t.forEach(t=>{this.selectedIdsSet.add(t)}),null!==this.primarySelectedId&&this.selectedIdsSet.has(this.primarySelectedId)||(0===this.selectedIdsSet.size?this.primarySelectedIdInternal=null:this.primarySelectedIdInternal=t[0]),this.setLastUser(e)}syncFrom(t){this.selectIds(t.selectedIds),this.setPrimarySelection(t.primarySelectedId)}isIdSelected(t){return this.selectedIdsSet.has(t)}get selectedOrAllInputData(){return this.selectedInputData.length>0?this.selectedInputData:this.appState.currentInputData}}r([i.observable],a.prototype,"selectedIdsSet",void 0),r([i.observable],a.prototype,"primarySelectedIdInternal",void 0),r([i.observable],a.prototype,"lastUserInternal",void 0),r([i.computed],a.prototype,"lastUser",null),r([i.computed],a.prototype,"primarySelectedId",null),r([i.computed],a.prototype,"selectedIds",null),r([i.computed],a.prototype,"selectedInputData",null),r([i.computed],a.prototype,"primarySelectedInputData",null),r([i.action],a.prototype,"setLastUser",null),r([i.action],a.prototype,"setPrimarySelection",null),r([i.action],a.prototype,"selectIds",null),r([i.action],a.prototype,"syncFrom",null),r([i.computed],a.prototype,"selectedOrAllInputData",null),e.SelectionService=a},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.SettingsService=void 0;const o=n(4),a=n(9),s=n(18);n(10);class c extends s.LitService{constructor(t,e,n){super(),this.appState=t,this.modulesService=e,this.selectionService=n,o.reaction(()=>t.compareExamplesEnabled,t=>{this.updateLayout()})}isDatasetValidForModels(t,e){return e.every(e=>this.isDatasetValidForModel(t,e))}isDatasetValidForModel(t,e){var n,r;return((null===(r=null===(n=this.appState.metadata)||void 0===n?void 0:n.models)||void 0===r?void 0:r[e].datasets)||[]).includes(t)}clearLayout(){this.modulesService.computeRenderLayout({},{},!1),this.modulesService.renderModules()}updateLayout(){this.modulesService.computeRenderLayout(this.appState.currentModelSpecs,this.appState.currentDatasetSpec,this.appState.compareExamplesEnabled),this.modulesService.renderModules()}updateSettings(t){var e,n,r;return i(this,void 0,void 0,(function*(){this.clearLayout(),yield this.raf();const i=null!==(e=t.models)&&void 0!==e?e:this.appState.currentModels,o=null!==(n=t.dataset)&&void 0!==n?n:this.appState.currentDataset,s=null!==(r=t.hiddenModuleKeys)&&void 0!==r?r:this.modulesService.hiddenModuleKeys,c=!a.arrayContainsSame(this.appState.currentModels,i),l=o!==this.appState.currentDataset&&o;c&&(yield this.appState.setCurrentModels(i)),l&&(this.selectionService.selectIds([]),this.appState.setCurrentDataset(o,!0));const u=this.modulesService.hiddenModuleKeys;a.setEquals(s,u)||this.modulesService.setHiddenModules(s),this.updateLayout()}))}raf(){return i(this,void 0,void 0,(function*(){return new Promise(t=>{requestAnimationFrame(t)})}))}}r([o.action],c.prototype,"clearLayout",null),r([o.action],c.prototype,"updateLayout",null),r([o.action],c.prototype,"updateSettings",null),e.SettingsService=c},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0}),e.LitSelectionToolbar=void 0,n(35),n(70),n(72);const i=n(24),o=n(0),a=n(8),s=n(15),c=n(4),l=n(7),u=n(9),d=n(10),h=n(51),f=n(74),p=n(11);let m=class extends i.MobxLitElement{constructor(){super(...arguments),this.appState=l.app.getService(d.AppState),this.selectionService=l.app.getService(d.SelectionService),this.sliceService=l.app.getService(d.SliceService),this.colorService=l.app.getService(d.ColorService),this.sliceToolbarVisible=!1,this.legendVisible=!1,this.highlightFavorite=!1}static get styles(){return[p.styles,f.styles]}get selectedIdPairs(){return this.selectionService.selectedOrAllInputData.filter(t=>t.meta.parentId).map(t=>[t.id,t.meta.parentId])}findAllParents(){return u.flatten(this.selectionService.selectedIds.map(t=>this.appState.getAncestry(t)))}findAllChildren(){const t=new Set(this.selectionService.selectedIds);for(const e of this.appState.currentInputData)for(const n of this.appState.getAncestry(e.id))this.selectionService.isIdSelected(n)&&t.add(e.id);return[...t]}selectRelated(){this.selectionService.selectIds([...this.findAllParents(),...this.findAllChildren()])}toggleFavorited(){const t=this.selectionService.primarySelectedInputData;null!=t&&null!=t.meta.isFavorited&&(t.meta.isFavorited=!t.meta.isFavorited,t.meta.isFavorited?this.sliceService.addIdsToSlice(h.FAVORITES_SLICE_NAME,[t.id]):this.sliceService.removeIdsFromSlice(h.FAVORITES_SLICE_NAME,[t.id]),this.sliceService.selectedSliceName===h.FAVORITES_SLICE_NAME&&this.sliceService.selectNamedSlice(h.FAVORITES_SLICE_NAME),this.highlightFavorite=t.meta.isFavorited)}renderLuckyButton(){return o.html`
      <button id='im-feeling-lucky' @click=${()=>{const t=u.randInt(0,this.appState.currentInputData.length),e=this.appState.currentInputData[t].id;this.selectionService.selectIds([e])}}>
        I'm feeling lucky
      </button>
    `}renderSelectionArrows(){const t=this.selectionService.primarySelectedId,e=this.appState.currentInputData.findIndex(e=>e.id===t),n=this.appState.currentInputData.length,r=t=>{const r=(e+t+n)%n,i=this.appState.currentInputData[r].id;this.selectionService.selectIds([i])};return o.html`
      <mwc-icon class='icon-button' id='ds-select-prev'
        @click=${()=>{r(-1)}}>
        chevron_left
      </mwc-icon>
      <mwc-icon class='icon-button mdi-outlined' id='ds-select-random'
        @click=${()=>{r(u.randInt(1,n))}}>
        casino
      </mwc-icon>
      <mwc-icon class='icon-button' id='ds-select-next'
        @click=${()=>{r(1)}}>
        chevron_right
      </mwc-icon>
    `}renderPrimarySelectControls(){const t=this.selectionService.selectedIds.length,e=this.selectionService.primarySelectedId;if(null==e)return;const n=u.shortenId(e),r=this.appState.indicesById.get(e),i=this.selectionService.selectedIds.findIndex(t=>t===e),a=e=>{const n=(i+e+t)%t,r=this.selectionService.selectedIds[n];this.selectionService.setPrimarySelection(r)};return o.html`
      <div id='primary-selection-status' class='selection-status-group'>
        (primary:&nbsp;<span class='monospace'> ${n}</span>
        ... [${r}]
        ${t>1?o.html`
          <mwc-icon class='icon-button' id='select-prev'
            @click=${()=>{a(-1)}}>
            chevron_left
          </mwc-icon>
          <mwc-icon class='icon-button mdi-outlined' id='select-random'
            @click=${()=>{a(u.randInt(1,t))}}>
            casino
          </mwc-icon>
          <mwc-icon class='icon-button' id='select-next'
            @click=${()=>{a(1)}}>
            chevron_right
          </mwc-icon>
        `:null}
         ${this.renderFavoriteButton()} )
      </div>
    `}renderPairControls(){const t=this.selectedIdPairs;if(0===t.length)return null;const e=l.app.getServiceArray(d.SelectionService)[1],n=[this.selectionService.primarySelectedId,e.primarySelectedId],r=n.map(t=>null!=t?this.appState.indicesById.get(t):null),i=n.includes(null)?-1:t.findIndex(t=>0===u.compareArrays(t,n)),a=-1!==i,s=t.length,c=n=>{const r=t[((a?i:0)+n+s)%s];0===this.selectionService.selectedIds.length&&this.selectionService.selectIds(u.flatten(t)),this.selectionService.setPrimarySelection(r[0]),e.setPrimarySelection(r[1])};return o.html`
      <div id='pair-controls' class='selection-status-group'>
        ${s} pairs available
        <mwc-icon class='icon-button' id='select-prev'
          @click=${()=>{c(-1)}}>
          chevron_left
        </mwc-icon>
        <mwc-icon class='icon-button mdi-outlined' id='select-random'
          @click=${()=>{c(u.randInt(1,s))}}>
          casino
        </mwc-icon>
        <mwc-icon class='icon-button' id='select-next'
          @click=${()=>{c(1)}}>
          chevron_right
        </mwc-icon>
        ${a?o.html`[${r[1]}, ${r[0]}] selected`:null}
      </div>
    `}renderFavoriteButton(){const t=this.selectionService.primarySelectedInputData;if(null==t)return;this.highlightFavorite=t.meta.isFavorited;return o.html`<mwc-icon class='icon-button' id='favorite-button' @click=${()=>{this.toggleFavorited()}}>
            ${this.highlightFavorite?"favorite":"favorite_border"}
          </mwc-icon>`}renderSliceToolbar(){const t=s.styleMap({visibility:this.sliceToolbarVisible?"visible":"hidden"});return o.html`
    <div class="toolbar-holder">
      <button id='toggle-slice-toolbar' @click=${()=>{this.sliceToolbarVisible=!this.sliceToolbarVisible}}>
        Slices <span data-icon=${this.sliceToolbarVisible?"expand_less":"expand_more"}></span>
      </button>
      <div class='togglable-toolbar-holder' id='slice-toolbar-container'
        style=${t}>
        <lit-slice-toolbar></lit-slice-toolbar>
      </div>
    </div>
    `}renderColorLegend(){const t=s.styleMap({visibility:this.legendVisible?"visible":"hidden"});return o.html`
    <div class="toolbar-holder">
      <button @click=${()=>{this.legendVisible=!this.legendVisible}}>
        Datapoint color <span data-icon=${this.legendVisible?"expand_less":"expand_more"}></span>
      </button>
      <div class='togglable-toolbar-holder' id='legend-container' style=${t}>
        <lit-legend-toolbar></lit-legend-toolbar>
      </div>
    </div>
    `}render(){const t=this.selectionService.selectedIds.length,e=this.appState.currentInputData.length,n=this.selectionService.primarySelectedId,r=a.classMap({"mode-active":this.appState.compareExamplesEnabled});return o.html`
    <div class='toolbar' id='main-toolbar'>
      <div id='status-group-left'>
        <div>
          ${t} of ${e} selected
        </div>
        ${0===t?this.renderLuckyButton():null}
        ${1===t?this.renderSelectionArrows():null}
        ${null!==n?this.renderPrimarySelectControls():null}
        ${this.appState.compareExamplesEnabled?this.renderPairControls():null}
      </div>
      <div id='button-holder-right'>
        <button id="select-related" @click=${()=>{this.selectRelated()}}
          ?disabled="${0===t}">
          Select related
        </button>
        <button id="clear-selection" @click=${()=>{this.selectionService.selectIds([])}}
          ?disabled="${0===t}">
          Clear selection
        </button>
        <button id='toggle-example-comparison'
          @click=${()=>{this.appState.compareExamplesEnabled=!this.appState.compareExamplesEnabled}} class=${r}
          ?disabled="${!this.appState.compareExamplesEnabled&&0===t}">
          Compare Datapoints
        </button>
        ${this.renderSliceToolbar()}
        ${this.renderColorLegend()}
      </div>
    </div>
    `}};r([c.observable],m.prototype,"sliceToolbarVisible",void 0),r([c.observable],m.prototype,"legendVisible",void 0),r([c.observable],m.prototype,"highlightFavorite",void 0),r([c.computed],m.prototype,"selectedIdPairs",null),m=r([o.customElement("lit-selection-toolbar")],m),e.LitSelectionToolbar=m},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ReactiveElement=void 0;const r=n(24),i=n(4);class o extends r.MobxLitElement{constructor(){super(...arguments),this.reactionDisposers=[]}disconnectedCallback(){super.disconnectedCallback(),this.reactionDisposers.forEach(t=>{t()})}react(t,e,n={}){const r=i.reaction(t,e,n);this.reactionDisposers.push(r)}reactImmediately(t,e,n={}){this.react(t,e,Object.assign(Object.assign({},n),{fireImmediately:!0}))}}e.ReactiveElement=o},function(t,e,n){"use strict";n.r(e),n.d(e,"styles",(function(){return r}));const r=n(0).css`.group-label {
  text-align: start;
  vertical-align: baseline;
  padding: 5px;
}

.group-container {
  position: relative; /* to allow overlay div */
  padding: 5px;
}

.tokens-holder {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
}

.salient-token {
  padding: 5px;
  margin: 5px;
  background-color: #1c313a;
  font-family: 'Share Tech Mono', monospace;
  color: black;
}

.salience-tooltip {
  position: fixed;
  padding: 5px;
  margin: auto;
  text-align: center;
  transform: translate(-50%, 5px);
  background-color: #f2f9ff;
  border-radius: 7px;
  border-style: solid;
  border-width: 1px;
  z-index: 10000;
  pointer-events: none;
  visibility: hidden;
}

.loading {
  opacity: 0.2;
  pointer-events: none;
}

.spinner-container {
  opacity: 1.0;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
}
`},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0}),e.DataTable=void 0,n(35);const i=n(20),o=n(0),a=n(8),s=n(15),c=n(4),l=n(59),u=n(90);var d;!function(t){t[t.START=0]="START",t[t.END=1]="END"}(d||(d={}));let h=class extends l.ReactiveElement{constructor(){super(...arguments),this.data=[],this.selectedIndices=[],this.primarySelectedIndex=-1,this.referenceSelectedIndex=-1,this.selectionDisabled=!1,this.controlsEnabled=!1,this.columnVisibility=new Map,this.onSelect=()=>{},this.onPrimarySelect=()=>{},this.sortAscending=!0,this.showColumnMenu=!1,this.columnMenuName="",this.columnSearchQueries=new Map,this.filterSelected=!1,this.columnDropdownVisible=!1,this.headerWidths=[],this.stickySortedData=null,this.selectedIndicesSetForRender=new Set,this.rowIndexToDataIndex=new Map,this.shiftSelectionStartIndex=0,this.shiftSelectionEndIndex=0,this.shiftSpanAnchor=d.START}static get styles(){return[u.styles]}firstUpdated(){const t=this.shadowRoot.getElementById("rows");this.resizeObserver=new ResizeObserver(()=>{this.resize()}),this.resizeObserver.observe(t),this.reactImmediately(()=>this.rowFilteredData,t=>{this.stickySortedData=null})}shouldUpdate(t){return t.get("data")&&(this.shiftSelectionStartIndex=0,this.shiftSelectionEndIndex=0),!0}resize(){const t=this.shadowRoot.querySelector("tr");t&&(this.headerWidths=[...t.children].map(t=>t.getBoundingClientRect().width))}get columnNames(){return Array.from(this.columnVisibility.keys())}get sortIndex(){return null==this.sortName?void 0:this.columnNames.indexOf(this.sortName)}get rowFilteredData(){const t=this.data.slice(),e=new Set(this.selectedIndices);return t.filter(t=>{let n=!0;for(const[e,r]of this.columnSearchQueries){const i=this.columnNames.indexOf(e);if(-1===i)return;const o=t[i];"string"==typeof o?n=n&&o.includes(r):"number"==typeof o&&(n=!(!n||""!==r)||o.toString()===r)}let r=!0;if(this.filterSelected){r=!(this.selectedIndices.length>0)||e.has(+t[0])}return n&&r})}getSortedData(){var t;let e=(null!==(t=this.stickySortedData)&&void 0!==t?t:this.rowFilteredData).slice();return null!=this.sortName&&(e=e.sort((t,e)=>(this.sortAscending?i.ascending:i.descending)(t[this.sortIndex],e[this.sortIndex]))),this.rowIndexToDataIndex=new Map(e.map((t,e)=>[e,+t[0]])),this.stickySortedData=e,e}setShiftSelectionSpan(t,e){this.shiftSelectionStartIndex=t,this.shiftSelectionEndIndex=e}isRowWithinShiftSelectionSpan(t){return t>=this.shiftSelectionStartIndex&&t<=this.shiftSelectionEndIndex}selectFromRange(t,e,n,r=!0){for(let i=e;i<=n;i++){const e=this.rowIndexToDataIndex.get(i);if(null==e)return;r?t.add(e):(t.delete(e),e===this.primarySelectedIndex&&this.setPrimarySelectedIndex(-1))}}handleRowClick(t,e){let n=new Set(this.selectedIndices),r=!0;const i=this.rowIndexToDataIndex.get(e);if(null!=i){if(t.metaKey||t.ctrlKey)n.has(i)?(n.delete(i),i===this.primarySelectedIndex&&this.setPrimarySelectedIndex(-1)):n.add(i),this.setShiftSelectionSpan(e,e);else if(t.shiftKey){t.preventDefault();const r=this.isRowWithinShiftSelectionSpan(e),i=this.shiftSelectionStartIndex,o=this.shiftSelectionEndIndex;r?this.shiftSpanAnchor===d.START?(this.selectFromRange(n,e+1,o,!1),this.shiftSelectionEndIndex=e):(this.selectFromRange(n,i,e-1,!1),this.shiftSelectionStartIndex=e):e>=o?(this.selectFromRange(n,o,e),this.setShiftSelectionSpan(i,e),this.shiftSpanAnchor=d.START):e<=i&&(this.selectFromRange(n,e,i),this.setShiftSelectionSpan(e,o),this.shiftSpanAnchor=d.END)}else n.has(i)&&1===n.size?(n=new Set,this.setPrimarySelectedIndex(-1)):n.has(i)&&i!==this.primarySelectedIndex?(this.setPrimarySelectedIndex(e),r=!1):(n=new Set([i]),this.setPrimarySelectedIndex(e)),this.setShiftSelectionSpan(e,e);r&&(this.selectedIndices=Array.from(n),this.onSelect([...this.selectedIndices]))}}setPrimarySelectedIndex(t){let e=-1;if(-1!==t){const n=this.rowIndexToDataIndex.get(t);if(null==n)return;e=n}this.primarySelectedIndex=e,this.onPrimarySelect(e)}render(){this.selectedIndicesSetForRender=new Set(this.selectedIndices);const t=this.getSortedData(),e=Array.from(this.columnVisibility.keys()),n=t.map(t=>t.filter((t,n)=>this.columnVisibility.get(e[n]))),r=void 0===this.sortName&&0===this.columnSearchQueries.size&&!this.filterSelected,i=this.columnNames.filter(t=>this.columnVisibility.get(t));return o.html`
      <div id="holder">
        ${this.controlsEnabled?o.html`
        <div class="toolbar">
          <lit-checkbox
            label="Only show selected"
            ?checked=${this.filterSelected}
            @change=${()=>{this.filterSelected=!this.filterSelected}}
          ></lit-checkbox>
          <div id="toolbar-buttons">
            <button id="default-view" @click=${()=>{this.columnSearchQueries.clear(),this.sortName=void 0,this.filterSelected=!1}}
              ?disabled="${r}">
              Reset view
            </button>
            <button id="select-all" @click=${()=>{this.selectedIndices=n.map((t,e)=>+t[0]),this.onSelect([...this.selectedIndices])}}>
              Select all
            </button>
            <button id="column-button" @click=${()=>{this.columnDropdownVisible=!this.columnDropdownVisible}}>
              Columns
              <span data-icon=${this.columnDropdownVisible?"expand_less":"expand_more"}></span>
            </button>
          </div>
          ${this.renderColumnDropdown()}
        </div>`:null}
        <div id="table-container">
          <div id="header-container">
            <div id="header">
              ${i.map((t,e)=>this.renderColumnHeader(t,e))}
            </div>
          </div>
          <div id="rows-container" @scroll=${t=>{const e=this.shadowRoot.getElementById("header-container"),n=t.target;null!=e&&null!=n&&(e.scrollLeft=n.scrollLeft)}}>
            <table id="rows">
              <tbody>
                ${n.map((t,e)=>this.renderRow(t,e))}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    `}renderColumnHeader(t,e){if(e>=this.headerWidths.length)return;const n=this.headerWidths[e],r=n?n+"px":"";let i=this.columnSearchQueries.get(t);void 0===i&&(i="");const c=s.styleMap({width:r,visibility:this.showColumnMenu&&this.columnMenuName===t?"visible":"hidden"}),l=s.styleMap({outline:(()=>!!(this.columnSearchQueries.get(t)||this.showColumnMenu&&this.columnMenuName===t))()?"auto":"none"}),u=this.sortName===t&&this.sortAscending,d=this.sortName===t&&!this.sortAscending,h=this.sortName===t&&!this.sortAscending,f=this.sortName===t&&this.sortAscending,p=a.classMap({arrow:!0,up:!0,active:u,inactive:d}),m=a.classMap({arrow:!0,down:!0,active:h,inactive:f}),g=s.styleMap({width:r});return o.html`
        <div>
          <div class="column-header" title=${t} style=${g}>
            <div class="header-text">${t}</div>
            ${this.controlsEnabled?o.html`
            <div class="menu-button-container">
              <mwc-icon class="menu-button" style=${l} @click=${()=>{this.columnMenuName===t?this.showColumnMenu=!this.showColumnMenu:(this.columnMenuName=t,this.showColumnMenu=!0)}}>search</mwc-icon>
            </div>`:null}
            <div class="arrow-container" @click=${()=>{this.sortName===t?this.sortAscending=!this.sortAscending:(this.sortName=t,this.sortAscending=!0)}}>
              <mwc-icon class=${p}>arrow_drop_up</mwc-icon>
              <mwc-icon class=${m}>arrow_drop_down</mwc-icon>
            </div>
          </div>
          ${this.controlsEnabled?o.html`
          <div class='togglable-menu-holder' style=${c}>
              <input type="search" id='search-menu-container'
              .value=${i}
              placeholder="Search" @input=${e=>{var n;this.columnSearchQueries.set(t,(null===(n=e.target)||void 0===n?void 0:n.value)||"")}}/>
          </div>`:null}
        </div>
      `}renderRow(t,e){const n=this.rowIndexToDataIndex.get(e);if(null==n)return;const r=this.selectedIndicesSetForRender.has(n),i=this.primarySelectedIndex===n,s=this.referenceSelectedIndex===n,c=a.classMap({selected:r,"primary-selected":i,"reference-selected":s});return o.html`
        <tr class="${c}" @mousedown=${t=>{this.selectionDisabled||this.handleRowClick(t,e)}}>
          ${t.map(t=>o.html`<td>${t}</td>`)}
        </tr>
      `}renderColumnDropdown(){return o.html`
        <div class='${this.columnDropdownVisible?"column-dropdown":"column-dropdown-hide"}'>
          ${this.columnNames.filter(t=>"index"!==t).map(t=>this.renderDropdownItem(t))}
        </div>
    `}renderDropdownItem(t){const e=this.columnVisibility.get(t);if(null==e)return;return o.html`
        <div>
          <lit-checkbox
              label=${t}
              ?checked=${e}
              @change=${()=>{this.columnVisibility.set(t,!e);requestAnimationFrame(()=>{this.resize()})}}
            >
          </lit-checkbox>
        </div>
        `}};r([c.observable,o.property({type:Array})],h.prototype,"data",void 0),r([o.property({type:Array})],h.prototype,"selectedIndices",void 0),r([o.property({type:Number})],h.prototype,"primarySelectedIndex",void 0),r([o.property({type:Number})],h.prototype,"referenceSelectedIndex",void 0),r([o.property({type:Boolean})],h.prototype,"selectionDisabled",void 0),r([o.property({type:Boolean})],h.prototype,"controlsEnabled",void 0),r([c.observable,o.property({type:Object})],h.prototype,"columnVisibility",void 0),r([o.property({type:Object})],h.prototype,"onSelect",void 0),r([o.property({type:Object})],h.prototype,"onPrimarySelect",void 0),r([c.observable],h.prototype,"sortName",void 0),r([c.observable],h.prototype,"sortAscending",void 0),r([c.observable],h.prototype,"showColumnMenu",void 0),r([c.observable],h.prototype,"columnMenuName",void 0),r([c.observable],h.prototype,"columnSearchQueries",void 0),r([c.observable],h.prototype,"filterSelected",void 0),r([c.observable],h.prototype,"columnDropdownVisible",void 0),r([c.observable],h.prototype,"headerWidths",void 0),r([c.computed],h.prototype,"columnNames",null),r([c.computed],h.prototype,"sortIndex",null),r([c.computed],h.prototype,"rowFilteredData",null),h=r([o.customElement("lit-data-table")],h),e.DataTable=h},function(t,e,n){"use strict";var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){var n,i;void 0===e&&(e=[]),this.points=t,this.metadata=e;var o=t[0].length;if(2!==o&&3!==o)throw new Error("Points must be an array of either 2 or 3 dimensional number arrays");try{for(var a=r(t),s=a.next();!s.done;s=a.next()){if(o!==s.value.length)throw new Error("Points must be an array of either 2 or 3 dimensional number arrays")}}catch(t){n={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}this.dimensions=o}return t.prototype.setSpriteMetadata=function(t){this.spriteMetadata=t},t}();e.Dataset=i},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.SpanGraphVis=void 0;const s=a(n(20)),c=n(0),l=n(8),u=n(15),d=n(139),h=n(140);function f(t,e,n){return[[0,0],[n,e],[t-n,e],[t,0]]}function p(t,e,n,r,i){const o=Math.min(e,n),a=Math.max(e,n);let s=`M ${o} ${t} `;if(a-o>2*i*r){const e=i*r;s+=`A ${e} ${r} 0 0 1 ${o+e} ${t-r} `,s+=`L ${a-e} ${t-r} `,s+=`A ${e} ${r} 0 0 1 ${a} ${t} `}else s+=`A ${(a-o)/2} ${r=(a-o)/(2*i)} 0 0 1 ${a} ${t} `;return s}function m(t,e,n){let r=`M ${e-n} ${t-1.5*n} `;return r+=`L ${e+n} ${t-1.5*n} `,r+=`L ${e} ${t} Z`,r}let g=class extends c.LitElement{constructor(){super(...arguments),this.data={tokens:[],layers:[]},this.showLayerLabel=!0,this.lineHeight=18,this.bracketHeight=5.5,this.yPad=5,this.arcBaseHeight=20,this.arcMaxHeight=40,this.arcAspect=1.2,this.arcArrowSize=4,this.viewPad=5,this.svgScaling=1.2,this.tokenXBounds=[]}static get styles(){return h.styles}renderTokens(t){return c.svg`
      <g id='token-group'>
        <text class='token-text' height=${this.lineHeight}>
          ${t.map(t=>c.svg`<tspan>${c.svg`${t+" "}`}</tspan>`)}
        </text>
      </g>`}getTokenGroup(){return this.shadowRoot.querySelector("g#token-group")}renderEdge(t,e){const n=this.lineHeight,r=-(this.bracketHeight+this.lineHeight);let i=t.label,o=!1;"number"==typeof t.label&&(i=t.label.toFixed(3),o=t.label<.5);const a=l.classMap({"arc-path":!0,"arc-neg":o}),s=l.classMap({"arc-arrow":!0,"arc-neg":o});return e=o?"gray":e,c.svg`
      <g class='edge-group' style=${u.styleMap({"--group-color":e})}
        data-color=${e}>
        ${t.span2?c.svg`
          <path class=${a}></path>
          <path class=${s}></path>
          `:""}
        <g class='at-span1'>
          <polyline class='span-bracket'></polyline>
          <foreignObject class='span-label' height=${n} y=${r}>
            ${c.html`<div>${i}</div>`}
          </foreignObject>
          <rect class='mousebox'></rect>
        </g>
        ${t.span2?c.svg`<g class='at-span2'>
            <polyline class='span-bracket'></polyline>
          </g>`:""}
      </g>
    `}renderLayer(t,e){const n=d.VizColor.getColor("deep",e).color,r=-(this.bracketHeight+.5*this.lineHeight),i=this.sortEdges(t.edges);return c.svg`
      <g id='layer-group-${t.name}' data-color=${n}>
        ${this.showLayerLabel?c.svg`
          <g class='layer-label'>
            <text x=${-10} y=${r} fill=${n}>
              ${c.svg`${t.name}`}
            </text>
          </g>`:null}
        ${i.map(t=>this.renderEdge(t,n))}
      </g>
    `}getLayerGroup(t){return this.shadowRoot.querySelector("g#layer-group-"+t)}render(){return c.svg`
      <svg id='svg' xmlns='http://www.w3.org/2000/svg'><g id='all'>
        ${this.data?this.renderTokens(this.data.tokens):""}
        ${this.data?this.data.layers.map(this.renderLayer.bind(this)):""}
      </g></svg>`}findTokenBounds(){const t=this.getTokenGroup().querySelectorAll("tspan"),e=[];return t.forEach(t=>{const n=t.getBBox();e.push([n.x,n.x+n.width])}),e}sortEdges(t){return t.slice().sort((t,e)=>s.descending(t.span1[1],e.span1[1]))}getStartX(t){return this.tokenXBounds[t[0]][0]}getEndX(t){return this.tokenXBounds[t[1]-1][1]}findAvailableWidths(t,e){const n=e.map(()=>0);for(let t=1;t<e.length;t++){const r=e[t],i=e[t-1];n[t]=this.getStartX(i.span1)-this.getStartX(r.span1)}const r=t.querySelector("g.edge-group foreignObject div");return null!==r&&(r.style.width="fit-content",n[0]=r.getBoundingClientRect().width),n}setMouseovers(t,e){const n=t.dataset.color,r=d.VizColor.getColor("deep",null).color,i=s.select(t).selectAll("g.edge-group").data(e),o=s.select(this.getTokenGroup()).selectAll("tspan");i.each((function(t,e){const a=(t,i)=>e===i?n:r,c=(e,r)=>{const i=t.span1[0]<=r&&r<t.span1[1],o=!!t.span2&&(t.span2[0]<=r&&r<t.span2[1]);return i||o?n:"black"},l=s.select(this).select("rect.mousebox");l.on("mouseover",()=>{i.style("--group-color",a),o.attr("fill",c),s.select(this).classed("selected",!0)}),l.on("mouseout",()=>{i.style("--group-color",(function(t){return this.dataset.color})),o.attr("fill","black"),s.select(this).classed("selected",!1)})}))}positionLayers(){let t=this.getTokenGroup().getBBox().y-this.yPad/2;for(let e=0;e<this.data.layers.length;e++){const n=this.getLayerGroup(this.data.layers[e].name);n.setAttribute("transform",`translate(0, ${t})`),t-=n.getBBox().height+this.yPad}}setSVGViewport(){const t=this.shadowRoot.querySelector("g#all").getBBox(),e=this.shadowRoot.getElementById("svg"),n=[t.x-this.viewPad,t.y-this.viewPad,t.width+2*this.viewPad,t.height+2*this.viewPad];e.setAttribute("viewBox",""+n),e.setAttribute("height",""+this.svgScaling*(t.height+2*this.viewPad))}updated(){if(null!=this.data){this.tokenXBounds=this.findTokenBounds();for(const t of this.data.layers){const e=this.sortEdges(t.edges),n=this.getLayerGroup(t.name),r=this.findAvailableWidths(n,e);n.querySelectorAll("g.edge-group").forEach((t,n)=>{const i=e[n],o=t.querySelector("g.at-span1");o.setAttribute("transform",`translate(${this.getStartX(i.span1)}, 0)`);const a=this.getEndX(i.span1)-this.getStartX(i.span1),s=f(a,-1*(this.bracketHeight-1),1);o.querySelector("polyline").setAttribute("points",""+s);const c=Math.max(a,r[n]-5);if(t.querySelector("foreignObject").setAttribute("width",""+c),i.span2){const e=t.querySelector("g.at-span2");e.setAttribute("transform",`translate(${this.getStartX(i.span2)}, 0)`);const n=f(this.getEndX(i.span2)-this.getStartX(i.span2),-1*(this.bracketHeight-1),1);e.querySelector("polyline").setAttribute("points",""+n);const r=-1*(this.bracketHeight+this.lineHeight+1),o=(this.getEndX(i.span1)+this.getStartX(i.span1))/2;let a=(this.getEndX(i.span2)+this.getStartX(i.span2))/2;a>o?a-=this.arcArrowSize+2:a+=this.arcArrowSize+2;const s=(i.span1[1]+i.span1[0])/2,c=(i.span2[1]+i.span2[0])/2,l=Math.min(30,Math.abs(c-s)),u=Math.min(this.arcBaseHeight+Math.round((10-l/6)*l),this.arcMaxHeight);t.querySelector("path.arc-path").setAttribute("d",""+p(r,o,a,u,this.arcAspect)),t.querySelector("path.arc-arrow").setAttribute("d",""+m(r,o,this.arcArrowSize))}}),this.setMouseovers(n,e)}this.shadowRoot.querySelectorAll("g.edge-group").forEach(t=>{!function(t,e){const n=t.getBBox();e.setAttribute("x",""+n.x),e.setAttribute("y",""+n.y),e.setAttribute("width",""+n.width),e.setAttribute("height",""+n.height)}(t.querySelector("foreignObject"),t.querySelector("rect.mousebox"))}),this.positionLayers(),this.setSVGViewport()}else this.tokenXBounds=[]}};o([c.property({type:Object})],g.prototype,"data",void 0),o([c.property({type:Boolean})],g.prototype,"showLayerLabel",void 0),o([c.property({type:Number})],g.prototype,"lineHeight",void 0),o([c.property({type:Number})],g.prototype,"bracketHeight",void 0),o([c.property({type:Number})],g.prototype,"yPad",void 0),o([c.property({type:Number})],g.prototype,"arcBaseHeight",void 0),o([c.property({type:Number})],g.prototype,"arcMaxHeight",void 0),o([c.property({type:Number})],g.prototype,"arcAspect",void 0),o([c.property({type:Number})],g.prototype,"arcArrowSize",void 0),o([c.property({type:Number})],g.prototype,"viewPad",void 0),o([c.property({type:Number})],g.prototype,"svgScaling",void 0),g=o([c.customElement("span-graph-vis")],g),e.SpanGraphVis=g},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.ClassificationModule=void 0;const o=n(0),a=n(15),s=n(4),c=n(7),l=n(13);n(5);const u=n(9);n(31);const d=n(10),h=n(86),f=n(11);let p=class extends l.LitModule{constructor(){super(...arguments),this.classificationService=c.app.getService(d.ClassificationService),this.labeledPredictions={}}static get styles(){return[f.styles,h.styles]}firstUpdated(){this.react(()=>this.selectionService.primarySelectedInputData,t=>{this.updateSelection()});this.react(()=>this.classificationService.allMarginSettings,t=>{this.updateSelection()}),this.updateSelection()}updateSelection(){return i(this,void 0,void 0,(function*(){const t=this.selectionService.primarySelectedInputData;if(null===t)return void(this.labeledPredictions={});const e=this.classificationService.getClassificationPreds([t],this.model,this.appState.currentDataset),n=yield this.loadLatest("multiclassPreds",e);null!==n&&(this.labeledPredictions=yield this.parseResult(n[0],t))}))}parseResult(t,e){return i(this,void 0,void 0,(function*(){const n=this.appState.currentModelSpecs[this.model].spec.output,r=u.findSpecKeys(n,"MulticlassPreds"),i=Object.keys(t),o={};for(let a=0;a<i.length;a++){const s=i[a];if(!r.includes(s))continue;const c=n[s].parent,l=t[s],u=(yield this.classificationService.getResults([e.id],this.model,s))[0],d=this.classificationService.getLabelNames(this.model,s),h=l.map((t,n)=>{const r={value:t,label:d[n].toString(),i:n,isPredicted:n===u.predictedClassIdx};return null!=c&&e.data[c]===d[n]&&(r.isGroundTruth=!0),r});o[s]=h}return o}))}render(){const t=Object.keys(this.labeledPredictions);return o.html`
        ${t.map(t=>this.renderRow(t,this.labeledPredictions[t]))}
    `}renderRow(t,e){return o.html`
        <div class='classification-row-holder'>
          <div class='classification-row-title'>${t}</div>
          <table>
            <tr>
              <th>Class</th>
              <th>Label</th>
              <th>Predicted</th>
              <th>Score</th>
            </tr>
            ${e.map(e=>this.renderClass(t,e))}
          </table>
        </div>`}renderClass(t,e){const n={},r=100-2.2*this.classificationService.getLabelNames(this.model,t).length;n.width=r*e.value+"%",n["background-color"]="#07a3ba",n["padding-left"]="0.75%",n["padding-right"]="0.75%",n["margin-left"]="0.35%",n["margin-right"]="0.35%";const i=e.value.toFixed(3);return o.html`
        <tr class='classification-row'>
          <td class='classification-label'>${e.label}</td>
          <td>${e.isGroundTruth?"✔":""}</td>
          <td>${e.isPredicted?"✔":""}</td>
          <td class='classification-cell'>
            <div style='${a.styleMap(n)}'></div>
            <div>${i}</div>
          </td>
        </tr>`}static shouldDisplayModule(t,e){return u.doesOutputSpecContain(t,"MulticlassPreds")}};p.title="Classification Results",p.duplicateForExampleComparison=!0,p.numCols=3,p.template=(t="",e=0)=>o.html`<classification-module model=${t} selectionServiceIndex=${e}></classification-module>`,r([s.observable],p.prototype,"labeledPredictions",void 0),p=r([o.customElement("classification-module")],p),e.ClassificationModule=p},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.DataTableModule=void 0,n(36);const o=n(0),a=n(4),s=n(7),c=n(13);n(61),n(5);const l=n(9);n(31),n(42);const u=n(10),d=n(91),h=n(11);let f=class extends c.LitModule{constructor(){super(...arguments),this.classificationService=s.app.getService(u.ClassificationService),this.regressionService=s.app.getService(u.RegressionService),this.columnVisibility=new Map,this.modelPredToClassificationInfo=new Map,this.modelPredToRegressionInfo=new Map,this.searchText="",this.filterSelected=!1}static get styles(){return[h.styles,d.styles]}get dataSpec(){return this.appState.currentDatasetSpec}get keys(){return this.appState.currentInputDataKeys.filter(t=>"meta"!==t)}get defaultColumns(){return["index","id",...this.keys]}get selectedRowIndices(){return this.selectionService.selectedIds.map(t=>this.appState.getIndexById(t)).filter(t=>-1!==t)}get keysToTableEntry(){const t=this.appState.currentModels,e=new Map;return t.forEach(t=>{const n=this.appState.currentModelSpecs[t].spec.output,r=l.findSpecKeys(n,["MulticlassPreds"]),i=l.findSpecKeys(n,["RegressionScore"]);this.addTableEntries(e,t,r,this.modelPredToClassificationInfo,this.classificationService.getDisplayNames()),this.addTableEntries(e,t,i,this.modelPredToRegressionInfo,this.regressionService.getDisplayNames())}),e}reversedAncestorIndices(t){return this.appState.getAncestry(t.id).map(t=>this.appState.indicesById.get(t)).reverse()}get data(){return this.appState.currentInputData.slice().sort((t,e)=>l.compareArrays(this.reversedAncestorIndices(t),this.reversedAncestorIndices(e))).map(t=>{let e=l.shortenId(t.id);e=e?e+"...":"",e=t.meta.added?"*"+e:e;const n=this.appState.indicesById.get(t.id);if(null==n)return[];const r=[];if(this.keysToTableEntry.size>0){const e=t.id;Array.from(this.columnVisibility.keys()).filter(t=>!this.defaultColumns.includes(t)).forEach(t=>{const n=this.keysToTableEntry.get(this.getTableKey(e,t));r.push(null==n?"-":n)})}return[n,e,...this.keys.map(e=>this.formatForDisplay(t.data[e],this.dataSpec[e])),...r]})}firstUpdated(){this.reactImmediately(()=>this.appState.currentInputData,t=>{null!=t&&this.updatePredictionInfo(t)});this.react(()=>this.appState.currentModels,t=>{this.updateColumns()});this.react(()=>this.appState.currentDataset,t=>{this.updateColumns()});this.react(()=>this.keys,t=>{this.updateColumns()}),this.updateColumns()}updatePredictionInfo(t){return i(this,void 0,void 0,(function*(){const e=new Map,n=new Map,r=this.appState.currentModels,i=t.map(t=>t.id);for(const t of r){const r=this.appState.currentModelSpecs[t].spec.output,o=l.findSpecKeys(r,["RegressionScore"]),a=l.findSpecKeys(r,["MulticlassPreds"]);for(const n of a){const r=yield this.classificationService.getResults(i,t,n);e.set(this.getTableKey(t,n),r)}for(const e of o){const r=yield this.regressionService.getResults(i,t,e);n.set(this.getTableKey(t,e),r)}}this.modelPredToClassificationInfo=e,this.modelPredToRegressionInfo=n}))}updateColumns(){const t=new Map;this.defaultColumns.forEach(e=>{t.set(e,!0)});const e=this.classificationService.getDisplayNames(),n=this.regressionService.getDisplayNames();this.appState.currentModels.forEach(r=>{const i=this.appState.currentModelSpecs[r].spec.output,o=l.findSpecKeys(i,["RegressionScore"]);this.setColumnNames(r,t,o,n);const a=l.findSpecKeys(i,["MulticlassPreds"]);this.setColumnNames(r,t,a,e)}),this.columnVisibility=t}setColumnNames(t,e,n,r){n.forEach(n=>{r.forEach(r=>{e.set(this.formatColumnName(t,n,r),!1)})})}addTableEntries(t,e,n,r,i){const o=this.appState.currentInputData.map(t=>t.id);n.forEach(n=>{const a=r.get(this.getTableKey(e,n));null!=a&&a.forEach((r,a)=>{const s=Object.entries(r),c=o[a];s.forEach((r,o)=>{const a=i[o],s=this.formatForDisplay(r[1]);null!=a&&t.set(this.getTableKey(c,this.formatColumnName(e,n,a)),s)})})})}formatForDisplay(t,e){if(null==t)return"";if(null!=e&&l.isLitSubtype(e,"SpanLabels")){return t.map(t=>`[${t.start}, ${t.end}): ${t.label}`).join(", ")}if(Array.isArray(t)){const e=25;return""+t.map(t=>"number"==typeof t?Number.isInteger(t)?t.toString():t.toFixed(4).toString():"string"==typeof t?t.length<e?t:t.substring(0,e)+"...":""+t).join(", ")}return"boolean"==typeof t?t?"✔":" ":"number"==typeof t?Number.isInteger(t)?t.toString():t.toFixed(4).toString():""+t}formatColumnName(t,e,n){return`${t}:${e}:${n}`}getTableKey(t,e){return`${t}:${e}`}onSelect(t){const e=t.map(t=>{var e;return null===(e=this.appState.currentInputData[t])||void 0===e?void 0:e.id}).filter(t=>null!=t);this.selectionService.selectIds(e)}onPrimarySelect(t){var e,n;const r=-1===t?null:null!==(n=null===(e=this.appState.currentInputData[t])||void 0===e?void 0:e.id)&&void 0!==n?n:null;this.selectionService.setPrimarySelection(r)}render(){const t=this.appState.getIndexById(this.selectionService.primarySelectedId);let e=-1;if(this.appState.compareExamplesEnabled){const t=s.app.getServiceArray(u.SelectionService)[1];e=this.appState.getIndexById(t.primarySelectedId)}return o.html`
        <lit-data-table
          .columnVisibility=${this.columnVisibility}
          .data=${this.data}
          .selectedIndices=${this.selectedRowIndices}
          .primarySelectedIndex=${t}
          .referenceSelectedIndex=${e}
          .onSelect=${t=>{this.onSelect(t)}}
          .onPrimarySelect=${t=>{this.onPrimarySelect(t)}}
          controlsEnabled
        ></lit-data-table>

    `}static shouldDisplayModule(t,e){return!0}};f.title="Data Table",f.template=()=>o.html`<data-table-module></data-table-module>`,f.numCols=5,f.duplicateForModelComparison=!1,r([a.observable],f.prototype,"columnVisibility",void 0),r([a.observable],f.prototype,"modelPredToClassificationInfo",void 0),r([a.observable],f.prototype,"modelPredToRegressionInfo",void 0),r([a.observable],f.prototype,"searchText",void 0),r([a.observable],f.prototype,"filterSelected",void 0),r([a.computed],f.prototype,"dataSpec",null),r([a.computed],f.prototype,"keys",null),r([a.computed],f.prototype,"defaultColumns",null),r([a.computed],f.prototype,"selectedRowIndices",null),r([a.computed],f.prototype,"keysToTableEntry",null),r([a.computed],f.prototype,"data",null),f=r([o.customElement("data-table-module")],f),e.DataTableModule=f},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e},s=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.DatapointEditorModule=void 0;const c=a(n(20)),l=n(0),u=n(15),d=n(4),h=n(7),f=n(13);n(5);const p=n(9),m=n(29),g=n(92),v=n(11);let y=class extends f.LitModule{constructor(){super(...arguments),this.groupService=h.app.getService(m.GroupService),this.isShiftPressed=!1,this.editedData={},this.datapointEdited=!1,this.inputHeights={}}static get styles(){return[v.styles,g.styles]}get dataTextLengths(){const t={},e=this.appState.currentInputDataKeys.filter(t=>!(this.groupService.categoricalFeatureNames.includes(t)||this.groupService.numericalFeatureNames.includes(t)));for(const n of e){const e=this.appState.currentInputData.map(t=>{var e;return null===(e=t.data[n])||void 0===e?void 0:e.length}),r=c.quantile(e,.8);null!=r&&(t[n]=r)}return t}firstUpdated(){const t=this.shadowRoot.getElementById("edit-table");this.resizeObserver=new ResizeObserver(()=>{this.resize()}),this.resizeObserver.observe(t);this.reactImmediately(()=>this.appState.currentDataset,()=>{d.when(()=>this.appState.currentInputDataIsLoaded,()=>{this.resize()})});this.reactImmediately(()=>this.selectionService.primarySelectedInputData,t=>{this.resetEditedData(null==t?null:t.data)})}updated(){const t=Array.from(this.shadowRoot.querySelectorAll("textarea"));for(const e of t)e.value=e.textContent}resize(){const t=this.shadowRoot.querySelectorAll(".input-box")[0];if(null==t)return;const e=Array.from(Object.keys(this.dataTextLengths));for(const n of e){const e=this.dataTextLengths[n],r=13,i=Math.ceil(r*e/t.clientWidth),o=1;this.inputHeights[n]=2*i+o+"ex"}}growToTextSize(t){const e=t.target;e.style.height=e.scrollHeight+"px"}defaultValueByField(t){const e=this.appState.currentDatasetSpec[t];if(p.isLitSubtype(e,"Scalar"))return 0;if(p.isLitSubtype(e,["Tokens","SequenceTags","SpanLabels","EdgeLabels"]))return[];return p.isLitSubtype(e,["TextSegment","CategoryLabel"])||console.log("Warning: default value requested for unrecognized input field type",t,e),""}resetEditedData(t){this.datapointEdited=!1;const e={},n=null==t?this.appState.currentInputDataKeys:Object.keys(t);for(const r of n)e[r]=null==t?this.defaultValueByField(r):t[r];this.editedData=e}render(){return l.html`
      <div id="container">
        ${this.renderEditText()}
        ${this.renderMakeResetButtons()}
      </div>
    `}get allRequiredInputsFilledOut(){const t=Object.keys(this.editedData);let e=!0;for(let n=0;n<t.length;n++)if(this.appState.currentModelRequiredInputSpecKeys.includes(t[n])&&""===this.editedData[t[n]]){e=!1;break}return e}renderMakeResetButtons(){const t=this.datapointEdited&&this.allRequiredInputsFilledOut,e=this.datapointEdited,n=!!this.selectionService.primarySelectedInputData;return l.html`
      <div class="button-holder">
        <button id="make"  @click=${()=>s(this,void 0,void 0,(function*(){const t=[[this.editedData]],e=[this.selectionService.primarySelectedId],n=yield this.appState.createNewDatapoints(t,e,"manual");this.selectionService.selectIds(n.map(t=>t.id))}))} ?disabled="${!t}">
          Analyze new datapoint
        </button>
        <button id="reset" @click=${()=>{this.resetEditedData(this.selectionService.primarySelectedInputData.data)}}  ?disabled="${!e}">
          Reset
        </button>
        <button id="reset" @click=${()=>{this.selectionService.selectIds([])}}  ?disabled="${!n}">
          Clear
      </button>
      </div>
    `}renderEditText(){const t=Object.keys(this.editedData);return l.html`
      <div id="edit-table">
       ${t.map(t=>this.renderEntry(t,this.editedData[t],!0))}
      </div>
    `}renderEntry(t,e,n){const r=(e,n=(t=>t))=>{this.datapointEdited=!0,this.editedData[t]=n(e.target.value)},i={height:this.inputHeights[t]},o=()=>l.html`
      <input type="text" class="input-short" @input=${r}
        ?readonly="${!n}" .value=${e}></input>`,a=()=>l.html`
      <input type="text" class="input-short" @input=${t=>{r(t,t=>+t)}}
        ?readonly="${!n}" .value=${e}></input>`,s=()=>{const t=e?e.join(" "):"";return l.html`
      <textarea class="input-box" style="${u.styleMap(i)}" @input=${t=>{r(t,t=>t?t.split(" "):[])}}
        ?readonly="${!n}">${t}</textarea>`},c=()=>l.html`${e?e.map(t=>l.html`<div class="span-label">[${t.start}, ${t.end}): ${t.label}</div>`):null}`;let d=()=>l.html`
      <textarea class="input-box" style="${u.styleMap(i)}" @input=${r}
        ?readonly="${!n}">${e}</textarea>`;const h=this.appState.currentDatasetSpec[t],f=null==h?void 0:h.vocab;null!=f?d=()=>{return t=f,l.html`
      <select class="dropdown"
        @change=${r}>
        <option value="" selected></option>
        ${t.map(t=>l.html`
            <option
              value="${t}"
              ?selected=${t===e}
              >
              ${t}
            </option>`)}
      </select>`;var t}:this.groupService.categoricalFeatureNames.includes(t)?d=o:this.groupService.numericalFeatureNames.includes(t)?d=a:p.isLitSubtype(h,["Tokens","SequenceTags"])?d=s:p.isLitSubtype(h,"SpanLabels")&&(d=c);const m=t=>{"Shift"===t.key&&(this.isShiftPressed=!1)},g=t=>{"Shift"===t.key&&(this.isShiftPressed=!0),"Enter"===t.key&&(this.isShiftPressed||(t.preventDefault(),this.shadowRoot.getElementById("make").click()))},v=this.appState.currentModelRequiredInputSpecKeys.includes(t),y=`${t}${v?"(*)":""}`;return l.html`
      <div class="entry"
        @input=${t=>{this.growToTextSize(t)}}
        @keyup=${t=>{m(t)}}
        @keydown=${t=>{g(t)}}
        >
        <div><label>${y}: </label></div>
        <div>
          ${d()}
        </div>
      </div>
    `}static shouldDisplayModule(t,e){return!0}};y.title="Datapoint Editor",y.numCols=3,y.template=(t="",e=0)=>l.html`<datapoint-editor-module selectionServiceIndex=${e}></datapoint-editor-module>`,y.duplicateForExampleComparison=!0,y.duplicateForModelComparison=!1,o([d.observable],y.prototype,"editedData",void 0),o([d.observable],y.prototype,"datapointEdited",void 0),o([d.observable],y.prototype,"inputHeights",void 0),o([d.computed],y.prototype,"dataTextLengths",null),o([d.computed],y.prototype,"allRequiredInputsFilledOut",null),y=o([l.customElement("datapoint-editor-module")],y),e.DatapointEditorModule=y},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0}),e.AppComponent=void 0,n(68),n(76),n(78);const i=n(24),o=n(0),a=n(7),s=n(10),c=n(83);let l=class extends i.MobxLitElement{constructor(){super(...arguments),this.appState=a.app.getService(s.AppState)}static get styles(){return[c.styles]}render(){return o.html`
      <lit-app-toolbar></lit-app-toolbar>
      <!-- Main content -->
      ${this.appState.initialized?o.html`<lit-modules></lit-modules>`:null}
      <lit-app-statusbar></lit-app-statusbar>
    `}};l=r([o.customElement("lit-app")],l),e.AppComponent=l},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0}),e.StatusbarComponent=void 0,n(35),n(52),n(58),n(39);const i=n(24),o=n(0),a=n(8),s=n(7),c=n(10),l=n(75),u=n(11);let d=class extends i.MobxLitElement{constructor(){super(...arguments),this.appState=s.app.getService(c.AppState),this.statusService=s.app.getService(c.StatusService)}static get styles(){return[u.styles,l.styles]}render(){const t=a.classMap({"progress-line":this.statusService.hasMessage,"no-progress-line":!this.statusService.hasMessage});return o.html`
      <div id="at-bottom">
        <div class="toolbar">
          <div class="text-line">
            <div id="status" class="info">
              ${this.statusService.hasMessage?this.renderMessages():null}
            </div>
            <div class="signature">
              <div>Made with <img src="static/favicon.png" class="emoji"> by the LIT team</div>
              <div title="Send feedback" id="feedback">
                <a href="https://github.com/PAIR-code/lit" target="_blank">
                  <mwc-icon class="icon-button">
                    feedback
                  </mwc-icon>
                </a>
              </div>
            </div>
          </div>
          <div class=${t}></div>
        </div>
      </div>
    `}renderMessages(){return o.html`
      ${this.statusService.hasError?this.renderError():this.renderLoading()}
    `}renderError(){return o.html`
     <div class="error">${this.statusService.errorMessage}</div>
      <mwc-icon class="icon-button" id="clear-errors" @click=${()=>{this.statusService.clearErrors()}}>
        clear
      </mwc-icon>
    `}renderLoading(){return o.html`
      <div>${this.statusService.loadingMessage}</div>
    `}};d=r([o.customElement("lit-app-statusbar")],d),e.StatusbarComponent=d},function(t,e,n){"use strict";n.r(e),n.d(e,"styles",(function(){return r}));const r=n(0).css`#global-settings-holder {
  width: 0;
  height: 0;
  z-index: 3;
  position: fixed;
}

#overlay {
  background-color: black;
  width: 100vw;
  height: 100vh;
  top: 0;
  left: 0;
  opacity: .5;
  transition: opacity 500ms;
  pointer-events: none;
}

#overlay.hide {
  opacity: 0;
}

#global-settings {
  position: absolute;
  top: 12vh;
  left: 10vw;
  height: 80vh;
  width: 80vw;
  padding: 12px 24px;
  box-sizing: border-box;
  background-color: white;
  box-shadow: 0 2px 2px 0 rgba(0, 0, 0, .14), 0 3px 1px -2px rgba(0, 0, 0, .2), 0 1px 5px 0 rgba(0, 0, 0, .12);
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  overflow: scroll;
}

#global-settings.hide {
  display: none;
}

#table-holder {
  display: flex;
}

#table-holder>* {
    padding: 12px;
}

.config-title {
  font-size: 1.5rem;
  border-bottom: 1px solid #dadce0;
  margin-bottom: 12pt;
}

.config-line {
  width: 100%;
  min-width: max-content;
  margin-left: -10px;
}

#buttons-container {
  display: flex;
  flex-direction: column;
  align-items: center;
}

#error-message {
  color: red;
  padding-left: 6px;
  margin-bottom: 6px;
  font-weight: 800;
}

#bottom-message {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 5pt;
}

.first-button {
  margin-left: 0;
}
`},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0}),e.LitLegendToolbar=void 0;const i=n(24),o=n(0),a=n(15),s=n(7);n(5);const c=n(9),l=n(10),u=n(71),d=n(11);let h=class extends i.MobxLitElement{constructor(){super(...arguments),this.colorService=s.app.getService(l.ColorService)}static get styles(){return[d.styles,u.styles]}render(){const t=this.colorService.colorableOptions.map((t,e)=>{const n=this.colorService.selectedColorOption.name===t.name;return o.html`<option value=${e} ?selected=${n}>
          ${t.name}</option>`}),e="number"==typeof this.colorService.selectedColorOption.scale.domain()[0];return o.html`
      <div class="top-holder">
        ${(()=>e?this.renderNumericScale(this.colorService.selectedColorOption.scale):this.renderCategoricalScale())()}
        <div class="dropdown-container">
          <label class="dropdown-label">Color datapoints by</label>
          <select class="dropdown color-dropdown" @change=${t=>{const e=t.target,n=(null==e?void 0:e.selectedIndex)||0;this.colorService.selectedColorOption=this.colorService.colorableOptions[n]}}>
            ${t}
          </select>
        </div>
      </div>
      `}renderCategoricalScale(){const t=t=>{const e=this.colorService.selectedColorOption.scale(t),n=a.styleMap({background:e});return o.html`
        <div class='legend-line'>
          <div class='legend-box' style=${n}></div>
          <div class='dropdown-label'>${t}</div>
        </div>
      `},e=this.colorService.selectedColorOption.scale.domain();return o.html`
        <div class="line-holder">
          ${e.map(e=>t(e))}
        </div>
        `}renderNumericScale(t){const e=c.range(300),n=c.range(5),r=t.domain(),i=r[1]-r[0];return o.html`
      <div class='numeric-legend-holder'>
        <div class='numeric-legend'>
          ${e.map(e=>{const n=t(r[0]+e/300*i),s=a.styleMap({background:n});return o.html`<div class='legend-pixel' style=${s}></div>`})}
        </div>
        <div class='tick-legend'>
        ${n.map(t=>{const e=t/4*300,n=a.styleMap({left:e+"px",position:"absolute"}),s=r[0]+t/4*i;return o.html`
              <div class='tick-holder' style=${n}>
                <div class='tick'></div>
                <div class='tick-label'>${s.toFixed(2)}</div>
              </div>`})}
        </div>
      </div>`}};h=r([o.customElement("lit-legend-toolbar")],h),e.LitLegendToolbar=h},function(t,e,n){"use strict";n.r(e),n.d(e,"styles",(function(){return r}));const r=n(0).css`/**
 * Padding and margins attempt to match the offsets of the left-
 * and right-most visual elements in the main app toolbar.
 */
.toolbar {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  align-items: center;
  justify-content: space-between;
  padding-left: 4pt;
  padding-right: 4pt;
}

.toolbar button {
  margin-top: 0;
  margin-bottom: 0;
}

#main-toolbar {
  background-color: #dcecef; /* light gray-blue */
}

.togglable-toolbar-holder {
  background-color: #eff6f8; /* light gray-blue */
  width: fit-content; /* set to 100% to span page */
  border: 1px solid;
  border-radius: 2pt;
  border-color: rgb(218, 220, 224);
  position: absolute;
}

#slice-toolbar-container {
  right: 0; /* remove to span page */
}

#status-group-left {
  display: flex;
  flex-direction: row;
  align-items: center;
  margin: 4pt;
}

#button-holder-right {
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: flex-end;
  flex-grow: 2;
  margin: 4pt;
}

#primary-selection-status {
  display: flex;
  flex-direction: row;
  align-items: center;
  margin-left: 4pt;
}

/**
 * For standalone MWC icons as buttons.
 * We don't use mwc-icon-button because this adds
 * a large backdrop and extra whitespace.
 */
mwc-icon.icon-button {
  height: 24px;
  width: 24px;
  min-width: 24px;
  --mdc-icon-size: 24px;
  cursor: pointer;
  user-select: none;
}

mwc-icon.icon-button:hover {
  opacity: .7;
}

mwc-icon.mdi-outlined {
  --mdc-icon-font: "Material Icons Outlined";
}

/* For in-line icons in a <span> */
[data-icon] {
  margin: 0;
}

[data-icon]:before {
  font-family: 'Material Icons';
  content: attr(data-icon);
  vertical-align: middle;
}

#favorite-button {
  margin-left: 5pt;
}

#legend-container {
  top: 100%;
  margin-left: -8pt; /* To account for button padding */
  cursor: default;
}
.legend-line {
  display: flex;
  align-items: center;
}
.legend-box{
  width: 10pt;
  height: 10pt;
  margin: 5px;
}
.legend-pixel {
  height: 10pt;
  width: 1px;
  border-bottom: 1px solid black;
}
.numeric-legend {
  display: flex;
}
.numeric-legend-holder {
  margin: 5px 30px;
}
.tick {
  width: 1;
  border-left: 1px solid black;
  height: 8pt;
}
.tick-legend {
  position: relative;
  height: 22px;
  width: fit-content;
}
.tick-label {
  font-size: 8pt;
  margin-left: -10px;
}
.color-dropdown {
  min-width: 150px;
}
.top-holder {
  display: flex;
}
.line-holder {
  padding-right: 20px;
}
`},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0}),e.SliceToolbar=void 0;const i=n(24),o=n(0),a=n(4),s=n(7),c=n(9),l=n(29),u=n(10),d=n(11),h=n(73);let f=class extends i.MobxLitElement{constructor(){super(...arguments),this.selectionService=s.app.getService(u.SelectionService),this.sliceService=s.app.getService(u.SliceService),this.groupService=s.app.getService(l.GroupService),this.appState=s.app.getService(u.AppState),this.sliceByFeatures=[],this.sliceName=""}static get styles(){return[d.styles,h.styles]}get createButtonEnabled(){return 0===this.selectionService.selectedIds.length&&this.anyCheckboxChecked||""!==this.sliceName&&this.selectionService.selectedIds.length>0}get deleteButtonEnabled(){return""!==this.sliceService.selectedSliceName}get anyCheckboxChecked(){return this.sliceByFeatures.length}get sliceNameInputEditable(){return this.selectionService.selectedIds.length>0||this.anyCheckboxChecked}lastCreatedSlice(){const t=this.sliceService.sliceNames;return t[t.length-1]}handleClickCreate(){if(this.anyCheckboxChecked)this.makeSlicesFromAllLabelCombos(),this.selectSlice(this.lastCreatedSlice());else{const t=this.selectionService.selectedIds,e=this.sliceName;this.sliceService.addNamedSlice(e,t),this.selectSlice(e)}this.sliceName="",this.sliceByFeatures=[]}makeSlicesFromAllLabelCombos(){const t=this.selectionService.selectedOrAllInputData,e=this.groupService.groupExamplesByFeatures(t,this.sliceByFeatures),n=this.sliceName;Object.keys(e).forEach(t=>{const r=`${n}  ${t}`,i=e[t].data.map(t=>t.id);this.sliceService.addNamedSlice(r,i)})}selectSlice(t){this.sliceService.selectNamedSlice(t,this)}deleteSlice(){this.sliceService.deleteNamedSlice(this.sliceService.selectedSliceName),this.selectSlice("")}renderButtons(){const t=()=>{this.handleClickCreate()};return o.html`
      <input type="text" id="input-box" .value=${this.sliceName}
        placeholder="Enter name" @input=${t=>{this.sliceName=t.target.value}}
        ?readonly="${!this.sliceNameInputEditable}"
        @keyup=${e=>{(e=>{c.handleEnterKey(e,t)})(e)}}/>
      <button ?disabled="${!this.createButtonEnabled}" id="create"
        @click=${t}>Create slice
      </button>
      <button ?disabled="${!this.deleteButtonEnabled}"  id="delete"
        @click=${()=>{this.deleteSlice()}}>Delete slice
      </button>
    `}renderSliceSelector(){const t=this.sliceService.selectedSliceName,e=[""].concat(this.sliceService.sliceNames);return o.html`
      <label class="dropdown-label">Selected slice</label>
      <select class="dropdown" id="slice-selector"
        .value=${t}
        @change=${t=>{const e=t.target.value;this.selectSlice(e)}}>
        ${e.map(e=>{const n=e===t;return o.html`
            <option ?selected="${n}" value=${e}>
              ${e}
            </option>`})}
      </select>
    `}renderFilters(){const t=(t,e)=>{if(t.target.checked)this.sliceByFeatures.push(e);else{const t=this.sliceByFeatures.indexOf(e);this.sliceByFeatures.splice(t,1)}},e=e=>o.html`
        <div>
          <div class='checkbox-holder'>
            <lit-checkbox
              ?checked=${this.sliceByFeatures.includes(e)}
              @change='${n=>{t(n,e)}}'
              label=${e}>
            </lit-checkbox>
          </div>
        </div>
      `;return o.html`${this.groupService.categoricalAndNumericalFeatureNames.map(t=>e(t))}`}renderNumSlices(){return this.anyCheckboxChecked?o.html`
        <div class="dropdown-label">
          (${this.groupService.numIntersectionsLabel(this.sliceByFeatures)} slices)
        </div>
      `:""}render(){return o.html`
      <div class="toolbar" id="slice-toolbar">
        ${this.renderSliceSelector()}
        ${this.renderButtons()}
      </div>
      <div class="toolbar" >
        <label class="dropdown-label">Slice by feature</label>
        ${this.renderFilters()}
        ${this.renderNumSlices()}
      </div>
    `}};r([a.observable],f.prototype,"sliceByFeatures",void 0),r([a.observable],f.prototype,"sliceName",void 0),r([a.computed],f.prototype,"createButtonEnabled",null),r([a.computed],f.prototype,"deleteButtonEnabled",null),r([a.computed],f.prototype,"anyCheckboxChecked",null),r([a.computed],f.prototype,"sliceNameInputEditable",null),f=r([o.customElement("lit-slice-toolbar")],f),e.SliceToolbar=f},function(t,e,n){"use strict";n.r(e),n.d(e,"styles",(function(){return r}));const r=n(0).css`/**
 * Padding and margins attempt to match the offsets of the left-
 * and right-most visual elements in the main app toolbar.
 */
.toolbar {
  display: flex;
  flex-direction: row;
  padding-left: 4pt;
  align-items: center;
}

#slice-selector {
  min-width: 120px;
  max-width: 120px;
}

#slice-toolbar {
  /* align these to the right */
  justify-content: flex-end;
  padding-right: 4pt;
  align-items: center;
}

.toolbar > * {
  margin: 4pt;
}

.checkbox-holder{
  display: flex;
  justify-content: space-between;
}

.checkbox-title{
  font-size: 12px;
}
`},function(t,e,n){"use strict";n.r(e),n.d(e,"styles",(function(){return r}));const r=n(0).css`/**
 * Padding and margins attempt to match the offsets of the left-
 * and right-most visual elements in the main app toolbar.
 */
.toolbar {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  align-items: center;
  justify-content: space-between;
  padding-left: 4pt;
  padding-right: 4pt;
}

.toolbar button {
  margin-top: 0;
  margin-bottom: 0;
}

#main-toolbar {
  box-shadow: 0 2px 2px 0 rgba(0, 0, 0, .14), 0 3px 1px -2px rgba(0, 0, 0, .2), 0 1px 5px 0 rgba(0, 0, 0, .12);
  background-color: white;
  border-bottom: 1px solid #dadce0;
}

.togglable-toolbar-holder {
  background-color: white;
  width: fit-content; /* set to 100% to span page */
  border: 1px solid;
  border-radius: 2pt;
  border-color: rgb(218, 220, 224);
  position: absolute;
}

#slice-toolbar-container {
  right: 0; /* remove to span page */
}

#status-group-left {
  display: flex;
  flex-direction: row;
  align-items: center;
  margin: 4px;
  max-height: 24px; /** To avoid page jumps when selections happen. **/
}

#button-holder-right {
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: flex-end;
  flex-grow: 2;
  margin: 4px;
}

.selection-status-group {
  display: flex;
  flex-direction: row;
  align-items: center;
}

#primary-selection-status {
  margin-left: 4pt;
}

#pair-controls {
  margin-left: 12pt;
}

/**
 * For standalone MWC icons as buttons.
 * We don't use mwc-icon-button because this adds
 * a large backdrop and extra whitespace.
 */
mwc-icon.icon-button {
  height: 16px;
  width: 16px;
  min-width: 16px;
  --mdc-icon-size: 16px;
  cursor: pointer;
  user-select: none;
}

mwc-icon.icon-button:hover {
  opacity: .7;
}

mwc-icon.mdi-outlined {
  --mdc-icon-font: "Material Icons Outlined";
}

/* For in-line icons in a <span> */
[data-icon] {
  margin: 0;
}

[data-icon]:before {
  font-family: 'Material Icons';
  content: attr(data-icon);
  vertical-align: middle;
}

#favorite-button {
  margin-left: 5pt;
}

#legend-container {
  right: 0;
  min-width: 300px;
  top: 100%;
  margin-left: -8pt; /* To account for button padding */
  margin-top: 6px;
  cursor: default;
}

.toolbar-holder {
  position: relative;
}

#toggle-example-comparison.mode-active {
  outline: 1px solid #2f8c9b;
  background: #faf49f;
}
`},function(t,e,n){"use strict";n.r(e),n.d(e,"styles",(function(){return r}));const r=n(0).css`#at-bottom {
  bottom: 0;
  position: sticky;
  z-index: 1;
}

.text-line {
  display: flex;
  justify-content: space-between;
  height: 20px;
  padding-top:2px
}

.toolbar {
  border-top: 1px solid #78d9ec;
  background-color: #e4f7fb;
  width: 100vw;
  color: #007b83;
  font-size: 10pt;
}

.info {
  padding-left: 10px;
}

.error {
  color: red;
}

#clear-errors{
  color: red;
}

#status {
  display: flex;
}

mwc-icon.icon-button {
  height: 18px;
  width: 18px;
  min-width: 18px;
  --mdc-icon-size: 18px;
  cursor: pointer;
  color: #007b83;
}

mwc-icon.icon-button:hover {
  opacity: .7;
}

.emoji {
  height: 10pt;
  margin-bottom: -5px;
  padding: 2pt 0;
}

.signature {
  padding-right: 10px;
  display: flex;
}

#feedback {
  margin-left: 8px;
}

.no-progress-line {
  height: 2px;
  width: 100%;
  margin: 0;
  background-color: #e4f7fb;
}

.progress-line, .progress-line:before {
  height: 2px;
  width: 100%;
  margin: 0;
}

.progress-line {
  background-color: #2f8c9b;
  display: -webkit-flex;
  display: flex;
}

.progress-line:before {
  background-color: #e4f7fb;
  content: '';
  -webkit-animation: running-progress 2s cubic-bezier(0.4, 0, 0.2, 1) infinite;
  animation: running-progress 2s cubic-bezier(0.4, 0, 0.2, 1) infinite;
}

@-webkit-keyframes running-progress {
  0% { margin-left: 0; margin-right: 100%; }
  50% { margin-left: 25%; margin-right: 0%; }
  100% { margin-left: 100%; margin-right: 0; }
}

@keyframes running-progress {
  0% { margin-left: 0; margin-right: 100%; }
  50% { margin-left: 25%; margin-right: 0%; }
  100% { margin-left: 100%; margin-right: 0; }
}
`},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0}),e.ToolbarComponent=void 0,n(35),n(52),n(58),n(39);const i=n(24),o=n(0),a=n(7),s=n(10),c=n(77),l=n(11),u=n(9);let d=class extends i.MobxLitElement{constructor(){super(...arguments),this.isGlobalSettingsOpen=!1,this.appState=a.app.getService(s.AppState),this.statusService=a.app.getService(s.StatusService),this.modulesService=a.app.getService(s.ModulesService),this.closeGlobalSettings=()=>{this.isGlobalSettingsOpen=!1}}static get styles(){return[l.styles,c.styles]}render(){const t=this.appState.initialized&&!this.modulesService.getSetting("hideToolbar");return o.html`
      ${this.appState.initialized?this.renderGlobalSettings():null}
      <div id="at-top">
        <div id="toolbar">
          <div id="headline">
            <div class="headline-section">
              <div>
                ${this.statusService.hasError?o.html`<img src="static/potato.svg" class="status-emoji">`:o.html`<img src="static/favicon.png" class="status-emoji">`}
                Language Interpretability Tool
              </div>
            </div>
            <div class="headline-section">
              <div title="Edit models and dataset" id="config">
                <mwc-icon class="icon-button" @click=${()=>{const t=this.appState.metadata.canonicalURL||window.location.host;u.copyToClipboard(t+window.location.search)}}>
                  link
                </mwc-icon>
                <mwc-icon class="icon-button" @click=${()=>{this.isGlobalSettingsOpen=!this.isGlobalSettingsOpen}}>
                  settings
                </mwc-icon>
              </div>
            </div>
          </div>
        </div>
        ${t?this.renderSelectionToolbar():null}
      </div>
    `}renderGlobalSettings(){return o.html`
      <lit-global-settings
        ?isOpen=${this.isGlobalSettingsOpen}
        .close=${this.closeGlobalSettings}
      ></lit-global-settings>
    `}renderSelectionToolbar(){return o.html`
      <lit-selection-toolbar></lit-selection-toolbar>
    `}};r([o.property({attribute:!1})],d.prototype,"isGlobalSettingsOpen",void 0),d=r([o.customElement("lit-app-toolbar")],d),e.ToolbarComponent=d},function(t,e,n){"use strict";n.r(e),n.d(e,"styles",(function(){return r}));const r=n(0).css`#at-top {
  top: 0;
  position: sticky;
  z-index: 3;
}

#toolbar {
  display: flex;
  flex-direction: row;
  align-items: center;
}

#headline {
  width: 100vw;
  display: flex;
  justify-content: space-between;
  align-items: center;
  background-color: #2f8c9b;
  font-family: 'Google Sans' !important;
  color: white;
  font-size: 14pt;
  letter-spacing: +0.1;
}

.headline-section {
  display: flex;
  align-items: center;
}

.headline-section>* {
  padding: 4px;
  display: flex;
  justify-content: center;
  align-items: center;
}

.spinner-holder {
  padding-left: 12pt;
}

#status {
  font-family: 'Google Sans' !important;
}

#status.info {
  font-size: 14pt;
  letter-spacing: 0.25;
  line-height: 20pt;
  color: white;
}

#status.error {
  font-size: 12pt;
  color: yellow;
}

#link {
  margin-right: 8pt;
}

#clear-errors{
  color: yellow;
}

mwc-icon.icon-button {
  height: 24px;
  width: 24px;
  min-width: 24px;
  --mdc-icon-size: 24px;
  cursor: pointer;
  margin-left: 5pt;
}

mwc-icon.icon-button:hover {
  opacity: .7;
}

mwc-icon.icon-button:active {
  opacity: .4;
}

.status-emoji {
  width: 20px;
  height: 20px;
  padding-right: 4px;
}

`},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0}),e.LitModules=void 0;const i=n(0),o=n(8),a=n(15);n(35),n(38);const s=n(10),c=n(7),l=n(13),u=n(79);n(80);let d=class extends i.LitElement{constructor(){super(...arguments),this.modulesService=c.app.getService(s.ModulesService),this.mainSectionHeight=this.modulesService.getSetting("mainHeight")||45}static get styles(){return u.styles}firstUpdated(){this.modulesService.setRenderModulesCallback(()=>{this.requestUpdate()})}disconnectedCallback(){super.disconnectedCallback(),this.modulesService.setRenderModulesCallback(()=>{})}connectedCallback(){super.connectedCallback(),this.style.setProperty("align-self",this.modulesService.getSetting("centerPage")?"center":"unset")}updated(){this.shadowRoot.querySelectorAll("lit-widget").forEach(t=>{const e=t.children[0];e instanceof l.LitModule&&(e.setIsLoading=e=>{t.isLoading=e})})}render(){const t=this.modulesService.getRenderLayout(),e=t.Main,n=Object.keys(t).filter(t=>"Main"!==t);""===this.modulesService.selectedTab&&(this.modulesService.selectedTab=n[0]);const r=a.styleMap({height:this.mainSectionHeight+"vh"});return i.html`
      <div id='main-panel' style=${r}>
        ${this.renderMainPanel(e)}
      </div>
      <div id='center-bar'>
        <div id='tabs'>
          ${this.renderTabs(n)}
        </div>
        <div id='drag-container'>
          <mwc-icon class="drag-icon">menu</mwc-icon>
          <div id='drag-handler' draggable='true'
              @drag=${t=>{this.onBarDragged(t)}}>
          </div>
        </div>
      </div>
      <div id='component-groups'>
        ${this.renderComponentGroups(t,n)}
      </div>
    `}onBarDragged(t){const e=this.shadowRoot.getElementById("main-panel").getBoundingClientRect().top;this.mainSectionHeight=Math.floor((t.clientY-e-10)/window.innerHeight*100)}renderComponentGroups(t,e){return e.map(e=>{const n=t[e].map(t=>i.html`
            <lit-widget-group .configGroup=${t}></lit-widget-group>`),r=this.modulesService.selectedTab===e,a=o.classMap({selected:r,"components-group-holder":!0});return i.html`
        <div class=${a}>
          ${n}
        </div>`})}renderTabs(t){return t.map(t=>{const e=t,n=this.modulesService.selectedTab===t,r=o.classMap({selected:n,tab:!0});return i.html`<div class=${r} @click=${t=>{this.modulesService.selectedTab=e,t.preventDefault(),this.requestUpdate()}}>${t}</div>`})}renderMainPanel(t){return t.map(t=>i.html`<lit-widget-group .configGroup=${t}></lit-widget-group>`)}};r([i.property({type:Number})],d.prototype,"mainSectionHeight",void 0),d=r([i.customElement("lit-modules")],d),e.LitModules=d},function(t,e,n){"use strict";n.r(e),n.d(e,"styles",(function(){return r}));const r=n(0).css`:host {
  display: flex;
  flex-direction: column;
  flex: 1;
  overflow: hidden;
  min-width: calc(min(1000px, 100vw));
  align-self: --align-self;
}

#main-panel {
  display: flex;
  border-bottom: 1px solid #dadce0;
  overflow-y: hidden;
  overflow-x: scroll;
}

#component-groups{
  position: relative;
  flex: 1;
}

.components-group-holder {
  position: absolute;
  background: #f1f3f4;
  overflow: auto;
  display: flex;
  visibility: hidden;
  height: 100%;
  width: 100%;
}
.components-group-holder.selected {
  visibility: visible;
  z-index: 1;
}

#center-bar {
  padding: 0 40px;
  color: #5f6368;
  background: white;
  display: flex;
}


#drag-container{
  position:relative;
  width: 50%;
  height: 100%;
  margin-left:auto;
}

#drag-handler {
  width: 100%;
  height: 100%;
  cursor: ns-resize;
  opacity: 0;
}

#tabs {
  max-width: 100%;
  display: flex;
  font-size: 9pt;
  margin-right: 38px;
}

.tab {
  padding: 2pt 5pt;
  width: 150px;
  text-align: center;
  border-bottom: 2px solid #dadce0;
  white-space: nowrap;
}
.tab:hover{
  background: #eee;
}
.tab.selected {
  font-weight: bold;
  border-bottom: 2px solid #1a73e8;
  color: black;
}
.drag-icon {
  pointer-events: none;
  position: absolute;
  left: 0%;
}`},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0}),e.LitWidget=e.WidgetGroup=void 0,n(39);const i=n(81),o=n(82),a=n(0),s=n(24),c=n(8);n(15),n(35),n(38);let l=class extends a.LitElement{constructor(){super(...arguments),this.configGroup=[],this.minimized=!1,this.maximized=!1,this.dragging=!1,this.userSetNumCols=0}static get styles(){return[i.styles]}render(){return this.renderModules(this.configGroup)}renderHeader(t){const e=t[0].moduleType.title,n=this.maximized?"fullscreen_exit":"fullscreen",r=this.minimized?"south_east":"south_west",i=()=>{this.minimized=!this.minimized,this.maximized=!1};return a.html`
    <div class=header>
      <div class="title" @click=${i}>${e}</div>
      <mwc-icon class="icon-button min-button" @click=${i}>
        ${r}
      </mwc-icon>
      <mwc-icon class="icon-button" @click=${()=>{this.maximized=!this.maximized,this.minimized=!1}}>
        ${n}
        </mwc-icon>
    </div>`}renderModules(t){const e=t.length>1,n=t[0].moduleType.duplicateAsRow,r=t.map(t=>this.renderModule(t,e&&!n));this.setWidthValues(t,n);const i=c.classMap({wrapper:!0,minimized:this.minimized,maximized:this.maximized,dragging:this.dragging}),o=c.classMap({"component-row":e&&n,"component-column":e&&!n,holder:!0});return a.html`
      <div class=${i} >
        ${this.renderHeader(t)}
        <div class=${o}>
          ${r}
          ${this.renderExpander()}
        </div>
      </div>
      `}renderModule(t,e){const n=t.moduleType,r=t.modelName,i=t.selectionServiceIndex;let o=null!=r?r:"";return void 0!==i&&n.duplicateForExampleComparison&&(o=o.concat(`${o?" - ":""} ${i?"Reference":"Main"}`)),a.html`
      <lit-widget
        displayTitle=${n.title}
        subtitle=${o}
        ?highlight=${1===i}
      >
        ${n.template(r,i)}
      </lit-widget>
    `}renderExpander(){const t=t=>{const e=this.shadowRoot.querySelector(".holder"),n=e.getBoundingClientRect().left,r=e.getBoundingClientRect().width,i=window.innerWidth,o=r/(this.userSetNumCols/12*i),a=t.clientX-n;if(a>0){const t=a/i*12;this.userSetNumCols=+Math.max(t/o,1).toFixed(1)}},e=()=>{this.userSetNumCols||(this.userSetNumCols=this.configGroup[0].moduleType.numCols),this.dragging=!0};return this.maximized||this.minimized?a.html``:a.html`
        <div class="expander">
          <div class="expander-drag-target" draggable='true'
            @drag=${e=>{t(e)}}
            @dragstart=${()=>{e()}}
            @dragend=${()=>{this.dragging=!1}}>
          </div>
        </div>
      `}setWidthValues(t,e){const n=t.map(t=>t.moduleType.numCols);let r=e?n.reduce((t,e)=>t+e,0):Math.max(...n);this.userSetNumCols&&(r=this.userSetNumCols);const i=this.flexGrowToWidth(r),o=this.shadowRoot.host;o.style.setProperty("--flex",r.toString()),o.style.setProperty("--width",i),o.style.setProperty("--min-width",i)}flexGrowToWidth(t){return(t/12*100).toFixed(3).toString()+"%"}};r([a.property({type:Array})],l.prototype,"configGroup",void 0),r([a.property({type:Boolean,reflect:!0})],l.prototype,"minimized",void 0),r([a.property({type:Boolean,reflect:!0})],l.prototype,"maximized",void 0),r([a.property({type:Boolean,reflect:!0})],l.prototype,"dragging",void 0),r([a.property({type:Number})],l.prototype,"userSetNumCols",void 0),l=r([a.customElement("lit-widget-group")],l),e.WidgetGroup=l;let u=class extends s.MobxLitElement{constructor(){super(...arguments),this.displayTitle="",this.subtitle="",this.isLoading=!1,this.highlight=!1}static get styles(){return o.styles}render(){const t=c.classMap({content:!0,loading:this.isLoading}),e=c.classMap({holder:!0,highlight:this.highlight});return a.html`
      <div class=${e}>
        ${this.subtitle?this.renderHeader():""}
        <div class="container">
          ${this.isLoading?this.renderSpinner():null}
          <div class=${t}>
            <slot></slot>
          </div>
        </div>
      </div>
    `}renderSpinner(){return a.html`
      <div class="spinner-container">
        <lit-spinner size=${36} color="var(--app-secondary-color)">
        </lit-spinner>
      </div>
    `}renderHeader(){return a.html`
    <div class=header>
      <span class="subtitle">${this.subtitle}</span>
    </div>
    `}};r([a.property({type:String})],u.prototype,"displayTitle",void 0),r([a.property({type:String})],u.prototype,"subtitle",void 0),r([a.property({type:Boolean})],u.prototype,"isLoading",void 0),r([a.property({type:Boolean})],u.prototype,"highlight",void 0),u=r([a.customElement("lit-widget")],u),e.LitWidget=u},function(t,e,n){"use strict";n.r(e),n.d(e,"styles",(function(){return r}));const r=n(0).css`:host{
  flex: var(--flex);
  min-width: var(--width);
  width: var(--width);
  transition: all .25s;
}


:host([minimized]) {
  width: 36px !important;
  min-width: 36px !important;
  flex: unset !important;
}

:host([maximized]) {
  transition: none;
  margin: 15px 45px;
  padding: 0;
  width: calc(100vw - 90px) !important;
  height: calc(100vh - 130px);
  position: fixed;
  z-index: 2;
  left: 0;
  top: 82px;
  box-shadow: rgba(0, 0, 0, 0.14) 0px 2px 2px 0px, rgba(0, 0, 0, 0.2) 0px 3px 1px -2px, rgba(0, 0, 0, 0.12) 0px 1px 5px 0px;
}

:host([dragging]) {
  transition: none;
}

.wrapper {
  padding: 4pt;
  height: 100%;
  box-sizing: border-box;
  background-color: white;
  background-clip: content-box;
  display: flex;
  flex-direction: column;
}

:host([maximized]) .wrapper {
  padding: 0;
}

.holder {
  height: 100%;
  display: flex;
  flex-direction: column;
  position: relative;
  flex: 1;
}

.header {
  display: flex;
  padding-left: 2pt;
  line-height: 20pt;
  align-items: center;
  justify-content: space-between;
  border: 1px solid rgb(218, 220, 224);
}

.title {
  font-size: 10pt;
  white-space: nowrap;
  overflow: hidden;
  cursor: pointer;
}

.component-row {
  display: flex;
  flex-direction: row;
}

.component-column {
  display: flex;
  flex-direction: column;
}

lit-widget {
  flex: 1;
  min-height: 125pt;
}

.min-button {
  flex: 1;
  text-align: right;  
}

.minimized .min-button{
  text-align: left;  
}

mwc-icon.icon-button {
  height: 24px;
  width: 24px;
  min-width: 24px;
  --mdc-icon-size: 24px;
  color: rgb(95, 99, 104);
  cursor: pointer;
}

mwc-icon.icon-button:hover {
  opacity: .7;
}


.minimized lit-widget{
  display: none;
}

.minimized .header {
  writing-mode: vertical-lr;
  transform: rotate(180deg);
  flex-direction: row-reverse;
  height: 100%;
  padding: 0pt 0pt 2pt 0pt;
}

.expander {
  position: absolute;
  bottom: 0px;
  right: 0px;
  height: 90%;
  width: 10px;
  cursor: ew-resize;
}

.expander-drag-target{
  position: absolute;
  width: 100%;
  height:100%;
  opacity: 0;
}`},function(t,e,n){"use strict";n.r(e),n.d(e,"styles",(function(){return r}));const r=n(0).css`:host {
  display: flex;
  position: relative;
  box-sizing: border-box;
  height: 100%;
  background: white;
}

.holder {
  display: flex;
  flex-direction: column;
  position: relative;
  border: 1px solid rgb(218, 220, 224);
  border-top: 0px;
  width: 100%;
  box-sizing: border-box;
}


.container {
  position: relative;
  display: flex;
  flex: 1;
  height: 0px; /** Height must be explicitly set **/
}

.content {
  overflow-y: auto;
  padding: 4px;
  width: 100%;
}

.content.loading {
  opacity: 0.2;
  pointer-events: none;
}

.header {
  color: rgb(32, 33, 36);
  line-height: 16pt;
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: space-between;
  padding: 0pt 4pt;
  border-bottom: 1px solid rgb(218, 220, 224);
}

.holder.highlight {
  border: 1px solid #2f8c9b;
  box-sizing: border-box;
}

.subtitle {
  font-size: 8pt;
  color: gray;
}

.spinner-container {
  position: absolute;
  top: 0;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
}
`},function(t,e,n){"use strict";n.r(e),n.d(e,"styles",(function(){return r}));const r=n(0).css`:host {
  height: 100vh;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  --app-drawer-width: 256px;
  --app-primary-color: rgb(171, 241, 248);
  --app-secondary-color: rgb(7, 163, 186);
  --app-dark-color: rgb(5, 30, 37);
  --app-dark-text-color: var(--app-secondary-color);
  --app-light-text-color: white;
  --app-section-even-color: #f7f7f7;
  --app-section-odd-color: white;
}

.page {
  display: none;
}

.page[active] {
  display: block;
}
`},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LAYOUTS=void 0,n(13);const r=n(85),i=n(64),o=n(87),a=n(89),s=n(65),c=n(66),l=n(93),u=n(108),d=n(119),h=n(121),f=n(123),p=n(125),m=n(126),g=n(127),v=n(138);n(38);const y=[v.SpanGraphGoldModule,v.SpanGraphModule,i.ClassificationModule,p.RegressionModule,h.LanguageModelPredictionModule,u.GeneratedTextModule];e.LAYOUTS={simple:{components:{Main:[c.DatapointEditorModule],Predictions:[...y],Data:[s.DataTableModule]},layoutSettings:{hideToolbar:!0,mainHeight:20,centerPage:!0}},classifier:{components:{Main:[s.DataTableModule,c.DatapointEditorModule],Classifiers:[o.ConfusionMatrixModule],Counterfactuals:[d.GeneratorModule],Predictions:[g.ScalarModule,...y],Explanations:[m.SalienceMapModule]}},lm:{components:{Main:[l.EmbeddingsModule,s.DataTableModule,c.DatapointEditorModule],Predictions:[h.LanguageModelPredictionModule,o.ConfusionMatrixModule],Counterfactuals:[d.GeneratorModule]}},spangraph:{components:{Main:[s.DataTableModule,c.DatapointEditorModule],Predictions:[v.SpanGraphGoldModule,v.SpanGraphModule],Performance:[f.MetricsModule],Counterfactuals:[d.GeneratorModule]}},default:{components:{Main:[l.EmbeddingsModule,s.DataTableModule,c.DatapointEditorModule],Performance:[f.MetricsModule,o.ConfusionMatrixModule],Predictions:[...y,g.ScalarModule],Explanations:[...y,m.SalienceMapModule,r.AttentionModule],Counterfactuals:[d.GeneratorModule],"Counterfactual Explanation":[a.CounterfactualExplainerModule]}}}},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.AttentionModule=void 0;const o=n(0),a=n(4);n(7);const s=n(13);n(5);const c=n(9),l=n(11);let u=class extends s.LitModule{constructor(){super(...arguments),this.selectedHeadIndex=0}static get styles(){return l.styles}firstUpdated(){this.reactImmediately(()=>this.selectionService.primarySelectedInputData,t=>{this.updateSelection(t)})}updateSelection(t){return i(this,void 0,void 0,(function*(){if(null===t)this.preds=void 0;else{const e=this.appState.currentDataset,n=this.apiService.getPreds([t],this.model,e,["Tokens","AttentionHeads"],"Fetching attention"),r=yield this.loadLatest("attentionAndTokens",n);if(null===r)return;this.preds=r[0]}}))}render(){return this.preds?o.html`
      <div>
        ${this.renderAttnHeadDropdown()}
        ${this.renderIdxDropdown()}
      </div>
        ${this.renderAttnHead()}
      `:null}renderAttnHead(){const t=this.appState.currentModelSpecs[this.model].spec.output[this.selectedLayer].align,e=this.preds[t[0]],n=this.preds[t[1]],r=e.map(t=>t.length+1),i=n.map(t=>t.length+1),a=o.svg`${e.join(" ")}`,s=o.svg`${n.join(" ")}`,l=6.5*Math.max(c.sumArray(r),c.sumArray(i));return o.svg`
    <svg width=${l} height=${164}
      font-family="'Share Tech Mono', monospace"
      font-size="${12}px">
      <text y=${20}> ${s}</text>
      ${this.renderAttnLines(100,6.5,25,r,i)}
      <text y=${140}> ${a}</text>
    </svg>
    `}renderAttnLines(t,e,n,r,i){const a=c.cumSumArray(r),s=c.cumSumArray(i),l=n,u=n+t;return this.preds[this.selectedLayer][this.selectedHeadIndex].map((t,n)=>o.svg`
            ${t.map((t,c)=>o.svg`
                <line
                  x1=${(t=>(a[t]-r[t]/2)*e)(c)}
                  y1=${l}
                  x2=${(t=>(s[t]-i[t]/2)*e)(n)}
                  y2=${u}
                  stroke="rgba(100,3,250,${t})"
                  stroke-width=2>
                </line>`)}`)}renderAttnHeadDropdown(){const t=this.appState.currentModelSpecs[this.model].spec.output,e=c.findSpecKeys(t,"AttentionHeads");void 0===this.selectedLayer&&(this.selectedLayer=e[0]);return o.html`
        <select class="dropdown" @change=${t=>this.selectedLayer=t.target.value}>
          ${e.map(t=>o.html`<option value=${t}>${t}</option>`)}
        </select>`}renderIdxDropdown(){const t=this.preds[this.selectedLayer].length,e=Array.from({length:t},(t,e)=>e);return o.html`
    <select class="dropdown" @change=${t=>this.selectedHeadIndex=Number(t.target.value)}>
      ${e.map(t=>o.html`<option value=${t}>${t}</option>`)}
    </select>`}static shouldDisplayModule(t,e){return c.doesOutputSpecContain(t,"AttentionHeads")}};u.title="Attention",u.numCols=6,u.duplicateForExampleComparison=!0,u.template=(t="",e=0)=>o.html`<attention-module model=${t} selectionServiceIndex=${e}></attention-module>`,r([a.observable],u.prototype,"selectedLayer",void 0),r([a.observable],u.prototype,"selectedHeadIndex",void 0),r([a.observable],u.prototype,"preds",void 0),u=r([o.customElement("attention-module")],u),e.AttentionModule=u},function(t,e,n){"use strict";n.r(e),n.d(e,"styles",(function(){return r}));const r=n(0).css`th {
  font-size: 8pt;
  padding-right: 8px;
}

td {
  font-size: 10pt
}

.classification-cell {
  position: relative;
  display: flex;
  width: 200px;
}

.classification-row-title {
  font-size: 10pt;
}

.classification-row-holder {
  padding-bottom: 10px;
}
`},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.ConfusionMatrixModule=void 0;const o=n(0),a=n(8),s=n(4),c=n(7),l=n(13);n(5);const u=n(9);n(31);const d=n(29),h=n(10),f=n(88),p=n(11);let m=class extends l.LitModule{constructor(){super(),this.classificationService=c.app.getService(h.ClassificationService),this.groupService=c.app.getService(d.GroupService),this.hideEmptyLabels=!1,this.selectedRowOption=0,this.selectedColOption=0,this.matrixCells=[],this.setInitialOptions()}static get styles(){return[p.styles,f.styles]}firstUpdated(){this.react(()=>this.appState.currentInputData,t=>{this.calculateMatrix()});this.react(()=>this.classificationService.allMarginSettings,t=>{this.calculateMatrix()});this.react(()=>this.selectionService.selectedInputData,t=>{this.selectionService.lastUser!==this&&this.calculateMatrix()}),this.calculateMatrix()}setInitialOptions(){for(let t=0;t<this.options.length;t++){const e=this.options[t].parent;if(void 0!==e){for(let t=0;t<this.options.length;t++)if(this.options[t].name===e){this.selectedRowOption=t;break}this.selectedColOption=t;break}}}get options(){const t=this.appState.currentModels,e=[],n=this.groupService.categoricalFeatures;for(const t of Object.keys(n)){const r=n[t],o=(e,n)=>this.groupService.getFeatureValForInput(e,n,t),a=t=>i(this,void 0,void 0,(function*(){return t.map(o)}));e.push({name:t,labelList:r,runner:a})}for(const n of t){const t=this.appState.getModelSpec(n).output;for(const r of u.findSpecKeys(t,"MulticlassPreds")){const o=t[r].parent,a=t[r].vocab,s=t=>i(this,void 0,void 0,(function*(){const e=(yield this.classificationService.getClassificationPreds(t,n,this.appState.currentDataset)).map((e,o)=>i(this,void 0,void 0,(function*(){return this.classificationService.getResults([t[o].id],n,r)})));return(yield Promise.all(e)).map(t=>a[t[0].predictedClassIdx])}));e.push({name:`${n}:${r}`,labelList:a,runner:s,parent:o})}}return e}calculateMatrix(){return i(this,void 0,void 0,(function*(){const t=this.options[this.selectedRowOption],e=this.options[this.selectedColOption],n=t.labelList,r=e.labelList,i=t.name,o=e.name,a=this.selectionService.selectedOrAllInputData;if(0===a.length)return;const s=t.runner(a),c=e.runner(a),l=Promise.all([s,c]),d=yield this.loadLatest("rowAndColIdxs",l);if(null===d)return;const h={[i]:d[0],[o]:d[1]},f=this.groupService.groupExamplesByFeatures(a,[i,o],(t,e,n)=>h[n][e]);this.matrixCells=n.map(t=>r.map(e=>{const n={[o]:e,[i]:t},r=f[u.objToDictKey(n)];return{examples:r?r.data:[],selected:!1}}))}))}render(){return o.html`
     ${this.renderControls()}
     ${this.renderMatrix()}
    `}renderControls(){return o.html`
      <div class="controls-holder">
        <div class="dropdown-holder">
          <label class="dropdown-label">Rows</label>
          <select class="dropdown" @change=${t=>{this.selectedRowOption=+t.target.value,this.calculateMatrix()}}>
            ${this.options.map((t,e)=>o.html`
              <option ?selected=${this.selectedRowOption===e} value=${e}>
                ${t.name}
              </option>`)}
          </select>
        </div>
        <div class="dropdown-holder">
          <label class="dropdown-label">Columns</label>
          <select class="dropdown" @change=${t=>{this.selectedColOption=+t.target.value,this.calculateMatrix()}}>
            ${this.options.map((t,e)=>o.html`
              <option ?selected=${this.selectedColOption===e} value=${e}>
                ${t.name}
               </option>`)}
          </select>
        </div>
        <lit-checkbox
          label="Hide empty labels"
          ?checked=${this.hideEmptyLabels}
          @change=${()=>{this.hideEmptyLabels=!this.hideEmptyLabels,this.calculateMatrix()}}>
        </lit-checkbox>
      </div>
    `}renderMatrix(){const t=this.options[this.selectedRowOption],e=this.options[this.selectedColOption],n=t.labelList,r=e.labelList;if(0===this.matrixCells.length)return null;const i=new Set,s=new Set;this.matrixCells.forEach((t,e)=>{t.forEach((t,o)=>{t.examples.length>0&&(i.add(n[e]),s.add(r[o]))})});const c=(t,e)=>this.hideEmptyLabels&&!s.has(t)?null:o.html`<th class="header-cell" @click=${()=>{const t=this.matrixCells.map(t=>t[e]),n=t.every(t=>t.selected);t.forEach(t=>{t.selected=!n}),this.updateSelection()}}>${t}</th>`,l=(t,e)=>{var n;if(null==(null===(n=this.matrixCells[t])||void 0===n?void 0:n[e]))return null;const i=this.matrixCells[t][e],c=a.classMap({cell:!0,selected:i.selected,diagonal:e===t});return this.hideEmptyLabels&&!s.has(r[e])?null:o.html`
          <td class=${c} @click=${()=>{i.selected=!i.selected,this.updateSelection()}}>
            ${i.examples.length}
          </td>`},u=(t,e)=>this.hideEmptyLabels&&!i.has(t)?null:o.html`
          <tr>
            <th class="header-cell" @click=${()=>{const t=this.matrixCells[e],n=t.every(t=>t.selected);t.forEach(t=>{t.selected=!n}),this.updateSelection()}}>${t}</th>
            ${r.map((t,n)=>l(e,n))}
          </tr>`;return o.html`
      <div class="matrix-holder">
        <div class="column-title">${e.name}</div>
        <div class="table-and-row-title-holder">
          <div class="row-title">${t.name}</div>
          <table>
            <tr>
              <th></th>
              ${r.map((t,e)=>c(t,e))}
            </tr>
            ${n.map((t,e)=>u(t,e))}
          </table>
        </div>
      </div>
      `}updateSelection(){const t=this.matrixCells.flat();let e=[];t.forEach(t=>{t.selected&&(e=e.concat(t.examples.map(t=>t.id)))}),this.selectionService.selectIds(e,this)}static shouldDisplayModule(t,e){return u.doesOutputSpecContain(t,"MulticlassPreds")}};m.title="Confusion Matrix",m.template=(t="")=>o.html`
      <confusion-matrix-module model=${t}>
      </confusion-matrix-module>`,m.duplicateForModelComparison=!1,r([s.observable],m.prototype,"hideEmptyLabels",void 0),r([s.observable],m.prototype,"matrixCells",void 0),r([s.computed],m.prototype,"options",null),m=r([o.customElement("confusion-matrix-module")],m),e.ConfusionMatrixModule=m},function(t,e,n){"use strict";n.r(e),n.d(e,"styles",(function(){return r}));const r=n(0).css`:host {
  display:flex;
  flex-direction: column;
}

.controls-holder {
  display: flex;
  flex-flow: row wrap;
  margin-bottom: 10px;
}

.cell {
  cursor: pointer;
  background: #e6e6e6;
}

.header-cell {
  cursor: pointer;
}

.cell.diagonal {
  background: #b5bcc3;
}

.cell.selected {
  background: #ffe839;
}

.cell:hover {
  background: #faf49f;
}

.dropdown {
  max-width: fit-content;
}

.dropdown-holder {
  padding: 0 8px;
}

/* Make the "Rows" and "Columns" labels the same width */
.dropdown-label {
  display: inline-block;
  width: 55px;
}

.matrix-holder {
  width: fit-content;
}

.table-and-row-title-holder {
  display: flex;
  width: fit-content;
}

.row-title {
  font-size: 11px;
  writing-mode: vertical-rl;
  transform: rotate(180deg);
  text-align: center;
  margin-right: 10px;
}

.column-title {
  font-size: 11px;
  margin-bottom: 5px;
  margin-left: 28px;
  text-align: center;
}
`},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.CounterfactualExplainerModule=e.SignedSalienceCmap=void 0,n(36),n(39);const o=n(0),a=n(8),s=n(15),c=n(4);n(7);const l=n(13);n(5);const u=n(9),d=n(60),h=n(11);class f extends class{constructor(t=1){this.gamma=t}}{bgCmap(t){let e=188;t<0&&(e=354,t=Math.abs(t));return`hsl(${e}, 50%, ${25+75*Math.pow(1-t,this.gamma)}%)`}textCmap(t){return Math.abs(t)>.1?"white":"black"}}e.SignedSalienceCmap=f;let p=class extends l.LitModule{constructor(){super(...arguments),this.model="",this.selectionServiceIndex=0,this.selectedClass=0,this.selectedPredKey="",this.state={autorun:!0,isLoading:!1,salience:{},cmap:new f(4)}}static get styles(){return[h.styles,d.styles,o.css`
        .options-dropdown {
          margin-right: 10px;
          margin-top: 10px;
          margin-bottom: 10px;
          min-width: 100px;
      }
      `]}firstUpdated(){this.react(()=>this.selectionService.primarySelectedInputData,t=>{this.state.autorun?this.runInterpreter():this.state.salience={}});this.react(()=>this.selectionService.selectedInputData,t=>{this.state.autorun?this.runInterpreter():this.state.salience={}});this.react(()=>this.state.autorun,t=>{t&&this.runInterpreter()});this.react(()=>this.selectedClass,t=>{this.state.autorun&&this.runInterpreter()});this.react(()=>this.selectedPredKey,t=>{this.state.autorun&&this.runInterpreter()}),this.state.autorun&&this.runInterpreter()}runInterpreter(){return i(this,void 0,void 0,(function*(){const t="counterfactual explainer",e=this.selectionService.primarySelectedInputData;if(null==e)return void(this.state.salience={});const n=this.selectionService.selectedInputData.filter(t=>t.id!==e.id);if(""===this.selectedPredKey)return;const r={class_to_explain:this.selectedClass,lowercase_tokens:!0,pred_key:this.selectedPredKey};this.state.isLoading=!0;const i=this.apiService.getInterpretations([e,...n],this.model,this.appState.currentDataset,t,r,"Running "+t),o=yield this.loadLatest("interpretations-"+t,i);this.state.isLoading=!1,null!==o&&(this.state.salience=o[0])}))}updated(){this.shadowRoot.querySelectorAll(".tokens-group").forEach(t=>{const e=t.querySelector(".salience-tooltip");t.querySelectorAll(".salient-token").forEach(t=>{t.onmouseover=function(){e.innerText=this.dataset.tooltip,e.style.visibility="visible";const t=this.getBoundingClientRect();e.style.left=(t.left+t.right)/2+"px",e.style.top=t.bottom+"px"},t.onmouseout=function(){e.style.visibility="hidden"}})})}renderToken(t,e,n){const r=s.styleMap({color:n.textCmap(e),"background-color":n.bgCmap(e)});return o.html`
      <div class="salient-token" style=${r}
        data-tooltip=${e.toPrecision(3)}>
        ${t}
      </div>`}renderGroup(t,e,n){const r=t[e].tokens,i=t[e].salience,a=r.map((t,e)=>this.renderToken(t,i[e],n));return o.html`
      <div class="tokens-group">
        <div class="tokens-group-title">
          ${e}
        </div>
        <div class="tokens-holder">
          ${a}
        </div>
        <div class="salience-tooltip">
        </div>
      </div>
    `}renderSpinner(){return o.html`
      <div class="spinner-container">
        <lit-spinner size=${24} color="var(--app-secondary-color)">
        </lit-spinner>
      </div>
    `}render(){const t=this.state.salience,e=this.state.cmap,n=this.appState.currentModelSpecs[this.model].spec.output,r=u.findSpecKeys(n,"MulticlassPreds");r.includes(this.selectedPredKey)||(this.selectedPredKey=r[0]);const i=n[this.selectedPredKey].vocab,s=null==i?[]:u.range(i.length);s.includes(this.selectedClass)||(this.selectedClass=s[s.length-1]);const c=r.map((t,e)=>o.html`<option value=${e}>
              ${t}</option>`),l=s.map((t,e)=>o.html`<option value=${e} >
              ${t}</option>`);return o.html`
      <label class="dropdown-label">Class to explain:</label>
      <select class="dropdown options-dropdown" @change=${t=>{const e=t.target;null!=e&&(this.selectedClass=+e.options[e.selectedIndex].value)}}>
         ${l}
      </select>
      <label class="dropdown-label">Model head:</label>
      <select class="dropdown options-dropdown" @change=${t=>{const e=t.target;null!=e&&(this.selectedPredKey=e.options[e.selectedIndex].value)}}>
         ${c}
      </select>
      <table>
        <tr>
          <th class='group-label'>
            ${"counterfactual explainer"}
            <lit-checkbox label="autorun"
              ?checked=${this.state.autorun}
              @change=${()=>{this.state.autorun=!this.state.autorun}}
            ></lit-checkbox>
          </th>
          <td class=${a.classMap({"group-container":!0,loading:this.state.isLoading})}>
            ${Object.keys(t).map(n=>this.renderGroup(t,n,e))}
            ${this.state.isLoading?this.renderSpinner():null}
          </td>
        </tr>
      </table>
    `}static shouldDisplayModule(t,e){for(const e of Object.keys(t)){const n=t[e].spec.input,r=t[e].spec.output;if(u.findSpecKeys(n,"TextSegment").length&&u.findSpecKeys(r,"MulticlassPreds").length)return!0}return!1}};p.title="Counterfactual Explanation",p.numCols=6,p.duplicateForExampleComparison=!0,p.template=(t="",e=0)=>o.html`<counterfactual-explainer-module model=${t} selectionServiceIndex=${e}></counterfactual-explainer-module>`,r([o.property({type:String})],p.prototype,"model",void 0),r([o.property({type:Number})],p.prototype,"selectionServiceIndex",void 0),r([c.observable],p.prototype,"selectedClass",void 0),r([c.observable],p.prototype,"selectedPredKey",void 0),r([c.observable],p.prototype,"state",void 0),p=r([o.customElement("counterfactual-explainer-module")],p),e.CounterfactualExplainerModule=p},function(t,e,n){"use strict";n.r(e),n.d(e,"styles",(function(){return r}));const r=n(0).css`:host {
  --table-header-height: 40px;
  --toolbar-height: 43px;
}

.toolbar{
  font-family: 'Google Sans', sans-serif !important;
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  height: var(--toolbar-height);
}

#toolbar-buttons{
  margin-bottom: 6px;
}

#holder{
  display: flex;
  flex-direction: column;
  height: 100%;
}

#table-container{
  height: calc(100% - var(--toolbar-height));
  overflow: visible;
}

#rows-container{
  width: 100%;
  height: calc(100% - var(--table-header-height));
  overflow-y: auto;
}

#rows {
  width: 100%;
}

#header-container {
  width: 100%;
  overflow-x:hidden;
}

#header {
  display: flex;
  flex-direction: row;
  align-items: center;
  min-width: 100%;
}

.column-header {
  background: #f5fcfc;
  font-weight: 400;
  font-size: 10pt;
  line-height: 12pt;
  color: #04394b;
  border-bottom: solid 1px #dadce0;
  padding: 5px 2px;
  cursor: pointer;
  display: flex;
  align-items: center;
  position: relative;
  box-sizing: border-box;
  height: var(--table-header-height);
}

.header-text {
  flex: 1;
  text-align: center;
  text-overflow: ellipsis;
  overflow: hidden;
  max-height: 100%;
}

.arrow-container {
  width: 20px;
  height: 20px;
  right: 2px;
  position: relative;
  user-select: none;
}

.arrow {
  position: absolute;
  --mdc-icon-size: 24px;
  color: rgba(0,0,0,0.1);
}

.arrow.up {
  top: -5px;
}

.arrow.down {
  top: 3px;
}

.arrow.active {
  color: var(--app-dark-color);
}

.arrow.inactive {
  color: rgba(0,0,0,0);
}

.menu-button-container {
  width: 20px;
  height: 20px;
  user-select: none;
}

.menu-button {
  --mdc-icon-size: 20px;
}

.menu-button:hover {
  opacity: .7;
}

.togglable-menu-holder {
  background-color: #eff6f8; /* light gray-blue */
  border: 1px solid;
  border-radius: 2pt;
  border-color: rgb(218, 220, 224);
  position: absolute;
}

#search-menu-container {
  width:100%;
}

table {
  min-width: 100%;
  border-spacing: 0;
  font-family: 'Google Sans', sans-serif;
  font-size: 10pt;
  line-height: 12pt;
  margin: 1px; /* don't clip outline if there's a reference selection */
}

thead {
  display: table-header-group;
  vertical-align: middle;
  border-color: inherit;
}

tr {
  display: table-row;
  vertical-align: inherit;
  border-color: inherit;
}

tr:hover {
  background: #f8f9fa;
}

tr.selected {
  background: #c5e4e8;
  color: #04394b;
  transition-duration: 0.2s;
  transition-property: background-color;
}

tr.primary-selected {
  background: #9bb7ba;
  color: #04394b;
  transition-duration: 0.2s;
  transition-property: background-color;
}

tr.reference-selected {
  outline: 1px solid #2f8c9b;
}

td {
  vertical-align: middle;
  min-width: 80px;
  padding: 5px 10px;
  box-sizing: border-box;
}

.n-rows {
  margin-left: 20px;
}

/* For in-line icons in a <span> */
[data-icon] {
  margin: 0;
}

[data-icon]:before {
  font-family: 'Material Icons';
  content: attr(data-icon);
  vertical-align: middle;
}

/* Column settings */
.column-button {
  position: absolute;
  right: 15px;
  top: 5px;
  width: 100px;
}

.column-dropdown-hide {
  visibility:hidden;
  position: absolute;
}

.column-dropdown {
  top: 50px;
  right: 15px;
  padding: 10px;
  background: white;
  border: 1px solid gray;
  position: absolute;
  visibility:visible;
  z-index: 1000;
}
`},function(t,e,n){"use strict";n.r(e),n.d(e,"styles",(function(){return r}));const r=n(0).css``},function(t,e,n){"use strict";n.r(e),n.d(e,"styles",(function(){return r}));const r=n(0).css`.staged-text {
  margin-bottom: 10px;
}

#container {
  display: flex;
  flex-direction: column;
  width: 100%;
}

.input-box {
  width: 95%;
}

.input-short {
  width: 95%;
}

.button-holder {
  display: flex;
}

.entry {
  margin: 15px 5px;
}

textarea {
  resize: vertical;
  height: 100px;
}

.span-label {
  font-family: Monospace;
}
`},function(t,e,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&i(e,t,n);return o(e,t),e},c=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.EmbeddingsModule=void 0;const l=s(n(20)),u=n(94),d=n(0);n(3);const h=n(4),f=n(7),p=n(13),m=n(106);n(5);const g=n(9),v=n(10),y=n(107),b=n(11);let x=r=class extends p.LitModule{constructor(){super(),this.projectorName="umap",this.projectedPoints=[],this.colorService=f.app.getService(v.ColorService),this.embeddingCache=new Map,this.selectedEmbeddingsIndex=0,this.selectedLabelIndex=0,this.appState.currentInputData.length>1e3&&(this.projectorName="pca")}static get styles(){return[b.styles,y.styles]}get projector(){return r.projectorChoices[this.projectorName]}get currentInputIndicesById(){const t=new Map;return this.appState.currentInputData.forEach((e,n)=>{t.set(e.id,n)}),t}get embeddingOptions(){return this.appState.currentModels.flatMap(t=>{const e=this.appState.metadata.models[t].spec;return g.findSpecKeys(e.output,"Embeddings").map(e=>({modelName:t,fieldName:e}))})}get embeddingOptionNames(){return this.embeddingOptions.map(t=>`${t.modelName}:${t.fieldName}`)}get displayLabels(){return this.appState.currentInputData.map(t=>{const e=Object.keys(t.data)[this.selectedLabelIndex];return{label:t.data[e],added:t.meta.added}})}get scatterGLDataset(){if(0===this.projectedPoints.length)return null;const t=this.displayLabels.slice(0,this.projectedPoints.length);return new u.Dataset(this.projectedPoints,t)}getEmbeddingCache(t,e){const n=`${t}:${e}`;if(!this.embeddingCache.has(n)){const r=t=>t.id,i=n=>c(this,void 0,void 0,(function*(){return this.apiService.getPreds(n,e,t,["Embeddings"],"Fetching embeddings")})),o=new m.BatchRequestCache(i,r);this.embeddingCache.set(n,o)}return this.embeddingCache.get(n)}firstUpdated(){const t=this.shadowRoot.getElementById("scatter-gl-container");this.scatterGL=new u.ScatterGL(t,{pointColorer:(t,e,n)=>this.pointColorer(t,e,n),onSelect:this.onSelect.bind(this),rotateOnStart:!1}),this.setupReactions();const e=this.shadowRoot.getElementById("scatter-gl-container");this.resizeObserver=new ResizeObserver(()=>{this.handleResize()}),this.resizeObserver.observe(e)}handleResize(){this.shadowRoot.getElementById("scatter-gl-container").offsetWidth>0&&this.scatterGL.resize()}setupReactions(){this.react(()=>this.colorService.all,t=>{this.updateScatterGL()});this.reactImmediately(()=>[this.appState.currentInputData,this.selectedEmbeddingsIndex,this.projectorName],()=>{this.computeProjectedEmbeddings()},{delay:.2}),this.reactImmediately(()=>this.scatterGLDataset,t=>{this.updateScatterGL()}),this.reactImmediately(()=>this.selectionService.selectedIds,t=>{const e=this.uniqueIdsToIndices(t);this.scatterGL.select(e)})}updateScatterGL(){this.scatterGLDataset&&(this.scatterGL.render(this.scatterGLDataset),this.scatterGL.render(this.scatterGLDataset))}uniqueIdsToIndices(t){return t.map(t=>this.currentInputIndicesById.get(t)).filter(t=>void 0!==t)}computeBackendEmbeddings(t){return c(this,void 0,void 0,(function*(){const e=this.embeddingOptions[this.selectedEmbeddingsIndex];if(!e)return;const{modelName:n,fieldName:r}=e,i=this.appState.currentInputData,o=this.appState.currentDataset,a={dataset_name:o,model_name:n,field_name:r,proj_kw:{n_components:3}},s=this.apiService.getInterpretations(i,n,o,t,a,"Fetching projections"),c=yield this.loadLatest("proj-"+JSON.stringify(a),s);null!==c&&(this.projectedPoints=c.map(t=>t.z))}))}computeProjectedEmbeddings(){return c(this,void 0,void 0,(function*(){if(this.appState.currentInputData.length)return this.computeBackendEmbeddings(this.projector.interpreterName);this.projectedPoints=[]}))}pointColorer(t,e,n){const r=this.appState.currentInputData[t],i=this.colorService.getDatapointColor(r),o=l.color(i);return null==r||this.selectionService.isIdSelected(r.id)||(o.opacity=0===this.selectionService.selectedInputData.length?.7:.1),o.toString()}onSelect(t){const e=this.appState.currentInputData.filter((e,n)=>t.includes(n)).map(t=>t.id);this.selectionService.selectIds(e)}render(){return d.html`
      <div class="container">
        <div class="toolbar-container flex-row">
          ${this.renderProjectorSelect()}
          ${this.renderEmbeddingsSelect()}
          ${this.renderLabelBySelect()}
        </div>
        <div id="scatter-gl-container"></div>
      </div>
    `}renderSpinner(){return d.html`
      <div class="spinner-container">
        <lit-spinner size=${36} color="var(--app-dark-color)"></lit-spinner>
      </div>`}renderProjectorSelect(){const t=r.projectorChoices,e=Object.keys(t).map(e=>d.html`
        <option value=${e} ?selected=${e===this.projectorName}>
          ${t[e].displayName}
        </option>
      `);return this.renderSelect("Projector",e,e=>{const n=e.target,r=(null==n?void 0:n.selectedIndex)||0;this.projectorName=Object.keys(t)[r]},this.projectorName)}renderEmbeddingsSelect(){const t=this.embeddingOptionNames,e=t.map((t,e)=>d.html`
        <option value=${e}>${t}</option>
      `);return this.renderSelect("Embedding",e,t=>{const e=t.target;this.selectedEmbeddingsIndex=(null==e?void 0:e.selectedIndex)||0},t[0])}renderLabelBySelect(){var t;const e=this.appState.currentInputData,n=null===e||0===e.length?[]:Object.keys(e[0].data),r=n.map((t,e)=>d.html`<option value=${e}>${t}</option>`);return this.renderSelect("Label by",r,t=>{const e=t.target;this.selectedLabelIndex=(null==e?void 0:e.selectedIndex)||0},null!==(t=n[0])&&void 0!==t?t:"")}renderSelect(t,e,n,r){return d.html`
      <div class="dropdown-container">
        <label class="dropdown-label">${t}</label>
        <select class="dropdown" @change=${n} .value=${r}>
          ${e}
        </select>
      </div>
    `}static shouldDisplayModule(t,e){return g.doesOutputSpecContain(t,"Embeddings")}};x.title="Embeddings",x.template=()=>d.html`<embeddings-module></embeddings-module>`,x.duplicateForModelComparison=!1,x.projectorChoices={pca:{displayName:"PCA",interpreterName:"pca"},umap:{displayName:"UMAP",interpreterName:"umap"}},a([h.observable],x.prototype,"projectorName",void 0),a([h.computed],x.prototype,"projector",null),a([h.observable],x.prototype,"projectedPoints",void 0),a([h.observable],x.prototype,"selectedEmbeddingsIndex",void 0),a([h.observable],x.prototype,"selectedLabelIndex",void 0),a([h.computed],x.prototype,"currentInputIndicesById",null),a([h.computed],x.prototype,"embeddingOptions",null),a([h.computed],x.prototype,"embeddingOptionNames",null),a([h.computed],x.prototype,"displayLabels",null),a([h.computed],x.prototype,"scatterGLDataset",null),x=r=a([d.customElement("embeddings-module")],x),e.EmbeddingsModule=x},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(95);e.ScatterGL=r.ScatterGL;var i=n(62);e.Dataset=i.Dataset},function(t,e,n){"use strict";var r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(r(arguments[e]));return t},o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0});var a=n(96),s=n(99),c=n(62),l=n(43),u=n(100),d=n(32),h=n(44),f=n(101),p=n(102),m=n(103),g=n(105),v=function(){function t(t,e){var n=this;void 0===e&&(e={}),this.pointColorer=null,this.sequences=[],this.renderMode="POINT",this.rotateOnStart=!0,this.selectEnabled=!0,this.showLabelsOnHover=!0,this.hoverPointIndex=null,this.selectedPointIndices=new Set,this.clickCallback=function(){},this.hoverCallback=function(){},this.selectCallback=function(){},this.cameraMoveCallback=function(){},this.onHover=function(t){n.hoverCallback(t),n.hoverPointIndex=t,n.updateScatterPlotAttributes(),n.renderScatterPlot()},this.onClick=function(t){n.clickCallback(t)},this.select=function(t){n.selectEnabled&&(n.selectedPointIndices=new Set(t),n.updateScatterPlotAttributes(),n.renderScatterPlot())},this.onSelect=function(t){n.selectEnabled&&(n.selectCallback(t),n.select(t))},this.containerElement=t,this.styles=u.makeStyles(e.styles),this.setParameters(e),this.scatterPlot=new a.ScatterPlot(t,{camera:e.camera,onClick:this.onClick,onHover:this.onHover,onSelect:this.onSelect,selectEnabled:this.selectEnabled,styles:this.styles}),this.scatterPlot.onCameraMove(this.cameraMoveCallback)}return t.prototype.setParameters=function(t){void 0!==t.onClick&&(this.clickCallback=t.onClick),void 0!==t.onHover&&(this.hoverCallback=t.onHover),void 0!==t.onSelect&&(this.selectCallback=t.onSelect),void 0!==t.onCameraMove&&(this.cameraMoveCallback=t.onCameraMove),void 0!==t.pointColorer&&(this.pointColorer=t.pointColorer),void 0!==t.renderMode&&(this.renderMode=t.renderMode),void 0!==t.rotateOnStart&&(this.rotateOnStart=t.rotateOnStart),void 0!==t.selectEnabled&&(this.selectEnabled=t.selectEnabled),void 0!==t.showLabelsOnHover&&(this.showLabelsOnHover=t.showLabelsOnHover)},t.prototype.render=function(t){this.updateDataset(t),this.setVisualizers(),this.rotateOnStart&&this.scatterPlot.startOrbitAnimation()},t.prototype.renderScatterPlot=function(){this.dataset&&this.scatterPlot.render()},t.prototype.setRenderMode=function(t){this.renderMode=t,this.setVisualizers(),this.updateScatterPlotAttributes(),this.updateScatterPlotPositions()},t.prototype.setTextRenderMode=function(){this.setRenderMode("TEXT"),this.renderScatterPlot()},t.prototype.setPointRenderMode=function(){this.setRenderMode("POINT"),this.renderScatterPlot()},t.prototype.setSpriteRenderMode=function(){this.dataset&&this.dataset.spriteMetadata&&(this.setRenderMode("SPRITE"),this.renderScatterPlot())},t.prototype.setSequences=function(t){this.sequences=t,this.updatePolylineAttributes(),this.setVisualizers(),this.renderScatterPlot()},t.prototype.setPanMode=function(){this.scatterPlot.setInteractionMode("PAN")},t.prototype.setSelectMode=function(){this.scatterPlot.setInteractionMode("SELECT")},t.prototype.setDimensions=function(t){var e=t<2||t>3,n=this.dataset&&t>this.dataset.dimensions;if(e||n)throw new RangeError("Setting invalid dimensionality");this.scatterPlot.setDimensions(t),this.renderScatterPlot()},t.prototype.setPointColorer=function(t){this.pointColorer=t,this.updateScatterPlotAttributes(),this.renderScatterPlot()},t.prototype.callPointColorer=function(t,e){return t(e,this.selectedPointIndices,this.hoverPointIndex)},t.prototype.setHoverPointIndex=function(t){this.hoverPointIndex=t,this.updateScatterPlotAttributes(),this.scatterPlot.orbitIsAnimating()||this.renderScatterPlot()},t.prototype.resize=function(){this.scatterPlot.resize()},t.prototype.updateDataset=function(t){this.setDataset(t),this.scatterPlot.setDimensions(t.dimensions),this.updateScatterPlotAttributes(),this.updateScatterPlotPositions(),this.renderScatterPlot()},t.prototype.isOrbiting=function(){return this.scatterPlot.orbitIsAnimating()},t.prototype.startOrbitAnimation=function(){this.scatterPlot.startOrbitAnimation()},t.prototype.stopOrbitAnimation=function(){this.scatterPlot.stopOrbitAnimation()},t.prototype.setDataset=function(t){this.dataset=t,this.labels3DVisualizer&&this.labels3DVisualizer.setLabelStrings(this.generate3DLabelsArray())},t.prototype.updateScatterPlotPositions=function(){var t=this.dataset;if(t){var e=this.generatePointPositionArray(t);this.scatterPlot.setPointPositions(e)}},t.prototype.updateScatterPlotAttributes=function(){var t=this.dataset;if(t){var e=this.generatePointColorArray(t),n=this.generatePointScaleFactorArray(t),r=this.generateVisibleLabelRenderParams(t);this.scatterPlot.setPointColors(e),this.scatterPlot.setPointScaleFactors(n),this.scatterPlot.setLabels(r)}},t.prototype.updatePolylineAttributes=function(){var t=this.dataset;if(t){var e=this.generateLineSegmentColorMap(t),n=this.generateLineSegmentOpacityArray(t),r=this.generateLineSegmentWidthArray(t);this.scatterPlot.setPolylineColors(e),this.scatterPlot.setPolylineOpacities(n),this.scatterPlot.setPolylineWidths(r)}},t.prototype.generatePointPositionArray=function(t){var e,n,r=[0,0];e=d.extent(t.points.map((function(t){return t[0]}))),n=d.extent(t.points.map((function(t){return t[1]}))),3===t.dimensions&&(r=d.extent(t.points.map((function(t){return t[2]}))));var i=function(t){return Math.abs(t[1]-t[0])},o=i(e),a=i(n),s=i(r),c=Math.max(o,a,s),l=h.SCATTER_PLOT_CUBE_LENGTH/2,u=function(t,e){return[t/c*-e,e*(t/c)]},f=u(o,l),p=u(a,l),m=u(s,l),g=new Float32Array(3*t.points.length),v=0;return t.points.forEach((function(i,o){var a=t.points[o];g[v++]=d.scaleLinear(a[0],e,f),g[v++]=d.scaleLinear(a[1],n,p),3===t.dimensions?g[v++]=d.scaleLinear(a[2],r,m):g[v++]=0})),g},t.prototype.generateVisibleLabelRenderParams=function(t){var e=this.hoverPointIndex,n=this.selectedPointIndices,r=this.styles,o=n.size+(null!==e?1:0),a=new Uint32Array(o),s=new Float32Array(o),c=new Int8Array(o),u=new Uint8Array(3*o),h=new Uint8Array(3*o),f=[];s.fill(r.label.scaleDefault),c.fill(1);var p=0;if(null!==e){f.push(this.getLabelText(e)),a[p]=e,s[p]=r.label.scaleLarge,c[p]=0;var m=d.styleRgbFromHexColor(r.label.fillColorHover);d.packRgbIntoUint8Array(u,p,m[0],m[1],m[2]);var g=d.styleRgbFromHexColor(r.label.strokeColorHover);d.packRgbIntoUint8Array(h,p,g[0],g[1],g[1]),++p}m=d.styleRgbFromHexColor(r.label.fillColorSelected),g=d.styleRgbFromHexColor(r.label.strokeColorSelected);if(1===n.size){var v=i(n)[0];f.push(this.getLabelText(v)),a[p]=v,s[p]=r.label.scaleLarge,c[p]=0,d.packRgbIntoUint8Array(u,p,m[0],m[1],m[2]),d.packRgbIntoUint8Array(h,p,g[0],g[1],g[2])}return new l.LabelRenderParams(new Float32Array(a),f,s,c,r.label.fontSize,u,h)},t.prototype.generatePointScaleFactorArray=function(t){var e,n,r=this.hoverPointIndex,i=this.selectedPointIndices,a=this.styles.point,s=a.scaleDefault,c=a.scaleSelected,l=a.scaleHover,u=new Float32Array(t.points.length);u.fill(s);i.size;try{for(var d=o(i.values()),h=d.next();!h.done;h=d.next()){u[h.value]=c}}catch(t){e={error:t}}finally{try{h&&!h.done&&(n=d.return)&&n.call(d)}finally{if(e)throw e.error}}return null!=r&&(u[r]=l),u},t.prototype.generatePointColorArray=function(t){var e,n,r=this.hoverPointIndex,i=this.pointColorer,a=this.selectedPointIndices,c=this.styles.point,l=c.colorHover,u=c.colorNoSelection,d=c.colorSelected,f=c.colorUnselected,p=new Float32Array(t.points.length*h.RGBA_NUM_ELEMENTS),m=f,g=u;"TEXT"===this.renderMode&&(m=this.styles.label3D.colorUnselected,g=this.styles.label3D.colorNoSelection),"SPRITE"===this.renderMode&&(m=this.styles.sprites.colorUnselected,g=this.styles.sprites.colorNoSelection);var v=t.points.length,y=this.selectedPointIndices.size;if(i)for(var b=0,x=0;x<v;++x){var _=s.parseColor(this.callPointColorer(i,x)||g);p[b++]=_.r,p[b++]=_.g,p[b++]=_.b,p[b++]=_.opacity}else{for(b=0,_=y>0?s.parseColor(m):s.parseColor(g),x=0;x<v;++x)p[b++]=_.r,p[b++]=_.g,p[b++]=_.b,p[b++]=_.opacity;_=s.parseColor(d);try{for(var w=o(a.values()),S=w.next();!S.done;S=w.next()){var M=S.value*h.RGBA_NUM_ELEMENTS;p[M++]=_.r,p[M++]=_.g,p[M++]=_.b,p[M++]=_.opacity}}catch(t){e={error:t}}finally{try{S&&!S.done&&(n=w.return)&&n.call(w)}finally{if(e)throw e.error}}if(null!=r){var E=s.parseColor(l),T=r*h.RGBA_NUM_ELEMENTS;p[T++]=E.r,p[T++]=E.g,p[T++]=E.b,p[T++]=E.opacity}}return p},t.prototype.generate3DLabelsArray=function(){var t=this.dataset;if(!t)return[];for(var e=[],n=t.points.length,r=0;r<n;++r)e.push(this.getLabelText(r));return e},t.prototype.generateLineSegmentColorMap=function(t){for(var e=this.pointColorer,n=this.styles,r={},i=0;i<this.sequences.length;i++){var o=this.sequences[i],a=new Float32Array(2*(o.indices.length-1)*3),c=0;if(e)for(var l=0;l<o.indices.length-1;l++){var u=s.parseColor(this.callPointColorer(e,o.indices[l])),h=s.parseColor(this.callPointColorer(e,o.indices[l+1]));a[c++]=u.r,a[c++]=u.g,a[c++]=u.b,a[c++]=h.r,a[c++]=h.g,a[c++]=h.b}else for(l=0;l<o.indices.length-1;l++){u=d.getDefaultPointInPolylineColor(l,o.indices.length,n.polyline.startHue,n.polyline.endHue,n.polyline.saturation,n.polyline.lightness),h=d.getDefaultPointInPolylineColor(l+1,o.indices.length,n.polyline.startHue,n.polyline.endHue,n.polyline.saturation,n.polyline.lightness);a[c++]=u.r,a[c++]=u.g,a[c++]=u.b,a[c++]=h.r,a[c++]=h.g,a[c++]=h.b}r[i]=a}return r},t.prototype.generateLineSegmentOpacityArray=function(t){var e=this.selectedPointIndices,n=this.styles,r=new Float32Array(this.sequences.length);if(e.size>0){r.fill(n.polyline.deselectedOpacity);var o=this.polylineVisualizer.getPointSequenceIndex(i(e)[0]);void 0!==o&&(r[o]=n.polyline.selectedOpacity)}else r.fill(n.polyline.defaultOpacity);return r},t.prototype.generateLineSegmentWidthArray=function(t){var e=this.selectedPointIndices,n=this.styles,r=new Float32Array(this.sequences.length);if(r.fill(n.polyline.defaultLineWidth),e.size>0){var o=this.polylineVisualizer.getPointSequenceIndex(i(e)[0]);void 0!==o&&(r[o]=n.polyline.selectedLineWidth)}return r},t.prototype.getLabelText=function(t){var e=this.dataset;if(!e)return"";var n=e.metadata[t];return n&&null!=n.label?""+n.label:""},t.prototype.initializeCanvasLabelsVisualizer=function(){return this.canvasLabelsVisualizer||(this.canvasLabelsVisualizer=new m.ScatterPlotVisualizerCanvasLabels(this.containerElement,this.styles)),this.canvasLabelsVisualizer},t.prototype.initialize3DLabelsVisualizer=function(){return this.labels3DVisualizer||(this.labels3DVisualizer=new f.ScatterPlotVisualizer3DLabels(this.styles)),this.labels3DVisualizer.setLabelStrings(this.generate3DLabelsArray()),this.labels3DVisualizer},t.prototype.initializePointVisualizer=function(){return this.pointVisualizer||(this.pointVisualizer=new p.ScatterPlotVisualizerSprites(this.styles)),this.pointVisualizer},t.prototype.initializeSpritesheetVisualizer=function(){var t=this,e=this.styles,n=this.dataset,r=n.spriteMetadata;if(!this.spritesheetVisualizer&&r){if(!r.spriteImage||!r.singleSpriteSize)return;for(var i=n.points.length,o=new Float32Array(i),a=0;a<i;++a)o[a]=a;var s=new p.ScatterPlotVisualizerSprites(e,{spritesheetImage:r.spriteImage,spriteDimensions:r.singleSpriteSize,spriteIndices:o,onImageLoad:function(){return t.renderScatterPlot()}});s.id="SPRITE_SHEET_VISUALIZER",this.spritesheetVisualizer=s}return this.spritesheetVisualizer},t.prototype.initializePolylineVisualizer=function(){return this.polylineVisualizer||(this.polylineVisualizer=new g.ScatterPlotVisualizerPolylines),this.polylineVisualizer.setSequences(this.sequences),this.polylineVisualizer},t.prototype.setVisualizers=function(){var t=this.dataset,e=this.renderMode,n=[];if("TEXT"===e){var r=this.initialize3DLabelsVisualizer();n.push(r)}else if("POINT"===e){r=this.initializePointVisualizer();n.push(r)}else if("SPRITE"===e&&t.spriteMetadata){(r=this.initializeSpritesheetVisualizer())&&n.push(r)}if(this.sequences.length>0){r=this.initializePolylineVisualizer();n.push(r)}if(("POINT"===e||"SPRITE"===e)&&this.showLabelsOnHover){r=this.initializeCanvasLabelsVisualizer();n.push(r)}this.scatterPlot.setActiveVisualizers(n)},t.Dataset=c.Dataset,t}();e.ScatterGL=v},function(t,e,n){"use strict";var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(e,"__esModule",{value:!0});var o=n(2),a=n(97),s=n(43),c=n(32),l=n(98),u=new o.Vector3(.45,.9,1.6),d=new o.Vector3(0,0,0),h=new o.Vector3(0,0,4),f=new o.Vector3(0,0,0),p=function(){function t(t,e){var n=this;this.clickCallback=function(){},this.hoverCallback=function(){},this.selectCallback=function(){},this.selectEnabled=!0,this.visualizers=new Map,this.onCameraMoveListeners=[],this.height=0,this.width=0,this.dimensions=3,this.interactionMode="PAN",this.pickingTexture=new o.WebGLRenderTarget(0,0),this.orbitAnimationOnNextCameraCreation=!1,this.orbitAnimationId=null,this.worldSpacePointPositions=new Float32Array(0),this.pointColors=new Float32Array(0),this.pointScaleFactors=new Float32Array(0),this.polylineColors={},this.polylineOpacities=new Float32Array(0),this.polylineWidths=new Float32Array(0),this.selecting=!1,this.nearestPoint=null,this.mouseIsDown=!1,this.isDragSequence=!1,this.lastHovered=null,this.container=t,this.styles=e.styles,this.setParameters(e),this.computeLayoutValues(),this.scene=new o.Scene,this.renderer=new o.WebGLRenderer({alpha:!0,premultipliedAlpha:!1,antialias:!1}),this.renderer.setClearColor(this.styles.backgroundColor,1),this.container.appendChild(this.renderer.domElement),this.light=new o.PointLight(16772287,1,0),this.scene.add(this.light),this.rectangleSelector=new l.ScatterPlotRectangleSelector(this.container,(function(t){return n.selectBoundingBox(t)}),this.styles),this.addInteractionListeners(),this.setDimensions(3),this.makeCamera(e.camera),this.resize()}return t.prototype.setParameters=function(t){void 0!==t.onClick&&(this.clickCallback=t.onClick),void 0!==t.onHover&&(this.hoverCallback=t.onHover),void 0!==t.onSelect&&(this.selectCallback=t.onSelect),void 0!==t.selectEnabled&&(this.selectEnabled=t.selectEnabled)},t.prototype.addInteractionListeners=function(){this.container.addEventListener("mousemove",this.onMouseMove.bind(this)),this.container.addEventListener("mousedown",this.onMouseDown.bind(this)),this.container.addEventListener("mouseup",this.onMouseUp.bind(this)),this.container.addEventListener("click",this.onClick.bind(this)),window.addEventListener("keydown",this.onKeyDown.bind(this),!1),window.addEventListener("keyup",this.onKeyUp.bind(this),!1)},t.prototype.addCameraControlsEventListeners=function(t){var e=this;t.addEventListener("start",(function(){e.stopOrbitAnimation(),e.onCameraMoveListeners.forEach((function(n){return n(e.camera.position,t.target)}))})),t.addEventListener("change",(function(){e.render()})),t.addEventListener("end",(function(){}))},t.prototype.makeOrbitControls=function(t,e){null!=this.orbitCameraControls&&this.orbitCameraControls.dispose();var n=new a.OrbitControls(t,this.renderer.domElement);n.zoomSpeed=.125,n.enableRotate=e,n.autoRotate=!1,n.enableKeys=!1,n.rotateSpeed=1,e?(n.mouseButtons.LEFT=o.MOUSE.LEFT,n.mouseButtons.RIGHT=o.MOUSE.RIGHT):(n.mouseButtons.LEFT=o.MOUSE.RIGHT,n.mouseButtons.RIGHT=o.MOUSE.LEFT),n.reset(),this.camera=t,this.orbitCameraControls=n,this.addCameraControlsEventListeners(this.orbitCameraControls)},t.prototype.makeCamera=function(t){void 0===t&&(t={});var e=this.makeDefaultCameraDef(this.dimensions,t);this.recreateCamera(e),3===this.dimensions&&this.styles.axesVisible?this.add3dAxes():this.remove3dAxesFromScene()},t.prototype.makeCamera3D=function(t,e,n){var r,i=e/n;(r=new o.PerspectiveCamera(70,i,.01,100)).position.set(t.position[0],t.position[1],t.position[2]);var a=new o.Vector3(t.target[0],t.target[1],t.target[2]);r.lookAt(a),r.zoom=t.zoom,r.updateProjectionMatrix(),this.camera=r,this.makeOrbitControls(r,!0)},t.prototype.makeCamera2D=function(t,e,n){var r,i=new o.Vector3(t.target[0],t.target[1],t.target[2]),a=e/n,s=-1.2,c=1.2,l=-1.2,u=1.2;a>1?(s*=a,c*=a):(u/=a,l/=a),(r=new o.OrthographicCamera(s,c,u,l,-1e3,1e3)).position.set(t.position[0],t.position[1],t.position[2]),r.up=new o.Vector3(0,0,1),r.lookAt(i),r.zoom=t.zoom,r.updateProjectionMatrix(),this.camera=r,this.makeOrbitControls(r,!1)},t.prototype.makeDefaultCameraDef=function(t,e){void 0===e&&(e={});var n=2===t,r=n?h:u,i=n?f:d,o={orthographic:n,zoom:1,position:[r.x,r.y,r.z],target:[i.x,i.y,i.z]};return e.zoom&&(o.zoom=e.zoom),e.position&&(o.position=e.position),e.target&&(o.target=e.target),o},t.prototype.recreateCamera=function(t){t.orthographic?this.makeCamera2D(t,this.width,this.height):this.makeCamera3D(t,this.width,this.height),this.orbitCameraControls.minDistance=.05,this.orbitCameraControls.maxDistance=10,this.orbitCameraControls.update(),this.orbitAnimationOnNextCameraCreation&&this.startOrbitAnimation()},t.prototype.setInteractionMode=function(t){this.interactionMode=t,"SELECT"===t?(this.selecting=!0,this.container.style.cursor="crosshair"):(this.selecting=!1,this.container.style.cursor="default")},t.prototype.onClick=function(t,e){if(void 0===e&&(e=!0),!t||!this.selecting){if(!this.isDragSequence&&e){var n=null!=this.nearestPoint?[this.nearestPoint]:[];this.selectCallback(n),this.clickCallback(this.nearestPoint)}this.isDragSequence=!1,this.render()}},t.prototype.onMouseDown=function(t){this.isDragSequence=!1,this.mouseIsDown=!0,this.selecting?(this.orbitCameraControls.enabled=!1,this.rectangleSelector.onMouseDown(t.offsetX,t.offsetY),this.setNearestPointToMouse(t)):!t.ctrlKey&&this.sceneIs3D()&&this.orbitCameraControls.mouseButtons.ORBIT===o.MOUSE.RIGHT?(this.orbitCameraControls.mouseButtons.ORBIT=o.MOUSE.LEFT,this.orbitCameraControls.mouseButtons.PAN=o.MOUSE.RIGHT):t.ctrlKey&&this.sceneIs3D()&&this.orbitCameraControls.mouseButtons.ORBIT===o.MOUSE.LEFT&&(this.orbitCameraControls.mouseButtons.ORBIT=o.MOUSE.RIGHT,this.orbitCameraControls.mouseButtons.PAN=o.MOUSE.LEFT)},t.prototype.onMouseUp=function(t){this.selecting&&(this.orbitCameraControls.enabled=!0,this.rectangleSelector.onMouseUp(),this.render()),this.mouseIsDown=!1},t.prototype.onMouseMove=function(t){this.isDragSequence=this.mouseIsDown,this.selecting&&this.mouseIsDown?(this.rectangleSelector.onMouseMove(t.offsetX,t.offsetY),this.render()):this.mouseIsDown||(this.setNearestPointToMouse(t),this.nearestPoint!=this.lastHovered&&(this.lastHovered=this.nearestPoint,this.hoverCallback(this.nearestPoint)))},t.prototype.onKeyDown=function(t){17===t.keyCode&&this.sceneIs3D()&&(this.orbitCameraControls.mouseButtons.ORBIT=o.MOUSE.RIGHT,this.orbitCameraControls.mouseButtons.PAN=o.MOUSE.LEFT),16===t.keyCode&&this.selectEnabled&&(this.selecting=!0,this.container.style.cursor="crosshair")},t.prototype.onKeyUp=function(t){17===t.keyCode&&this.sceneIs3D()&&(this.orbitCameraControls.mouseButtons.ORBIT=o.MOUSE.LEFT,this.orbitCameraControls.mouseButtons.PAN=o.MOUSE.RIGHT),16===t.keyCode&&this.selectEnabled&&(this.selecting=!1,this.container.style.cursor="default",this.render())},t.prototype.getPointIndicesFromPickingTexture=function(t){if(null==this.worldSpacePointPositions)return[];var e=this.worldSpacePointPositions.length/3,n=window.devicePixelRatio||1,r=Math.floor(t.x*n),i=Math.floor(t.y*n),o=Math.max(Math.floor(t.width*n),1),a=Math.max(Math.floor(t.height*n),1),s=new Uint8Array(o*a*4);this.renderer.readRenderTargetPixels(this.pickingTexture,r,this.pickingTexture.height-i,o,a,s);for(var c=new Uint8Array(this.worldSpacePointPositions.length),l=0;l<o*a;l++){var u=s[4*l]<<16|s[4*l+1]<<8|s[4*l+2];16777215!==u&&u<e&&(c[u]=1)}var d=[];for(l=0;l<c.length;l++)1===c[l]&&d.push(l);return d},t.prototype.selectBoundingBox=function(t){var e=this.getPointIndicesFromPickingTexture(t);this.selectCallback(e)},t.prototype.setNearestPointToMouse=function(t){if(null!=this.pickingTexture){var e={x:t.offsetX,y:t.offsetY,width:1,height:1},n=this.getPointIndicesFromPickingTexture(e);this.nearestPoint=n.length?n[0]:null}else this.nearestPoint=null},t.prototype.computeLayoutValues=function(){return this.width=this.container.offsetWidth,this.height=Math.max(1,this.container.offsetHeight),[this.width,this.height]},t.prototype.sceneIs3D=function(){return 3===this.dimensions},t.prototype.remove3dAxesFromScene=function(){var t=this.scene.getObjectByName("axes");return null!=t&&this.scene.remove(t),t},t.prototype.add3dAxes=function(){var t=new o.AxesHelper;t.name="axes",this.scene.add(t)},t.prototype.setDimensions=function(t){if(2!==t&&3!==t)throw new RangeError("dimensions must be 2 or 3");this.dimensions!==t&&(this.dimensions=t,this.makeCamera())},t.prototype.getCameraPosition=function(){var t=this.camera.position;return[t.x,t.y,t.z]},t.prototype.getCameraTarget=function(){var t=this.orbitCameraControls.target;return[t.x,t.y,t.z]},t.prototype.setCameraPositionAndTarget=function(t,e){this.stopOrbitAnimation(),this.camera.position.set(t[0],t[1],t[2]),this.orbitCameraControls.target.set(e[0],e[1],e[2]),this.orbitCameraControls.update(),this.render()},t.prototype.startOrbitAnimation=function(){this.sceneIs3D()&&(null!=this.orbitAnimationId&&this.stopOrbitAnimation(),this.orbitCameraControls.autoRotate=!0,this.orbitCameraControls.rotateSpeed=7,this.updateOrbitAnimation())},t.prototype.orbitIsAnimating=function(){return null!=this.orbitAnimationId},t.prototype.updateOrbitAnimation=function(){var t=this;this.orbitCameraControls.update(),this.orbitAnimationId=requestAnimationFrame((function(){return t.updateOrbitAnimation()}))},t.prototype.stopOrbitAnimation=function(){this.orbitCameraControls.autoRotate=!1,this.orbitCameraControls.rotateSpeed=1,null!=this.orbitAnimationId&&(cancelAnimationFrame(this.orbitAnimationId),this.orbitAnimationId=null)},t.prototype.setActiveVisualizers=function(t){var e,n,i,o,a=new Set(t.map((function(t){return t.id})));try{for(var s=r(this.visualizers.values()),c=s.next();!c.done;c=s.next()){var l=c.value;a.has(l.id)||(l.dispose(),this.visualizers.delete(l.id))}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}try{for(var u=r(t),d=u.next();!d.done;d=u.next()){l=d.value;this.visualizers.set(l.id,l),l.setScene(this.scene),l.onResize(this.width,this.height),this.worldSpacePointPositions&&l.onPointPositionsChanged(this.worldSpacePointPositions)}}catch(t){i={error:t}}finally{try{d&&!d.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}},t.prototype.disposeAllVisualizers=function(){this.visualizers.forEach((function(t){return t.dispose()})),this.visualizers.clear()},t.prototype.setPointPositions=function(t){this.worldSpacePointPositions=t,this.visualizers.forEach((function(e){return e.onPointPositionsChanged(t)}))},t.prototype.render=function(){var t=this.camera.position.clone();t.x+=1,t.y+=1,this.light.position.set(t.x,t.y,t.z);var e=this.camera instanceof o.PerspectiveCamera?s.CameraType.Perspective:s.CameraType.Orthographic,n=[0,0];null!=this.worldSpacePointPositions&&(n=c.getNearFarPoints(this.worldSpacePointPositions,this.camera.position,this.orbitCameraControls.target));var r=new s.RenderContext(this.camera,e,this.orbitCameraControls.target,this.width,this.height,n[0],n[1],this.styles.backgroundColor,this.pointColors,this.pointScaleFactors,this.labels,this.polylineColors,this.polylineOpacities,this.polylineWidths);this.visualizers.forEach((function(t){return t.onPickingRender(r)}));var i=this.remove3dAxesFromScene();this.renderer.setRenderTarget(this.pickingTexture),this.renderer.render(this.scene,this.camera),null!=i&&this.scene.add(i),this.visualizers.forEach((function(t){return t.onRender(r)})),this.renderer.setRenderTarget(null),this.renderer.render(this.scene,this.camera)},t.prototype.setPointColors=function(t){this.pointColors=t},t.prototype.setPointScaleFactors=function(t){this.pointScaleFactors=t},t.prototype.setLabels=function(t){this.labels=t},t.prototype.setPolylineColors=function(t){this.polylineColors=t},t.prototype.setPolylineOpacities=function(t){this.polylineOpacities=t},t.prototype.setPolylineWidths=function(t){this.polylineWidths=t},t.prototype.resetZoom=function(){this.recreateCamera(this.makeDefaultCameraDef(this.dimensions)),this.render()},t.prototype.setDayNightMode=function(t){for(var e=this.container.querySelectorAll("canvas"),n=t?"invert(100%)":"",r=0;r<e.length;r++)e[r].style.filter=n},t.prototype.resize=function(t){void 0===t&&(t=!0);var e=i([this.width,this.height],2),n=e[0],r=e[1],a=i(this.computeLayoutValues(),2),s=a[0],c=a[1];if(3===this.dimensions){(l=this.camera).aspect=s/c,l.updateProjectionMatrix()}else{var l=this.camera,u=s/n,d=c/r,h=(l.right-l.left)*u/2,f=(l.top-l.bottom)*d/2;l.top=f,l.bottom=-f,l.left=-h,l.right=h,l.updateProjectionMatrix()}var p=window.devicePixelRatio||1;this.renderer.setPixelRatio(p),this.renderer.setSize(s,c);var m=new o.Vector2;this.renderer.getSize(m);var g=this.renderer.getPixelRatio();this.pickingTexture=new o.WebGLRenderTarget(m.width*g,m.height*g),this.pickingTexture.texture.minFilter=o.LinearFilter,this.visualizers.forEach((function(t){return t.onResize(s,c)})),t&&this.render()},t.prototype.onCameraMove=function(t){this.onCameraMoveListeners.push(t)},t.prototype.clickOnPoint=function(t){this.nearestPoint=t,this.onClick(null,!1)},t}();e.ScatterPlot=p},function(t,e,n){"use strict";n.r(e),n.d(e,"OrbitControls",(function(){return i})),n.d(e,"MapControls",(function(){return o}));var r=n(2),i=function(t,e){var n,i,o,a,s;void 0===e&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=t,this.domElement=e,this.enabled=!0,this.target=new r.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:r.MOUSE.ROTATE,MIDDLE:r.MOUSE.DOLLY,RIGHT:r.MOUSE.PAN},this.touches={ONE:r.TOUCH.ROTATE,TWO:r.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return m.phi},this.getAzimuthalAngle=function(){return m.theta},this.saveState=function(){c.target0.copy(c.target),c.position0.copy(c.object.position),c.zoom0=c.object.zoom},this.reset=function(){c.target.copy(c.target0),c.object.position.copy(c.position0),c.object.zoom=c.zoom0,c.object.updateProjectionMatrix(),c.dispatchEvent(l),c.update(),f=h.NONE},this.update=(n=new r.Vector3,i=(new r.Quaternion).setFromUnitVectors(t.up,new r.Vector3(0,1,0)),o=i.clone().inverse(),a=new r.Vector3,s=new r.Quaternion,function(){var t=c.object.position;return n.copy(t).sub(c.target),n.applyQuaternion(i),m.setFromVector3(n),c.autoRotate&&f===h.NONE&&O(2*Math.PI/60/60*c.autoRotateSpeed),c.enableDamping?(m.theta+=g.theta*c.dampingFactor,m.phi+=g.phi*c.dampingFactor):(m.theta+=g.theta,m.phi+=g.phi),m.theta=Math.max(c.minAzimuthAngle,Math.min(c.maxAzimuthAngle,m.theta)),m.phi=Math.max(c.minPolarAngle,Math.min(c.maxPolarAngle,m.phi)),m.makeSafe(),m.radius*=v,m.radius=Math.max(c.minDistance,Math.min(c.maxDistance,m.radius)),!0===c.enableDamping?c.target.addScaledVector(y,c.dampingFactor):c.target.add(y),n.setFromSpherical(m),n.applyQuaternion(o),t.copy(c.target).add(n),c.object.lookAt(c.target),!0===c.enableDamping?(g.theta*=1-c.dampingFactor,g.phi*=1-c.dampingFactor,y.multiplyScalar(1-c.dampingFactor)):(g.set(0,0,0),y.set(0,0,0)),v=1,!!(b||a.distanceToSquared(c.object.position)>p||8*(1-s.dot(c.object.quaternion))>p)&&(c.dispatchEvent(l),a.copy(c.object.position),s.copy(c.object.quaternion),b=!1,!0)}),this.dispose=function(){c.domElement.removeEventListener("contextmenu",tt,!1),c.domElement.removeEventListener("mousedown",$,!1),c.domElement.removeEventListener("wheel",Y,!1),c.domElement.removeEventListener("touchstart",Z,!1),c.domElement.removeEventListener("touchend",Q,!1),c.domElement.removeEventListener("touchmove",J,!1),document.removeEventListener("mousemove",q,!1),document.removeEventListener("mouseup",X,!1),c.domElement.removeEventListener("keydown",K,!1)};var c=this,l={type:"change"},u={type:"start"},d={type:"end"},h={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},f=h.NONE,p=1e-6,m=new r.Spherical,g=new r.Spherical,v=1,y=new r.Vector3,b=!1,x=new r.Vector2,_=new r.Vector2,w=new r.Vector2,S=new r.Vector2,M=new r.Vector2,E=new r.Vector2,T=new r.Vector2,A=new r.Vector2,C=new r.Vector2;function P(){return Math.pow(.95,c.zoomSpeed)}function O(t){g.theta-=t}function k(t){g.phi-=t}var L,R=(L=new r.Vector3,function(t,e){L.setFromMatrixColumn(e,0),L.multiplyScalar(-t),y.add(L)}),I=function(){var t=new r.Vector3;return function(e,n){!0===c.screenSpacePanning?t.setFromMatrixColumn(n,1):(t.setFromMatrixColumn(n,0),t.crossVectors(c.object.up,t)),t.multiplyScalar(e),y.add(t)}}(),N=function(){var t=new r.Vector3;return function(e,n){var r=c.domElement;if(c.object.isPerspectiveCamera){var i=c.object.position;t.copy(i).sub(c.target);var o=t.length();o*=Math.tan(c.object.fov/2*Math.PI/180),R(2*e*o/r.clientHeight,c.object.matrix),I(2*n*o/r.clientHeight,c.object.matrix)}else c.object.isOrthographicCamera?(R(e*(c.object.right-c.object.left)/c.object.zoom/r.clientWidth,c.object.matrix),I(n*(c.object.top-c.object.bottom)/c.object.zoom/r.clientHeight,c.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),c.enablePan=!1)}}();function D(t){c.object.isPerspectiveCamera?v/=t:c.object.isOrthographicCamera?(c.object.zoom=Math.max(c.minZoom,Math.min(c.maxZoom,c.object.zoom*t)),c.object.updateProjectionMatrix(),b=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),c.enableZoom=!1)}function z(t){c.object.isPerspectiveCamera?v*=t:c.object.isOrthographicCamera?(c.object.zoom=Math.max(c.minZoom,Math.min(c.maxZoom,c.object.zoom/t)),c.object.updateProjectionMatrix(),b=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),c.enableZoom=!1)}function j(t){x.set(t.clientX,t.clientY)}function F(t){S.set(t.clientX,t.clientY)}function B(t){if(1==t.touches.length)x.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),n=.5*(t.touches[0].pageY+t.touches[1].pageY);x.set(e,n)}}function U(t){if(1==t.touches.length)S.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),n=.5*(t.touches[0].pageY+t.touches[1].pageY);S.set(e,n)}}function H(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(e*e+n*n);T.set(0,r)}function V(t){if(1==t.touches.length)_.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),n=.5*(t.touches[0].pageY+t.touches[1].pageY);_.set(e,n)}w.subVectors(_,x).multiplyScalar(c.rotateSpeed);var r=c.domElement;O(2*Math.PI*w.x/r.clientHeight),k(2*Math.PI*w.y/r.clientHeight),x.copy(_)}function G(t){if(1==t.touches.length)M.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),n=.5*(t.touches[0].pageY+t.touches[1].pageY);M.set(e,n)}E.subVectors(M,S).multiplyScalar(c.panSpeed),N(E.x,E.y),S.copy(M)}function W(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(e*e+n*n);A.set(0,r),C.set(0,Math.pow(A.y/T.y,c.zoomSpeed)),D(C.y),T.copy(A)}function $(t){if(!1!==c.enabled){var e;switch(t.preventDefault(),c.domElement.focus?c.domElement.focus():window.focus(),t.button){case 0:e=c.mouseButtons.LEFT;break;case 1:e=c.mouseButtons.MIDDLE;break;case 2:e=c.mouseButtons.RIGHT;break;default:e=-1}switch(e){case r.MOUSE.DOLLY:if(!1===c.enableZoom)return;!function(t){T.set(t.clientX,t.clientY)}(t),f=h.DOLLY;break;case r.MOUSE.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===c.enablePan)return;F(t),f=h.PAN}else{if(!1===c.enableRotate)return;j(t),f=h.ROTATE}break;case r.MOUSE.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===c.enableRotate)return;j(t),f=h.ROTATE}else{if(!1===c.enablePan)return;F(t),f=h.PAN}break;default:f=h.NONE}f!==h.NONE&&(document.addEventListener("mousemove",q,!1),document.addEventListener("mouseup",X,!1),c.dispatchEvent(u))}}function q(t){if(!1!==c.enabled)switch(t.preventDefault(),f){case h.ROTATE:if(!1===c.enableRotate)return;!function(t){_.set(t.clientX,t.clientY),w.subVectors(_,x).multiplyScalar(c.rotateSpeed);var e=c.domElement;O(2*Math.PI*w.x/e.clientHeight),k(2*Math.PI*w.y/e.clientHeight),x.copy(_),c.update()}(t);break;case h.DOLLY:if(!1===c.enableZoom)return;!function(t){A.set(t.clientX,t.clientY),C.subVectors(A,T),C.y>0?D(P()):C.y<0&&z(P()),T.copy(A),c.update()}(t);break;case h.PAN:if(!1===c.enablePan)return;!function(t){M.set(t.clientX,t.clientY),E.subVectors(M,S).multiplyScalar(c.panSpeed),N(E.x,E.y),S.copy(M),c.update()}(t)}}function X(t){!1!==c.enabled&&(document.removeEventListener("mousemove",q,!1),document.removeEventListener("mouseup",X,!1),c.dispatchEvent(d),f=h.NONE)}function Y(t){!1===c.enabled||!1===c.enableZoom||f!==h.NONE&&f!==h.ROTATE||(t.preventDefault(),t.stopPropagation(),c.dispatchEvent(u),function(t){t.deltaY<0?z(P()):t.deltaY>0&&D(P()),c.update()}(t),c.dispatchEvent(d))}function K(t){!1!==c.enabled&&!1!==c.enableKeys&&!1!==c.enablePan&&function(t){var e=!1;switch(t.keyCode){case c.keys.UP:N(0,c.keyPanSpeed),e=!0;break;case c.keys.BOTTOM:N(0,-c.keyPanSpeed),e=!0;break;case c.keys.LEFT:N(c.keyPanSpeed,0),e=!0;break;case c.keys.RIGHT:N(-c.keyPanSpeed,0),e=!0}e&&(t.preventDefault(),c.update())}(t)}function Z(t){if(!1!==c.enabled){switch(t.preventDefault(),t.touches.length){case 1:switch(c.touches.ONE){case r.TOUCH.ROTATE:if(!1===c.enableRotate)return;B(t),f=h.TOUCH_ROTATE;break;case r.TOUCH.PAN:if(!1===c.enablePan)return;U(t),f=h.TOUCH_PAN;break;default:f=h.NONE}break;case 2:switch(c.touches.TWO){case r.TOUCH.DOLLY_PAN:if(!1===c.enableZoom&&!1===c.enablePan)return;!function(t){c.enableZoom&&H(t),c.enablePan&&U(t)}(t),f=h.TOUCH_DOLLY_PAN;break;case r.TOUCH.DOLLY_ROTATE:if(!1===c.enableZoom&&!1===c.enableRotate)return;!function(t){c.enableZoom&&H(t),c.enableRotate&&B(t)}(t),f=h.TOUCH_DOLLY_ROTATE;break;default:f=h.NONE}break;default:f=h.NONE}f!==h.NONE&&c.dispatchEvent(u)}}function J(t){if(!1!==c.enabled)switch(t.preventDefault(),t.stopPropagation(),f){case h.TOUCH_ROTATE:if(!1===c.enableRotate)return;V(t),c.update();break;case h.TOUCH_PAN:if(!1===c.enablePan)return;G(t),c.update();break;case h.TOUCH_DOLLY_PAN:if(!1===c.enableZoom&&!1===c.enablePan)return;!function(t){c.enableZoom&&W(t),c.enablePan&&G(t)}(t),c.update();break;case h.TOUCH_DOLLY_ROTATE:if(!1===c.enableZoom&&!1===c.enableRotate)return;!function(t){c.enableZoom&&W(t),c.enableRotate&&V(t)}(t),c.update();break;default:f=h.NONE}}function Q(t){!1!==c.enabled&&(c.dispatchEvent(d),f=h.NONE)}function tt(t){!1!==c.enabled&&t.preventDefault()}c.domElement.addEventListener("contextmenu",tt,!1),c.domElement.addEventListener("mousedown",$,!1),c.domElement.addEventListener("wheel",Y,!1),c.domElement.addEventListener("touchstart",Z,!1),c.domElement.addEventListener("touchend",Q,!1),c.domElement.addEventListener("touchmove",J,!1),c.domElement.addEventListener("keydown",K,!1),-1===c.domElement.tabIndex&&(c.domElement.tabIndex=0),this.update()};i.prototype=Object.create(r.EventDispatcher.prototype),i.prototype.constructor=i;var o=function(t,e){i.call(this,t,e),this.mouseButtons.LEFT=r.MOUSE.PAN,this.mouseButtons.RIGHT=r.MOUSE.ROTATE,this.touches.ONE=r.TOUCH.PAN,this.touches.TWO=r.TOUCH.DOLLY_ROTATE};o.prototype=Object.create(r.EventDispatcher.prototype),o.prototype.constructor=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n){this.startCoordinates=[0,0],this.svgElement=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svgElement.style.display="none",this.svgElement.style.height="100%",this.svgElement.style.width="100%",this.svgElement.style.position="absolute",t.insertAdjacentElement("afterbegin",this.svgElement),this.rectElement=document.createElementNS("http://www.w3.org/2000/svg","rect"),this.rectElement.style.stroke=n.select.stroke,this.rectElement.style.strokeDasharray=n.select.strokeDashArray,this.rectElement.style.strokeWidth=""+n.select.strokeWidth,this.rectElement.style.fill=n.select.fill,this.rectElement.style.fillOpacity=""+n.select.fillOpacity,this.svgElement.appendChild(this.rectElement),this.selectionCallback=e,this.isMouseDown=!1}return t.prototype.onMouseDown=function(t,e){this.isMouseDown=!0,this.rectElement.style.display="block",this.svgElement.style.display="block",this.startCoordinates=[t,e],this.lastBoundingBox={x:this.startCoordinates[0],y:this.startCoordinates[1],width:1,height:1}},t.prototype.onMouseMove=function(t,e){this.isMouseDown&&(this.lastBoundingBox.x=Math.min(t,this.startCoordinates[0]),this.lastBoundingBox.y=Math.max(e,this.startCoordinates[1]),this.lastBoundingBox.width=Math.max(t,this.startCoordinates[0])-this.lastBoundingBox.x,this.lastBoundingBox.height=this.lastBoundingBox.y-Math.min(e,this.startCoordinates[1]),this.rectElement.setAttribute("x",""+this.lastBoundingBox.x),this.rectElement.setAttribute("y",""+(this.lastBoundingBox.y-this.lastBoundingBox.height)),this.rectElement.setAttribute("width",""+this.lastBoundingBox.width),this.rectElement.setAttribute("height",""+this.lastBoundingBox.height))},t.prototype.onMouseUp=function(){this.isMouseDown=!1,this.svgElement.style.display="none",this.rectElement.style.display="none",this.rectElement.setAttribute("width","0"),this.rectElement.setAttribute("height","0"),this.selectionCallback(this.lastBoundingBox)},t}();e.ScatterPlotRectangleSelector=r},function(t,e,n){"use strict";var r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),o=new Map,a=/^(rgba|hsla)\((\d+),\s*(\d+%?),\s*(\d+%?)(?:,\s*(\d+(?:\.\d+)?))?\)$/;e.parseColor=function(t){if(o.has(t))return o.get(t);var e=function(t){var e=a.exec(t);if(e){var n=r(e,6),i=(n[0],n[1]),o=n[2],s=n[3],c=n[4],l=n[5];return{colorString:i.replace("a","")+"("+o+","+s+","+c+")",opacity:parseFloat(l)}}return{colorString:t,opacity:1}}(t),n=e.colorString,s=e.opacity,c=new i.Color(n),l={r:c.r,g:c.g,b:c.b,opacity:s};return o.set(t,l),l}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.makeStyles=function(t){var e={backgroundColor:"#ffffff",axesVisible:!0,fog:{color:"#ffffff",enabled:!0,threshold:5e3},label:{fontSize:10,scaleDefault:1,scaleLarge:2,fillColorSelected:"#000000",fillColorHover:"#000000",strokeColorSelected:"#ffffff",strokeColorHover:"#ffffff",strokeWidth:3,fillWidth:6},label3D:{fontSize:80,scale:2.2,color:"black",backgroundColor:"#ffffff",colorUnselected:"#ffffff",colorNoSelection:"#ffffff"},point:{colorUnselected:"rgba(227, 227, 227, 0.7)",colorNoSelection:"rgba(117, 117, 217, 0.7)",colorSelected:"rgba(250, 102, 102, 0.7)",colorHover:"rgba(118, 11, 79, 0.7)",scaleDefault:1,scaleSelected:1.2,scaleHover:1.2},polyline:{startHue:60,endHue:360,saturation:1,lightness:.3,defaultOpacity:.2,defaultLineWidth:2,selectedOpacity:.9,selectedLineWidth:3,deselectedOpacity:.05},select:{fill:"#dddddd",fillOpacity:.2,stroke:"#aaaaaa",strokeWidth:2,strokeDashArray:"10 5"},sprites:{minPointSize:5,imageSize:30,colorUnselected:"#ffffff",colorNoSelection:"#ffffff"}};if(void 0===t)return e;for(var n in e){var r=n;"object"==typeof e[r]&&"object"==typeof t[r]?e[r]=Object.assign(e[r],t[r]):void 0!==t[r]&&(e[r]=t[r])}return e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(32),o=n(44),a=function(t,e){return"\n      attribute vec2 posObj;\n      attribute vec4 color;\n      varying vec2 vUv;\n      varying vec4 vColor;\n\n      void main() {\n        vUv = uv;\n        vColor = color;\n\n        // Rotate label to face camera.\n\n        vec4 vRight = vec4(\n          modelViewMatrix[0][0], modelViewMatrix[1][0], modelViewMatrix[2][0], 0);\n\n        vec4 vUp = vec4(\n          modelViewMatrix[0][1], modelViewMatrix[1][1], modelViewMatrix[2][1], 0);\n\n        vec4 vAt = -vec4(\n          modelViewMatrix[0][2], modelViewMatrix[1][2], modelViewMatrix[2][2], 0);\n\n        mat4 pointToCamera = mat4(vRight, vUp, vAt, vec4(0, 0, 0, 1));\n\n        vec2 scaledPos = posObj * "+1/t+" * "+e+";\n\n        vec4 posRotated = pointToCamera * vec4(scaledPos, 0, 1);\n        vec4 mvPosition = modelViewMatrix * (vec4(position, 0) + posRotated);\n        gl_Position = projectionMatrix * mvPosition;\n      }"},s=function(){function t(t){this.styles=t,this.id="3D_LABELS",this.labelStrings=[],this.worldSpacePointPositions=new Float32Array(0),this.pickingColors=new Float32Array(0),this.renderColors=new Float32Array(0),this.uniforms={},this.totalVertexCount=0,this.labelVertexMap=[]}return t.prototype.createGlyphTexture=function(){var t=this.styles.label3D,e=t.fontSize,n=t.backgroundColor,r=t.color,o=document.createElement("canvas");o.width=8192,o.height=e;var a=o.getContext("2d");a.font="bold "+e+"px roboto",a.textBaseline="top",a.fillStyle=n,a.rect(0,0,o.width,o.height),a.fill(),a.fillStyle=r;for(var s=a.measureText(" ").width,c=new Float32Array(256),l=new Float32Array(256),u=0,d=0;d<256;d++){var h=" "+String.fromCharCode(d),f=a.measureText(h).width;c[d]=f-s,l[d]=u,a.fillText(h,u-s,0),u+=f}return{texture:i.createTextureFromCanvas(o),lengths:c,offsets:l}},t.prototype.processLabelVerts=function(t){var e=0;this.labelVertexMap=[];for(var n=0;n<t;n++){for(var r=this.labelStrings[n],i=[],o=0;o<r.length;o++){for(var a=0;a<6;a++)i.push(6*e+a);e++}this.labelVertexMap.push(i)}this.totalVertexCount=6*e},t.prototype.createColorBuffers=function(t){var e=this;this.pickingColors=new Float32Array(this.totalVertexCount*o.RGB_NUM_ELEMENTS),this.renderColors=new Float32Array(this.totalVertexCount*o.RGB_NUM_ELEMENTS);for(var n=function(t){var n=new r.Color(t);i.labelVertexMap[t].forEach((function(t){e.pickingColors[o.RGB_NUM_ELEMENTS*t]=n.r,e.pickingColors[o.RGB_NUM_ELEMENTS*t+1]=n.g,e.pickingColors[o.RGB_NUM_ELEMENTS*t+2]=n.b,e.renderColors[o.RGB_NUM_ELEMENTS*t]=1,e.renderColors[o.RGB_NUM_ELEMENTS*t+1]=1,e.renderColors[o.RGB_NUM_ELEMENTS*t+2]=1}))},i=this,a=0;a<t;a++)n(a)},t.prototype.createLabels=function(){var t=this,e=this.styles.label3D,n=e.fontSize,s=e.scale;if(null!=this.labelStrings&&null!=this.worldSpacePointPositions){var c=this.worldSpacePointPositions.length/o.XYZ_NUM_ELEMENTS;if(c===this.labelStrings.length){this.glyphTexture=this.createGlyphTexture(),this.uniforms={texture:{type:"t"},picking:{type:"bool"}},this.material=new r.ShaderMaterial({uniforms:this.uniforms,transparent:!0,vertexShader:a(n,s),fragmentShader:"\n      uniform sampler2D texture;\n      uniform bool picking;\n      varying vec2 vUv;\n      varying vec4 vColor;\n\n      void main() {\n        if (picking) {\n          gl_FragColor = vColor;\n        } else {\n          vec4 fromTexture = texture2D(texture, vUv);\n          gl_FragColor = vColor * fromTexture;\n        }\n      }"}),this.processLabelVerts(c),this.createColorBuffers(c);var l=new Float32Array(this.totalVertexCount*o.XYZ_NUM_ELEMENTS);this.positions=new r.BufferAttribute(l,o.XYZ_NUM_ELEMENTS);var u=new Float32Array(this.totalVertexCount*o.XYZ_NUM_ELEMENTS),d=new Float32Array(this.totalVertexCount*o.UV_NUM_ELEMENTS),h=new Float32Array(this.totalVertexCount*o.RGB_NUM_ELEMENTS),f=new r.BufferAttribute(u,2),p=new r.BufferAttribute(d,o.UV_NUM_ELEMENTS),m=new r.BufferAttribute(h,o.RGB_NUM_ELEMENTS);this.geometry=new r.BufferGeometry,this.geometry.setAttribute("posObj",f),this.geometry.setAttribute("position",this.positions),this.geometry.setAttribute("uv",p),this.geometry.setAttribute("color",m);for(var g=0,v=0;v<c;v++){for(var y=this.labelStrings[v],b=0,x=0;x<y.length;x++){var _=y.charCodeAt(x);b+=this.glyphTexture.lengths[_]}b/=-2;for(x=0;x<y.length;x++){_=y.charCodeAt(x);var w=this.glyphTexture.lengths[_],S=(b+w)/n,M=b/n,E=n/n;f.setXY(6*g+0,M,0),f.setXY(6*g+1,S,0),f.setXY(6*g+2,M,E),f.setXY(6*g+3,M,E),f.setXY(6*g+4,S,0),f.setXY(6*g+5,S,E);var T=this.glyphTexture.offsets[_],A=this.glyphTexture.offsets[_]+w;T/=8192,A/=8192;p.setXY(6*g+0,T,1),p.setXY(6*g+1,A,1),p.setXY(6*g+2,T,0),p.setXY(6*g+3,T,0),p.setXY(6*g+4,A,1),p.setXY(6*g+5,A,0),g++,b+=w}}var C=function(e){var n=i.vector3FromPackedArray(P.worldSpacePointPositions,e);P.labelVertexMap[e].forEach((function(e){t.positions.setXYZ(e,n.x,n.y,n.z)}))},P=this;for(v=0;v<c;v++)C(v);this.labelsMesh=new r.Mesh(this.geometry,this.material),this.labelsMesh.frustumCulled=!1,this.scene.add(this.labelsMesh)}}},t.prototype.colorLabels=function(t){if(null!=this.labelStrings&&null!=this.geometry&&null!=t){var e=this.geometry.getAttribute("color");e.array=this.renderColors;for(var n=t.length/o.RGBA_NUM_ELEMENTS,i=0,a=0;a<n;++a){for(var s=new r.Color(t[i],t[i+1],t[i+2]),c=this.labelVertexMap[a].length,l=0;l<c;++l)e.setXYZ(this.labelVertexMap[a][l],s.r,s.g,s.b);i+=o.RGBA_NUM_ELEMENTS}e.needsUpdate=!0}},t.prototype.setScene=function(t){this.scene=t},t.prototype.dispose=function(){this.labelsMesh&&(this.scene&&this.scene.remove(this.labelsMesh),this.labelsMesh=null),this.geometry&&(this.geometry.dispose(),this.geometry=null),null!=this.glyphTexture&&null!=this.glyphTexture.texture&&(this.glyphTexture.texture.dispose(),this.glyphTexture.texture=null)},t.prototype.onPickingRender=function(t){if(null!=this.geometry){this.material.uniforms.texture.value=this.glyphTexture.texture,this.material.uniforms.picking.value=!0;var e=this.geometry.getAttribute("color");e.array=this.pickingColors,e.needsUpdate=!0}else this.createLabels()},t.prototype.onRender=function(t){if(null!=this.geometry){this.colorLabels(t.pointColors),this.material.uniforms.texture.value=this.glyphTexture.texture,this.material.uniforms.picking.value=!1;var e=this.geometry.getAttribute("color");e.array=this.renderColors,e.needsUpdate=!0}else this.createLabels()},t.prototype.onPointPositionsChanged=function(t){this.worldSpacePointPositions=t,this.dispose()},t.prototype.setLabelStrings=function(t){this.labelStrings=t,this.dispose()},t.prototype.onResize=function(t,e){},t}();e.ScatterPlotVisualizer3DLabels=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(43),o=n(32),a=n(44),s=function(t){return"\n    // Index of the specific vertex (passed in as bufferAttribute), and the\n    // variable that will be used to pass it to the fragment shader.\n    attribute float spriteIndex;\n    attribute vec4 color;\n    attribute float scaleFactor;\n\n    varying vec2 xyIndex;\n    varying vec4 vColor;\n\n    uniform bool sizeAttenuation;\n    uniform float pointSize;\n    uniform float spritesPerRow;\n    uniform float spritesPerColumn;\n\n    varying float fogDepth;\n\n    void main() {\n      // Pass index and color values to fragment shader.\n      vColor = color;\n      xyIndex = vec2(mod(spriteIndex, spritesPerRow),\n                floor(spriteIndex / spritesPerColumn));\n\n      // Transform current vertex by modelViewMatrix (model world position and\n      // camera world position matrix).\n      vec4 cameraSpacePos = modelViewMatrix * vec4(position, 1.0);\n\n      // Project vertex in camera-space to screen coordinates using the camera's\n      // projection matrix.\n      gl_Position = projectionMatrix * cameraSpacePos;\n\n      // Create size attenuation (if we're in 3D mode) by making the size of\n      // each point inversly proportional to its distance to the camera.\n      float outputPointSize = pointSize;\n      if (sizeAttenuation) {\n        outputPointSize = -pointSize / cameraSpacePos.z;\n        fogDepth = pointSize / outputPointSize * 1.2;\n      } else {  // Create size attenuation (if we're in 2D mode)\n        const float PI = 3.1415926535897932384626433832795;\n        const float minScale = 0.1;  // minimum scaling factor\n        const float outSpeed = 2.0;  // shrink speed when zooming out\n        const float outNorm = (1. - minScale) / atan(outSpeed);\n        const float maxScale = 15.0;  // maximum scaling factor\n        const float inSpeed = 0.02;  // enlarge speed when zooming in\n        const float zoomOffset = 0.3;  // offset zoom pivot\n        float zoom = projectionMatrix[0][0] + zoomOffset;  // zoom pivot\n        float scale = zoom < 1. ? 1. + outNorm * atan(outSpeed * (zoom - 1.)) :\n                      1. + 2. / PI * (maxScale - 1.) * atan(inSpeed * (zoom - 1.));\n        outputPointSize = pointSize * scale;\n      }\n\n      gl_PointSize =\n        max(outputPointSize * scaleFactor, "+t.toFixed(1)+");\n    }"},c="\n    bool point_in_unit_circle(vec2 spriteCoord) {\n      vec2 centerToP = spriteCoord - vec2(0.5, 0.5);\n      return dot(centerToP, centerToP) < (0.5 * 0.5);\n    }\n\n    bool point_in_unit_equilateral_triangle(vec2 spriteCoord) {\n      vec3 v0 = vec3(0, 1, 0);\n      vec3 v1 = vec3(0.5, 0, 0);\n      vec3 v2 = vec3(1, 1, 0);\n      vec3 p = vec3(spriteCoord, 0);\n      float p_in_v0_v1 = cross(v1 - v0, p - v0).z;\n      float p_in_v1_v2 = cross(v2 - v1, p - v1).z;\n      return (p_in_v0_v1 > 0.0) && (p_in_v1_v2 > 0.0);\n    }\n\n    bool point_in_unit_square(vec2 spriteCoord) {\n      return true;\n    }\n  ",l="\n    varying vec2 xyIndex;\n    varying vec4 vColor;\n\n    uniform sampler2D texture;\n    uniform float spritesPerRow;\n    uniform float spritesPerColumn;\n    uniform bool isImage;\n\n    "+r.ShaderChunk.common+"\n    "+c+"\n    uniform vec3 fogColor;\n    varying float fogDepth;\n\t\tuniform float fogNear;\n    uniform float fogFar;\n\n    void main() {\n      if (isImage) {\n        // Coordinates of the vertex within the entire sprite image.\n        vec2 coords =\n          (gl_PointCoord + xyIndex) / vec2(spritesPerRow, spritesPerColumn);\n        gl_FragColor = vColor * texture2D(texture, coords);\n      } else {\n        bool inside = point_in_unit_circle(gl_PointCoord);\n        if (!inside) {\n          discard;\n        }\n        gl_FragColor = vColor;\n      }\n      float fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n      gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n    }",u=function(){function t(t,e){this.styles=t,this.id="SPRITES",this.isSpriteSheetMode=!1,this.spritesPerRow=0,this.spritesPerColumn=0,this.spriteDimensions=[0,0],this.worldSpacePointPositions=new Float32Array(0),this.pickingColors=new Float32Array(0),this.renderColors=new Float32Array(0),this.standinTextureForPoints=o.createTextureFromCanvas(document.createElement("canvas")),e&&(this.spriteSheetParams=e,this.setSpriteSheet(e),this.isSpriteSheetMode=!0),this.renderMaterial=this.createRenderMaterial(),this.pickingMaterial=this.createPickingMaterial()}return t.prototype.createUniforms=function(){return{texture:{type:"t"},spritesPerRow:{type:"f"},spritesPerColumn:{type:"f"},fogColor:{type:"c"},fogNear:{type:"f"},fogFar:{type:"f"},isImage:{type:"bool"},sizeAttenuation:{type:"bool"},pointSize:{type:"f"}}},t.prototype.createRenderMaterial=function(){this.isSpriteSheetMode;var t=this.createUniforms();return new r.ShaderMaterial({uniforms:t,vertexShader:s(this.styles.sprites.minPointSize),fragmentShader:l,transparent:!0,depthFunc:r.LessDepth,fog:this.styles.fog.enabled,blending:r.NormalBlending})},t.prototype.createPickingMaterial=function(){var t=this.createUniforms();return new r.ShaderMaterial({uniforms:t,vertexShader:s(this.styles.sprites.minPointSize),fragmentShader:"\n    varying vec2 xyIndex;\n    varying vec4 vColor;\n    uniform bool isImage;\n\n    \n    bool point_in_unit_circle(vec2 spriteCoord) {\n      vec2 centerToP = spriteCoord - vec2(0.5, 0.5);\n      return dot(centerToP, centerToP) < (0.5 * 0.5);\n    }\n\n    bool point_in_unit_equilateral_triangle(vec2 spriteCoord) {\n      vec3 v0 = vec3(0, 1, 0);\n      vec3 v1 = vec3(0.5, 0, 0);\n      vec3 v2 = vec3(1, 1, 0);\n      vec3 p = vec3(spriteCoord, 0);\n      float p_in_v0_v1 = cross(v1 - v0, p - v0).z;\n      float p_in_v1_v2 = cross(v2 - v1, p - v1).z;\n      return (p_in_v0_v1 > 0.0) && (p_in_v1_v2 > 0.0);\n    }\n\n    bool point_in_unit_square(vec2 spriteCoord) {\n      return true;\n    }\n  \n\n    varying float fogDepth;\n\n    void main() {\n      xyIndex; // Silence 'unused variable' warning.\n      fogDepth; // Silence 'unused variable' warning.\n      if (isImage) {\n        gl_FragColor = vColor;\n      } else {\n        bool inside = point_in_unit_circle(gl_PointCoord);\n        if (!inside) {\n          discard;\n        }\n        gl_FragColor = vColor;\n      }\n    }",transparent:!0,depthTest:!0,depthWrite:!0,fog:!1,blending:r.NormalBlending})},t.prototype.createPointSprites=function(t,e){var n=null!=e?e.length/a.XYZ_NUM_ELEMENTS:0,i=this.createGeometry(n);this.fog=new r.Fog(16777215),this.points=new r.Points(i,this.renderMaterial),this.points.frustumCulled=!1,null!=this.spriteIndexBufferAttribute&&this.points.geometry.setAttribute("spriteIndex",this.spriteIndexBufferAttribute),t.add(this.points)},t.prototype.calculatePointSize=function(t){var e=this.styles.sprites.imageSize;if(this.texture)return t?e:this.spriteDimensions[0];var n=null!=this.worldSpacePointPositions?this.worldSpacePointPositions.length/a.XYZ_NUM_ELEMENTS:1,r=200/Math.log(n)/Math.log(8);return t?r:r/1.5},t.prototype.createGeometry=function(t){var e=t;this.pickingColors=new Float32Array(e*a.RGBA_NUM_ELEMENTS);for(var n=0,i=0;i<e;i++){var o=new r.Color(i);this.pickingColors[n++]=o.r,this.pickingColors[n++]=o.g,this.pickingColors[n++]=o.b,this.pickingColors[n++]=1}var s=new r.BufferGeometry;return s.setAttribute("position",new r.BufferAttribute(new Float32Array([]),a.XYZ_NUM_ELEMENTS)),s.setAttribute("color",new r.BufferAttribute(new Float32Array([]),a.RGBA_NUM_ELEMENTS)),s.setAttribute("scaleFactor",new r.BufferAttribute(new Float32Array([]),a.INDEX_NUM_ELEMENTS)),s.computeVertexNormals(),s},t.prototype.setFogDistances=function(t,e,n){var r=this.styles.fog,i=r.threshold,o=r.enabled;if(t&&o){var s=this.worldSpacePointPositions.length/a.XYZ_NUM_ELEMENTS;this.fog.near=e;var c=2-Math.min(s,i)/i;this.fog.far=n*c}else this.fog.near=1/0,this.fog.far=1/0},t.prototype.dispose=function(){this.disposeGeometry(),this.disposeSpriteSheet()},t.prototype.disposeGeometry=function(){null!=this.points&&(this.scene.remove(this.points),this.points.geometry.dispose(),this.points=null,this.worldSpacePointPositions=null)},t.prototype.disposeSpriteSheet=function(){this.texture&&this.texture.dispose(),this.texture=null,this.renderMaterial=null,this.pickingMaterial=null,this.spriteSheetImage=null},t.prototype.setScene=function(t){this.scene=t},t.prototype.setSpriteSheet=function(t){var e=this,n=t.spriteDimensions,i=t.spriteIndices,s=t.onImageLoad,c=t.spritesheetImage;if("string"==typeof c){var l=c;(c=new Image).src=l}this.spriteSheetImage=c,this.texture=o.createTextureFromImage(this.spriteSheetImage,(function(){e.spritesPerRow=e.spriteSheetImage.width/n[0],e.spritesPerColumn=e.spriteSheetImage.height/n[1],s()})),this.spriteDimensions=n,this.spriteIndexBufferAttribute=new r.BufferAttribute(i,a.INDEX_NUM_ELEMENTS),null!=this.points&&this.points.geometry.setAttribute("spriteIndex",this.spriteIndexBufferAttribute)},t.prototype.onPointPositionsChanged=function(t){null!=this.points&&this.worldSpacePointPositions.length!==t.length&&this.disposeGeometry(),this.worldSpacePointPositions=t,null==this.points&&this.createPointSprites(this.scene,t),this.spriteSheetParams&&this.setSpriteSheet(this.spriteSheetParams),this.renderMaterial=this.createRenderMaterial(),this.pickingMaterial=this.createPickingMaterial();var e=this.points.geometry.getAttribute("position");e.array=t,e.count=t.length/a.XYZ_NUM_ELEMENTS,e.needsUpdate=!0},t.prototype.onPickingRender=function(t){var e=t.cameraType===i.CameraType.Perspective;this.pickingMaterial.uniforms.spritesPerRow.value=this.spritesPerRow,this.pickingMaterial.uniforms.spritesPerRow.value=this.spritesPerColumn,this.pickingMaterial.uniforms.sizeAttenuation.value=e,this.pickingMaterial.uniforms.pointSize.value=this.calculatePointSize(e),this.points.material=this.pickingMaterial;var n=this.points.geometry.getAttribute("color");n.array=this.pickingColors,n.count=this.pickingColors.length/a.RGBA_NUM_ELEMENTS,n.needsUpdate=!0;var r=this.points.geometry.getAttribute("scaleFactor");r.array=t.pointScaleFactors,r.count=t.pointScaleFactors.length,r.count=t.pointScaleFactors.length/a.INDEX_NUM_ELEMENTS,r.needsUpdate=!0},t.prototype.onRender=function(t){var e=t.camera instanceof r.PerspectiveCamera;this.setFogDistances(e,t.nearestCameraSpacePointZ,t.farthestCameraSpacePointZ),this.scene.fog=this.fog,this.scene.fog.color=new r.Color(t.backgroundColor),this.renderMaterial.uniforms.fogColor.value=this.scene.fog.color,this.renderMaterial.uniforms.fogNear.value=this.fog.near,this.renderMaterial.uniforms.fogFar.value=this.fog.far,this.renderMaterial.uniforms.spritesPerRow.value=this.spritesPerRow,this.renderMaterial.uniforms.spritesPerColumn.value=this.spritesPerColumn,this.renderMaterial.uniforms.isImage.value=null!=this.texture,this.renderMaterial.uniforms.texture.value=null!=this.texture?this.texture:this.standinTextureForPoints,this.renderMaterial.uniforms.sizeAttenuation.value=e,this.renderMaterial.uniforms.pointSize.value=this.calculatePointSize(e),this.points.material=this.renderMaterial;var n=this.points.geometry.getAttribute("color");this.renderColors=t.pointColors,n.array=this.renderColors,n.count=this.renderColors.length/a.RGBA_NUM_ELEMENTS,n.needsUpdate=!0;var i=this.points.geometry.getAttribute("scaleFactor");i.array=t.pointScaleFactors,i.count=t.pointScaleFactors.length/a.INDEX_NUM_ELEMENTS,i.needsUpdate=!0},t.prototype.onResize=function(t,e){},t}();e.ScatterPlotVisualizerSprites=u},function(t,e,n){"use strict";var r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),o=n(43),a=n(104),s=n(32),c=function(){function t(t,e){this.styles=e,this.id="CANVAS_LABELS",this.worldSpacePointPositions=new Float32Array(0),this.labelsActive=!0,this.canvas=document.createElement("canvas"),t.appendChild(this.canvas),this.gc=this.canvas.getContext("2d"),this.canvas.style.position="absolute",this.canvas.style.left="0",this.canvas.style.top="0",this.canvas.style.pointerEvents="none"}return t.prototype.removeAllLabels=function(){var t=this.canvas.width*window.devicePixelRatio,e=this.canvas.height*window.devicePixelRatio;this.gc.clearRect(0,0,t,e)},t.prototype.makeLabels=function(t){if(null!=t.labels&&0!==t.labels.pointIndices.length&&null!=this.worldSpacePointPositions){var e,n=t.labels,c=t.cameraType===o.CameraType.Perspective,l=parseInt(this.gc.font,10),u=window.devicePixelRatio,d=this.canvas.width*u,h=this.canvas.height*u,f={loX:0,hiX:d,loY:0,hiY:h};e=new a.CollisionGrid(f,d/25,h/50);var p=[t.farthestCameraSpacePointZ,t.nearestCameraSpacePointZ],m=function(t){return s.scaleExponential(t,p,[.1,1])},g=t.camera.position,v=g.clone().sub(t.cameraTarget),y=new i.Vector3;this.gc.textBaseline="middle",this.gc.miterLimit=2;for(var b=Math.min(1e4,n.pointIndices.length),x=0;x<b;++x){var _,w=n.pointIndices[x];if(_=s.vector3FromPackedArray(this.worldSpacePointPositions,w),y.copy(g).sub(_),!(v.dot(y)<0)){var S=r(s.vector3DToScreenCoords(t.camera,t.screenWidth,t.screenHeight,_),2),M=S[0],E=S[1],T={loX:(M+=4)-2,hiX:M+1+2,loY:E-l/2-2,hiY:E+l/2+2};if(e.insert(T,!0)){var A=n.labelStrings[x],C=n.defaultFontSize*n.scaleFactors[x]*u;if(this.gc.font=C+"px roboto",T.hiX+=this.gc.measureText(A).width-1,e.insert(T)){var P=1;c&&1===n.useSceneOpacityFlags[x]&&(P=m(y.length())),this.gc.fillStyle=this.styleStringFromPackedRgba(n.fillColors,x,P),this.gc.strokeStyle=this.styleStringFromPackedRgba(n.strokeColors,x,P),this.gc.lineWidth=this.styles.label.strokeWidth,this.gc.strokeText(A,M,E),this.gc.lineWidth=this.styles.label.fillWidth,this.gc.fillText(A,M,E)}}}}}},t.prototype.styleStringFromPackedRgba=function(t,e,n){var r=3*e;return"rgba("+t[r]+","+t[r+1]+","+t[r+2]+","+n+")"},t.prototype.onResize=function(t,e){var n=window.devicePixelRatio;this.canvas.width=t*n,this.canvas.height=e*n,this.canvas.style.width=t+"px",this.canvas.style.height=e+"px"},t.prototype.dispose=function(){this.removeAllLabels()},t.prototype.onPointPositionsChanged=function(t){this.worldSpacePointPositions=t,this.removeAllLabels()},t.prototype.onRender=function(t){this.labelsActive&&(this.removeAllLabels(),this.makeLabels(t))},t.prototype.setScene=function(t){},t.prototype.onPickingRender=function(t){},t}();e.ScatterPlotVisualizerCanvasLabels=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n){this.bound=t,this.cellWidth=e,this.cellHeight=n,this.numHorizCells=Math.ceil(this.boundWidth(t)/e),this.numVertCells=Math.ceil(this.boundHeight(t)/n),this.grid=new Array(this.numHorizCells*this.numVertCells)}return t.prototype.boundWidth=function(t){return t.hiX-t.loX},t.prototype.boundHeight=function(t){return t.hiY-t.loY},t.prototype.boundsIntersect=function(t,e){return!(t.loX>e.hiX||t.loY>e.hiY||t.hiX<e.loX||t.hiY<e.loY)},t.prototype.insert=function(t,e){if(void 0===e&&(e=!1),t.hiX<this.bound.loX||t.loX>this.bound.hiX||t.hiY<this.bound.loY||t.loY>this.bound.hiY)return!1;for(var n=this.getCellX(t.loX),r=this.getCellX(t.hiX),i=this.getCellY(t.loY),o=this.getCellY(t.hiY),a=i*this.numHorizCells+n,s=a,c=i;c<=o;c++){for(var l=n;l<=r;l++){var u=this.grid[s++];if(u)for(var d=0;d<u.length;d++)if(this.boundsIntersect(t,u[d]))return!1}s+=this.numHorizCells-(r-n+1)}if(e)return!0;s=a;for(c=i;c<=o;c++){for(l=n;l<=r;l++)this.grid[s]?this.grid[s].push(t):this.grid[s]=[t],s++;s+=this.numHorizCells-(r-n+1)}return!0},t.prototype.getCellX=function(t){return Math.floor((t-this.bound.loX)/this.cellWidth)},t.prototype.getCellY=function(t){return Math.floor((t-this.bound.loY)/this.cellHeight)},t}();e.CollisionGrid=r},function(t,e,n){"use strict";var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),o=n(32),a=n(44),s=function(){function t(){this.id="POLYLINES",this.sequences=[],this.polylines=[],this.polylinePositionBuffer={},this.polylineColorBuffer={},this.pointSequenceIndices=new Map}return t.prototype.getPointSequenceIndex=function(t){return this.pointSequenceIndices.get(t)},t.prototype.updateSequenceIndices=function(){for(var t=0;t<this.sequences.length;t++)for(var e=this.sequences[t],n=0;n<e.indices.length-1;n++){var r=e.indices[n];this.pointSequenceIndices.set(r,t),this.pointSequenceIndices.set(r+1,t)}},t.prototype.createPolylines=function(){var t,e;this.updateSequenceIndices();try{for(var n=r(this.polylines),o=n.next();!o.done;o=n.next()){var a=o.value;this.scene.remove(a),a.geometry.dispose()}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.polylines=[];for(var s=0;s<this.sequences.length;s++){var c=new i.BufferGeometry;c.addAttribute("position",this.polylinePositionBuffer[s]),c.addAttribute("color",this.polylineColorBuffer[s]);var l=new i.LineBasicMaterial({linewidth:1,opacity:1,transparent:!0,vertexColors:i.VertexColors});(a=new i.LineSegments(c,l)).frustumCulled=!1,this.polylines.push(a),this.scene.add(a)}},t.prototype.dispose=function(){var t,e;try{for(var n=r(this.polylines),i=n.next();!i.done;i=n.next()){var o=i.value;this.scene.remove(o),o.geometry.dispose()}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.polylines=[],this.polylinePositionBuffer={},this.polylineColorBuffer={}},t.prototype.setScene=function(t){this.scene=t},t.prototype.setSequences=function(t){this.sequences=t},t.prototype.onPointPositionsChanged=function(t){if(null==t&&this.dispose(),null!=t&&0!==this.sequences.length){for(var e=0;e<this.sequences.length;e++){var n=2*((c=this.sequences[e]).indices.length-1),r=new Float32Array(n*a.XYZ_NUM_ELEMENTS);this.polylinePositionBuffer[e]=new i.BufferAttribute(r,a.XYZ_NUM_ELEMENTS);var s=new Float32Array(n*a.RGBA_NUM_ELEMENTS);this.polylineColorBuffer[e]=new i.BufferAttribute(s,a.RGBA_NUM_ELEMENTS)}for(e=0;e<this.sequences.length;e++){for(var c=this.sequences[e],l=0,u=0;u<c.indices.length-1;u++){var d=c.indices[u],h=c.indices[u+1],f=o.vector3FromPackedArray(t,d),p=o.vector3FromPackedArray(t,h);this.polylinePositionBuffer[e].setXYZ(l,f.x,f.y,f.z),this.polylinePositionBuffer[e].setXYZ(l+1,p.x,p.y,p.z),l+=2}this.polylinePositionBuffer[e].needsUpdate=!0}this.createPolylines()}},t.prototype.onRender=function(t){for(var e=0;e<this.polylines.length;e++){var n=this.polylines[e].material;n.opacity=t.polylineOpacities[e],n.linewidth=t.polylineWidths[e],this.polylineColorBuffer[e].array=t.polylineColors[e],this.polylineColorBuffer[e].needsUpdate=!0}},t.prototype.onPickingRender=function(t){},t.prototype.onResize=function(t,e){},t}();e.ScatterPlotVisualizerPolylines=s},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.BatchRequestCache=void 0;e.BatchRequestCache=class{constructor(t,e){this.requestFn=t,this.keyFn=e,this.resultCache=new Map}call(t){return r(this,void 0,void 0,(function*(){const e=t.map(t=>this.resultCache.get(this.keyFn(t))),n=[];for(let t=0;t<e.length;++t)void 0===e[t]&&n.push(t);if(0===n.length)return e;const r=n.map(e=>t[e]),i=yield this.requestFn(r);return null===i?null:(n.forEach((n,r)=>{const o=this.keyFn(t[n]),a=i[r];this.resultCache.set(o,a),e[n]=a}),e)}))}}},function(t,e,n){"use strict";n.r(e),n.d(e,"styles",(function(){return r}));const r=n(0).css`#scatter-gl-container {
  height: 100%;
  user-select: none;
}

#scatter-gl-container>canvas {
  outline: none;
}

.toolbar-container {
  padding: 2pt 0;
  justify-content: space-between;
  position: absolute
}

.flex-row {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
}

.container {
  position: relative;
  height: 100%;
  overflow: hidden;
}
`},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.getTextDiff=e.GeneratedTextModule=void 0;const a=o(n(109)),s=n(0),c=n(8),l=n(4);n(7);const u=n(13);n(5);const d=n(9),h=n(118),f=n(11);let p=class extends u.LitModule{constructor(){super(...arguments),this.generatedText=[],this.isChecked=!0}static get styles(){return[f.styles,h.styles]}firstUpdated(){this.reactImmediately(()=>this.selectionService.primarySelectedInputData,t=>{null!=t&&this.updateSelection([t])})}updateSelection(t){return i(this,void 0,void 0,(function*(){if(this.generatedText=[],null==t)return;const e=this.appState.currentDataset,n=this.apiService.getPreds(t,this.model,e,["GeneratedText"],"Generating text"),r=yield this.loadLatest("generatedText",n);null!==r&&(this.generatedText=r)}))}render(){const t=this.appState.getModelSpec(this.model),e=d.findSpecKeys(t.output,"GeneratedText").map(e=>t.output[e].parent),n=this.selectionService.primarySelectedInputData;if(null==n)return;const r=[n];return s.html`
      <div>
        <div class="checkbox-container ${r.length>0?"":"hidden"}">
          <lit-checkbox ?checked=${this.isChecked} @change=${t=>{this.isChecked=!this.isChecked}}></lit-checkbox>
          <div>Display word-wise diffs</div>
        </div>
        <div class="results-holder">
          ${this.generatedText.map((t,n)=>this.renderOutput(t,e,r[n]))}
        </div>
      </div>
    `}renderOutput(t,e,n){return Object.keys(t).map((r,i)=>{const o=e[i];if(null==o)return this.renderTranslationText(r,t[r]);{const e=n.data[o];return this.renderDiffText(o,e,r,t[r])}})}renderTranslationText(t,e){return s.html`
      <div class="output">
        <div class="key">${t} </div>
        <div class="value">${e}</div>
      </div>
    `}renderDiffText(t,e,n,r){const i=this.isChecked,o=m(e,r,i);return s.html`
      ${this.renderDiffString(t,o.inputStrings,o.equal,i)}
      ${this.renderDiffString(n,o.outputStrings,o.equal,i)}
      <br>
    `}renderDiffString(t,e,n,r){let i=e;if(r){const t=e.length-1;i=e.map((e,n)=>n!==t?e.concat(" "):e)}return s.html`
      <div class="output">
        <div class="key">${t} </div>
        <div class="value">
          ${i.map((t,e)=>{const r=c.classMap({highlighted:!n[e]});return s.html`<span class=${r}>${t}</span>`})}
        </div>
      </div>
    `}static shouldDisplayModule(t,e){return d.doesOutputSpecContain(t,"GeneratedText")}};function m(t,e,n){const r=t.split(" "),i=e.split(" "),o=(n?new a.default.SequenceMatcher(()=>!1,r,i):new a.default.SequenceMatcher(()=>!1,t,e)).getOpcodes(),s=[],c=[],l=[];for(const a of o){const o=a[0],u=Number(a[1]),d=Number(a[2]),h=Number(a[3]),f=Number(a[4]);l.push("equal"===o),n?(s.push(r.slice(u,d).join(" ")),c.push(i.slice(h,f).join(" "))):(s.push(t.slice(u,d)),c.push(e.slice(h,f)))}return{inputStrings:s,outputStrings:c,equal:l}}p.title="Generated Text",p.template=(t="")=>s.html`
      <generated-text-module model=${t}>
      </generated-text-module>`,r([l.observable],p.prototype,"generatedText",void 0),r([l.observable],p.prototype,"isChecked",void 0),p=r([s.customElement("generated-text-module")],p),e.GeneratedTextModule=p,e.getTextDiff=m},function(t,e,n){t.exports=n(110)},function(t,e,n){(function(){var t,r,i,o,a,s,c,l,u,d,h,f,p,m,g,v,y,b,x,_,w,S=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};l=Math.floor,d=Math.max,h=Math.min,r=n(111),s=n(113),y=function(t,e){return e?2*t/e:1},v=function(t,e){var n,r,i,o,a,s;for(a=[t.length,e.length],n=o=0,s=h(r=a[0],i=a[1]);0<=s?o<s:o>s;n=0<=s?++o:--o){if(t[n]<e[n])return-1;if(t[n]>e[n])return 1}return r-i},w=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},g=function(t){var e,n;for(e=0,n=t.length;e<n;e++)if(t[e])return!0;return!1},a=function(){function t(t,e,n,r){this.isjunk=t,null==e&&(e=""),null==n&&(n=""),this.autojunk=null==r||r,this.a=this.b=null,this.setSeqs(e,n)}return t.name="SequenceMatcher",t.prototype.setSeqs=function(t,e){return this.setSeq1(t),this.setSeq2(e)},t.prototype.setSeq1=function(t){if(t!==this.a)return this.a=t,this.matchingBlocks=this.opcodes=null},t.prototype.setSeq2=function(t){if(t!==this.b)return this.b=t,this.matchingBlocks=this.opcodes=null,this.fullbcount=null,this._chainB()},t.prototype._chainB=function(){var t,e,n,r,i,o,a,s,c,u,d,h,f,p;for(t=this.b,this.b2j=e={},r=u=0,h=t.length;u<h;r=++u)n=t[r],(w(e,n)?e[n]:e[n]=[]).push(r);if(o={},i=this.isjunk)for(d=0,f=(p=Object.keys(e)).length;d<f;d++)i(n=p[d])&&(o[n]=!0,delete e[n]);if(c={},a=t.length,this.autojunk&&a>=200)for(n in s=l(a/100)+1,e)e[n].length>s&&(c[n]=!0,delete e[n]);return this.isbjunk=function(t){return w(o,t)},this.isbpopular=function(t){return w(c,t)}},t.prototype.findLongestMatch=function(t,e,n,r){var i,o,a,s,c,l,u,d,h,f,p,m,g,v,y,b,x,_,S,M,E;for(i=(b=[this.a,this.b,this.b2j,this.isbjunk])[0],o=b[1],a=b[2],d=b[3],s=(x=[t,n,0])[0],c=x[1],l=x[2],f={},u=g=t;t<=e?g<e:g>e;u=t<=e?++g:--g){for(m={},v=0,y=(_=w(a,i[u])?a[i[u]]:[]).length;v<y;v++)if(!((h=_[v])<n)){if(h>=r)break;(p=m[h]=(f[h-1]||0)+1)>l&&(s=(S=[u-p+1,h-p+1,p])[0],c=S[1],l=S[2])}f=m}for(;s>t&&c>n&&!d(o[c-1])&&i[s-1]===o[c-1];)s=(M=[s-1,c-1,l+1])[0],c=M[1],l=M[2];for(;s+l<e&&c+l<r&&!d(o[c+l])&&i[s+l]===o[c+l];)l++;for(;s>t&&c>n&&d(o[c-1])&&i[s-1]===o[c-1];)s=(E=[s-1,c-1,l+1])[0],c=E[1],l=E[2];for(;s+l<e&&c+l<r&&d(o[c+l])&&i[s+l]===o[c+l];)l++;return[s,c,l]},t.prototype.getMatchingBlocks=function(){var t,e,n,r,i,o,a,s,c,l,u,d,h,f,p,m,g,y,b,x,_,w,S,M,E,T;if(this.matchingBlocks)return this.matchingBlocks;for(y=[[0,f=(w=[this.a.length,this.b.length])[0],0,p=w[1]]],m=[];y.length;)e=(S=y.pop())[0],t=S[1],r=S[2],n=S[3],i=(M=b=this.findLongestMatch(e,t,r,n))[0],s=M[1],(u=M[2])&&(m.push(b),e<i&&r<s&&y.push([e,i,r,s]),i+u<t&&s+u<n&&y.push([i+u,t,s+u,n]));for(m.sort(v),o=c=d=0,g=[],x=0,_=m.length;x<_;x++)a=(E=m[x])[0],l=E[1],h=E[2],o+d===a&&c+d===l?d+=h:(d&&g.push([o,c,d]),o=(T=[a,l,h])[0],c=T[1],d=T[2]);return d&&g.push([o,c,d]),g.push([f,p,0]),this.matchingBlocks=g},t.prototype.getOpcodes=function(){var t,e,n,r,i,o,a,s,c,l,u,d;if(this.opcodes)return this.opcodes;for(r=i=0,this.opcodes=e=[],s=0,c=(l=this.getMatchingBlocks()).length;s<c;s++)t=(u=l[s])[0],n=u[1],o=u[2],a="",r<t&&i<n?a="replace":r<t?a="delete":i<n&&(a="insert"),a&&e.push([a,r,t,i,n]),r=(d=[t+o,n+o])[0],i=d[1],o&&e.push(["equal",t,r,n,i]);return e},t.prototype.getGroupedOpcodes=function(t){var e,n,r,i,o,a,s,c,l,u,f,p,m,g,v;for(null==t&&(t=3),(e=this.getOpcodes()).length||(e=[["equal",0,1,0,1]]),"equal"===e[0][0]&&(l=(p=e[0])[0],i=p[1],o=p[2],a=p[3],s=p[4],e[0]=[l,d(i,o-t),o,d(a,s-t),s]),"equal"===e[e.length-1][0]&&(l=(m=e[e.length-1])[0],i=m[1],o=m[2],a=m[3],s=m[4],e[e.length-1]=[l,i,h(o,i+t),a,h(s,a+t)]),c=t+t,r=[],n=[],u=0,f=e.length;u<f;u++)l=(g=e[u])[0],i=g[1],o=g[2],a=g[3],s=g[4],"equal"===l&&o-i>c&&(n.push([l,i,h(o,i+t),a,h(s,a+t)]),r.push(n),n=[],i=(v=[d(i,o-t),d(a,s-t)])[0],a=v[1]),n.push([l,i,o,a,s]);return!n.length||1===n.length&&"equal"===n[0][0]||r.push(n),r},t.prototype.ratio=function(){var t,e,n,r;for(t=0,e=0,n=(r=this.getMatchingBlocks()).length;e<n;e++)t+=r[e][2];return y(t,this.a.length+this.b.length)},t.prototype.quickRatio=function(){var t,e,n,r,i,o,a,s,c,l,u;if(!this.fullbcount)for(this.fullbcount=n={},o=0,s=(l=this.b).length;o<s;o++)n[e=l[o]]=(n[e]||0)+1;for(n=this.fullbcount,t={},r=0,a=0,c=(u=this.a).length;a<c;a++)e=u[a],i=w(t,e)?t[e]:n[e]||0,t[e]=i-1,i>0&&r++;return y(r,this.a.length+this.b.length)},t.prototype.realQuickRatio=function(){var t,e,n;return n=[this.a.length,this.b.length],y(h(t=n[0],e=n[1]),t+e)},t}(),u=function(t,e,n,i){var o,s,c,l,u,d,h,f,p;if(null==n&&(n=3),null==i&&(i=.6),!(n>0))throw new Error("n must be > 0: ("+n+")");if(!(0<=i&&i<=1))throw new Error("cutoff must be in [0.0, 1.0]: ("+i+")");for(o=[],(s=new a).setSeq2(t),l=0,d=e.length;l<d;l++)c=e[l],s.setSeq1(c),s.realQuickRatio()>=i&&s.quickRatio()>=i&&s.ratio()>=i&&o.push([s.ratio(),c]);for(p=[],u=0,h=(o=r.nlargest(o,n,v)).length;u<h;u++)(f=o[u])[0],c=f[1],p.push(c);return p},b=function(t,e){var n,r,i;for(n=(i=[0,t.length])[0],r=i[1];n<r&&t[n]===e;)n++;return n},t=function(){function t(t,e){this.linejunk=t,this.charjunk=e}return t.name="Differ",t.prototype.compare=function(t,e){var n,r,i,o,s,c,l,u,d,h,f,p,m,g;for(l=[],d=0,f=(m=new a(this.linejunk,t,e).getOpcodes()).length;d<f;d++){switch(u=(g=m[d])[0],r=g[1],n=g[2],o=g[3],i=g[4],u){case"replace":s=this._fancyReplace(t,r,n,e,o,i);break;case"delete":s=this._dump("-",t,r,n);break;case"insert":s=this._dump("+",e,o,i);break;case"equal":s=this._dump(" ",t,r,n);break;default:throw new Error("unknow tag ("+u+")")}for(h=0,p=s.length;h<p;h++)c=s[h],l.push(c)}return l},t.prototype._dump=function(t,e,n,r){var i,o,a;for(a=[],i=o=n;n<=r?o<r:o>r;i=n<=r?++o:--o)a.push(t+" "+e[i]);return a},t.prototype._plainReplace=function(t,e,n,r,i,o){var a,c,l,u,d,h,f,p,m,g;for(s(e<n&&i<o),o-i<n-e?(a=this._dump("+",r,i,o),d=this._dump("-",t,e,n)):(a=this._dump("-",t,e,n),d=this._dump("+",r,i,o)),u=[],h=0,p=(g=[a,d]).length;h<p;h++)for(f=0,m=(c=g[h]).length;f<m;f++)l=c[f],u.push(l);return u},t.prototype._fancyReplace=function(t,e,n,r,i,o){var s,c,l,u,d,h,f,p,m,g,v,y,b,x,_,w,S,M,E,T,A,C,P,O,k,L,R,I,N,D,z,j,F,B,U,H,V,G,W,$,q,X,Y,K,Z,J,Q,tt;for(f=(H=[.74,.75])[0],x=H[1],b=new a(this.charjunk),_=(V=[null,null])[0],w=V[1],C=[],M=O=i;i<=o?O<o:O>o;M=i<=o?++O:--O)for(g=r[M],b.setSeq2(g),S=k=e;e<=n?k<n:k>n;S=e<=n?++k:--k)(c=t[S])!==g?(b.setSeq1(c),b.realQuickRatio()>f&&b.quickRatio()>f&&b.ratio()>f&&(f=(X=[b.ratio(),S,M])[0],p=X[1],m=X[2])):null===_&&(_=(q=[S,M])[0],w=q[1]);if(f<x){if(null===_){for(L=0,I=(Y=this._plainReplace(t,e,n,r,i,o)).length;L<I;L++)A=Y[L],C.push(A);return C}p=(K=[_,w,1])[0],m=K[1],f=K[2]}else _=null;for(R=0,N=(Z=this._fancyHelper(t,e,p,r,i,m)).length;R<N;R++)A=Z[R],C.push(A);if(s=(J=[t[p],r[m]])[0],h=J[1],null===_){for(d=y="",b.setSeqs(s,h),F=0,D=(Q=b.getOpcodes()).length;F<D;F++)switch(P=(tt=Q[F])[0],l=tt[1],u=tt[2],v=tt[3],E=(G=[u-l,tt[4]-v])[0],T=G[1],P){case"replace":d+=Array(E+1).join("^"),y+=Array(T+1).join("^");break;case"delete":d+=Array(E+1).join("-");break;case"insert":y+=Array(T+1).join("+");break;case"equal":d+=Array(E+1).join(" "),y+=Array(T+1).join(" ");break;default:throw new Error("unknow tag ("+P+")")}for(B=0,z=(W=this._qformat(s,h,d,y)).length;B<z;B++)A=W[B],C.push(A)}else C.push("  "+s);for(U=0,j=($=this._fancyHelper(t,p+1,n,r,m+1,o)).length;U<j;U++)A=$[U],C.push(A);return C},t.prototype._fancyHelper=function(t,e,n,r,i,o){var a;return a=[],e<n?a=i<o?this._fancyReplace(t,e,n,r,i,o):this._dump("-",t,e,n):i<o&&(a=this._dump("+",r,i,o)),a},t.prototype._qformat=function(t,e,n,r){var i,o;return o=[],i=h(b(t,"\t"),b(e,"\t")),i=h(i,b(n.slice(0,i)," ")),i=h(i,b(r.slice(0,i)," ")),n=n.slice(i).replace(/\s+$/,""),r=r.slice(i).replace(/\s+$/,""),o.push("- "+t),n.length&&o.push("? "+Array(i+1).join("\t")+n+"\n"),o.push("+ "+e),r.length&&o.push("? "+Array(i+1).join("\t")+r+"\n"),o},t}(),o=function(t,e){return null==e&&(e=/^\s*#?\s*$/),e.test(t)},i=function(t,e){return null==e&&(e=" \t"),S.call(e,t)>=0},_=function(t,e){var n,r;return n=t+1,1===(r=e-t)?""+n:(r||n--,n+","+r)},m=function(t,e,n){var r,i,o,s,c,l,u,d,h,f,p,m,g,v,y,b,x,w,S,M,E,T,A,C,P,O,k,L,R,I,N,D,z,j,F,B,U;for(null==(c=(N=null!=n?n:{}).fromfile)&&(c=""),null==(S=N.tofile)&&(S=""),null==(l=N.fromfiledate)&&(l=""),null==(M=N.tofiledate)&&(M=""),null==N.n&&3,null==(y=N.lineterm)&&(y="\n"),v=[],b=!1,E=0,P=(D=new a(null,t,e).getGroupedOpcodes()).length;E<P;E++)for(u=D[E],b||(b=!0,s=l?"\t"+l:"",w=M?"\t"+M:"",v.push("--- "+c+s+y),v.push("+++ "+S+w+y)),m=(z=[u[0],u[u.length-1]])[1],r=_((o=z[0])[1],m[2]),i=_(o[3],m[4]),v.push("@@ -"+r+" +"+i+" @@"+y),T=0,O=u.length;T<O;T++)if(x=(j=u[T])[0],d=j[1],h=j[2],f=j[3],p=j[4],"equal"!==x){if("replace"===x||"delete"===x)for(C=0,L=(B=t.slice(d,h)).length;C<L;C++)g=B[C],v.push("-"+g);if("replace"===x||"insert"===x)for(I=0,R=(U=e.slice(f,p)).length;I<R;I++)g=U[I],v.push("+"+g)}else for(A=0,k=(F=t.slice(d,h)).length;A<k;A++)g=F[A],v.push(" "+g);return v},x=function(t,e){var n,r;return n=t+1,(r=e-t)||n--,r<=1?""+n:n+","+(n+r-1)},c=function(t,e,n){var r,i,o,s,c,l,u,d,h,f,p,m,v,y,b,_,w,S,M,E,T,A,C,P,O,k,L,R,I,N,D,z,j,F,B,U,H,V;for(null==(c=(z=null!=n?n:{}).fromfile)&&(c=""),null==(E=z.tofile)&&(E=""),null==(l=z.fromfiledate)&&(l=""),null==(T=z.tofiledate)&&(T=""),null==z.n&&3,null==(b=z.lineterm)&&(b="\n"),_={insert:"+ ",delete:"- ",replace:"! ",equal:"  "},w=!1,y=[],A=0,k=(j=new a(null,t,e).getGroupedOpcodes()).length;A<k;A++)if(u=j[A],!w){if(w=!0,s=l?"\t"+l:"",M=T?"\t"+T:"",y.push("*** "+c+s+b),y.push("--- "+E+M+b),o=(F=[u[0],u[u.length-1]])[0],m=F[1],y.push("***************"+b),r=x(o[1],m[2]),y.push("*** "+r+" ****"+b),g(function(){var t,e,n,r;for(r=[],t=0,e=u.length;t<e;t++)n=u[t],S=n[0],n[1],n[2],n[3],n[4],r.push("replace"===S||"delete"===S);return r}()))for(C=0,L=u.length;C<L;C++)if(B=u[C],S=B[0],d=B[1],h=B[2],B[3],B[4],"insert"!==S)for(P=0,R=(U=t.slice(d,h)).length;P<R;P++)v=U[P],y.push(_[S]+v);if(i=x(o[3],m[4]),y.push("--- "+i+" ----"+b),g(function(){var t,e,n,r;for(r=[],t=0,e=u.length;t<e;t++)n=u[t],S=n[0],n[1],n[2],n[3],n[4],r.push("replace"===S||"insert"===S);return r}()))for(O=0,I=u.length;O<I;O++)if(H=u[O],S=H[0],H[1],H[2],f=H[3],p=H[4],"delete"!==S)for(D=0,N=(V=e.slice(f,p)).length;D<N;D++)v=V[D],y.push(_[S]+v)}return y},f=function(e,n,r,o){return null==o&&(o=i),new t(r,o).compare(e,n)},p=function(t,e){var n,r,i,o,a,s,c;if(!(o={1:"- ",2:"+ "}[e]))throw new Error("unknow delta choice (must be 1 or 2): "+e);for(i=["  ",o],r=[],a=0,s=t.length;a<s;a++)c=(n=t[a]).slice(0,2),S.call(i,c)>=0&&r.push(n.slice(2));return r},e._arrayCmp=v,e.SequenceMatcher=a,e.getCloseMatches=u,e._countLeading=b,e.Differ=t,e.IS_LINE_JUNK=o,e.IS_CHARACTER_JUNK=i,e._formatRangeUnified=_,e.unifiedDiff=m,e._formatRangeContext=x,e.contextDiff=c,e.ndiff=f,e.restore=p}).call(this)},function(t,e,n){t.exports=n(112)},function(t,e,n){var r,i,o;(function(){var n,a,s,c,l,u,d,h,f,p,m,g,v,y,b;s=Math.floor,p=Math.min,a=function(t,e){return t<e?-1:t>e?1:0},f=function(t,e,n,r,i){var o;if(null==n&&(n=0),null==i&&(i=a),n<0)throw new Error("lo must be non-negative");for(null==r&&(r=t.length);n<r;)i(e,t[o=s((n+r)/2)])<0?r=o:n=o+1;return[].splice.apply(t,[n,n-n].concat(e)),e},u=function(t,e,n){return null==n&&(n=a),t.push(e),y(t,0,t.length-1,n)},l=function(t,e){var n,r;return null==e&&(e=a),n=t.pop(),t.length?(r=t[0],t[0]=n,b(t,0,e)):r=n,r},h=function(t,e,n){var r;return null==n&&(n=a),r=t[0],t[0]=e,b(t,0,n),r},d=function(t,e,n){var r;return null==n&&(n=a),t.length&&n(t[0],e)<0&&(e=(r=[t[0],e])[0],t[0]=r[1],b(t,0,n)),e},c=function(t,e){var n,r,i,o,c,l;for(null==e&&(e=a),c=[],r=0,i=(o=function(){l=[];for(var e=0,n=s(t.length/2);0<=n?e<n:e>n;0<=n?e++:e--)l.push(e);return l}.apply(this).reverse()).length;r<i;r++)n=o[r],c.push(b(t,n,e));return c},v=function(t,e,n){var r;if(null==n&&(n=a),-1!==(r=t.indexOf(e)))return y(t,0,r,n),b(t,r,n)},m=function(t,e,n){var r,i,o,s,l;if(null==n&&(n=a),!(i=t.slice(0,e)).length)return i;for(c(i,n),o=0,s=(l=t.slice(e)).length;o<s;o++)r=l[o],d(i,r,n);return i.sort(n).reverse()},g=function(t,e,n){var r,i,o,s,u,d,h,m,g;if(null==n&&(n=a),10*e<=t.length){if(!(o=t.slice(0,e).sort(n)).length)return o;for(i=o[o.length-1],s=0,d=(h=t.slice(e)).length;s<d;s++)n(r=h[s],i)<0&&(f(o,r,0,null,n),o.pop(),i=o[o.length-1]);return o}for(c(t,n),g=[],u=0,m=p(e,t.length);0<=m?u<m:u>m;0<=m?++u:--u)g.push(l(t,n));return g},y=function(t,e,n,r){var i,o,s;for(null==r&&(r=a),i=t[n];n>e&&r(i,o=t[s=n-1>>1])<0;)t[n]=o,n=s;return t[n]=i},b=function(t,e,n){var r,i,o,s,c;for(null==n&&(n=a),i=t.length,c=e,o=t[e],r=2*e+1;r<i;)(s=r+1)<i&&!(n(t[r],t[s])<0)&&(r=s),t[e]=t[r],r=2*(e=r)+1;return t[e]=o,y(t,c,e,n)},n=function(){function t(t){this.cmp=null!=t?t:a,this.nodes=[]}return t.push=u,t.pop=l,t.replace=h,t.pushpop=d,t.heapify=c,t.updateItem=v,t.nlargest=m,t.nsmallest=g,t.prototype.push=function(t){return u(this.nodes,t,this.cmp)},t.prototype.pop=function(){return l(this.nodes,this.cmp)},t.prototype.peek=function(){return this.nodes[0]},t.prototype.contains=function(t){return-1!==this.nodes.indexOf(t)},t.prototype.replace=function(t){return h(this.nodes,t,this.cmp)},t.prototype.pushpop=function(t){return d(this.nodes,t,this.cmp)},t.prototype.heapify=function(){return c(this.nodes,this.cmp)},t.prototype.updateItem=function(t){return v(this.nodes,t,this.cmp)},t.prototype.clear=function(){return this.nodes=[]},t.prototype.empty=function(){return 0===this.nodes.length},t.prototype.size=function(){return this.nodes.length},t.prototype.clone=function(){var e;return(e=new t).nodes=this.nodes.slice(0),e},t.prototype.toArray=function(){return this.nodes.slice(0)},t.prototype.insert=t.prototype.push,t.prototype.top=t.prototype.peek,t.prototype.front=t.prototype.peek,t.prototype.has=t.prototype.contains,t.prototype.copy=t.prototype.clone,t}(),i=[],void 0===(o="function"==typeof(r=function(){return n})?r.apply(e,i):r)||(t.exports=o)}).call(this)},function(t,e,n){"use strict";(function(e){var r=n(114);
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function i(t,e){if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0}function o(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var a=n(115),s=Object.prototype.hasOwnProperty,c=Array.prototype.slice,l="foo"===function(){}.name;function u(t){return Object.prototype.toString.call(t)}function d(t){return!o(t)&&("function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer))))}var h=t.exports=y,f=/\s*function\s+([^\(\s]*)\s*/;function p(t){if(a.isFunction(t)){if(l)return t.name;var e=t.toString().match(f);return e&&e[1]}}function m(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function g(t){if(l||!a.isFunction(t))return a.inspect(t);var e=p(t);return"[Function"+(e?": "+e:"")+"]"}function v(t,e,n,r,i){throw new h.AssertionError({message:n,actual:t,expected:e,operator:r,stackStartFunction:i})}function y(t,e){t||v(t,!0,e,"==",h.ok)}function b(t,e,n,r){if(t===e)return!0;if(o(t)&&o(e))return 0===i(t,e);if(a.isDate(t)&&a.isDate(e))return t.getTime()===e.getTime();if(a.isRegExp(t)&&a.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(d(t)&&d(e)&&u(t)===u(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===i(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(o(t)!==o(e))return!1;var s=(r=r||{actual:[],expected:[]}).actual.indexOf(t);return-1!==s&&s===r.expected.indexOf(e)||(r.actual.push(t),r.expected.push(e),function(t,e,n,r){if(null==t||null==e)return!1;if(a.isPrimitive(t)||a.isPrimitive(e))return t===e;if(n&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var i=x(t),o=x(e);if(i&&!o||!i&&o)return!1;if(i)return t=c.call(t),e=c.call(e),b(t,e,n);var s,l,u=S(t),d=S(e);if(u.length!==d.length)return!1;for(u.sort(),d.sort(),l=u.length-1;l>=0;l--)if(u[l]!==d[l])return!1;for(l=u.length-1;l>=0;l--)if(s=u[l],!b(t[s],e[s],n,r))return!1;return!0}(t,e,n,r))}return n?t===e:t==e}function x(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function _(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function w(t,e,n,r){var i;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),i=function(t){var e;try{t()}catch(t){e=t}return e}(e),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),t&&!i&&v(i,n,"Missing expected exception"+r);var o="string"==typeof r,s=!t&&i&&!n;if((!t&&a.isError(i)&&o&&_(i,n)||s)&&v(i,n,"Got unwanted exception"+r),t&&i&&n&&!_(i,n)||!t&&i)throw i}h.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=function(t){return m(g(t.actual),128)+" "+t.operator+" "+m(g(t.expected),128)}(this),this.generatedMessage=!0);var e=t.stackStartFunction||v;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var n=new Error;if(n.stack){var r=n.stack,i=p(e),o=r.indexOf("\n"+i);if(o>=0){var a=r.indexOf("\n",o+1);r=r.substring(a+1)}this.stack=r}}},a.inherits(h.AssertionError,Error),h.fail=v,h.ok=y,h.equal=function(t,e,n){t!=e&&v(t,e,n,"==",h.equal)},h.notEqual=function(t,e,n){t==e&&v(t,e,n,"!=",h.notEqual)},h.deepEqual=function(t,e,n){b(t,e,!1)||v(t,e,n,"deepEqual",h.deepEqual)},h.deepStrictEqual=function(t,e,n){b(t,e,!0)||v(t,e,n,"deepStrictEqual",h.deepStrictEqual)},h.notDeepEqual=function(t,e,n){b(t,e,!1)&&v(t,e,n,"notDeepEqual",h.notDeepEqual)},h.notDeepStrictEqual=function t(e,n,r){b(e,n,!0)&&v(e,n,r,"notDeepStrictEqual",t)},h.strictEqual=function(t,e,n){t!==e&&v(t,e,n,"===",h.strictEqual)},h.notStrictEqual=function(t,e,n){t===e&&v(t,e,n,"!==",h.notStrictEqual)},h.throws=function(t,e,n){w(!0,t,e,n)},h.doesNotThrow=function(t,e,n){w(!1,t,e,n)},h.ifError=function(t){if(t)throw t},h.strict=r((function t(e,n){e||v(e,!0,n,"==",t)}),h,{equal:h.strictEqual,deepEqual:h.deepStrictEqual,notEqual:h.notStrictEqual,notDeepEqual:h.notDeepStrictEqual}),h.strict.strict=h.strict;var S=Object.keys||function(t){var e=[];for(var n in t)s.call(t,n)&&e.push(n);return e}}).call(this,n(54))},function(t,e,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function a(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,s,c=a(t),l=1;l<arguments.length;l++){for(var u in n=Object(arguments[l]))i.call(n,u)&&(c[u]=n[u]);if(r){s=r(n);for(var d=0;d<s.length;d++)o.call(n,s[d])&&(c[s[d]]=n[s[d]])}}return c}},function(t,e,n){(function(t){var r=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++)n[e[r]]=Object.getOwnPropertyDescriptor(t,e[r]);return n},i=/%[sdj%]/g;e.format=function(t){if(!v(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(s(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,o=r.length,a=String(t).replace(i,(function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}})),c=r[n];n<o;c=r[++n])m(c)||!x(c)?a+=" "+c:a+=" "+s(c);return a},e.deprecate=function(n,r){if(void 0!==t&&!0===t.noDeprecation)return n;if(void 0===t)return function(){return e.deprecate(n,r).apply(this,arguments)};var i=!1;return function(){if(!i){if(t.throwDeprecation)throw new Error(r);t.traceDeprecation?console.trace(r):console.error(r),i=!0}return n.apply(this,arguments)}};var o,a={};function s(t,n){var r={seen:[],stylize:l};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),p(n)?r.showHidden=n:n&&e._extend(r,n),y(r.showHidden)&&(r.showHidden=!1),y(r.depth)&&(r.depth=2),y(r.colors)&&(r.colors=!1),y(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),u(r,t,r.depth)}function c(t,e){var n=s.styles[e];return n?"["+s.colors[n][0]+"m"+t+"["+s.colors[n][1]+"m":t}function l(t,e){return t}function u(t,n,r){if(t.customInspect&&n&&S(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return v(i)||(i=u(t,i,r)),i}var o=function(t,e){if(y(e))return t.stylize("undefined","undefined");if(v(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(g(e))return t.stylize(""+e,"number");if(p(e))return t.stylize(""+e,"boolean");if(m(e))return t.stylize("null","null")}(t,n);if(o)return o;var a=Object.keys(n),s=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(n)),w(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return d(n);if(0===a.length){if(S(n)){var c=n.name?": "+n.name:"";return t.stylize("[Function"+c+"]","special")}if(b(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(_(n))return t.stylize(Date.prototype.toString.call(n),"date");if(w(n))return d(n)}var l,x="",M=!1,E=["{","}"];(f(n)&&(M=!0,E=["[","]"]),S(n))&&(x=" [Function"+(n.name?": "+n.name:"")+"]");return b(n)&&(x=" "+RegExp.prototype.toString.call(n)),_(n)&&(x=" "+Date.prototype.toUTCString.call(n)),w(n)&&(x=" "+d(n)),0!==a.length||M&&0!=n.length?r<0?b(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),l=M?function(t,e,n,r,i){for(var o=[],a=0,s=e.length;a<s;++a)C(e,String(a))?o.push(h(t,e,n,r,String(a),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(h(t,e,n,r,i,!0))})),o}(t,n,r,s,a):a.map((function(e){return h(t,n,r,s,e,M)})),t.seen.pop(),function(t,e,n){if(t.reduce((function(t,e){return e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(l,x,E)):E[0]+x+E[1]}function d(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,n,r,i,o){var a,s,c;if((c=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?s=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(s=t.stylize("[Setter]","special")),C(r,i)||(a="["+i+"]"),s||(t.seen.indexOf(c.value)<0?(s=m(n)?u(t,c.value,null):u(t,c.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+s.split("\n").map((function(t){return"   "+t})).join("\n")):s=t.stylize("[Circular]","special")),y(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function f(t){return Array.isArray(t)}function p(t){return"boolean"==typeof t}function m(t){return null===t}function g(t){return"number"==typeof t}function v(t){return"string"==typeof t}function y(t){return void 0===t}function b(t){return x(t)&&"[object RegExp]"===M(t)}function x(t){return"object"==typeof t&&null!==t}function _(t){return x(t)&&"[object Date]"===M(t)}function w(t){return x(t)&&("[object Error]"===M(t)||t instanceof Error)}function S(t){return"function"==typeof t}function M(t){return Object.prototype.toString.call(t)}function E(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(n){if(y(o)&&(o=t.env.NODE_DEBUG||""),n=n.toUpperCase(),!a[n])if(new RegExp("\\b"+n+"\\b","i").test(o)){var r=t.pid;a[n]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",n,r,t)}}else a[n]=function(){};return a[n]},e.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=f,e.isBoolean=p,e.isNull=m,e.isNullOrUndefined=function(t){return null==t},e.isNumber=g,e.isString=v,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=y,e.isRegExp=b,e.isObject=x,e.isDate=_,e.isError=w,e.isFunction=S,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(116);var T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function A(){var t=new Date,e=[E(t.getHours()),E(t.getMinutes()),E(t.getSeconds())].join(":");return[t.getDate(),T[t.getMonth()],e].join(" ")}function C(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",A(),e.format.apply(e,arguments))},e.inherits=n(117),e._extend=function(t,e){if(!e||!x(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t};var P="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function O(t,e){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return e(t)}e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(P&&t[P]){var e;if("function"!=typeof(e=t[P]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,P,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,n,r=new Promise((function(t,r){e=t,n=r})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(t,r){t?n(t):e(r)}));try{t.apply(this,i)}catch(t){n(t)}return r}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),P&&Object.defineProperty(e,P,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,r(t))},e.promisify.custom=P,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var i=n.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var o=this,a=function(){return i.apply(o,arguments)};e.apply(this,n).then((function(e){t.nextTick(a,null,e)}),(function(e){t.nextTick(O,e,a)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),Object.defineProperties(n,r(e)),n}}).call(this,n(53))},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){"use strict";n.r(e),n.d(e,"styles",(function(){return r}));const r=n(0).css`.output {
  display: flex;
  margin-top: 10px;
  margin-left: 5px;
  min-height: 45px;
}

.key {
  font-weight: bold;
  min-width: 100px;
}

.results-holder {
  max-height: 400px;
  overflow-y: scroll;
}

.highlighted {
  color: #ffa500;
  font-weight: bold;
}

.checkbox-container {
  height: 45px;
  display: flex;
  flex-direction: row;
  justify-content: start;
  align-items: center;
}

.hidden {
  visibility: hidden;
}
`},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.GeneratorModule=void 0;const o=n(0),a=n(8),s=n(15),c=n(4),l=n(7),u=n(13);n(5);const d=n(9),h=n(29),f=n(10),p=n(120),m=n(11);let g=class extends u.LitModule{constructor(){super(...arguments),this.groupService=l.app.getService(h.GroupService),this.editedData={},this.isGenerating=!1,this.sourceExamples=[],this.generated=[],this.appliedGenerator=null,this.datapointEdited=!1,this.substitutions="great -> terrible",this.embeddingSelection=0}static get styles(){return[m.styles,p.styles]}get datasetName(){return this.appState.currentDataset}get modelName(){return this.appState.currentModels[0]}get embeddingFields(){const t=this.appState.currentModels[0],e=this.appState.currentModelSpecs[t].spec;return d.findSpecKeys(e.output,"Embeddings")}get totalNumGenerated(){return this.generated.reduce((t,e)=>t+e.length,0)}firstUpdated(){this.reactImmediately(()=>this.selectionService.primarySelectedInputData,t=>{this.selectionService.lastUser!==this&&this.resetEditedData()}),this.react(()=>this.totalNumGenerated,t=>{t<=0&&this.resetEditedData()})}updated(){const t=this.shadowRoot.getElementById("header"),e=this.shadowRoot.querySelector(".row");if(t)for(let n=0;n<t.children.length;n++){const r=e.children[n].offsetWidth;t.children[n].style.minWidth=r+"px"}}resetEditedData(){this.sourceExamples=[],this.generated=[],this.appliedGenerator=null}handleGeneratorClick(t,e){this.isGenerating||this.generate(t,this.modelName,e)}generate(t,e,n){return i(this,void 0,void 0,(function*(){this.isGenerating=!0,this.sourceExamples=this.selectionService.selectedOrAllInputData;const r=yield this.apiService.getGenerated(this.sourceExamples,e,this.appState.currentDataset,t,n);this.generated=r,this.appliedGenerator=t,this.isGenerating=!1}))}createNewDatapoints(t,e,n){return i(this,void 0,void 0,(function*(){const r=yield this.appState.createNewDatapoints(t,e,n),i=r.map(t=>t.id);if(0!==i.length&&(this.selectionService.selectIds([...e,...i],this),this.selectionService.setPrimarySelection(i[0],this),this.appState.compareExamplesEnabled)){const t=l.app.getServiceArray(f.SelectionService)[1];t.selectIds([...e,...i],this);const n=r[0].meta.parentId;t.setPrimarySelection(n,this)}}))}render(){return o.html`
      <div class="generator-module-wrapper">
        ${this.renderGeneratorButtons()}
        ${this.renderGenerated()}
      </div>
    `}renderGenerated(){const t=this.isGenerating,e=null!==this.appliedGenerator&&0===this.totalNumGenerated;return o.html`
        <div id='generated-holder'>
          ${this.renderHeader()}
          <div class="entries">
            ${t?o.html`<div>Generating...</div>`:null}
            ${e?o.html`<div>Nothing available for this generator</div>`:null}
            ${this.renderEntries()}
        </div>
      </div>
    `}renderEntries(){const t=this.sourceExamples;return this.generated.map((e,n)=>e.map((e,r)=>{const a=Object.keys(e);return o.html`
          <div class='row'>
            ${a.map(t=>this.renderEntry(t,e[t],!1))}
            <button class="button add-button" @click=${()=>i(this,void 0,void 0,(function*(){const i=t[n].id;this.generated[n].splice(r,1),yield this.createNewDatapoints([[e]],[i],this.appliedGenerator)}))}>Add</button>
            <button class="button" @click=${()=>{this.generated[n].splice(r,1)}}>Remove</button>
          </div>
        `}))}renderHeader(){return this.totalNumGenerated<=0?null:o.html`
      <div id='header'>
        ${this.renderKeys()}
        ${this.totalNumGenerated<=0?null:o.html`
          <button class='button add-button' @click=${()=>i(this,void 0,void 0,(function*(){const t=this.sourceExamples.map(t=>t.id);yield this.createNewDatapoints(this.generated,t,this.appliedGenerator),this.resetEditedData()}))}>
             Add (${this.totalNumGenerated})
          </button>
          <button class='button' @click=${this.resetEditedData}>
             Clear
          </button>
        `}
      </div>`}renderKeys(){const t=this.appState.currentInputDataKeys;return o.html`${t.map(t=>o.html`<div class='entry'>${t}</div>`)}`}renderGeneratorButtons(){const t=this.selectionService.selectedOrAllInputData,e=this.appState.metadata.generators,n=this.appState.metadata.generators.length>0?`Generate counterfactuals for current selection (${t.length} datapoint${1===t.length?"":"s"}):`:"No generators provided by the server.",r=t=>{const e=t.target;this.substitutions=e.value},i=t=>{const e=t.map((t,e)=>o.html`
          <option value=${e}>${t}</option>
        `),n=t[0];return o.html`
      <span class="dropdown-container">
        <label class="dropdown-label">Embedding</label>
        <select class="dropdown" @change=${t=>{const e=t.target;this.embeddingSelection=(null==e?void 0:e.selectedIndex)||0}} .value=${n}>
          ${e}
        </select>
      </span>
    `},a=t=>o.html`
        <div class='generator-control'>
          <button @click=${()=>{this.handleGeneratorClick(t)}}>${t}</button>
        </div>`,c=t=>o.html`
        <div>
          <button @click=${()=>{this.handleGeneratorClick(t,{model_name:this.modelName,dataset_name:this.datasetName,field_name:this.embeddingFields[this.embeddingSelection]})}}>${t}</button>
          ${i(this.embeddingFields)}
        </div>`,l=t=>o.html`
        <div class='generator-control'>
          <button @click=${()=>{this.handleGeneratorClick(t,{subs:this.substitutions})}}>${t}</button>
          <label class="input-label">Substitutions: </label>
          <input type="text" style=${s.styleMap({width:"40%"})}
            @input=${r}
            .value="${this.substitutions}" />
        </div>`;return o.html`
        <div id="generators">
          <div>${n}</div>
          ${e.map(t=>"similarity_searcher"===t?c(t):"word_replacer"===t?l(t):a(t))}
        </div>
    `}renderEntry(t,e,n){const r=this.groupService.categoricalFeatureNames.includes(t),i=e=>{this.datapointEdited=!0,this.editedData[t]=e.target.value},s=t=>{d.handleEnterKey(t,()=>{this.shadowRoot.getElementById("make").click()})},c=a.classMap({entry:!0,text:!r});return o.html`
      <div class=${c} @keyup=${t=>{s(t)}}>
          ${r?(()=>{const n=this.groupService.categoricalFeatures[t];return o.html`
      <select class="dropdown"
        @change=${i}>
        <option value="" selected></option>
        ${n.map(t=>o.html`
            <option
              value="${t}"
              ?selected=${t===e}
              >
              ${t}
            </option>`)}
      </select>`})():n?o.html`
      <input type="text" class="input-box" @input=${i}
      .value="${e}" />`:o.html`<div>${e}</div>`}
      </div>
    `}static shouldDisplayModule(t,e){return!0}};g.title="Datapoint Generator",g.numCols=12,g.template=()=>o.html`<generator-module></generator-module>`,g.duplicateForModelComparison=!1,r([c.observable],g.prototype,"editedData",void 0),r([c.observable],g.prototype,"isGenerating",void 0),r([c.observable],g.prototype,"sourceExamples",void 0),r([c.observable],g.prototype,"generated",void 0),r([c.observable],g.prototype,"appliedGenerator",void 0),r([c.observable],g.prototype,"datapointEdited",void 0),r([c.observable],g.prototype,"substitutions",void 0),r([c.observable],g.prototype,"embeddingSelection",void 0),r([c.computed],g.prototype,"datasetName",null),r([c.computed],g.prototype,"modelName",null),r([c.computed],g.prototype,"embeddingFields",null),r([c.computed],g.prototype,"totalNumGenerated",null),g=r([o.customElement("generator-module")],g),e.GeneratorModule=g},function(t,e,n){"use strict";n.r(e),n.d(e,"styles",(function(){return r}));const r=n(0).css`.generator-module-wrapper {
  height: 100%;
  display: flex;
  flex-direction: row;
}

#generators {
  flex: 1;
  margin-right: 15px;
}

#generators .label {
  font-size: 16px;
  font-weight: bold;
  margin-bottom: 10px;
}

#generators.visible {
  display: block;
}

#generated-holder {
  height: 100%;
  flex: 2;
}

.generator-control {
  display: flex;
  flex-direction: row;
}

.entries {
  max-height: calc(100% - 20px); /** Offset the height of the toolbar**/
  overflow-y: scroll;
}

.input-label {
  margin-right: 4px;
  padding: 10px;
}

.input-box {
  width: 95%;
}

.row {
  display: flex;
  align-items: center;
}

.row:hover {
    background: #f8f9fa;
}

.entry {
  margin: 5px 10px;
}

.entry.text{
  flex: 1;
}

.entry > div {
  width: 100%;
}

.add-button {
  min-width: 65px;
}

#header{
  height: 35px;
  display: flex;
  align-items: center;
  text-align: center;
  background: rgb(245, 252, 252);
  border-bottom: 1px solid rgb(218, 220, 224);
}

`},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.LanguageModelPredictionModule=void 0,n(36);const o=n(0),a=n(8),s=n(4);n(7);const c=n(13);n(5);const l=n(9),u=n(122),d=n(11);let h=class extends c.LitModule{constructor(){super(...arguments),this.maskToken="[MASK]",this.clickToMask=!1,this.tokens=[],this.selectedInput=null,this.maskApplied=!1,this.lmResults=[],this.selectedTokenIndex=null}static get styles(){return[d.styles,u.styles]}get predKey(){const t=this.appState.getModelSpec(this.model);return l.findSpecKeys(t.output,"TokenTopKPreds")[0]}get outputTokensKey(){return this.appState.getModelSpec(this.model).output[this.predKey].align}get inputTokensKey(){const t=this.appState.getModelSpec(this.model);return t.input.hasOwnProperty(this.outputTokensKey)&&l.isLitSubtype(t.input[this.outputTokensKey],"Tokens")?this.outputTokensKey:null}firstUpdated(){this.reactImmediately(()=>this.selectionService.primarySelectedInputData,t=>{this.updateSelection(t)})}updateSelection(t){return i(this,void 0,void 0,(function*(){if(this.selectedTokenIndex=null,null==t)return this.selectedInput=null,this.tokens=[],void(this.lmResults=[]);const e=this.appState.currentDataset,n=this.apiService.getPreds([t],this.model,e,["Tokens","TokenTopKPreds"],"Loading tokens"),r=yield this.loadLatest("modelPreds",n);if(null===r)return;const i=r[0];this.tokens=i[this.outputTokensKey],this.lmResults=i[this.predKey],this.selectedInput=t;const o=this.tokens.indexOf(this.maskToken);-1!==o&&(this.selectedTokenIndex=o),0===l.flatten(this.lmResults).length&&null!=this.inputTokensKey&&(this.clickToMask=!0)}))}updateLmResults(t){return i(this,void 0,void 0,(function*(){if(null!=this.selectedInput){if(this.clickToMask){if(null==this.inputTokensKey)return;const e=[...this.tokens];e[t]=this.maskToken;const n=[{data:Object.assign({},this.selectedInput.data,{[this.inputTokensKey]:e}),id:"",meta:{}}],r=this.appState.currentDataset,i=this.apiService.getPreds(n,this.model,r,["TokenTopKPreds"]),o=yield this.loadLatest("mlmResults",i);if(null===o)return;this.lmResults=o[0][this.predKey],this.maskApplied=!0}this.selectedTokenIndex=t}}))}updated(){if(null==this.selectedTokenIndex)return;const t=this.shadowRoot.querySelectorAll(".token")[this.selectedTokenIndex].offsetLeft;this.shadowRoot.getElementById("output-words").style.marginLeft=t-8+"px"}render(){return o.html`
      ${this.renderControls()}
      ${this.renderInputWords()}
      ${this.renderOutputWords()}
    `}renderControls(){return o.html`
      <div id='controls'>
        ${this.inputTokensKey?o.html`
          <lit-checkbox label="Click to mask?"
            ?checked=${this.clickToMask}
            @change=${()=>{this.clickToMask=!this.clickToMask}}
          ></lit-checkbox>
        `:null}
      </div>
    `}renderInputWords(){return o.html`
      <div id="input-words">
        ${this.tokens.map((t,e)=>{const n=a.classMap({token:!0,selected:e===this.selectedTokenIndex,masked:e===this.selectedTokenIndex&&this.maskApplied});return o.html`<div class=${n} @click=${()=>{e===this.selectedTokenIndex?(this.selectedTokenIndex=null,this.maskApplied=!1):this.updateLmResults(e)}}>${t}</div>`})}
      </div>
    `}renderOutputWords(){if(null===this.selectedTokenIndex||null===this.lmResults)return o.html``;const t=this.selectedTokenIndex||0;return o.html`
      <div id="output-words">
        ${this.lmResults[t].map(e=>{const n=this.tokens[t],r=e[0],i=(100*e[1]).toFixed(1),s=a.classMap({output:!0,same:r===n});return o.html`<div class=${s}>${r} ${i}%</div>`})}
      </div>
    `}static shouldDisplayModule(t,e){return l.doesOutputSpecContain(t,"TokenTopKPreds")}};h.title="LM Predictions",h.duplicateForExampleComparison=!0,h.duplicateAsRow=!0,h.numCols=6,h.template=(t="",e=0)=>o.html`<lm-prediction-module model=${t} selectionServiceIndex=${e}></lm-prediction-module>`,r([o.property({type:String})],h.prototype,"maskToken",void 0),r([s.observable],h.prototype,"clickToMask",void 0),r([s.observable],h.prototype,"tokens",void 0),r([s.observable],h.prototype,"selectedInput",void 0),r([s.observable],h.prototype,"maskApplied",void 0),r([s.observable],h.prototype,"lmResults",void 0),r([s.observable],h.prototype,"selectedTokenIndex",void 0),r([s.computed],h.prototype,"predKey",null),r([s.computed],h.prototype,"outputTokensKey",null),r([s.computed],h.prototype,"inputTokensKey",null),h=r([o.customElement("lm-prediction-module")],h),e.LanguageModelPredictionModule=h},function(t,e,n){"use strict";n.r(e),n.d(e,"styles",(function(){return r}));const r=n(0).css`#input-words {
  display: flex;
  flex-direction: row;
  font-family: 'Share Tech Mono', monospace;
}

.token {
  padding: 5px;
  margin: 5px;
  background-color: #1c313a;
  color: white;
}

.token:hover {
  background-color: #a4a4a4;
  cursor: pointer;
}

.token.selected {
  background-color: #fbc02d;
}

.token.masked {
  text-decoration: line-through;
}

#outputs-container {
  padding-bottom: 1rem;
}

.output {
  width: max-content;
  padding: 5px;
  background-color: #fff263;
  font-family: 'Share Tech Mono', monospace;
}

.output.same {
  border: 3px solid #fbc02d;
  box-sizing: border-box;
}

.instructions {
  padding: 5px;
}

.hidden {
  display: none;
}
`},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.MetricsModule=void 0;const o=n(0),a=n(4),s=n(7),c=n(13);n(61),n(5),n(9);const l=n(29),u=n(10),d=n(124),h=n(11);let f=class extends c.LitModule{constructor(){super(...arguments),this.sliceService=s.app.getService(u.SliceService),this.groupService=s.app.getService(l.GroupService),this.classificationService=s.app.getService(u.ClassificationService),this.datasetMetrics=null,this.metricsList=[],this.facetBySlice=!1,this.selectedFacets=[]}static get styles(){return[h.styles,d.styles]}get tableData(){const t=this.appState.currentModels;let e=[];this.metricsList.forEach(n=>{const r=this.createRowsForMetrics(n.metrics,t,n.name,n.length,n.facets);null!=r&&(e=e.concat(r))});const n=new Set;e.forEach(t=>{Object.keys(t.metrics).forEach(t=>{n.add(t)})});const r=[...n],i=this.selectedFacets,o=e.map(t=>{const e=r.map(e=>{var n;const r=null!==(n=t.metrics[e])&&void 0!==n?n:"-";return"number"==typeof r&&r%1!=0?r.toFixed(3):r}),n=this.selectedFacets.map(e=>t.facets&&t.facets[e]?t.facets[e]:"-");return[t.model,t.selection,t.predKey,t.group,t.numExamples,...n,...e]});return{header:["Model","From","Field","Group","N"].concat(i.concat(r)),data:o}}firstUpdated(){this.react(()=>this.appState.currentInputData,t=>{this.updateDatasetMetrics(t)}),this.react(()=>this.selectionService.selectedInputData,()=>{this.updateMetricsList()}),this.react(()=>this.classificationService.allMarginSettings,t=>{this.updateDatasetMetrics(this.appState.currentInputData)}),this.updateDatasetMetrics(this.appState.currentInputData)}updateDatasetMetrics(t){return i(this,void 0,void 0,(function*(){const e=this.appState.currentModels;this.datasetMetrics=yield Promise.all(e.map(e=>i(this,void 0,void 0,(function*(){return this.getMetrics(t,e)})))),yield this.updateMetricsList()}))}updateMetricsList(){return i(this,void 0,void 0,(function*(){const t=this.appState.currentModels,e=this.appState.currentInputData;if(!t||!e||null==this.datasetMetrics)return;const n=[{metrics:this.datasetMetrics,length:e.length,name:"dataset"}];yield this.fillMetricsList(n),this.metricsList=n}))}fillMetricsList(t){return i(this,void 0,void 0,(function*(){const e=this.selectionService.selectedInputData;if(e.length){const n={selection:{data:e}};yield this.fillMetricsListFaceted(t,n)}yield this.fillMetricsListFaceted(t,this.getFacetedData()),yield this.fillMetricsListFaceted(t,this.getSlicedData())}))}fillMetricsListFaceted(t,e){return i(this,void 0,void 0,(function*(){const n=this.appState.currentModels;for(const r of Object.keys(e)){const o=yield Promise.all(n.map(t=>i(this,void 0,void 0,(function*(){return this.getMetrics(e[r].data,t)})))),a=e[r].displayName||r;t.push({metrics:o,length:e[r].data.length,name:a,facets:e[r].facets})}}))}facetedDataDisplayName(){return(this.selectionService.selectedInputData.length?"selection":"dataset")+" (faceted)"}getFacetedData(){const t=this.selectionService.selectedOrAllInputData;if(this.selectedFacets.length>0){const e=this.groupService.groupExamplesByFeatures(t,this.selectedFacets);return Object.keys(e).forEach(t=>{e[t].displayName=this.facetedDataDisplayName()}),e}return{}}getSlicedData(){const t={};return this.facetBySlice&&this.sliceService.sliceNames.forEach(e=>{t[e]={displayName:"Slice : "+e,data:this.sliceService.getSliceDataByName(e)}}),t}getMetrics(t,e){return i(this,void 0,void 0,(function*(){if(null==t||0===t.length)return;const n=this.classificationService.marginSettings[e]||{};return yield this.apiService.getInterpretations(t,e,this.appState.currentDataset,"metrics",n)}))}createRowsForMetrics(t,e,n,r,i){const o=[];for(let a=0;a<e.length;a++){const s=t[a];if(null!=s)for(const t of Object.keys(s))for(const c of s[t])0!==Object.keys(c.metrics).length&&o.push({model:e[a],selection:n,group:t,numExamples:r,labelKey:c.label_key,predKey:c.pred_key,metrics:c.metrics,facets:i})}return o}render(){return o.html`
          <div class="metrics-module-wrapper">
            ${this.renderFacetSelector()}
            ${this.renderTable()}
          </div>
        `}renderTable(){const t=this.tableData.header,e=new Map;return t.forEach(t=>{e.set(t,!0)}),o.html`
    <lit-data-table
      .columnVisibility=${e}
      .data=${this.tableData.data}
        selectionDisabled
    ></lit-data-table>
  `}renderFacetSelector(){const t=(t,e)=>{if(t.target.checked)this.selectedFacets.push(e);else{const t=this.selectedFacets.indexOf(e);this.selectedFacets.splice(t,1)}this.updateMetricsList()},e=this.sliceService.areAllSlicesEmpty(),n=t=>{this.facetBySlice=t.target.checked,this.updateMetricsList()};return o.html`
    <div class="facet-selector">
      <label class="dropdown-label">Show slices</label>
      ${this.renderCheckbox("",!1,t=>{n(t)},e)}
      <label class="dropdown-label">Facet by</label>
       ${this.groupService.categoricalAndNumericalFeatureNames.map(e=>this.renderCheckbox(e,!1,n=>{t(n,e)},!1))}
    </div>
    `}renderCheckbox(t,e,n,r){return o.html`
        <div class='checkbox-holder'>
          <lit-checkbox
            ?checked=${e}
            ?disabled=${r}
            @change='${e=>{n(e,t)}}'
            label=${t}>
          </lit-checkbox>
        </div>
    `}static shouldDisplayModule(t,e){return!0}};f.title="Metrics",f.numCols=8,f.template=()=>o.html`<metrics-module></metrics-module>`,f.duplicateForModelComparison=!1,r([a.observable],f.prototype,"metricsList",void 0),r([a.observable],f.prototype,"facetBySlice",void 0),r([a.observable],f.prototype,"selectedFacets",void 0),r([a.computed],f.prototype,"tableData",null),f=r([o.customElement("metrics-module")],f),e.MetricsModule=f},function(t,e,n){"use strict";n.r(e),n.d(e,"styles",(function(){return r}));const r=n(0).css`
.checkbox-holder {
  display: flex;
  justify-content: space-between;
  margin-right: 4pt;
}

.facet-selector {
  display: flex;
}

.facet-selector > .dropdown-label {
  margin: 4pt;
}`},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.RegressionModule=void 0;const o=n(0),a=n(4),s=n(7),c=n(13);n(5);const l=n(9),u=n(10),d=n(11);let h=class extends c.LitModule{constructor(){super(...arguments),this.regressionService=s.app.getService(u.RegressionService),this.results=[]}static get styles(){return[d.styles,o.css`
        td {
          padding-right: 4px;
        }
      `]}firstUpdated(){this.reactImmediately(()=>this.selectionService.primarySelectedInputData,t=>{this.updateSelection(t)})}updateSelection(t){return i(this,void 0,void 0,(function*(){if(this.results=[],null==t)return;const e=[t],n=this.appState.currentDataset,r=this.regressionService.getRegressionPreds(e,this.model,n),i=yield this.loadLatest("regressionPreds",r);if(null!==i){if(i.length>0){const t=Object.keys(i[0]);for(let n=0;n<e.length;n++)for(const r of t){const t=(yield this.regressionService.getResults([e[n].id],this.model,r))[0];i[n][this.regressionService.getErrorKey(r)]=t.error}}this.results=i}}))}render(){const t=this.selectionService.primarySelectedInputData;if(null==t)return null;const e=[t],n=this.appState.getModelSpec(this.model),r=l.findSpecKeys(n.input,"TextSegment"),i=l.findSpecKeys(n.output,"RegressionScore"),a=[],s=[];e.forEach(t=>{s.push([])});for(const t of i){const r=n.output[t].parent||"-";a.push(r),a.push(t),a.push("error"),s.forEach((n,i)=>{n.push(null==e[i].data[r]?"-":e[i].data[r].toFixed(4)),n.push(0===this.results.length||null==this.results[i][t]?"-":this.results[i][t].toFixed(4)),n.push(0===this.results.length||null==this.results[i][this.regressionService.getErrorKey(t)]?"-":this.results[i][this.regressionService.getErrorKey(t)].toFixed(4))})}if(e.length>1)for(const t of r)a.push(t),s.forEach((n,r)=>{n.push(e[r].data[t])});return o.html`
        <table>
          <tr>
            ${a.map(t=>o.html`<th>${t}</th>`)}
          </tr>
          ${s.map(t=>(t=>o.html`
      <tr>
        ${t.map(t=>o.html`<td>${t}</td>`)}
      </tr>`)(t))}
        </table>`}static shouldDisplayModule(t,e){return l.doesOutputSpecContain(t,"RegressionScore")}};h.title="Regression Results",h.duplicateForExampleComparison=!0,h.numCols=2,h.template=(t="",e=0)=>o.html`<regression-module model=${t} selectionServiceIndex=${e}></regression-module>`,r([a.observable],h.prototype,"results",void 0),h=r([o.customElement("regression-module")],h),e.RegressionModule=h},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.SalienceMapModule=e.SignedSalienceCmap=e.UnsignedSalienceCmap=void 0,n(36),n(39);const o=n(0),a=n(8),s=n(15),c=n(4);n(7);const l=n(13);n(5);const u=n(9),d=n(60),h=n(11);class f{constructor(t=1){this.gamma=t}}class p extends f{bgCmap(t){return`hsl(270, 50%, ${100*Math.pow(1-t,this.gamma)}%)`}textCmap(t){return t>.1?"white":"black"}}e.UnsignedSalienceCmap=p;class m extends f{bgCmap(t){let e=188;t<0&&(e=354,t=Math.abs(t));return`hsl(${e}, 50%, ${25+75*Math.pow(1-t,this.gamma)}%)`}textCmap(t){return Math.abs(t)>.1?"white":"black"}}e.SignedSalienceCmap=m;let g=class extends l.LitModule{constructor(){super(...arguments),this.state={grad_norm:{autorun:!0,isLoading:!1,salience:{},cmap:new p(4),canRun:t=>u.findSpecKeys(t,"TokenGradients").length>0},lime:{autorun:!1,isLoading:!1,salience:{},cmap:new m(4)}}}static get styles(){return[h.styles,d.styles]}shouldRunInterpreter(t){return this.state[t].autorun&&(null==this.state[t].canRun||this.state[t].canRun(this.appState.getModelSpec(this.model).output))}firstUpdated(){for(const t of Object.keys(this.state)){const e=()=>this.selectionService.primarySelectedInputData;this.react(e,e=>{this.shouldRunInterpreter(t)?this.runInterpreter(t):this.state[t].salience={}});const n=()=>this.state[t].autorun;this.react(n,e=>{this.shouldRunInterpreter(t)&&this.runInterpreter(t)}),this.shouldRunInterpreter(t)&&this.runInterpreter(t)}}runInterpreter(t){return i(this,void 0,void 0,(function*(){const e=this.selectionService.primarySelectedInputData;if(null==e)return void(this.state[t].salience={});this.state[t].isLoading=!0;const n=this.apiService.getInterpretations([e],this.model,this.appState.currentDataset,t,void 0,"Running "+t),r=yield this.loadLatest("interpretations-"+t,n);this.state[t].isLoading=!1,null!==r&&(this.state[t].salience=r[0])}))}updated(){this.shadowRoot.querySelectorAll(".tokens-group").forEach(t=>{const e=t.querySelector(".salience-tooltip");t.querySelectorAll(".salient-token").forEach(t=>{t.onmouseover=function(){e.innerText=this.dataset.tooltip,e.style.visibility="visible";const t=this.getBoundingClientRect();e.style.left=(t.left+t.right)/2+"px",e.style.top=t.bottom+"px"},t.onmouseout=function(){e.style.visibility="hidden"}})})}renderToken(t,e,n){const r=s.styleMap({color:n.textCmap(e),"background-color":n.bgCmap(e)});return o.html`
      <div class="salient-token" style=${r}
        data-tooltip=${e.toPrecision(3)}>
        ${t}
      </div>`}renderGroup(t,e,n){const r=t[e].tokens,i=t[e].salience,a=r.map((t,e)=>this.renderToken(t,i[e],n));return o.html`
      <div class="tokens-group">
        <div class="tokens-group-title">
          ${e}
        </div>
        <div class="tokens-holder">
          ${a}
        </div>
        <div class="salience-tooltip">
        </div>
      </div>
    `}renderSpinner(){return o.html`
      <div class="spinner-container">
        <lit-spinner size=${24} color="var(--app-secondary-color)">
        </lit-spinner>
      </div>
    `}render(){return o.html`
      <table>
        ${Object.keys(this.state).map(t=>{if(null!=this.state[t].canRun&&!this.state[t].canRun(this.appState.getModelSpec(this.model).output))return null;const e=this.state[t].salience,n=this.state[t].cmap;return o.html`
            <tr>
              <th class='group-label'>
                ${t}
                <lit-checkbox label="autorun"
                  ?checked=${this.state[t].autorun}
                  @change=${()=>{this.state[t].autorun=!this.state[t].autorun}}
                ></lit-checkbox>
              </th>
              <td class=${a.classMap({"group-container":!0,loading:this.state[t].isLoading})}>
                ${Object.keys(e).map(t=>this.renderGroup(e,t,n))}
                ${this.state[t].isLoading?this.renderSpinner():null}
              </td>
            </tr>
          `})}
      </table>
    `}static shouldDisplayModule(t,e){for(const e of Object.keys(t)){const n=t[e].spec.input,r=t[e].spec.output,i=u.findSpecKeys(r,"TokenGradients").length,o=u.findSpecKeys(n,"TextSegment").length&&u.findSpecKeys(r,"MulticlassPreds").length;if(i||o)return!0}return!1}};g.title="Salience Maps",g.numCols=6,g.duplicateForExampleComparison=!0,g.template=(t="",e=0)=>o.html`<salience-map-module model=${t} selectionServiceIndex=${e}></salience-map-module>`,r([c.observable],g.prototype,"state",void 0),g=r([o.customElement("salience-map-module")],g),e.SalienceMapModule=g},function(t,e,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&i(e,t,n);return o(e,t),e},c=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.ScalarModule=void 0;const l=s(n(20)),u=n(0),d=n(4),h=n(128),f=n(7),p=n(13);n(5);const m=n(9),g=n(10),v=n(137),y=n(11);let b=r=class extends p.LitModule{constructor(){super(...arguments),this.colorService=f.app.getService(g.ColorService),this.classificationService=f.app.getService(g.ClassificationService),this.regressionService=f.app.getService(g.RegressionService),this.inputIDToIndex=new Map,this.brushObjects=[],this.preds=[],this.plotWidth=r.maxPlotWidth,this.plotHeight=r.minPlotHeight}static get styles(){return[y.styles,v.styles]}get scalarKeys(){const t=this.appState.currentModelSpecs[this.model].spec.output;return m.findSpecKeys(t,"Scalar")}get classificationKeys(){const t=this.appState.currentModelSpecs[this.model].spec.output;return m.findSpecKeys(t,"MulticlassPreds")}firstUpdated(){const t=this.appState.getModelSpec(this.model);this.classificationKeys.forEach(e=>{const n=t.output[e];null!=n.null_idx&&null!=n.vocab&&this.classificationService.setMargin(this.model,e,0)}),this.makePlot();this.reactImmediately(()=>this.appState.currentInputData,t=>{null!=t&&this.updatePredictions(t)});this.reactImmediately(()=>this.selectionService.selectedInputData,t=>{null!=t&&(this.clearBrushes(),this.updateGeneralSelection(t))});this.reactImmediately(()=>this.selectionService.primarySelectedInputData,t=>{this.updatePrimarySelection(t)});this.reactImmediately(()=>this.classificationService.allMarginSettings,t=>{this.updateThreshold(),this.updateColors()});this.reactImmediately(()=>this.colorService.selectedColorOption,t=>{this.updateColors()});const e=this.shadowRoot.getElementById("container");this.resizeObserver=new ResizeObserver(()=>{this.resize()}),this.resizeObserver.observe(e)}resize(){this.makePlot(),this.updatePlotData()}clearBrushes(){for(const t of this.brushObjects)t.selection.call(t.brush.move,null)}updateColors(){const t=this.shadowRoot.querySelectorAll(".scatterplot");for(const e of Array.from(t)){const t=e;this.updateAllScatterplotColors(t)}}updateGeneralSelection(t){this.updateSelection(t,"#overlay","selected-point")}updatePrimarySelection(t){const e=[];null!==t&&e.push(t),this.updateSelection(e,"#primaryOverlay","primary-selected-point")}updateSelection(t,e,n){const r=this.shadowRoot.querySelectorAll(".scatterplot");for(const i of Array.from(r)){const r=i,o=l.select(r).select("#dataPoints").selectAll("circle"),a=t.map(t=>this.inputIDToIndex.get(t.id)),s=[];o.each((t,e,n)=>{if(a.includes(e)){const t=l.select(n[e]).attr("cx"),r=l.select(n[e]).attr("cy"),i=l.select(n[e]).style("fill"),o=l.select(n[e]).attr("data-id");s.push([t,r,i,o])}});const c=l.select(r).select(e);c.selectAll("circle").remove();c.selectAll("circle").data(s).enter().append("circle").attr("cx",t=>+t[0]).attr("cy",t=>+t[1]).classed(n,!0).style("fill",t=>t[2]).on("click",(t,e,n)=>{this.selectionService.setPrimarySelection(t[3])})}}updatePredictions(t){return c(this,void 0,void 0,(function*(){if(null==t)return;const e=this.appState.currentDataset,n=Promise.all([this.classificationService.getClassificationPreds(t,this.model,e),this.regressionService.getRegressionPreds(t,this.model,e),this.apiService.getPreds(t,this.model,e,["Scalar"])]),r=yield this.loadLatest("predictionScores",n);if(null===r)return;const i=r[0],o=r[1],a=r[2];if(null==i&&null==o&&null==a)return;const s=[];for(let e=0;e<i.length;e++){const n=t[e].id,r=Object.assign({},i[e],a[e],o[e],{id:n});s.push(r)}if(null!=o){const e=t.map(t=>t.id),n=Object.keys(o[0]);for(let t=0;t<n.length;t++){const r=yield this.regressionService.getResults(e,this.model,n[t]);for(let e=0;e<s.length;e++)s[e][this.regressionService.getErrorKey(n[t])]=r[e].error}}this.preds=s,this.updatePlotData()}))}getXScale(t){var e;let n=[0,1];const i=null===(e=this.appState.currentModelSpecs[this.model])||void 0===e?void 0:e.spec.output;if(null!=i&&m.isLitSubtype(i[t],"Scalar")){const e=this.preds.map(e=>e[t]);n=[Math.min(...e),Math.max(...e)]}return l.scaleLinear().domain(n).range([0,this.plotWidth-r.plotLeftMargin])}getYScale(t){var e;let n=[0,1];const i=null===(e=this.appState.currentModelSpecs[this.model])||void 0===e?void 0:e.spec.output;if(null!=i&&m.isLitSubtype(i[t],"Scalar")){const e=this.regressionService.ranges[`${this.model}:${t}`];null==e||isNaN(e.error[0])||isNaN(e.error[1])||(n=e.error)}return l.scaleLinear().domain(n).range([this.plotHeight-r.plotBottomMargin,0])}updateThreshold(){const t=this.classificationService.marginSettings[this.model]||{},e=this.shadowRoot.querySelectorAll(".scatterplot");for(const n of Array.from(e)){const e=n,i=n.dataset.key;if(null==i)return;const o=this.appState.getModelSpec(this.model),a=o.output[i].vocab;if(m.isLitSubtype(o.output[i],"Scalar")||2!==a.length)continue;if(null==t[i])continue;const s=m.getThresholdFromMargin(+t[i]),c=l.select(e).select("#threshold");c.selectAll("line").remove();const u=this.getXScale(i),d=this.getYScale(i);c.append("line").attr("x1",u(s)).attr("y1",d(0)).attr("x2",u(s)).attr("y2",d(this.plotHeight-r.plotBottomMargin)).style("stroke","black")}}updateAllScatterplotColors(t){this.updateScatterplotColors(t,"#dataPoints"),this.updateScatterplotColors(t,"#overlay")}updateScatterplotColors(t,e){l.select(t).select(e).selectAll("circle").style("fill",(t,e,n)=>{const r=l.select(n[e]).attr("data-id"),i=this.appState.getCurrentInputDataById(r);return this.colorService.getDatapointColor(i)})}makePlot(){const t=this.shadowRoot.getElementById("container");if(!t.offsetHeight||!t.offsetWidth)return;const e=Array.from(this.shadowRoot.querySelectorAll(".scatterplot"));if(!e.length)return;this.plotWidth=t.offsetWidth-2*r.plotLeftMargin;const n=(t.offsetHeight-r.plotBottomMargin)/e.length-15;this.plotHeight=Math.min(Math.max(r.minPlotHeight,n),r.maxPlotHeight);for(const t of Array.from(e)){if(null==t.dataset.key)continue;const e=t;l.select(e).attr("width",this.plotWidth).attr("height",this.plotHeight).selectAll("*").remove(),l.select(e).append("g").attr("id","threshold").attr("transform","translate("+r.plotLeftMargin.toString()+",0)"),this.updateThreshold(),l.select(e).append("g").attr("id","dataPoints").attr("transform","translate("+r.plotLeftMargin.toString()+",0)"),l.select(e).append("g").attr("id","overlay").attr("transform","translate("+r.plotLeftMargin.toString()+",0)"),l.select(e).append("g").attr("id","primaryOverlay").attr("transform","translate("+r.plotLeftMargin.toString()+",0)"),this.updateAllScatterplotColors(e)}}updatePlotData(){var t;const e=this.shadowRoot.querySelectorAll(".scatterplot");for(const n of Array.from(e)){const e=n.dataset.key,i=n.dataset.label;if(null==e||null==i)return;const o=null!==(t=n.dataset.axisTitle)&&void 0!==t?t:e,a=this.appState.getModelSpec(this.model),s=m.isLitSubtype(a.output[e],"Scalar"),c=this.regressionService.ranges[`${this.model}:${e}`],u=null!=c&&!isNaN(c.error[0])&&!isNaN(c.error[1]),d=(m.isLitSubtype(a.output[e],"MulticlassPreds"),n),f=l.select(d);l.select(d).select("#xAxis").remove(),l.select(d).select("#yAxis").remove(),l.select(d).select("#brushGroup").remove();const p=this.getXScale(e),g=this.getYScale(e);l.select(d).append("g").attr("id","xAxis").attr("transform","translate("+r.plotLeftMargin.toString()+","+(this.plotHeight-r.plotBottomMargin).toString()+")").call(l.axisBottom(p));const v=l.axisLeft(g);let y=0;if(s&&u&&(y=5),v.ticks(y),l.select(d).append("g").attr("id","yAxis").attr("transform","translate("+r.plotLeftMargin.toString()+", 0)").call(v),l.select(d).append("text").attr("transform","translate("+(this.plotWidth/2).toString()+" ,"+(this.plotHeight-r.plotBottomMargin+r.xLabelOffsetY).toString()+")").style("text-anchor","middle").text(o),s&&u&&l.select(d).append("text").attr("transform","translate("+(r.plotLeftMargin+r.yLabelOffsetX).toString()+", "+(this.plotHeight/2+r.yLabelOffsetY).toString()+") rotate(270)").style("text-anchor","middle").text("error"),s&&u){const t=this.regressionService.ranges[`${this.model}:${e}`].error;t[0]<0&&t[1]>0&&l.select(d).append("line").attr("x1",r.plotLeftMargin).attr("y1",(this.plotHeight-r.plotBottomMargin)/2).attr("x2",this.plotWidth+r.plotLeftMargin).attr("y2",(this.plotHeight-r.plotBottomMargin)/2).style("stroke",r.zeroLineColor)}const b=s&&u?l.brush():l.brushX();b.extent([[0,0],[this.plotWidth-r.plotLeftMargin,this.plotHeight-r.plotBottomMargin]]).on("start end",()=>{l.event.sourceEvent&&this.selectBrushedPoints(d)});const x=f.append("g").attr("id","brushGroup").attr("transform","translate("+r.plotLeftMargin.toString()+",0)").call(b);this.brushObjects.push({brush:b,selection:x});const _=l.select(d).select("#dataPoints");_.selectAll("circle").remove(),_.raise(),l.select(d).select("#overlay").raise(),l.select(d).select("#primaryOverlay").raise();const w=_.selectAll("circle").data(this.preds).enter().append("circle"),S=h("lit");w.attr("cx",t=>{if(m.isLitSubtype(a.output[e],"MulticlassPreds")){const n=a.output[e].vocab.indexOf(i);return p(t[e][n])}return p(t[e])}).attr("cy",t=>m.isLitSubtype(a.output[e],"Scalar")&&u?g(t[this.regressionService.getErrorKey(e)]):g(S())).style("fill",t=>{const e=this.appState.getCurrentInputDataById(t.id);return this.colorService.getDatapointColor(e)}).classed("point",!0).on("click",t=>{this.selectionService.selectIds([t.id])}).each((t,e,n)=>{this.inputIDToIndex.set(t.id,e),l.select(n[e]).attr("data-id",t.id)})}this.updateGeneralSelection(this.selectionService.selectedInputData),this.updatePrimarySelection(this.selectionService.primarySelectedInputData)}selectBrushedPoints(t){const e=l.event.selection;if(null!=e&&e.length>0){const n=[],r="number"!=typeof e[0],i=r?[e[0][0],e[1][0]]:e,o=r?[e[0][1],e[1][1]]:null;l.select(t).select("#dataPoints").selectAll("circle").each((t,e,a)=>{const s=+l.select(a[e]).attr("cx");if(s<i[0]||s>i[1])return;if(r&&null!=o){const t=+l.select(a[e]).attr("cy");if(t<o[0]||t>o[1])return}const c=l.select(a[e]).attr("data-id");n.push(c)}),this.selectionService.selectIds(n)}}render(){return u.html`
      <div id='container'>
        ${this.scalarKeys.map(t=>this.renderPlot(t,""))}
        ${this.classificationKeys.map(t=>this.renderClassificationGroup(t))}
      </div>
    `}renderClassificationGroup(t){const e=this.appState.getModelSpec(this.model),n=e.output[t].vocab,r=this.classificationService.marginSettings[this.model]||{},i=e.output[t].null_idx;return 2===n.length&&null!=i?u.html`<div>${this.renderThresholdSlider(r,t)}</div>
          ${this.renderPlot(t,n[1-i])}`:u.html`
        ${null!=n&&null!=i?this.renderMarginSlider(r,t):null}
        ${n.map(e=>this.renderPlot(t,e))}`}renderPlot(t,e){const n=e?`${t}:${e}`:t;return u.html`
        <div class='plot-holder'>${u.svg`
          <svg class='scatterplot' data-key='${t}'
                                   data-label='${e}'
                                   data-axisTitle='${n}'>
          </svg>`}
        </div>
      `}renderThresholdSlider(t,e){return this.renderSlider(t,e,0,1,.01,n=>{const r=+n.target.value,i=1!==r?0!==r?Math.log(r/(1-r)):-5:5;t[e]=i},t=>{const e=m.getThresholdFromMargin(+t);return Math.round(100*e)/100},"threshold")}renderMarginSlider(t,e){return this.renderSlider(t,e,-5,5,.05,n=>{const r=n.target.value;t[e]=+r},t=>t,"margin")}renderSlider(t,e,n,r,i,o,a,s){if(null==t[e])return;const c=a(t[e]),l=0===t[e];return u.html`
        <div class="slider-row">
          <div>${e} ${s}:</div>
          <input type="range" min="${n}" max="${r}" step="${i}"
                 .value="${c.toString()}" class="slider"
                 @change=${o}>
          <div class="slider-label">${c}</div>
          <button @click=${n=>{t[e]=0}} ?disabled="${l}">Reset</button>
        </div>`}static shouldDisplayModule(t,e){return m.doesOutputSpecContain(t,["Scalar","MulticlassPreds"])}};b.title="Scalars",b.numCols=4,b.template=(t="")=>u.html`
      <scalar-module model=${t}>
      </scalar-module>`,b.maxPlotWidth=900,b.minPlotHeight=100,b.maxPlotHeight=250,b.plotBottomMargin=35,b.plotLeftMargin=5,b.xLabelOffsetY=30,b.yLabelOffsetX=-32,b.yLabelOffsetY=-25,b.zeroLineColor="#cccccc",a([d.observable],b.prototype,"preds",void 0),a([d.observable],b.prototype,"plotWidth",void 0),a([d.observable],b.prototype,"plotHeight",void 0),a([d.computed],b.prototype,"scalarKeys",null),a([d.computed],b.prototype,"classificationKeys",null),b=r=a([u.customElement("scalar-module")],b),e.ScalarModule=b},function(t,e,n){var r=n(129),i=n(130),o=n(131),a=n(132),s=n(133),c=n(134),l=n(135);l.alea=r,l.xor128=i,l.xorwow=o,l.xorshift7=a,l.xor4096=s,l.tychei=c,t.exports=l},function(t,e,n){(function(t){var r;!function(t,i,o){function a(t){var e,n=this,r=(e=4022871197,function(t){t=String(t);for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}function s(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function c(t,e){var n=new a(t),r=e&&e.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=c:n(19)&&n(34)?void 0===(r=function(){return c}.call(e,n,e,i))||(i.exports=r):this.alea=c}(0,t,n(19))}).call(this,n(33)(t))},function(t,e,n){(function(t){var r;!function(t,i,o){function a(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function c(t,e){var n=new a(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=c:n(19)&&n(34)?void 0===(r=function(){return c}.call(e,n,e,i))||(i.exports=r):this.xor128=c}(0,t,n(19))}).call(this,n(33)(t))},function(t,e,n){(function(t){var r;!function(t,i,o){function a(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function c(t,e){var n=new a(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=c:n(19)&&n(34)?void 0===(r=function(){return c}.call(e,n,e,i))||(i.exports=r):this.xorwow=c}(0,t,n(19))}).call(this,n(33)(t))},function(t,e,n){(function(t){var r;!function(t,i,o){function a(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function s(t,e){return e.x=t.x.slice(),e.i=t.i,e}function c(t,e){null==t&&(t=+new Date);var n=new a(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&(r.x&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=c:n(19)&&n(34)?void 0===(r=function(){return c}.call(e,n,e,i))||(i.exports=r):this.xorshift7=c}(0,t,n(19))}).call(this,n(33)(t))},function(t,e,n){(function(t){var r;!function(t,i,o){function a(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,o=e.i;return e.w=r=r+1640531527|0,n=i[o+34&127],t=i[o=o+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=i[o]=n^t,e.i=o,n+(r^r>>>16)|0},function(t,e){var n,r,i,o,a,s=[],c=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,c=Math.max(c,e.length)),i=0,o=-32;o<c;++o)e&&(r^=e.charCodeAt((o+32)%e.length)),0===o&&(a=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(a=a+1640531527|0,i=0==(n=s[127&o]^=r+a)?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,o=512;o>0;--o)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[i]=r^n;t.w=a,t.X=s,t.i=i}(e,t)}function s(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function c(t,e){null==t&&(t=+new Date);var n=new a(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&(r.X&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=c:n(19)&&n(34)?void 0===(r=function(){return c}.call(e,n,e,i))||(i.exports=r):this.xor4096=c}(0,t,n(19))}).call(this,n(33)(t))},function(t,e,n){(function(t){var r;!function(t,i,o){function a(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function s(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function c(t,e){var n=new a(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=c:n(19)&&n(34)?void 0===(r=function(){return c}.call(e,n,e,i))||(i.exports=r):this.tychei=c}(0,t,n(19))}).call(this,n(33)(t))},function(t,e,n){var r;!function(i,o,a){var s,c=a.pow(256,6),l=a.pow(2,52),u=2*l;function d(t,e,n){var r=[],d=p(function t(e,n){var r,i=[],o=typeof e;if(n&&"object"==o)for(r in e)try{i.push(t(e[r],n-1))}catch(t){}return i.length?i:"string"==o?e:e+"\0"}((e=1==e?{entropy:!0}:e||{}).entropy?[t,m(o)]:null==t?function(){try{var t;return s&&(t=s.randomBytes)?t=t(256):(t=new Uint8Array(256),(i.crypto||i.msCrypto).getRandomValues(t)),m(t)}catch(t){var e=i.navigator,n=e&&e.plugins;return[+new Date,i,n,i.screen,m(o)]}}():t,3),r),g=new h(r),v=function(){for(var t=g.g(6),e=c,n=0;t<l;)t=256*(t+n),e*=256,n=g.g(1);for(;t>=u;)t/=2,e/=2,n>>>=1;return(t+n)/e};return v.int32=function(){return 0|g.g(4)},v.quick=function(){return g.g(4)/4294967296},v.double=v,p(m(g.S),o),(e.pass||n||function(t,e,n,r){return r&&(r.S&&f(r,g),t.state=function(){return f(g,{})}),n?(a.random=t,e):t})(v,d,"global"in e?e.global:this==a,e.state)}function h(t){var e,n=t.length,r=this,i=0,o=r.i=r.j=0,a=r.S=[];for(n||(t=[n++]);i<256;)a[i]=i++;for(i=0;i<256;i++)a[i]=a[o=255&o+t[i%n]+(e=a[i])],a[o]=e;(r.g=function(t){for(var e,n=0,i=r.i,o=r.j,a=r.S;t--;)e=a[i=255&i+1],n=256*n+a[255&(a[i]=a[o=255&o+e])+(a[o]=e)];return r.i=i,r.j=o,n})(256)}function f(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function p(t,e){for(var n,r=t+"",i=0;i<r.length;)e[255&i]=255&(n^=19*e[255&i])+r.charCodeAt(i++);return m(e)}function m(t){return String.fromCharCode.apply(0,t)}if(p(a.random(),o),t.exports){t.exports=d;try{s=n(136)}catch(t){}}else void 0===(r=function(){return d}.call(e,n,e,t))||(t.exports=r)}("undefined"!=typeof self?self:this,[],Math)},function(t,e){},function(t,e,n){"use strict";n.r(e),n.d(e,"styles",(function(){return r}));const r=n(0).css`.label {
  margin-bottom: 4px;
}

.primary-selected-point {
  r: 4px;
  opacity: 1.0;
  stroke-width: 1px;
  stroke: #000;
}

.selected-point {
  r: 5px;
  fill-opacity: 0.8;
  stroke-width: 2px;
  stroke: #fff;
}

.point {
  r: 4px;
  opacity: .25;
}

#container{
  height: 100%;
}

.plot-holder {
  margin-bottom: 15px;
}

.slider-row {
  display: flex;
  flex-wrap: wrap;
}

.slider-row div {
  padding-top: 9px;
}

.slider-label {
  width: 30px;
}

`},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.SpanGraphModule=e.SpanGraphGoldModule=void 0,n(63),n(20);const o=n(0),a=n(4);n(7);const s=n(13);n(63),n(5);const c=n(9),l=n(11),u=o.css`
  .outer-container {
    display: flex;
    flex-direction: column;
    justify-content: center;
    position: relative;
    overflow: hidden;
  }

  .token-group {
    padding-left: 5px;
    padding-top: 30pt;
  }

  #pred-group {
    outline: 1px dashed gray;
  }

  #gold-group{
    margin-top: 17pt;
  }
`,d=["SequenceTags","SpanLabels","EdgeLabels"];function h(t){const e=c.findSpecKeys(t,d),n=c.findSpecKeys(t,"Tokens"),r={};for(const t of n)r[t]=[];for(const n of e){r[t[n].align].push(n)}return r}function f(t,e){const n=h(e),r={};for(const i of Object.keys(n)){const o=[];for(const r of n[i]){let n=t[r];0===n.length&&(n=[]),c.isLitSubtype(e[r],"SequenceTags")?n=n.map((t,e)=>({span1:[e,e+1],label:t})):c.isLitSubtype(e[r],"SpanLabels")&&(n=n.map(t=>({span1:[t.start,t.end],label:t.label}))),o.push({name:r,edges:n})}let a=t[i];if(0===a.length){a=t[c.findSpecKeys(e,"TextSegment")[0]].split()}r[i]={tokens:a,layers:o}}return r}function p(t,e){const n=h(e);return o.html`${Object.keys(n).map(e=>{var n,r;const i=1===(null===(r=null===(n=t[e])||void 0===n?void 0:n.layers)||void 0===r?void 0:r.length);return o.html`
      <div id=${e} class="token-group">
        ${i?o.html`<div>${t[e].layers[0].name}</div>`:null}
        <span-graph-vis-vertical .data=${t[e]} .showLayerLabel=${!i}>
        </span-graph-vis-vertical>
      </div>
    `})}`}let m=class extends s.LitModule{get dataSpec(){return this.appState.currentDatasetSpec}get goldDisplayData(){const t=this.selectionService.primarySelectedInputData;return null===t?{}:f(t.data,this.dataSpec)}static get styles(){return[l.styles,u]}render(){return o.html`
      <div id="gold-group" class='outer-container'>
        ${p(this.goldDisplayData,this.dataSpec)}
      </div>
    `}static shouldDisplayModule(t,e){const n=c.findSpecKeys(e,"Tokens").length>0,r=c.findSpecKeys(e,d).length>0;return n&&r}};m.title="Structured Prediction (gold)",m.duplicateForExampleComparison=!0,m.duplicateForModelComparison=!1,m.duplicateAsRow=!0,m.numCols=4,m.template=(t="",e=0)=>o.html`<span-graph-gold-module selectionServiceIndex=${e}></span-graph-gold-module>`,r([a.computed],m.prototype,"dataSpec",null),r([a.computed],m.prototype,"goldDisplayData",null),m=r([o.customElement("span-graph-gold-module")],m),e.SpanGraphGoldModule=m;let g=class extends s.LitModule{constructor(){super(...arguments),this.predDisplayData={}}get predSpec(){return this.appState.getModelSpec(this.model).output}updatePredDisplayData(t){return i(this,void 0,void 0,(function*(){if(null===t)this.predDisplayData={};else{const e=this.apiService.getPreds([t],this.model,this.appState.currentDataset,["Tokens"].concat(d)),n=yield this.loadLatest("getPreds",e);if(!n)return;this.predDisplayData=f(n[0],this.predSpec)}}))}static get styles(){return[l.styles,u]}firstUpdated(){this.reactImmediately(()=>this.selectionService.primarySelectedInputData,t=>{this.updatePredDisplayData(t)})}render(){return o.html`
      <div id="pred-group" class='outer-container'>
        ${p(this.predDisplayData,this.predSpec)}
      </div>
    `}static shouldDisplayModule(t,e){const n=Object.keys(t);for(let e=0;e<n.length;e++){const r=t[n[e]].spec,i=c.findSpecKeys(r.output,"Tokens").length>0,o=c.findSpecKeys(r.output,d).length>0;if(i&&o)return!0}return!1}};g.title="Structured Prediction (model preds)",g.duplicateForExampleComparison=!0,g.duplicateAsRow=!0,g.numCols=4,g.template=(t="",e=0)=>o.html`<span-graph-module model=${t} selectionServiceIndex=${e}></span-graph-module>`,r([a.computed],g.prototype,"predSpec",null),r([a.observable],g.prototype,"predDisplayData",void 0),g=r([o.customElement("span-graph-module")],g),e.SpanGraphModule=g},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VizColor=void 0;class r{static getColor(t,e){const n=r.colors[t];return null===e?n[n.length-1]:n[e%(n.length-1)]}}e.VizColor=r,r.colors={pastel:[{color:"#ffd8c3",textColor:"black"},{color:"#87cdf9",textColor:"black"},{color:"#faf49f",textColor:"black"},{color:"#cdc5ff",textColor:"black"},{color:"#f6aea9",textColor:"black"},{color:"#bdf4e7",textColor:"black"},{color:"#edc4e6",textColor:"black"},{color:"#dadce0",textColor:"black"}],bright:[{color:"#f0bd80",textColor:"black"},{color:"#61aff7",textColor:"black"},{color:"#ffe839",textColor:"black"},{color:"#9b86ef",textColor:"black"},{color:"#ff777b",textColor:"black"},{color:"#7ddad3",textColor:"black"},{color:"#ef96cd",textColor:"black"},{color:"#b5bcc3",textColor:"black"}],deep:[{color:"#ff9230",textColor:"black"},{color:"#3c7dbf",textColor:"white"},{color:"#ffc700",textColor:"black"},{color:"#7647ea",textColor:"white"},{color:"#fc4f61",textColor:"white"},{color:"#1f978a",textColor:"white"},{color:"#b22a72",textColor:"white"},{color:"#879695",textColor:"white"}],dark:[{color:"#ba4a0d",textColor:"white"},{color:"#184889",textColor:"white"},{color:"#b48014",textColor:"white"},{color:"#270086",textColor:"white"},{color:"#b12d33",textColor:"white"},{color:"#006067",textColor:"white"},{color:"#632440",textColor:"white"},{color:"#515050",textColor:"white"}]}},function(t,e,n){"use strict";n.r(e),n.d(e,"styles",(function(){return r}));const r=n(0).css`text.token-text {
  alignment-baseline: middle;
  dominant-baseline: central;
}

polyline.span-bracket {
  fill: none;
  stroke-width: 1.2px;
  stroke: var(--group-color);
}

.selected polyline.span-bracket {
  stroke-width: 1.8px;
}

path.arc-path {
  stroke-width: 1.2px;
  stroke: var(--group-color);
  fill: none;
}

path.arc-path.arc-neg {
  stroke-dasharray: 3,1;
  stroke: gray;
}

.selected path.arc-path {
  stroke-width: 1.8px;
}

path.arc-arrow {
  stroke-width: 1.2px;
  stroke: var(--group-color);
  fill: var(--group-color);
}

path.arc-arrow.arc-neg {
  stroke: gray;
  fill: gray;
}


.layer-label text {
  font-family: 'Share Tech Mono', monospace;
  dominant-baseline: middle;
  text-anchor: end;
}

foreignObject.span-label {
  overflow: visible;
}

.span-label div {
  background-color: white;
  font-family: 'Share Tech Mono', monospace;
  line-height: 1.0;
  padding: 1px;
  padding-right: 3px; /* for occluding labels on mouseover */
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  color: var(--group-color);
}

g.selected .span-label div {
  background-color: white;
  overflow-x: visible;
  width: fit-content;  /* needed to include background when expanding */
}

.mousebox {
  fill: white;
  fill-opacity: 0.0;
}
`},function(t,e,n){"use strict";n.r(e),n.d(e,"TextField",(function(){return B}));var r=n(1),i=n(0),o=n(23),a=n(17),s={NOTCH_ELEMENT_SELECTOR:".mdc-notched-outline__notch"},c={NOTCH_ELEMENT_PADDING:8},l={NO_LABEL:"mdc-notched-outline--no-label",OUTLINE_NOTCHED:"mdc-notched-outline--notched",OUTLINE_UPGRADED:"mdc-notched-outline--upgraded"},u=function(t){function e(n){return t.call(this,Object(r.a)(Object(r.a)({},e.defaultAdapter),n))||this}return Object(r.c)(e,t),Object.defineProperty(e,"strings",{get:function(){return s},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cssClasses",{get:function(){return l},enumerable:!0,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return c},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},setNotchWidthProperty:function(){},removeNotchWidthProperty:function(){}}},enumerable:!0,configurable:!0}),e.prototype.notch=function(t){var n=e.cssClasses.OUTLINE_NOTCHED;t>0&&(t+=c.NOTCH_ELEMENT_PADDING),this.adapter_.setNotchWidthProperty(t),this.adapter_.addClass(n)},e.prototype.closeNotch=function(){var t=e.cssClasses.OUTLINE_NOTCHED;this.adapter_.removeClass(t),this.adapter_.removeNotchWidthProperty()},e}(a.a);
/**
@license
Copyright 2019 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
class d extends o.a{constructor(){super(...arguments),this.mdcFoundationClass=u,this.width=0,this.open=!1,this.lastOpen=this.open}createAdapter(){return{addClass:t=>this.mdcRoot.classList.add(t),removeClass:t=>this.mdcRoot.classList.remove(t),setNotchWidthProperty:t=>this.notchElement.style.setProperty("width",t+"px"),removeNotchWidthProperty:()=>this.notchElement.style.removeProperty("width")}}openOrClose(t,e){this.mdcFoundation&&(t&&void 0!==e?this.mdcFoundation.notch(e):this.mdcFoundation.closeNotch())}render(){return this.openOrClose(this.open,this.width),i.html`
      <span class="mdc-notched-outline">
        <span class="mdc-notched-outline__leading"></span>
        <span class="mdc-notched-outline__notch">
          <slot></slot>
        </span>
        <span class="mdc-notched-outline__trailing"></span>
      </span>`}}Object(r.b)([Object(i.query)(".mdc-notched-outline")],d.prototype,"mdcRoot",void 0),Object(r.b)([Object(i.property)({type:Number})],d.prototype,"width",void 0),Object(r.b)([Object(i.property)({type:Boolean,reflect:!0})],d.prototype,"open",void 0),Object(r.b)([Object(i.query)(".mdc-notched-outline__notch")],d.prototype,"notchElement",void 0);
/**
@license
Copyright 2018 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
const h=i.css`.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;border-top:1px solid;border-bottom:1px solid;pointer-events:none}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid;flex-grow:1}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{flex:0 0 auto;width:auto;max-width:calc(100% - 12px * 2)}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(100% / .75)}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{padding:0}:host{display:block;position:absolute;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] :host,:host[dir=rtl]{text-align:right}::slotted(.mdc-floating-label){display:inline-block;position:relative;top:17px;bottom:auto;max-width:100%}::slotted(.mdc-floating-label--float-above){text-overflow:clip}.mdc-notched-outline--upgraded ::slotted(.mdc-floating-label--float-above){max-width:calc(100% / .75)}.mdc-notched-outline__leading{width:12px;width:var(--mdc-notched-outline-leading-width, 12px);border-radius:4px 0 0 4px;border-radius:var(--mdc-notched-outline-leading-border-radius, 4px 0 0 4px)}.mdc-notched-outline__trailing{border-radius:0 4px 4px 0;border-radius:var(--mdc-notched-outline-trailing-border-radius, 0 4px 4px 0)}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{border-color:var(--mdc-notched-outline-border-color, var(--mdc-theme-primary, #6200ee));border-width:1px;border-width:var(--mdc-notched-outline-stroke-width, 1px)}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0;padding-top:var(--mdc-notched-outline-notch-offset, 0)}`;
/**
@license
Copyright 2019 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/let f=class extends d{};f.styles=h,f=Object(r.b)([Object(i.customElement)("mwc-notched-outline")],f);var p=n(21),m={LABEL_FLOAT_ABOVE:"mdc-floating-label--float-above",LABEL_SHAKE:"mdc-floating-label--shake",ROOT:"mdc-floating-label"},g=function(t){function e(n){var i=t.call(this,Object(r.a)(Object(r.a)({},e.defaultAdapter),n))||this;return i.shakeAnimationEndHandler_=function(){return i.handleShakeAnimationEnd_()},i}return Object(r.c)(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return m},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},getWidth:function(){return 0},registerInteractionHandler:function(){},deregisterInteractionHandler:function(){}}},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.adapter_.registerInteractionHandler("animationend",this.shakeAnimationEndHandler_)},e.prototype.destroy=function(){this.adapter_.deregisterInteractionHandler("animationend",this.shakeAnimationEndHandler_)},e.prototype.getWidth=function(){return this.adapter_.getWidth()},e.prototype.shake=function(t){var n=e.cssClasses.LABEL_SHAKE;t?this.adapter_.addClass(n):this.adapter_.removeClass(n)},e.prototype.float=function(t){var n=e.cssClasses,r=n.LABEL_FLOAT_ABOVE,i=n.LABEL_SHAKE;t?this.adapter_.addClass(r):(this.adapter_.removeClass(r),this.adapter_.removeClass(i))},e.prototype.handleShakeAnimationEnd_=function(){var t=e.cssClasses.LABEL_SHAKE;this.adapter_.removeClass(t)},e}(a.a),v=n(3);
/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */const y=new WeakMap,b=Object(v.directive)(t=>e=>{const n=y.get(e);if(n){if(n.label!==t){const t=e.committer.element,n=new Event("labelchange");t.dispatchEvent(n)}}else{const n=e.committer.element;n.classList.add("mdc-floating-label");const r=(t=>({addClass:e=>t.classList.add(e),removeClass:e=>t.classList.remove(e),getWidth:()=>t.scrollWidth,registerInteractionHandler:(e,n)=>{t.addEventListener(e,n)},deregisterInteractionHandler:(e,n)=>{t.removeEventListener(e,n)}}))(n),i=new g(r);i.init(),e.setValue(i),y.set(e,{label:t,foundation:i})}});
/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
var x={LINE_RIPPLE_ACTIVE:"mdc-line-ripple--active",LINE_RIPPLE_DEACTIVATING:"mdc-line-ripple--deactivating"},_=function(t){function e(n){var i=t.call(this,Object(r.a)(Object(r.a)({},e.defaultAdapter),n))||this;return i.transitionEndHandler_=function(t){return i.handleTransitionEnd(t)},i}return Object(r.c)(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return x},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setStyle:function(){},registerEventHandler:function(){},deregisterEventHandler:function(){}}},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.adapter_.registerEventHandler("transitionend",this.transitionEndHandler_)},e.prototype.destroy=function(){this.adapter_.deregisterEventHandler("transitionend",this.transitionEndHandler_)},e.prototype.activate=function(){this.adapter_.removeClass(x.LINE_RIPPLE_DEACTIVATING),this.adapter_.addClass(x.LINE_RIPPLE_ACTIVE)},e.prototype.setRippleCenter=function(t){this.adapter_.setStyle("transform-origin",t+"px center")},e.prototype.deactivate=function(){this.adapter_.addClass(x.LINE_RIPPLE_DEACTIVATING)},e.prototype.handleTransitionEnd=function(t){var e=this.adapter_.hasClass(x.LINE_RIPPLE_DEACTIVATING);"opacity"===t.propertyName&&e&&(this.adapter_.removeClass(x.LINE_RIPPLE_ACTIVE),this.adapter_.removeClass(x.LINE_RIPPLE_DEACTIVATING))},e}(a.a);
/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */const w=new WeakMap,S=Object(v.directive)(()=>t=>{if(!w.get(t)){const e=t.committer.element;e.classList.add("mdc-line-ripple");const n=(t=>({addClass:e=>t.classList.add(e),removeClass:e=>t.classList.remove(e),hasClass:e=>t.classList.contains(e),setStyle:(e,n)=>t.style.setProperty(e,n),registerEventHandler:(e,n)=>{t.addEventListener(e,n)},deregisterEventHandler:(e,n)=>{t.removeEventListener(e,n)}}))(e),r=new _(n);r.init(),t.setValue(r),w.set(t,r)}});
/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
var M={ARIA_CONTROLS:"aria-controls",INPUT_SELECTOR:".mdc-text-field__input",LABEL_SELECTOR:".mdc-floating-label",LEADING_ICON_SELECTOR:".mdc-text-field__icon--leading",LINE_RIPPLE_SELECTOR:".mdc-line-ripple",OUTLINE_SELECTOR:".mdc-notched-outline",PREFIX_SELECTOR:".mdc-text-field__affix--prefix",SUFFIX_SELECTOR:".mdc-text-field__affix--suffix",TRAILING_ICON_SELECTOR:".mdc-text-field__icon--trailing"},E={DISABLED:"mdc-text-field--disabled",FOCUSED:"mdc-text-field--focused",FULLWIDTH:"mdc-text-field--fullwidth",HELPER_LINE:"mdc-text-field-helper-line",INVALID:"mdc-text-field--invalid",LABEL_FLOATING:"mdc-text-field--label-floating",NO_LABEL:"mdc-text-field--no-label",OUTLINED:"mdc-text-field--outlined",ROOT:"mdc-text-field",TEXTAREA:"mdc-text-field--textarea",WITH_LEADING_ICON:"mdc-text-field--with-leading-icon",WITH_TRAILING_ICON:"mdc-text-field--with-trailing-icon"},T={LABEL_SCALE:.75},A=["pattern","min","max","required","step","minlength","maxlength"],C=["color","date","datetime-local","month","range","time","week"],P=["mousedown","touchstart"],O=["click","keydown"],k=function(t){function e(n,i){void 0===i&&(i={});var o=t.call(this,Object(r.a)(Object(r.a)({},e.defaultAdapter),n))||this;return o.isFocused_=!1,o.receivedUserInput_=!1,o.isValid_=!0,o.useNativeValidation_=!0,o.helperText_=i.helperText,o.characterCounter_=i.characterCounter,o.leadingIcon_=i.leadingIcon,o.trailingIcon_=i.trailingIcon,o.inputFocusHandler_=function(){return o.activateFocus()},o.inputBlurHandler_=function(){return o.deactivateFocus()},o.inputInputHandler_=function(){return o.handleInput()},o.setPointerXOffset_=function(t){return o.setTransformOrigin(t)},o.textFieldInteractionHandler_=function(){return o.handleTextFieldInteraction()},o.validationAttributeChangeHandler_=function(t){return o.handleValidationAttributeChange(t)},o}return Object(r.c)(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return E},enumerable:!0,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return M},enumerable:!0,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return T},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldAlwaysFloat_",{get:function(){var t=this.getNativeInput_().type;return C.indexOf(t)>=0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldFloat",{get:function(){return this.shouldAlwaysFloat_||this.isFocused_||!!this.getValue()||this.isBadInput_()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldShake",{get:function(){return!this.isFocused_&&!this.isValid()&&!!this.getValue()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!0},registerTextFieldInteractionHandler:function(){},deregisterTextFieldInteractionHandler:function(){},registerInputInteractionHandler:function(){},deregisterInputInteractionHandler:function(){},registerValidationAttributeChangeHandler:function(){return new MutationObserver((function(){}))},deregisterValidationAttributeChangeHandler:function(){},getNativeInput:function(){return null},isFocused:function(){return!1},activateLineRipple:function(){},deactivateLineRipple:function(){},setLineRippleTransformOrigin:function(){},shakeLabel:function(){},floatLabel:function(){},hasLabel:function(){return!1},getLabelWidth:function(){return 0},hasOutline:function(){return!1},notchOutline:function(){},closeOutline:function(){}}},enumerable:!0,configurable:!0}),e.prototype.init=function(){var t=this;this.adapter_.isFocused()?this.inputFocusHandler_():this.adapter_.hasLabel()&&this.shouldFloat&&(this.notchOutline(!0),this.adapter_.floatLabel(!0),this.styleFloating_(!0)),this.adapter_.registerInputInteractionHandler("focus",this.inputFocusHandler_),this.adapter_.registerInputInteractionHandler("blur",this.inputBlurHandler_),this.adapter_.registerInputInteractionHandler("input",this.inputInputHandler_),P.forEach((function(e){t.adapter_.registerInputInteractionHandler(e,t.setPointerXOffset_)})),O.forEach((function(e){t.adapter_.registerTextFieldInteractionHandler(e,t.textFieldInteractionHandler_)})),this.validationObserver_=this.adapter_.registerValidationAttributeChangeHandler(this.validationAttributeChangeHandler_),this.setCharacterCounter_(this.getValue().length)},e.prototype.destroy=function(){var t=this;this.adapter_.deregisterInputInteractionHandler("focus",this.inputFocusHandler_),this.adapter_.deregisterInputInteractionHandler("blur",this.inputBlurHandler_),this.adapter_.deregisterInputInteractionHandler("input",this.inputInputHandler_),P.forEach((function(e){t.adapter_.deregisterInputInteractionHandler(e,t.setPointerXOffset_)})),O.forEach((function(e){t.adapter_.deregisterTextFieldInteractionHandler(e,t.textFieldInteractionHandler_)})),this.adapter_.deregisterValidationAttributeChangeHandler(this.validationObserver_)},e.prototype.handleTextFieldInteraction=function(){var t=this.adapter_.getNativeInput();t&&t.disabled||(this.receivedUserInput_=!0)},e.prototype.handleValidationAttributeChange=function(t){var e=this;t.some((function(t){return A.indexOf(t)>-1&&(e.styleValidity_(!0),!0)})),t.indexOf("maxlength")>-1&&this.setCharacterCounter_(this.getValue().length)},e.prototype.notchOutline=function(t){if(this.adapter_.hasOutline())if(t){var e=this.adapter_.getLabelWidth()*T.LABEL_SCALE;this.adapter_.notchOutline(e)}else this.adapter_.closeOutline()},e.prototype.activateFocus=function(){this.isFocused_=!0,this.styleFocused_(this.isFocused_),this.adapter_.activateLineRipple(),this.adapter_.hasLabel()&&(this.notchOutline(this.shouldFloat),this.adapter_.floatLabel(this.shouldFloat),this.styleFloating_(this.shouldFloat),this.adapter_.shakeLabel(this.shouldShake)),this.helperText_&&this.helperText_.showToScreenReader()},e.prototype.setTransformOrigin=function(t){var e=t.touches,n=e?e[0]:t,r=n.target.getBoundingClientRect(),i=n.clientX-r.left;this.adapter_.setLineRippleTransformOrigin(i)},e.prototype.handleInput=function(){this.autoCompleteFocus(),this.setCharacterCounter_(this.getValue().length)},e.prototype.autoCompleteFocus=function(){this.receivedUserInput_||this.activateFocus()},e.prototype.deactivateFocus=function(){this.isFocused_=!1,this.adapter_.deactivateLineRipple();var t=this.isValid();this.styleValidity_(t),this.styleFocused_(this.isFocused_),this.adapter_.hasLabel()&&(this.notchOutline(this.shouldFloat),this.adapter_.floatLabel(this.shouldFloat),this.styleFloating_(this.shouldFloat),this.adapter_.shakeLabel(this.shouldShake)),this.shouldFloat||(this.receivedUserInput_=!1)},e.prototype.getValue=function(){return this.getNativeInput_().value},e.prototype.setValue=function(t){this.getValue()!==t&&(this.getNativeInput_().value=t),this.setCharacterCounter_(t.length);var e=this.isValid();this.styleValidity_(e),this.adapter_.hasLabel()&&(this.notchOutline(this.shouldFloat),this.adapter_.floatLabel(this.shouldFloat),this.styleFloating_(this.shouldFloat),this.adapter_.shakeLabel(this.shouldShake))},e.prototype.isValid=function(){return this.useNativeValidation_?this.isNativeInputValid_():this.isValid_},e.prototype.setValid=function(t){this.isValid_=t,this.styleValidity_(t);var e=!t&&!this.isFocused_&&!!this.getValue();this.adapter_.hasLabel()&&this.adapter_.shakeLabel(e)},e.prototype.setUseNativeValidation=function(t){this.useNativeValidation_=t},e.prototype.isDisabled=function(){return this.getNativeInput_().disabled},e.prototype.setDisabled=function(t){this.getNativeInput_().disabled=t,this.styleDisabled_(t)},e.prototype.setHelperTextContent=function(t){this.helperText_&&this.helperText_.setContent(t)},e.prototype.setLeadingIconAriaLabel=function(t){this.leadingIcon_&&this.leadingIcon_.setAriaLabel(t)},e.prototype.setLeadingIconContent=function(t){this.leadingIcon_&&this.leadingIcon_.setContent(t)},e.prototype.setTrailingIconAriaLabel=function(t){this.trailingIcon_&&this.trailingIcon_.setAriaLabel(t)},e.prototype.setTrailingIconContent=function(t){this.trailingIcon_&&this.trailingIcon_.setContent(t)},e.prototype.setCharacterCounter_=function(t){if(this.characterCounter_){var e=this.getNativeInput_().maxLength;if(-1===e)throw new Error("MDCTextFieldFoundation: Expected maxlength html property on text input or textarea.");this.characterCounter_.setCounterValue(t,e)}},e.prototype.isBadInput_=function(){return this.getNativeInput_().validity.badInput||!1},e.prototype.isNativeInputValid_=function(){return this.getNativeInput_().validity.valid},e.prototype.styleValidity_=function(t){var n=e.cssClasses.INVALID;t?this.adapter_.removeClass(n):this.adapter_.addClass(n),this.helperText_&&this.helperText_.setValidity(t)},e.prototype.styleFocused_=function(t){var n=e.cssClasses.FOCUSED;t?this.adapter_.addClass(n):this.adapter_.removeClass(n)},e.prototype.styleDisabled_=function(t){var n=e.cssClasses,r=n.DISABLED,i=n.INVALID;t?(this.adapter_.addClass(r),this.adapter_.removeClass(i)):this.adapter_.removeClass(r),this.leadingIcon_&&this.leadingIcon_.setDisabled(t),this.trailingIcon_&&this.trailingIcon_.setDisabled(t)},e.prototype.styleFloating_=function(t){var n=e.cssClasses.LABEL_FLOATING;t?this.adapter_.addClass(n):this.adapter_.removeClass(n)},e.prototype.getNativeInput_=function(){return(this.adapter_?this.adapter_.getNativeInput():null)||{disabled:!1,maxLength:-1,type:"input",validity:{badInput:!1,valid:!0},value:""}},e}(a.a),L=n(8),R=n(22);
/**
 * @license
 * Copyright (c) 2020 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const I=Object(v.directive)(t=>e=>{let n;if(e instanceof v.EventPart||e instanceof v.NodePart)throw new Error("The `live` directive is not allowed on text or event bindings");if(e instanceof v.BooleanAttributePart)N(e.strings),n=e.element.hasAttribute(e.name),e.value=n;else{const{element:r,name:i,strings:o}=e.committer;if(N(o),e instanceof v.PropertyPart){if(n=r[i],n===t)return}else e instanceof v.AttributePart&&(n=r.getAttribute(i));if(n===String(t))return}e.setValue(t)}),N=t=>{if(2!==t.length||""!==t[0]||""!==t[1])throw new Error("`live` bindings can only contain a single expression")},D=["touchstart","touchmove","scroll","mousewheel"],z=(t={})=>{const e={};for(const n in t)e[n]=t[n];return Object.assign({badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valid:!0,valueMissing:!1},e)};class j extends p.a{constructor(){super(...arguments),this.mdcFoundationClass=k,this.value="",this.type="text",this.placeholder="",this.label="",this.icon="",this.iconTrailing="",this.disabled=!1,this.required=!1,this.minLength=-1,this.maxLength=-1,this.outlined=!1,this.fullWidth=!1,this.helper="",this.validateOnInitialRender=!1,this.validationMessage="",this.autoValidate=!1,this.pattern="",this.min="",this.max="",this.step=null,this.size=null,this.helperPersistent=!1,this.charCounter=!1,this.endAligned=!1,this.prefix="",this.suffix="",this.readOnly=!1,this.outlineOpen=!1,this.outlineWidth=0,this.isUiValid=!0,this._validity=z(),this._outlineUpdateComplete=null,this.validityTransform=null}get validity(){return this._checkValidity(this.value),this._validity}get willValidate(){return this.formElement.willValidate}get selectionStart(){return this.formElement.selectionStart}get selectionEnd(){return this.formElement.selectionEnd}get shouldRenderHelperText(){return!!this.helper||!!this.validationMessage||this.charCounterVisible}get charCounterVisible(){return this.charCounter&&-1!==this.maxLength}focus(){const t=new CustomEvent("focus");this.formElement.dispatchEvent(t),this.formElement.focus()}blur(){const t=new CustomEvent("blur");this.formElement.dispatchEvent(t),this.formElement.blur()}select(){this.formElement.select()}setSelectionRange(t,e,n){this.formElement.setSelectionRange(t,e,n)}render(){const t={"mdc-text-field--disabled":this.disabled,"mdc-text-field--no-label":!this.label,"mdc-text-field--filled":!this.outlined,"mdc-text-field--outlined":this.outlined,"mdc-text-field--fullwidth":this.fullWidth,"mdc-text-field--with-leading-icon":this.icon,"mdc-text-field--with-trailing-icon":this.iconTrailing,"mdc-text-field--end-aligned":this.endAligned},e=this.outlined?"":i.html`<div class="mdc-text-field__ripple"></div>`;return i.html`
      <label class="mdc-text-field ${Object(L.classMap)(t)}">
        ${e}
        ${this.icon?this.renderIcon(this.icon):""}
        ${this.prefix?this.renderAffix(this.prefix):""}
        ${this.renderInput()}
        ${this.suffix?this.renderAffix(this.suffix,!0):""}
        ${this.iconTrailing?this.renderIcon(this.iconTrailing,!0):""}
        ${this.outlined?this.renderOutlined():this.renderLabelText()}
      </label>
      ${this.renderHelperText(this.renderCharCounter())}
    `}updated(t){t.has("value")&&void 0!==t.get("value")&&this.mdcFoundation.setValue(this.value)}renderInput(){const t=-1===this.minLength?void 0:this.minLength,e=-1===this.maxLength?void 0:this.maxLength;return i.html`
      <input
          aria-labelledby="label"
          class="mdc-text-field__input"
          type="${this.type}"
          .value="${I(this.value)}"
          ?disabled="${this.disabled}"
          placeholder="${this.placeholder}"
          ?required="${this.required}"
          ?readonly="${this.readOnly}"
          minlength="${Object(R.a)(t)}"
          maxlength="${Object(R.a)(e)}"
          pattern="${Object(R.a)(this.pattern?this.pattern:void 0)}"
          min="${Object(R.a)(""===this.min?void 0:this.min)}"
          max="${Object(R.a)(""===this.max?void 0:this.max)}"
          step="${Object(R.a)(null===this.step?void 0:this.step)}"
          size="${Object(R.a)(null===this.size?void 0:this.size)}"
          inputmode="${Object(R.a)(this.inputMode)}"
          @input="${this.handleInputChange}"
          @blur="${this.onInputBlur}">`}renderAffix(t,e=!1){const n={"mdc-text-field__affix--prefix":!e,"mdc-text-field__affix--suffix":e};return i.html`<span class="mdc-text-field__affix ${Object(L.classMap)(n)}">
        ${t}</span>`}renderIcon(t,e=!1){const n={"mdc-text-field__icon--leading":!e,"mdc-text-field__icon--trailing":e};return i.html`<i class="material-icons mdc-text-field__icon ${Object(L.classMap)(n)}">${t}</i>`}renderOutlined(){let t="";return this.label&&(t=i.html`
        <span
            .floatingLabelFoundation=${b(this.label)}
            @labelchange=${this.onLabelChange}
            id="label">
          ${this.label}
        </span>
      `),i.html`
      <mwc-notched-outline
          .width=${this.outlineWidth}
          .open=${this.outlineOpen}
          class="mdc-notched-outline">
        ${t}
      </mwc-notched-outline>`}renderLabelText(){let t="";return this.label&&!this.fullWidth&&(t=i.html`
      <span
          .floatingLabelFoundation=${b(this.label)}
          id="label">
        ${this.label}
      </span>`),i.html`
      ${t}
      <span .lineRippleFoundation=${S()}></span>
    `}renderHelperText(t){if(!this.shouldRenderHelperText)return;const e=this.validationMessage&&!this.isUiValid,n={"mdc-text-field-helper-text--persistent":this.helperPersistent,"mdc-text-field-helper-text--validation-msg":e};return i.html`
      <div class="mdc-text-field-helper-line">
        <div class="mdc-text-field-helper-text ${Object(L.classMap)(n)}">${e?this.validationMessage:this.helper}</div>
        ${t}
      </div>
    `}renderCharCounter(){if(!this.charCounterVisible)return;const t=Math.min(this.value.length,this.maxLength);return i.html`<span class="mdc-text-field-character-counter">${t} / ${this.maxLength}</span>`}onInputBlur(){this.reportValidity()}checkValidity(){const t=this._checkValidity(this.value);if(!t){const t=new Event("invalid",{bubbles:!1,cancelable:!0});this.dispatchEvent(t)}return t}reportValidity(){const t=this.checkValidity();return this.mdcFoundation.setValid(t),this.isUiValid=t,t}_checkValidity(t){const e=this.formElement.validity;let n=z(e);if(this.validityTransform){const e=this.validityTransform(t,n);n=Object.assign(Object.assign({},n),e),this.mdcFoundation.setUseNativeValidation(!1)}else this.mdcFoundation.setUseNativeValidation(!0);return this._validity=n,this._validity.valid}setCustomValidity(t){this.validationMessage=t,this.formElement.setCustomValidity(t)}handleInputChange(){this.value=this.formElement.value,this.autoValidate&&this.reportValidity()}createFoundation(){void 0!==this.mdcFoundation&&this.mdcFoundation.destroy(),this.mdcFoundation=new this.mdcFoundationClass(this.createAdapter()),this.mdcFoundation.init()}createAdapter(){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.getRootAdapterMethods()),this.getInputAdapterMethods()),this.getLabelAdapterMethods()),this.getLineRippleAdapterMethods()),this.getOutlineAdapterMethods())}getRootAdapterMethods(){return Object.assign({registerTextFieldInteractionHandler:(t,e)=>this.addEventListener(t,e),deregisterTextFieldInteractionHandler:(t,e)=>this.removeEventListener(t,e),registerValidationAttributeChangeHandler:t=>{const e=new MutationObserver(e=>{t((t=>t.map(t=>t.attributeName).filter(t=>t))(e))});return e.observe(this.formElement,{attributes:!0}),e},deregisterValidationAttributeChangeHandler:t=>t.disconnect()},Object(p.b)(this.mdcRoot))}getInputAdapterMethods(){return{getNativeInput:()=>this.formElement,isFocused:()=>!!this.shadowRoot&&this.shadowRoot.activeElement===this.formElement,registerInputInteractionHandler:(t,e)=>this.formElement.addEventListener(t,e,{passive:t in D}),deregisterInputInteractionHandler:(t,e)=>this.formElement.removeEventListener(t,e)}}getLabelAdapterMethods(){return{floatLabel:t=>this.labelElement&&this.labelElement.floatingLabelFoundation.float(t),getLabelWidth:()=>this.labelElement?this.labelElement.floatingLabelFoundation.getWidth():0,hasLabel:()=>Boolean(this.labelElement),shakeLabel:t=>this.labelElement&&this.labelElement.floatingLabelFoundation.shake(t)}}getLineRippleAdapterMethods(){return{activateLineRipple:()=>{this.lineRippleElement&&this.lineRippleElement.lineRippleFoundation.activate()},deactivateLineRipple:()=>{this.lineRippleElement&&this.lineRippleElement.lineRippleFoundation.deactivate()},setLineRippleTransformOrigin:t=>{this.lineRippleElement&&this.lineRippleElement.lineRippleFoundation.setRippleCenter(t)}}}async _getUpdateComplete(){await super._getUpdateComplete(),await this._outlineUpdateComplete}async firstUpdated(){const t=this.outlineElement;t&&(this._outlineUpdateComplete=t.updateComplete,await this._outlineUpdateComplete),super.firstUpdated(),this.validateOnInitialRender&&this.reportValidity()}getOutlineAdapterMethods(){return{closeOutline:()=>this.outlineElement&&(this.outlineOpen=!1),hasOutline:()=>Boolean(this.outlineElement),notchOutline:t=>{this.outlineElement&&!this.outlineOpen&&(this.outlineWidth=t,this.outlineOpen=!0)}}}async onLabelChange(){this.label&&await this.layout()}async layout(){if(await this.updateComplete,this.labelElement&&this.outlineElement){const t=this.labelElement.floatingLabelFoundation.getWidth();this.outlineOpen&&(this.outlineWidth=t)}}}Object(r.b)([Object(i.query)(".mdc-text-field")],j.prototype,"mdcRoot",void 0),Object(r.b)([Object(i.query)("input")],j.prototype,"formElement",void 0),Object(r.b)([Object(i.query)(".mdc-floating-label")],j.prototype,"labelElement",void 0),Object(r.b)([Object(i.query)(".mdc-line-ripple")],j.prototype,"lineRippleElement",void 0),Object(r.b)([Object(i.query)("mwc-notched-outline")],j.prototype,"outlineElement",void 0),Object(r.b)([Object(i.query)(".mdc-notched-outline__notch")],j.prototype,"notchElement",void 0),Object(r.b)([Object(i.property)({type:String})],j.prototype,"value",void 0),Object(r.b)([Object(i.property)({type:String})],j.prototype,"type",void 0),Object(r.b)([Object(i.property)({type:String})],j.prototype,"placeholder",void 0),Object(r.b)([Object(i.property)({type:String})],j.prototype,"label",void 0),Object(r.b)([Object(i.property)({type:String})],j.prototype,"icon",void 0),Object(r.b)([Object(i.property)({type:String})],j.prototype,"iconTrailing",void 0),Object(r.b)([Object(i.property)({type:Boolean,reflect:!0})],j.prototype,"disabled",void 0),Object(r.b)([Object(i.property)({type:Boolean})],j.prototype,"required",void 0),Object(r.b)([Object(i.property)({type:Number})],j.prototype,"minLength",void 0),Object(r.b)([Object(i.property)({type:Number})],j.prototype,"maxLength",void 0),Object(r.b)([Object(i.property)({type:Boolean,reflect:!0})],j.prototype,"outlined",void 0),Object(r.b)([Object(i.property)({type:Boolean,reflect:!0})],j.prototype,"fullWidth",void 0),Object(r.b)([Object(i.property)({type:String})],j.prototype,"helper",void 0),Object(r.b)([Object(i.property)({type:Boolean})],j.prototype,"validateOnInitialRender",void 0),Object(r.b)([Object(i.property)({type:String})],j.prototype,"validationMessage",void 0),Object(r.b)([Object(i.property)({type:Boolean})],j.prototype,"autoValidate",void 0),Object(r.b)([Object(i.property)({type:String})],j.prototype,"pattern",void 0),Object(r.b)([Object(i.property)({type:Number})],j.prototype,"min",void 0),Object(r.b)([Object(i.property)({type:Number})],j.prototype,"max",void 0),Object(r.b)([Object(i.property)({type:Number})],j.prototype,"step",void 0),Object(r.b)([Object(i.property)({type:Number})],j.prototype,"size",void 0),Object(r.b)([Object(i.property)({type:Boolean})],j.prototype,"helperPersistent",void 0),Object(r.b)([Object(i.property)({type:Boolean})],j.prototype,"charCounter",void 0),Object(r.b)([Object(i.property)({type:Boolean})],j.prototype,"endAligned",void 0),Object(r.b)([Object(i.property)({type:String})],j.prototype,"prefix",void 0),Object(r.b)([Object(i.property)({type:String})],j.prototype,"suffix",void 0),Object(r.b)([Object(i.property)({type:String})],j.prototype,"inputMode",void 0),Object(r.b)([Object(i.property)({type:Boolean})],j.prototype,"readOnly",void 0),Object(r.b)([Object(i.property)({type:Boolean})],j.prototype,"outlineOpen",void 0),Object(r.b)([Object(i.property)({type:Number})],j.prototype,"outlineWidth",void 0),Object(r.b)([Object(i.property)({type:Boolean})],j.prototype,"isUiValid",void 0),Object(r.b)([Object(i.eventOptions)({passive:!0})],j.prototype,"handleInputChange",null);
/**
@license
Copyright 2018 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
const F=i.css`.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-subtitle1-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:1rem;font-size:var(--mdc-typography-subtitle1-font-size, 1rem);font-weight:400;font-weight:var(--mdc-typography-subtitle1-font-weight, 400);letter-spacing:.009375em;letter-spacing:var(--mdc-typography-subtitle1-letter-spacing, 0.009375em);text-decoration:inherit;text-decoration:var(--mdc-typography-subtitle1-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-subtitle1-text-transform, inherit);position:absolute;left:0;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform;transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}[dir=rtl] .mdc-floating-label,.mdc-floating-label[dir=rtl]{right:0;left:auto;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0 - 0%)) translateY(-106%) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-106%) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-106%) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-106%) scale(0.75)}}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{border-bottom-width:1px;z-index:1}.mdc-line-ripple::after{transform:scaleX(0);border-bottom-width:2px;opacity:0;z-index:2}.mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;border-top:1px solid;border-bottom:1px solid;pointer-events:none}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid;flex-grow:1}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{flex:0 0 auto;width:auto;max-width:calc(100% - 12px * 2)}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(100% / .75)}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{padding:0}.mdc-text-field-helper-text{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-caption-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:.75rem;font-size:var(--mdc-typography-caption-font-size, 0.75rem);line-height:1.25rem;line-height:var(--mdc-typography-caption-line-height, 1.25rem);font-weight:400;font-weight:var(--mdc-typography-caption-font-weight, 400);letter-spacing:.0333333333em;letter-spacing:var(--mdc-typography-caption-letter-spacing, 0.0333333333em);text-decoration:inherit;text-decoration:var(--mdc-typography-caption-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-caption-text-transform, inherit);display:block;margin-top:0;line-height:normal;margin:0;opacity:0;will-change:opacity;transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-text-field-helper-text::before{display:inline-block;width:0;height:16px;content:"";vertical-align:0}.mdc-text-field-helper-text--persistent{transition:none;opacity:1;will-change:initial}.mdc-text-field-character-counter{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-caption-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:.75rem;font-size:var(--mdc-typography-caption-font-size, 0.75rem);line-height:1.25rem;line-height:var(--mdc-typography-caption-line-height, 1.25rem);font-weight:400;font-weight:var(--mdc-typography-caption-font-weight, 400);letter-spacing:.0333333333em;letter-spacing:var(--mdc-typography-caption-letter-spacing, 0.0333333333em);text-decoration:inherit;text-decoration:var(--mdc-typography-caption-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-caption-text-transform, inherit);display:block;margin-top:0;line-height:normal;margin-left:auto;margin-right:0;padding-left:16px;padding-right:0;white-space:nowrap}.mdc-text-field-character-counter::before{display:inline-block;width:0;height:16px;content:"";vertical-align:0}[dir=rtl] .mdc-text-field-character-counter,.mdc-text-field-character-counter[dir=rtl]{margin-left:0;margin-right:auto}[dir=rtl] .mdc-text-field-character-counter,.mdc-text-field-character-counter[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field__icon{align-self:center;cursor:pointer}.mdc-text-field__icon:not([tabindex]),.mdc-text-field__icon[tabindex="-1"]{cursor:default;pointer-events:none}.mdc-text-field__icon--leading{margin-left:16px;margin-right:8px}[dir=rtl] .mdc-text-field__icon--leading,.mdc-text-field__icon--leading[dir=rtl]{margin-left:8px;margin-right:16px}.mdc-text-field__icon--trailing{margin-left:12px;margin-right:12px}[dir=rtl] .mdc-text-field__icon--trailing,.mdc-text-field__icon--trailing[dir=rtl]{margin-left:12px;margin-right:12px}@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transform:translate(var(--mdc-ripple-fg-translate-start, 0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity, 0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity, 0)}to{opacity:0}}.mdc-text-field--filled{--mdc-ripple-fg-size: 0;--mdc-ripple-left: 0;--mdc-ripple-top: 0;--mdc-ripple-fg-scale: 1;--mdc-ripple-fg-translate-end: 0;--mdc-ripple-fg-translate-start: 0;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mdc-text-field--filled .mdc-text-field__ripple::before,.mdc-text-field--filled .mdc-text-field__ripple::after{position:absolute;border-radius:50%;opacity:0;pointer-events:none;content:""}.mdc-text-field--filled .mdc-text-field__ripple::before{transition:opacity 15ms linear,background-color 15ms linear;z-index:1}.mdc-text-field--filled.mdc-ripple-upgraded .mdc-text-field__ripple::before{transform:scale(var(--mdc-ripple-fg-scale, 1))}.mdc-text-field--filled.mdc-ripple-upgraded .mdc-text-field__ripple::after{top:0;left:0;transform:scale(0);transform-origin:center center}.mdc-text-field--filled.mdc-ripple-upgraded--unbounded .mdc-text-field__ripple::after{top:var(--mdc-ripple-top, 0);left:var(--mdc-ripple-left, 0)}.mdc-text-field--filled.mdc-ripple-upgraded--foreground-activation .mdc-text-field__ripple::after{animation:mdc-ripple-fg-radius-in 225ms forwards,mdc-ripple-fg-opacity-in 75ms forwards}.mdc-text-field--filled.mdc-ripple-upgraded--foreground-deactivation .mdc-text-field__ripple::after{animation:mdc-ripple-fg-opacity-out 150ms;transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}.mdc-text-field--filled .mdc-text-field__ripple::before,.mdc-text-field--filled .mdc-text-field__ripple::after{top:calc(50% - 100%);left:calc(50% - 100%);width:200%;height:200%}.mdc-text-field--filled.mdc-ripple-upgraded .mdc-text-field__ripple::after{width:var(--mdc-ripple-fg-size, 100%);height:var(--mdc-ripple-fg-size, 100%)}.mdc-text-field__ripple{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none}.mdc-text-field{border-radius:4px 4px 0 0;padding:0 16px;display:inline-flex;align-items:baseline;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-floating-label{color:rgba(0,0,0,.6)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__input{color:rgba(0,0,0,.87)}@media all{.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:rgba(0,0,0,.54)}}@media all{.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:rgba(0,0,0,.54)}}.mdc-text-field .mdc-text-field__input{caret-color:#6200ee;caret-color:var(--mdc-theme-primary, #6200ee)}.mdc-text-field:not(.mdc-text-field--disabled)+.mdc-text-field-helper-line .mdc-text-field-helper-text{color:rgba(0,0,0,.6)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field-character-counter,.mdc-text-field:not(.mdc-text-field--disabled)+.mdc-text-field-helper-line .mdc-text-field-character-counter{color:rgba(0,0,0,.6)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__icon--leading{color:rgba(0,0,0,.54)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__icon--trailing{color:rgba(0,0,0,.54)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__affix--prefix{color:rgba(0,0,0,.6)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__affix--suffix{color:rgba(0,0,0,.6)}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-text-field.mdc-text-field--with-leading-icon{padding-left:0;padding-right:16px}[dir=rtl] .mdc-text-field.mdc-text-field--with-leading-icon,.mdc-text-field.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:16px;padding-right:0}.mdc-text-field.mdc-text-field--with-trailing-icon{padding-left:16px;padding-right:0}[dir=rtl] .mdc-text-field.mdc-text-field--with-trailing-icon,.mdc-text-field.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}[dir=rtl] .mdc-text-field.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon,.mdc-text-field.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0;padding-right:0}.mdc-text-field__input{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-subtitle1-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:1rem;font-size:var(--mdc-typography-subtitle1-font-size, 1rem);font-weight:400;font-weight:var(--mdc-typography-subtitle1-font-weight, 400);letter-spacing:.009375em;letter-spacing:var(--mdc-typography-subtitle1-letter-spacing, 0.009375em);text-decoration:inherit;text-decoration:var(--mdc-typography-subtitle1-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-subtitle1-text-transform, inherit);height:28px;transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1);width:100%;min-width:0;border:none;border-radius:0;background:none;appearance:none;padding:0}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}.mdc-text-field__input:-webkit-autofill{z-index:auto !important}@media all{.mdc-text-field__input::placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1);opacity:0}}@media all{.mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1);opacity:0}}@media all{.mdc-text-field--fullwidth .mdc-text-field__input::placeholder,.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}}@media all{.mdc-text-field--fullwidth .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}}.mdc-text-field__affix{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-subtitle1-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:1rem;font-size:var(--mdc-typography-subtitle1-font-size, 1rem);font-weight:400;font-weight:var(--mdc-typography-subtitle1-font-weight, 400);letter-spacing:.009375em;letter-spacing:var(--mdc-typography-subtitle1-letter-spacing, 0.009375em);text-decoration:inherit;text-decoration:var(--mdc-typography-subtitle1-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-subtitle1-text-transform, inherit);height:28px;transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1);opacity:0;white-space:nowrap}.mdc-text-field--label-floating .mdc-text-field__affix,.mdc-text-field--no-label .mdc-text-field__affix{opacity:1}.mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field__affix--prefix,.mdc-text-field__affix--prefix[dir=rtl]{padding-left:2px;padding-right:0}.mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-left:0;padding-right:12px}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--end-aligned .mdc-text-field__affix--prefix[dir=rtl]{padding-left:12px;padding-right:0}.mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field__affix--suffix,.mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:12px}.mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:2px;padding-right:0}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--end-aligned .mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:2px}.mdc-text-field__input:-webkit-autofill+.mdc-floating-label{transform:translateY(-50%) scale(0.75);cursor:auto}.mdc-text-field--filled{height:56px}.mdc-text-field--filled .mdc-text-field__ripple::before,.mdc-text-field--filled .mdc-text-field__ripple::after{background-color:rgba(0,0,0,.87)}.mdc-text-field--filled:hover .mdc-text-field__ripple::before{opacity:.04}.mdc-text-field--filled.mdc-ripple-upgraded--background-focused .mdc-text-field__ripple::before,.mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms;opacity:.12}.mdc-text-field--filled::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-text-field--filled:not(.mdc-text-field--disabled){background-color:#f5f5f5}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.42)}.mdc-text-field--filled:not(.mdc-text-field--disabled):hover .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.87)}.mdc-text-field--filled .mdc-line-ripple::after{border-bottom-color:#6200ee;border-bottom-color:var(--mdc-theme-primary, #6200ee)}.mdc-text-field--filled .mdc-floating-label{left:16px;right:initial}[dir=rtl] .mdc-text-field--filled .mdc-floating-label,.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:16px}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled.mdc-text-field--no-label::before{display:none}.mdc-text-field--outlined{height:56px;overflow:visible}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined{0%{transform:translateX(calc(0 - 0%)) translateY(-34.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-34.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-34.75px) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-34.75px) scale(0.75)}}.mdc-text-field--outlined .mdc-text-field__input{height:100%}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:rgba(0,0,0,.38)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:rgba(0,0,0,.87)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:#6200ee;border-color:var(--mdc-theme-primary, #6200ee)}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-radius:4px 0 0 4px}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-radius:0 4px 4px 0}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-radius:0 4px 4px 0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-radius:4px 0 0 4px}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--outlined .mdc-text-field__ripple::before,.mdc-text-field--outlined .mdc-text-field__ripple::after{content:none}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:initial}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:4px}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:transparent}.mdc-text-field--textarea{flex-direction:column;width:auto;height:auto;padding:0;transition:none}.mdc-text-field--textarea .mdc-floating-label{top:18px}.mdc-text-field--textarea .mdc-floating-label:not(.mdc-floating-label--float-above){transform:none}.mdc-text-field--textarea .mdc-text-field__input{flex-grow:1;height:auto;min-height:1.5rem;overflow-x:hidden;overflow-y:auto;box-sizing:border-box;margin-left:0;margin-right:1px;padding:0 16px;line-height:1.5rem}[dir=rtl] .mdc-text-field--textarea .mdc-text-field__input,.mdc-text-field--textarea .mdc-text-field__input[dir=rtl]{margin-left:1px;margin-right:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-outlined{0%{transform:translateX(calc(0 - 0%)) translateY(-24.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-24.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-24.75px) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-24.75px) scale(0.75)}}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field__input{margin-bottom:2px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter{padding:0 16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::after{display:inline-block;width:0;height:16px;content:"";vertical-align:-16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::before{display:none}.mdc-text-field--fullwidth{padding:0;width:100%}.mdc-text-field--fullwidth:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.42)}.mdc-text-field--fullwidth.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.42)}.mdc-text-field--fullwidth:not(.mdc-text-field--textarea){display:flex}.mdc-text-field--fullwidth:not(.mdc-text-field--textarea) .mdc-text-field__input{height:100%}.mdc-text-field--fullwidth:not(.mdc-text-field--textarea) .mdc-floating-label{display:none}.mdc-text-field--fullwidth:not(.mdc-text-field--textarea)::before{display:none}.mdc-text-field--fullwidth:not(.mdc-text-field--textarea) .mdc-text-field__ripple::before,.mdc-text-field--fullwidth:not(.mdc-text-field--textarea) .mdc-text-field__ripple::after{content:none}.mdc-text-field--fullwidth:not(.mdc-text-field--textarea):not(.mdc-text-field--disabled){background-color:transparent}.mdc-text-field--fullwidth.mdc-text-field--textarea .mdc-text-field__input{resize:vertical}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 48px);left:48px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:48px}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 64px / 0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label{left:36px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:36px}.mdc-text-field--with-leading-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(0.75)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-34.75px) translateX(32px) scale(0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon{0%{transform:translateX(calc(0 - 32px)) translateY(-34.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 32px)) translateY(-34.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 32px)) translateY(-34.75px) scale(0.75)}100%{transform:translateX(calc(0 - 32px)) translateY(-34.75px) scale(0.75)}}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake,.mdc-text-field--with-leading-icon.mdc-text-field--outlined[dir=rtl] .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon-rtl{0%{transform:translateX(calc(0 - -32px)) translateY(-34.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - -32px)) translateY(-34.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - -32px)) translateY(-34.75px) scale(0.75)}100%{transform:translateX(calc(0 - -32px)) translateY(-34.75px) scale(0.75)}}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 64px / 0.75)}.mdc-text-field--with-trailing-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 96px / 0.75)}.mdc-text-field__input:required~.mdc-floating-label::after,.mdc-text-field__input:required~.mdc-notched-outline .mdc-floating-label::after{margin-left:1px;content:"*"}.mdc-text-field-helper-line{display:flex;justify-content:space-between;box-sizing:border-box}.mdc-text-field+.mdc-text-field-helper-line{padding-right:16px;padding-left:16px}.mdc-form-field>.mdc-text-field+label{align-self:flex-start}.mdc-text-field--focused:not(.mdc-text-field--disabled) .mdc-floating-label{color:rgba(98,0,238,.87)}.mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--focused .mdc-notched-outline__trailing{border-width:2px}.mdc-text-field--focused+.mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg){opacity:1}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-text-field--focused.mdc-text-field--outlined.mdc-text-field--textarea .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--invalid:not(.mdc-text-field--disabled):hover .mdc-line-ripple::before{border-bottom-color:#b00020;border-bottom-color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:#b00020;border-bottom-color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label{color:#b00020;color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{color:#b00020;color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid .mdc-text-field__input{caret-color:#b00020;caret-color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__icon--trailing{color:#b00020;color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:#b00020;border-bottom-color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:#b00020;border-color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:#b00020;border-color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:#b00020;border-color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{opacity:1}.mdc-text-field--disabled{pointer-events:none}.mdc-text-field--disabled .mdc-text-field__input{color:rgba(0,0,0,.38)}@media all{.mdc-text-field--disabled .mdc-text-field__input::placeholder{color:rgba(0,0,0,.38)}}@media all{.mdc-text-field--disabled .mdc-text-field__input:-ms-input-placeholder{color:rgba(0,0,0,.38)}}.mdc-text-field--disabled .mdc-floating-label{color:rgba(0,0,0,.38)}.mdc-text-field--disabled+.mdc-text-field-helper-line .mdc-text-field-helper-text{color:rgba(0,0,0,.38)}.mdc-text-field--disabled .mdc-text-field-character-counter,.mdc-text-field--disabled+.mdc-text-field-helper-line .mdc-text-field-character-counter{color:rgba(0,0,0,.38)}.mdc-text-field--disabled .mdc-text-field__icon--leading{color:rgba(0,0,0,.3)}.mdc-text-field--disabled .mdc-text-field__icon--trailing{color:rgba(0,0,0,.3)}.mdc-text-field--disabled .mdc-text-field__affix--prefix{color:rgba(0,0,0,.38)}.mdc-text-field--disabled .mdc-text-field__affix--suffix{color:rgba(0,0,0,.38)}.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.06)}.mdc-text-field--disabled .mdc-notched-outline__leading,.mdc-text-field--disabled .mdc-notched-outline__notch,.mdc-text-field--disabled .mdc-notched-outline__trailing{border-color:rgba(0,0,0,.06)}@media screen and (-ms-high-contrast: active){.mdc-text-field--disabled .mdc-text-field__input::placeholder{color:GrayText}}@media screen and (-ms-high-contrast: active){.mdc-text-field--disabled .mdc-text-field__input:-ms-input-placeholder{color:GrayText}}@media screen and (-ms-high-contrast: active){.mdc-text-field--disabled .mdc-floating-label{color:GrayText}}@media screen and (-ms-high-contrast: active){.mdc-text-field--disabled+.mdc-text-field-helper-line .mdc-text-field-helper-text{color:GrayText}}@media screen and (-ms-high-contrast: active){.mdc-text-field--disabled .mdc-text-field-character-counter,.mdc-text-field--disabled+.mdc-text-field-helper-line .mdc-text-field-character-counter{color:GrayText}}@media screen and (-ms-high-contrast: active){.mdc-text-field--disabled .mdc-text-field__icon--leading{color:GrayText}}@media screen and (-ms-high-contrast: active){.mdc-text-field--disabled .mdc-text-field__icon--trailing{color:GrayText}}@media screen and (-ms-high-contrast: active){.mdc-text-field--disabled .mdc-text-field__affix--prefix{color:GrayText}}@media screen and (-ms-high-contrast: active){.mdc-text-field--disabled .mdc-text-field__affix--suffix{color:GrayText}}@media screen and (-ms-high-contrast: active){.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:GrayText}}@media screen and (-ms-high-contrast: active){.mdc-text-field--disabled .mdc-notched-outline__leading,.mdc-text-field--disabled .mdc-notched-outline__notch,.mdc-text-field--disabled .mdc-notched-outline__trailing{border-color:GrayText}}.mdc-text-field--disabled .mdc-floating-label{cursor:default}.mdc-text-field--disabled.mdc-text-field--filled{background-color:#fafafa}.mdc-text-field--end-aligned .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--end-aligned .mdc-text-field__input[dir=rtl]{text-align:left}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix{direction:ltr}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--leading,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--leading{order:1}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{order:2}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input{order:3}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{order:4}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--trailing,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--trailing{order:5}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--prefix{padding-right:12px}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--suffix{padding-left:2px}.material-icons{font-family:var(--mdc-icon-font, "Material Icons");font-weight:normal;font-style:normal;font-size:var(--mdc-icon-size, 24px);line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;font-feature-settings:"liga"}:host{display:inline-flex;flex-direction:column;outline:none}:host([fullwidth]){display:flex}.mdc-text-field{width:100%;border-radius:4px 4px 0 0;border-radius:var(--mdc-text-field-filled-border-radius, 4px 4px 0 0)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.42);border-bottom-color:var(--mdc-text-field-idle-line-color, rgba(0, 0, 0, 0.42))}.mdc-text-field:not(.mdc-text-field--disabled):hover .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.87);border-bottom-color:var(--mdc-text-field-hover-line-color, rgba(0, 0, 0, 0.87))}.mdc-text-field.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.06);border-bottom-color:var(--mdc-text-field-disabled-line-color, rgba(0, 0, 0, 0.06))}.mdc-text-field.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:#b00020;border-bottom-color:var(--mdc-theme-error, #b00020)}mwc-notched-outline{--mdc-notched-outline-border-color: var(--mdc-text-field-outlined-idle-border-color, rgba(0, 0, 0, 0.38))}:host(:not([disabled]):hover) :not(.mdc-text-field--invalid):not(.mdc-text-field--focused) mwc-notched-outline{--mdc-notched-outline-border-color: var(--mdc-text-field-outlined-hover-border-color, rgba(0, 0, 0, 0.87))}:host(:not([disabled])) .mdc-text-field:not(.mdc-text-field--outlined){background-color:var(--mdc-text-field-fill-color, whitesmoke)}:host(:not([disabled])) .mdc-text-field.mdc-text-field--invalid mwc-notched-outline{--mdc-notched-outline-border-color: var(--mdc-text-field-error-color, var(--mdc-theme-error, #b00020))}:host(:not([disabled])) .mdc-text-field.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-character-counter,:host(:not([disabled])) .mdc-text-field.mdc-text-field--invalid .mdc-text-field__icon{color:var(--mdc-text-field-error-color, var(--mdc-theme-error, #b00020))}:host(:not([disabled])) .mdc-text-field:not(.mdc-text-field--invalid):not(.mdc-text-field--focused) .mdc-floating-label,:host(:not([disabled])) .mdc-text-field:not(.mdc-text-field--invalid):not(.mdc-text-field--focused) .mdc-floating-label::after{color:var(--mdc-text-field-label-ink-color, rgba(0, 0, 0, 0.6))}:host(:not([disabled])) .mdc-text-field.mdc-text-field--focused mwc-notched-outline{--mdc-notched-outline-stroke-width: 2px}:host(:not([disabled])) .mdc-text-field.mdc-text-field--focused:not(.mdc-text-field--invalid) mwc-notched-outline{--mdc-notched-outline-border-color: var(--mdc-text-field-focused-label-color, var(--mdc-theme-primary, rgba(98, 0, 238, 0.87)))}:host(:not([disabled])) .mdc-text-field.mdc-text-field--focused:not(.mdc-text-field--invalid) .mdc-floating-label{color:#6200ee;color:var(--mdc-theme-primary, #6200ee)}:host(:not([disabled])) .mdc-text-field.mdc-text-field--focused:not(.mdc-text-field--invalid) .mdc-text-field__input:required~.mdc-floating-label::after,:host(:not([disabled])) .mdc-text-field.mdc-text-field--focused:not(.mdc-text-field--invalid) .mdc-text-field__input:required~.mdc-notched-outline .mdc-floating-label::after{color:#6200ee;color:var(--mdc-theme-primary, #6200ee)}:host(:not([disabled])) .mdc-text-field .mdc-text-field__input{color:var(--mdc-text-field-ink-color, rgba(0, 0, 0, 0.87))}:host(:not([disabled])) .mdc-text-field .mdc-text-field__input::placeholder{color:var(--mdc-text-field-label-ink-color, rgba(0, 0, 0, 0.6))}:host(:not([disabled])) .mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg),:host(:not([disabled])) .mdc-text-field-helper-line:not(.mdc-text-field--invalid) .mdc-text-field-character-counter{color:var(--mdc-text-field-label-ink-color, rgba(0, 0, 0, 0.6))}:host([disabled]) .mdc-text-field:not(.mdc-text-field--outlined){background-color:var(--mdc-text-field-disabled-fill-color, #fafafa)}:host([disabled]) .mdc-text-field.mdc-text-field--outlined mwc-notched-outline{--mdc-notched-outline-border-color: var(--mdc-text-field-outlined-disabled-border-color, rgba(0, 0, 0, 0.06))}:host([disabled]) .mdc-text-field:not(.mdc-text-field--invalid):not(.mdc-text-field--focused) .mdc-floating-label,:host([disabled]) .mdc-text-field:not(.mdc-text-field--invalid):not(.mdc-text-field--focused) .mdc-floating-label::after{color:var(--mdc-text-field-disabled-ink-color, rgba(0, 0, 0, 0.38))}:host([disabled]) .mdc-text-field .mdc-text-field__input,:host([disabled]) .mdc-text-field .mdc-text-field__input::placeholder{color:var(--mdc-text-field-disabled-ink-color, rgba(0, 0, 0, 0.38))}:host([disabled]) .mdc-text-field-helper-line .mdc-text-field-helper-text,:host([disabled]) .mdc-text-field-helper-line .mdc-text-field-character-counter{color:var(--mdc-text-field-disabled-ink-color, rgba(0, 0, 0, 0.38))}`;
/**
@license
Copyright 2019 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/let B=class extends j{};B.styles=F,B=Object(r.b)([Object(i.customElement)("mwc-textfield")],B)},function(t,e,n){"use strict";n.r(e),n.d(e,"Radio",(function(){return P}));var r=n(1),i=n(0),o=n(21),a=n(40);
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
function s(t){return void 0===t&&(t=window),!!function(t){void 0===t&&(t=window);var e=!1;try{var n={get passive(){return e=!0,!1}},r=function(){};t.document.addEventListener("test",r,n),t.document.removeEventListener("test",r,n)}catch(t){e=!1}return e}(t)&&{passive:!0}}var c=n(46),l=n(48),u=n(47),d=n(3);
/**
@license
Copyright 2018 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
const h=i.css`@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transform:translate(var(--mdc-ripple-fg-translate-start, 0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity, 0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity, 0)}to{opacity:0}}`,f=Object(u.b)(window);
/**
@license
Copyright 2018 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/class p{constructor(t){this.foundation=t}startPress(){this.foundation.activate()}endPress(){this.foundation.deactivate()}startFocus(){this.foundation.handleFocus()}endFocus(){this.foundation.handleBlur()}destroy(){this.foundation.destroy()}setUnbounded(t){this.foundation.setUnbounded(t)}}const m=navigator.userAgent.match(/Safari/);let g=!1;const v=t=>{m&&!g&&(()=>{g=!0;const t=document.createElement("style"),e=new d.NodePart({templateFactory:d.templateFactory});e.appendInto(t),e.setValue(h),e.commit(),document.head.appendChild(t)})();const e=t.surfaceNode,n=t.interactionNode||e;n.getRootNode()!==e.getRootNode()&&""===n.style.position&&(n.style.position="relative");const r={browserSupportsCssVars:()=>f,isUnbounded:()=>void 0===t.unbounded||t.unbounded,isSurfaceActive:()=>Object(c.a)(n,":active"),isSurfaceDisabled:()=>Boolean(n.hasAttribute("disabled")),addClass:t=>e.classList.add(t),removeClass:t=>e.classList.remove(t),containsEventTarget:t=>n.contains(t),registerInteractionHandler:(t,e)=>n.addEventListener(t,e,s()),deregisterInteractionHandler:(t,e)=>n.removeEventListener(t,e,s()),registerDocumentInteractionHandler:(t,e)=>document.documentElement.addEventListener(t,e,s()),deregisterDocumentInteractionHandler:(t,e)=>document.documentElement.removeEventListener(t,e,s()),registerResizeHandler:t=>window.addEventListener("resize",t),deregisterResizeHandler:t=>window.removeEventListener("resize",t),updateCssVariable:(t,n)=>e.style.setProperty(t,n),computeBoundingRect:()=>e.getBoundingClientRect(),getWindowPageOffset:()=>({x:window.pageXOffset,y:window.pageYOffset})},i=new l.a(r);return i.init(),new p(i)},y=new WeakMap,b=Object(d.directive)((t={})=>e=>{const n=e.committer.element,r=t.interactionNode||n;let i=e.value;const o=y.get(i);void 0!==o&&o!==r&&(i.destroy(),i=d.noChange),i===d.noChange?(i=v(Object.assign({},t,{surfaceNode:n})),y.set(i,r),e.setValue(i)):(void 0!==t.unbounded&&i.setUnbounded(t.unbounded),void 0!==t.disabled&&i.setUnbounded(t.disabled)),!0===t.active?i.startPress():!1===t.active&&i.endPress()});var x=n(17),_={NATIVE_CONTROL_SELECTOR:".mdc-radio__native-control"},w={DISABLED:"mdc-radio--disabled",ROOT:"mdc-radio"},S=function(t){function e(n){return t.call(this,Object(r.a)(Object(r.a)({},e.defaultAdapter),n))||this}return Object(r.c)(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return w},enumerable:!0,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return _},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},setNativeControlDisabled:function(){}}},enumerable:!0,configurable:!0}),e.prototype.setDisabled=function(t){var n=e.cssClasses.DISABLED;this.adapter_.setNativeControlDisabled(t),t?this.adapter_.addClass(n):this.adapter_.removeClass(n)},e}(x.a);
/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
/**
@license
Copyright 2018 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
class M extends o.a{constructor(){super(...arguments),this._checked=!1,this.global=!1,this.disabled=!1,this.value="",this.name="",this.mdcFoundationClass=S}get checked(){return this._checked}set checked(t){const e=this._checked;!!t!=!!e&&(this._checked=t,this.formElement&&(this.formElement.checked=t),void 0!==this._selectionController&&this._selectionController.update(this),this.requestUpdate("checked",e),this.dispatchEvent(new Event("checked",{bubbles:!0,composed:!0})))}_handleUpdatedValue(t){this.formElement.value=t}connectedCallback(){super.connectedCallback(),this._selectionController=A.getController(this),this._selectionController.register(this),this._selectionController.update(this)}disconnectedCallback(){this._selectionController.unregister(this),this._selectionController=void 0}focusNative(){this.formElement.focus()}get ripple(){return this.rippleElement.ripple}createAdapter(){return Object.assign(Object.assign({},Object(o.b)(this.mdcRoot)),{setNativeControlDisabled:t=>{this.formElement.disabled=t}})}_changeHandler(){this.checked=this.formElement.checked}_focusHandler(){void 0!==this._selectionController&&this._selectionController.focus(this)}_clickHandler(){this.formElement.focus()}render(){return i.html`
      <div class="mdc-radio" .ripple=${b()}>
        <input
          class="mdc-radio__native-control"
          type="radio"
          name="${this.name}"
          .checked="${this.checked}"
          .value="${this.value}"
          @change="${this._changeHandler}"
          @focus="${this._focusHandler}"
          @click="${this._clickHandler}">
        <div class="mdc-radio__background">
          <div class="mdc-radio__outer-circle"></div>
          <div class="mdc-radio__inner-circle"></div>
        </div>
        <div class="mdc-radio__ripple"></div>
      </div>`}firstUpdated(){super.firstUpdated(),this.formElement.checked=this.checked,void 0!==this._selectionController&&this._selectionController.update(this)}}Object(r.b)([Object(i.query)(".mdc-radio")],M.prototype,"mdcRoot",void 0),Object(r.b)([Object(i.query)("input")],M.prototype,"formElement",void 0),Object(r.b)([Object(i.query)(".mdc-radio__ripple")],M.prototype,"rippleElement",void 0),Object(r.b)([Object(i.property)({type:Boolean})],M.prototype,"global",void 0),Object(r.b)([Object(i.property)({type:Boolean,reflect:!0})],M.prototype,"checked",null),Object(r.b)([Object(i.property)({type:Boolean}),Object(a.a)((function(t){this.mdcFoundation.setDisabled(t)}))],M.prototype,"disabled",void 0),Object(r.b)([Object(i.property)({type:String}),Object(a.a)((function(t){this._handleUpdatedValue(t)}))],M.prototype,"value",void 0),Object(r.b)([Object(i.property)({type:String})],M.prototype,"name",void 0);const E=Symbol("selection controller");class T{constructor(){this.selected=null,this.ordered=null,this.set=new Set}}class A{constructor(t){this.sets={},this.focusedSet=null,this.mouseIsDown=!1,this.updating=!1,t.addEventListener("keydown",t=>this.keyDownHandler(t)),t.addEventListener("mousedown",()=>this.mousedownHandler()),t.addEventListener("mouseup",()=>this.mouseupHandler())}static getController(t){const e=!("global"in t)||"global"in t&&t.global?document:t.getRootNode();let n=e[E];return void 0===n&&(n=new A(e),e[E]=n),n}keyDownHandler(t){if(!(t.target instanceof M))return;const e=t.target;this.has(e)&&("ArrowRight"==t.key||"ArrowDown"==t.key?this.next(e):"ArrowLeft"!=t.key&&"ArrowUp"!=t.key||this.previous(e))}mousedownHandler(){this.mouseIsDown=!0}mouseupHandler(){this.mouseIsDown=!1}has(t){return this.getSet(t.name).set.has(t)}previous(t){const e=this.getOrdered(t),n=e.indexOf(t);this.select(e[n-1]||e[e.length-1])}next(t){const e=this.getOrdered(t),n=e.indexOf(t);this.select(e[n+1]||e[0])}select(t){t.click()}focus(t){if(this.mouseIsDown)return;const e=this.getSet(t.name),n=this.focusedSet;this.focusedSet=e,n!=e&&e.selected&&e.selected!=t&&e.selected.focusNative()}getOrdered(t){const e=this.getSet(t.name);return e.ordered||(e.ordered=Array.from(e.set),e.ordered.sort((t,e)=>t.compareDocumentPosition(e)==Node.DOCUMENT_POSITION_PRECEDING?1:0)),e.ordered}getSet(t){return this.sets[t]||(this.sets[t]=new T),this.sets[t]}register(t){const e=this.getSet(t.name);e.set.add(t),e.ordered=null}unregister(t){const e=this.getSet(t.name);e.set.delete(t),e.ordered=null,e.selected==t&&(e.selected=null)}update(t){if(!this.updating){if(this.updating=!0,t.checked){const e=this.getSet(t.name);for(const n of e.set)n.checked=n==t;e.selected=t}this.updating=!1}}}
/**
@license
Copyright 2018 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/const C=i.css`.mdc-touch-target-wrapper{display:inline}.mdc-radio{padding:10px;display:inline-block;position:relative;flex:0 0 auto;box-sizing:content-box;width:20px;height:20px;cursor:pointer;will-change:opacity,transform,border-color,color}.mdc-radio .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:rgba(0,0,0,.54)}.mdc-radio .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:#018786;border-color:var(--mdc-theme-secondary, #018786)}.mdc-radio .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:#018786;border-color:var(--mdc-theme-secondary, #018786)}.mdc-radio [aria-disabled=true] .mdc-radio__native-control:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle,.mdc-radio .mdc-radio__native-control:disabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:rgba(0,0,0,.38)}.mdc-radio [aria-disabled=true] .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mdc-radio .mdc-radio__native-control:disabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:rgba(0,0,0,.38)}.mdc-radio [aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background .mdc-radio__inner-circle,.mdc-radio .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:rgba(0,0,0,.38)}.mdc-radio .mdc-radio__background::before{background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}.mdc-radio .mdc-radio__background::before{top:-10px;left:-10px;width:40px;height:40px}.mdc-radio .mdc-radio__native-control{top:0px;right:0px;left:0px;width:40px;height:40px}.mdc-radio__background{display:inline-block;position:relative;box-sizing:border-box;width:20px;height:20px}.mdc-radio__background::before{position:absolute;transform:scale(0, 0);border-radius:50%;opacity:0;pointer-events:none;content:"";transition:opacity 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-radio__outer-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;border-width:2px;border-style:solid;border-radius:50%;transition:border-color 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-radio__inner-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;transform:scale(0, 0);border-width:10px;border-style:solid;border-radius:50%;transition:transform 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1),border-color 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-radio__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit;z-index:1}.mdc-radio--touch{margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-radio--touch .mdc-radio__native-control{top:-4px;right:-4px;left:-4px;width:48px;height:48px}.mdc-radio__native-control:checked+.mdc-radio__background,.mdc-radio__native-control:disabled+.mdc-radio__background{transition:opacity 120ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__outer-circle{transition:border-color 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__inner-circle,.mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{transition:transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1),border-color 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio--disabled{cursor:default;pointer-events:none}.mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__inner-circle{transform:scale(0.5);transition:transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1),border-color 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio__native-control:disabled+.mdc-radio__background,[aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background{cursor:default}.mdc-radio__native-control:focus+.mdc-radio__background::before{transform:scale(1);opacity:.12;transition:opacity 120ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transform:translate(var(--mdc-ripple-fg-translate-start, 0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity, 0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity, 0)}to{opacity:0}}.mdc-radio{--mdc-ripple-fg-size: 0;--mdc-ripple-left: 0;--mdc-ripple-top: 0;--mdc-ripple-fg-scale: 1;--mdc-ripple-fg-translate-end: 0;--mdc-ripple-fg-translate-start: 0;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mdc-radio .mdc-radio__ripple::before,.mdc-radio .mdc-radio__ripple::after{position:absolute;border-radius:50%;opacity:0;pointer-events:none;content:""}.mdc-radio .mdc-radio__ripple::before{transition:opacity 15ms linear,background-color 15ms linear;z-index:1}.mdc-radio.mdc-ripple-upgraded .mdc-radio__ripple::before{transform:scale(var(--mdc-ripple-fg-scale, 1))}.mdc-radio.mdc-ripple-upgraded .mdc-radio__ripple::after{top:0;left:0;transform:scale(0);transform-origin:center center}.mdc-radio.mdc-ripple-upgraded--unbounded .mdc-radio__ripple::after{top:var(--mdc-ripple-top, 0);left:var(--mdc-ripple-left, 0)}.mdc-radio.mdc-ripple-upgraded--foreground-activation .mdc-radio__ripple::after{animation:mdc-ripple-fg-radius-in 225ms forwards,mdc-ripple-fg-opacity-in 75ms forwards}.mdc-radio.mdc-ripple-upgraded--foreground-deactivation .mdc-radio__ripple::after{animation:mdc-ripple-fg-opacity-out 150ms;transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}.mdc-radio .mdc-radio__ripple::before,.mdc-radio .mdc-radio__ripple::after{top:calc(50% - 50%);left:calc(50% - 50%);width:100%;height:100%}.mdc-radio.mdc-ripple-upgraded .mdc-radio__ripple::before,.mdc-radio.mdc-ripple-upgraded .mdc-radio__ripple::after{top:var(--mdc-ripple-top, calc(50% - 50%));left:var(--mdc-ripple-left, calc(50% - 50%));width:var(--mdc-ripple-fg-size, 100%);height:var(--mdc-ripple-fg-size, 100%)}.mdc-radio.mdc-ripple-upgraded .mdc-radio__ripple::after{width:var(--mdc-ripple-fg-size, 100%);height:var(--mdc-ripple-fg-size, 100%)}.mdc-radio .mdc-radio__ripple::before,.mdc-radio .mdc-radio__ripple::after{background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}.mdc-radio:hover .mdc-radio__ripple::before{opacity:.04}.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__ripple::before,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__ripple::before{transition-duration:75ms;opacity:.12}.mdc-radio:not(.mdc-ripple-upgraded) .mdc-radio__ripple::after{transition:opacity 150ms linear}.mdc-radio:not(.mdc-ripple-upgraded):active .mdc-radio__ripple::after{transition-duration:75ms;opacity:.12}.mdc-radio.mdc-ripple-upgraded{--mdc-ripple-fg-opacity: 0.12}.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__background::before{content:none}.mdc-radio__ripple{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none}:host{display:inline-block;outline:none}.mdc-radio{vertical-align:bottom}.mdc-radio .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unchecked-color, rgba(0, 0, 0, 0.54))}.mdc-radio [aria-disabled=true] .mdc-radio__native-control:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle,.mdc-radio .mdc-radio__native-control:disabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-color, rgba(0, 0, 0, 0.38))}.mdc-radio [aria-disabled=true] .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mdc-radio .mdc-radio__native-control:disabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-color, rgba(0, 0, 0, 0.38))}.mdc-radio [aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background .mdc-radio__inner-circle,.mdc-radio .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-disabled-color, rgba(0, 0, 0, 0.38))}`;
/**
@license
Copyright 2018 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/let P=class extends M{};P.styles=C,P=Object(r.b)([Object(i.customElement)("mwc-radio")],P)},function(t,e,n){"use strict";n.r(e),n.d(e,"Checkbox",(function(){return v}));var r=n(1),i=n(0),o=n(23),a=n(48),s=n(8),c=n(15);
/**
@license
Copyright 2018 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
class l extends o.a{constructor(){super(...arguments),this.primary=!1,this.accent=!1,this.unbounded=!1,this.disabled=!1,this.activated=!1,this.selected=!1,this.hovering=!1,this.bgFocused=!1,this.fgActivation=!1,this.fgDeactivation=!1,this.fgScale="",this.fgSize="",this.translateStart="",this.translateEnd="",this.leftPos="",this.topPos="",this.mdcFoundationClass=a.a}get isActive(){return(this.parentElement||this).matches(":active")}createAdapter(){return{browserSupportsCssVars:()=>!0,isUnbounded:()=>this.unbounded,isSurfaceActive:()=>this.isActive,isSurfaceDisabled:()=>this.disabled,addClass:t=>{switch(t){case"mdc-ripple-upgraded--background-focused":this.bgFocused=!0;break;case"mdc-ripple-upgraded--foreground-activation":this.fgActivation=!0;break;case"mdc-ripple-upgraded--foreground-deactivation":this.fgDeactivation=!0}},removeClass:t=>{switch(t){case"mdc-ripple-upgraded--background-focused":this.bgFocused=!1;break;case"mdc-ripple-upgraded--foreground-activation":this.fgActivation=!1;break;case"mdc-ripple-upgraded--foreground-deactivation":this.fgDeactivation=!1}},containsEventTarget:()=>!0,registerInteractionHandler:()=>{},deregisterInteractionHandler:()=>{},registerDocumentInteractionHandler:()=>{},deregisterDocumentInteractionHandler:()=>{},registerResizeHandler:()=>{},deregisterResizeHandler:()=>{},updateCssVariable:(t,e)=>{switch(t){case"--mdc-ripple-fg-scale":this.fgScale=e;break;case"--mdc-ripple-fg-size":this.fgSize=e;break;case"--mdc-ripple-fg-translate-end":this.translateEnd=e;break;case"--mdc-ripple-fg-translate-start":this.translateStart=e;break;case"--mdc-ripple-left":this.leftPos=e;break;case"--mdc-ripple-top":this.topPos=e}},computeBoundingRect:()=>(this.parentElement||this).getBoundingClientRect(),getWindowPageOffset:()=>({x:window.pageXOffset,y:window.pageYOffset})}}startPress(t){this.waitForFoundation(()=>{this.mdcFoundation.activate(t)})}endPress(){this.waitForFoundation(()=>{this.mdcFoundation.deactivate()})}startFocus(){this.waitForFoundation(()=>{this.mdcFoundation.handleFocus()})}endFocus(){this.waitForFoundation(()=>{this.mdcFoundation.handleBlur()})}startHover(){this.hovering=!0}endHover(){this.hovering=!1}waitForFoundation(t){this.mdcFoundation?t():this.updateComplete.then(t)}render(){const t={"mdc-ripple-upgraded--unbounded":this.unbounded,"mdc-ripple-upgraded--background-focused":this.bgFocused,"mdc-ripple-upgraded--foreground-activation":this.fgActivation,"mdc-ripple-upgraded--foreground-deactivation":this.fgDeactivation,hover:this.hovering,primary:this.primary,accent:this.accent,disabled:this.disabled,activated:this.activated,selected:this.selected};return i.html`
        <div class="mdc-ripple-surface mdc-ripple-upgraded ${Object(s.classMap)(t)}"
          style="${Object(c.styleMap)({"--mdc-ripple-fg-scale":this.fgScale,"--mdc-ripple-fg-size":this.fgSize,"--mdc-ripple-fg-translate-end":this.translateEnd,"--mdc-ripple-fg-translate-start":this.translateStart,"--mdc-ripple-left":this.leftPos,"--mdc-ripple-top":this.topPos})}"></div>`}}Object(r.b)([Object(i.query)(".mdc-ripple-surface")],l.prototype,"mdcRoot",void 0),Object(r.b)([Object(i.property)({type:Boolean})],l.prototype,"primary",void 0),Object(r.b)([Object(i.property)({type:Boolean})],l.prototype,"accent",void 0),Object(r.b)([Object(i.property)({type:Boolean})],l.prototype,"unbounded",void 0),Object(r.b)([Object(i.property)({type:Boolean})],l.prototype,"disabled",void 0),Object(r.b)([Object(i.property)({type:Boolean})],l.prototype,"activated",void 0),Object(r.b)([Object(i.property)({type:Boolean})],l.prototype,"selected",void 0),Object(r.b)([Object(i.internalProperty)()],l.prototype,"hovering",void 0),Object(r.b)([Object(i.internalProperty)()],l.prototype,"bgFocused",void 0),Object(r.b)([Object(i.internalProperty)()],l.prototype,"fgActivation",void 0),Object(r.b)([Object(i.internalProperty)()],l.prototype,"fgDeactivation",void 0),Object(r.b)([Object(i.internalProperty)()],l.prototype,"fgScale",void 0),Object(r.b)([Object(i.internalProperty)()],l.prototype,"fgSize",void 0),Object(r.b)([Object(i.internalProperty)()],l.prototype,"translateStart",void 0),Object(r.b)([Object(i.internalProperty)()],l.prototype,"translateEnd",void 0),Object(r.b)([Object(i.internalProperty)()],l.prototype,"leftPos",void 0),Object(r.b)([Object(i.internalProperty)()],l.prototype,"topPos",void 0);
/**
@license
Copyright 2018 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
const u=i.css`@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transform:translate(var(--mdc-ripple-fg-translate-start, 0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity, 0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity, 0)}to{opacity:0}}:host{display:block;position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%;pointer-events:none}.primary{--mdc-ripple-color: var(--mdc-theme-primary, #6200ee)}.accent{--mdc-ripple-color: var(--mdc-theme-secondary, #018786)}.mdc-ripple-surface{top:0;bottom:0;left:0;right:0;width:100%;height:100%;pointer-events:none;--mdc-ripple-fg-size: 0;--mdc-ripple-left: 0;--mdc-ripple-top: 0;--mdc-ripple-fg-scale: 1;--mdc-ripple-fg-translate-end: 0;--mdc-ripple-fg-translate-start: 0;-webkit-tap-highlight-color:rgba(0,0,0,0);position:relative;outline:none;overflow:hidden;--mdc-ripple-fg-opacity: var(--mdc-ripple-press-opacity, 0.12)}.mdc-ripple-surface::before,.mdc-ripple-surface::after{position:absolute;border-radius:50%;opacity:0;pointer-events:none;content:""}.mdc-ripple-surface::before{transition:opacity 15ms linear,background-color 15ms linear;z-index:1}.mdc-ripple-surface.mdc-ripple-upgraded::before{transform:scale(var(--mdc-ripple-fg-scale, 1))}.mdc-ripple-surface.mdc-ripple-upgraded::after{top:0;left:0;transform:scale(0);transform-origin:center center}.mdc-ripple-surface.mdc-ripple-upgraded--unbounded::after{top:var(--mdc-ripple-top, 0);left:var(--mdc-ripple-left, 0)}.mdc-ripple-surface.mdc-ripple-upgraded--foreground-activation::after{animation:mdc-ripple-fg-radius-in 225ms forwards,mdc-ripple-fg-opacity-in 75ms forwards}.mdc-ripple-surface.mdc-ripple-upgraded--foreground-deactivation::after{animation:mdc-ripple-fg-opacity-out 150ms;transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}.mdc-ripple-surface::before,.mdc-ripple-surface::after{top:calc(50% - 100%);left:calc(50% - 100%);width:200%;height:200%}.mdc-ripple-surface.mdc-ripple-upgraded::after{width:var(--mdc-ripple-fg-size, 100%);height:var(--mdc-ripple-fg-size, 100%)}.mdc-ripple-surface.mdc-ripple-upgraded--unbounded{overflow:visible}.mdc-ripple-surface.mdc-ripple-upgraded--unbounded::before,.mdc-ripple-surface.mdc-ripple-upgraded--unbounded::after{top:calc(50% - 50%);left:calc(50% - 50%);width:100%;height:100%}.mdc-ripple-surface.mdc-ripple-upgraded--unbounded.mdc-ripple-upgraded::before,.mdc-ripple-surface.mdc-ripple-upgraded--unbounded.mdc-ripple-upgraded::after{top:var(--mdc-ripple-top, calc(50% - 50%));left:var(--mdc-ripple-left, calc(50% - 50%));width:var(--mdc-ripple-fg-size, 100%);height:var(--mdc-ripple-fg-size, 100%)}.mdc-ripple-surface.mdc-ripple-upgraded--unbounded.mdc-ripple-upgraded::after{width:var(--mdc-ripple-fg-size, 100%);height:var(--mdc-ripple-fg-size, 100%)}.mdc-ripple-surface.hover::before{opacity:.04;opacity:var(--mdc-ripple-hover-opacity, 0.04)}.mdc-ripple-surface.mdc-ripple-upgraded--background-focused::before{opacity:.12;opacity:var(--mdc-ripple-focus-opacity, 0.12)}.mdc-ripple-surface::before,.mdc-ripple-surface::after{background-color:#000;background-color:var(--mdc-ripple-color, #000)}.mdc-ripple-surface.activated::before{opacity:.12;opacity:var(--mdc-ripple-activated-opacity, 0.12)}.mdc-ripple-surface.activated.hover::before{opacity:.16;opacity:calc(var(--mdc-ripple-hover-opacity, 0.04) + var(--mdc-ripple-activated-opacity, 0.12))}.mdc-ripple-surface.activated.mdc-ripple-upgraded--background-focused::before{opacity:.24;opacity:calc(var(--mdc-ripple-focus-opacity, 0.12) + var(--mdc-ripple-activated-opacity, 0.12))}.mdc-ripple-surface.activated{--mdc-ripple-press-opacity: calc(var(--mdc-ripple-press-opacity, 0.12) + 0.12)}.mdc-ripple-surface.selected::before{opacity:.08;opacity:var(--mdc-ripple-selected-opacity, 0.08)}.mdc-ripple-surface.selected.hover::before{opacity:.12;opacity:calc(var(--mdc-ripple-hover-opacity, 0.04) + var(--mdc-ripple-selected-opacity, 0.08))}.mdc-ripple-surface.selected.mdc-ripple-upgraded--background-focused::before{opacity:.2;opacity:calc(var(--mdc-ripple-focus-opacity, 0.12) + var(--mdc-ripple-selected-opacity, 0.08))}.mdc-ripple-surface.selected{--mdc-ripple-press-opacity: calc(var(--mdc-ripple-press-opacity, 0.12) + 0.08)}.mdc-ripple-surface.disabled{--mdc-ripple-color: transparent}`;
/**
@license
Copyright 2018 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/let d=class extends l{};d.styles=u,d=Object(r.b)([Object(i.customElement)("mwc-ripple")],d);var h=n(21);
/**
@license
Copyright 2020 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/class f{constructor(t){this.startPress=e=>{t().then(t=>{t&&t.startPress(e)})},this.endPress=()=>{t().then(t=>{t&&t.endPress()})},this.startFocus=()=>{t().then(t=>{t&&t.startFocus()})},this.endFocus=()=>{t().then(t=>{t&&t.endFocus()})},this.startHover=()=>{t().then(t=>{t&&t.startHover()})},this.endHover=()=>{t().then(t=>{t&&t.endHover()})}}}var p=n(22);
/**
@license
Copyright 2019 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/class m extends h.a{constructor(){super(...arguments),this.checked=!1,this.indeterminate=!1,this.disabled=!1,this.value="",this.animationClass="",this.shouldRenderRipple=!1,this.mdcFoundationClass=void 0,this.mdcFoundation=void 0,this.rippleElement=null,this.rippleHandlers=new f(()=>(this.shouldRenderRipple=!0,this.ripple.then(t=>this.rippleElement=t),this.ripple))}createAdapter(){return{}}update(t){const e=t.get("indeterminate"),n=t.get("checked");if(void 0!==e||void 0!==n){const t=this.calculateAnimationStateName(!!n,!!e),r=this.calculateAnimationStateName(this.checked,this.indeterminate);this.animationClass=`${t}-${r}`}super.update(t)}calculateAnimationStateName(t,e){return e?"indeterminate":t?"checked":"unchecked"}renderRipple(){const t=this.indeterminate||this.checked;return i.html`${this.shouldRenderRipple?i.html`<mwc-ripple .accent="${t}" .disabled="${this.disabled}" .unbounded="${!0}"></mwc-ripple>`:""}`}render(){const t=this.indeterminate||this.checked,e={"mdc-checkbox--disabled":this.disabled,"mdc-checkbox--selected":t,"mdc-checkbox--anim-checked-indeterminate":"checked-indeterminate"==this.animationClass,"mdc-checkbox--anim-checked-unchecked":"checked-unchecked"==this.animationClass,"mdc-checkbox--anim-indeterminate-checked":"indeterminate-checked"==this.animationClass,"mdc-checkbox--anim-indeterminate-unchecked":"indeterminate-unchecked"==this.animationClass,"mdc-checkbox--anim-unchecked-checked":"unchecked-checked"==this.animationClass,"mdc-checkbox--anim-unchecked-indeterminate":"unchecked-indeterminate"==this.animationClass},n=this.indeterminate?"mixed":void 0;return i.html`
      <div class="mdc-checkbox mdc-checkbox--upgraded ${Object(s.classMap)(e)}">
        <input type="checkbox"
              class="mdc-checkbox__native-control"
              aria-checked="${Object(p.a)(n)}"
              data-indeterminate="${this.indeterminate?"true":"false"}"
              ?disabled="${this.disabled}"
              .indeterminate="${this.indeterminate}"
              .checked="${this.checked}"
              .value="${this.value}"
              @change="${this._changeHandler}"
              @focus="${this._handleFocus}"
              @blur="${this._handleBlur}"
              @mousedown="${this._activateRipple}"
              @mouseup="${this._deactivateRipple}"
              @mouseenter="${this._handleMouseEnter}"
              @mouseleave="${this._handleMouseLeave}"
              @touchstart="${this._activateRipple}"
              @touchend="${this._deactivateRipple}"
              @touchcancel="${this._deactivateRipple}">
        <div class="mdc-checkbox__background">
          <svg class="mdc-checkbox__checkmark"
              viewBox="0 0 24 24">
            <path class="mdc-checkbox__checkmark-path"
                  fill="none"
                  d="M1.73,12.91 8.1,19.28 22.79,4.59"></path>
          </svg>
          <div class="mdc-checkbox__mixedmark"></div>
        </div>
        ${this.renderRipple()}
      </div>`}_handleFocus(){this.rippleHandlers.startFocus()}_handleBlur(){this.rippleHandlers.endFocus()}_activateRipple(){this.rippleHandlers.startPress()}_deactivateRipple(){this.rippleHandlers.endPress()}_handleMouseEnter(){this.rippleHandlers.startHover()}_handleMouseLeave(){this.rippleHandlers.endHover()}_changeHandler(){this.checked=this.formElement.checked,this.indeterminate=this.formElement.indeterminate}get isRippleActive(){var t;return(null===(t=this.rippleElement)||void 0===t?void 0:t.isActive)||!1}}Object(r.b)([Object(i.query)(".mdc-checkbox")],m.prototype,"mdcRoot",void 0),Object(r.b)([Object(i.query)("input")],m.prototype,"formElement",void 0),Object(r.b)([Object(i.property)({type:Boolean,reflect:!0})],m.prototype,"checked",void 0),Object(r.b)([Object(i.property)({type:Boolean})],m.prototype,"indeterminate",void 0),Object(r.b)([Object(i.property)({type:Boolean,reflect:!0})],m.prototype,"disabled",void 0),Object(r.b)([Object(i.property)({type:String})],m.prototype,"value",void 0),Object(r.b)([Object(i.internalProperty)()],m.prototype,"animationClass",void 0),Object(r.b)([Object(i.internalProperty)()],m.prototype,"shouldRenderRipple",void 0),Object(r.b)([Object(i.queryAsync)("mwc-ripple")],m.prototype,"ripple",void 0);
/**
@license
Copyright 2018 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
const g=i.css`.mdc-touch-target-wrapper{display:inline}@keyframes mdc-checkbox-unchecked-checked-checkmark-path{0%,50%{stroke-dashoffset:29.7833385}50%{animation-timing-function:cubic-bezier(0, 0, 0.2, 1)}100%{stroke-dashoffset:0}}@keyframes mdc-checkbox-unchecked-indeterminate-mixedmark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0, 0, 0, 1)}100%{transform:scaleX(1)}}@keyframes mdc-checkbox-checked-unchecked-checkmark-path{from{animation-timing-function:cubic-bezier(0.4, 0, 1, 1);opacity:1;stroke-dashoffset:0}to{opacity:0;stroke-dashoffset:-29.7833385}}@keyframes mdc-checkbox-checked-indeterminate-checkmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(45deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-checked-checkmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(45deg);opacity:0}to{transform:rotate(360deg);opacity:1}}@keyframes mdc-checkbox-checked-indeterminate-mixedmark{from{animation-timing-function:mdc-animation-deceleration-curve-timing-function;transform:rotate(-45deg);opacity:0}to{transform:rotate(0deg);opacity:1}}@keyframes mdc-checkbox-indeterminate-checked-mixedmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(315deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-unchecked-mixedmark{0%{animation-timing-function:linear;transform:scaleX(1);opacity:1}32.8%,100%{transform:scaleX(0);opacity:0}}.mdc-checkbox{display:inline-block;position:relative;flex:0 0 18px;box-sizing:content-box;width:18px;height:18px;line-height:0;white-space:nowrap;cursor:pointer;vertical-align:bottom;padding:11px}.mdc-checkbox .mdc-checkbox__native-control:checked~.mdc-checkbox__background::before,.mdc-checkbox .mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background::before,.mdc-checkbox .mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background::before{background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}.mdc-checkbox.mdc-checkbox--selected .mdc-checkbox__ripple::before,.mdc-checkbox.mdc-checkbox--selected .mdc-checkbox__ripple::after{background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}.mdc-checkbox.mdc-checkbox--selected:hover .mdc-checkbox__ripple::before{opacity:.04}.mdc-checkbox.mdc-checkbox--selected.mdc-ripple-upgraded--background-focused .mdc-checkbox__ripple::before,.mdc-checkbox.mdc-checkbox--selected:not(.mdc-ripple-upgraded):focus .mdc-checkbox__ripple::before{transition-duration:75ms;opacity:.12}.mdc-checkbox.mdc-checkbox--selected:not(.mdc-ripple-upgraded) .mdc-checkbox__ripple::after{transition:opacity 150ms linear}.mdc-checkbox.mdc-checkbox--selected:not(.mdc-ripple-upgraded):active .mdc-checkbox__ripple::after{transition-duration:75ms;opacity:.12}.mdc-checkbox.mdc-checkbox--selected.mdc-ripple-upgraded{--mdc-ripple-fg-opacity: 0.12}.mdc-checkbox.mdc-ripple-upgraded--background-focused.mdc-checkbox--selected .mdc-checkbox__ripple::before,.mdc-checkbox.mdc-ripple-upgraded--background-focused.mdc-checkbox--selected .mdc-checkbox__ripple::after{background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}.mdc-checkbox .mdc-checkbox__background{top:11px;left:11px}.mdc-checkbox .mdc-checkbox__background::before{top:-13px;left:-13px;width:40px;height:40px}.mdc-checkbox .mdc-checkbox__native-control{top:0px;right:0px;left:0px;width:40px;height:40px}.mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:rgba(0,0,0,.54);background-color:transparent}.mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:#018786;border-color:var(--mdc-theme-secondary, #018786);background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}@keyframes mdc-checkbox-fade-in-background-8A000000secondary00000000secondary{0%{border-color:rgba(0,0,0,.54);background-color:transparent}50%{border-color:#018786;border-color:var(--mdc-theme-secondary, #018786);background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}}@keyframes mdc-checkbox-fade-out-background-8A000000secondary00000000secondary{0%,80%{border-color:#018786;border-color:var(--mdc-theme-secondary, #018786);background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}100%{border-color:rgba(0,0,0,.54);background-color:transparent}}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-8A000000secondary00000000secondary}.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-8A000000secondary00000000secondary}.mdc-checkbox__native-control[disabled]:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:rgba(0,0,0,.38);background-color:transparent}.mdc-checkbox__native-control[disabled]:checked~.mdc-checkbox__background,.mdc-checkbox__native-control[disabled]:indeterminate~.mdc-checkbox__background,.mdc-checkbox__native-control[data-indeterminate=true][disabled]~.mdc-checkbox__background{border-color:transparent;background-color:rgba(0,0,0,.38)}.mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:#fff}.mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:#fff}.mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:#fff}.mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:#fff}@media screen and (-ms-high-contrast: active){.mdc-checkbox__native-control[disabled]:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:GrayText;background-color:transparent}.mdc-checkbox__native-control[disabled]:checked~.mdc-checkbox__background,.mdc-checkbox__native-control[disabled]:indeterminate~.mdc-checkbox__background,.mdc-checkbox__native-control[data-indeterminate=true][disabled]~.mdc-checkbox__background{border-color:GrayText;background-color:transparent}.mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:GrayText}.mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:GrayText}.mdc-checkbox__mixedmark{margin:0 1px}}.mdc-checkbox--disabled{cursor:default;pointer-events:none}.mdc-checkbox__background{display:inline-flex;position:absolute;align-items:center;justify-content:center;box-sizing:border-box;width:18px;height:18px;border:2px solid currentColor;border-radius:2px;background-color:transparent;pointer-events:none;will-change:background-color,border-color;transition:background-color 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),border-color 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__background .mdc-checkbox__background::before{background-color:#000;background-color:var(--mdc-theme-on-surface, #000)}.mdc-checkbox__checkmark{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;opacity:0;transition:opacity 180ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox--upgraded .mdc-checkbox__checkmark{opacity:1}.mdc-checkbox__checkmark-path{transition:stroke-dashoffset 180ms 0ms cubic-bezier(0.4, 0, 0.6, 1);stroke:currentColor;stroke-width:3.12px;stroke-dashoffset:29.7833385;stroke-dasharray:29.7833385}.mdc-checkbox__mixedmark{width:100%;height:0;transform:scaleX(0) rotate(0deg);border-width:1px;border-style:solid;opacity:0;transition:opacity 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox--upgraded .mdc-checkbox__background,.mdc-checkbox--upgraded .mdc-checkbox__checkmark,.mdc-checkbox--upgraded .mdc-checkbox__checkmark-path,.mdc-checkbox--upgraded .mdc-checkbox__mixedmark{transition:none !important}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__background,.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__background,.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__background,.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__background{animation-duration:180ms;animation-timing-function:linear}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-unchecked-checked-checkmark-path 180ms linear 0s;transition:none}.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-unchecked-indeterminate-mixedmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-checked-unchecked-checkmark-path 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__checkmark{animation:mdc-checkbox-checked-indeterminate-checkmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-checked-indeterminate-mixedmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__checkmark{animation:mdc-checkbox-indeterminate-checked-checkmark 500ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-checked-mixedmark 500ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-unchecked-mixedmark 300ms linear 0s;transition:none}.mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background{transition:border-color 90ms 0ms cubic-bezier(0, 0, 0.2, 1),background-color 90ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__checkmark-path{stroke-dashoffset:0}.mdc-checkbox__background::before{position:absolute;transform:scale(0, 0);border-radius:50%;opacity:0;pointer-events:none;content:"";will-change:opacity,transform;transition:opacity 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__native-control:focus~.mdc-checkbox__background::before{transform:scale(1);opacity:.12;transition:opacity 80ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 80ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-checkbox__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit}.mdc-checkbox__native-control:disabled{cursor:default;pointer-events:none}.mdc-checkbox--touch{margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-checkbox--touch .mdc-checkbox__native-control{top:-4px;right:-4px;left:-4px;width:48px;height:48px}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark{transition:opacity 180ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 180ms 0ms cubic-bezier(0, 0, 0.2, 1);opacity:1}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(-45deg)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__checkmark{transform:rotate(45deg);opacity:0;transition:opacity 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__mixedmark,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(0deg);opacity:1}:host{outline:none;display:inline-block}.mdc-checkbox .mdc-checkbox__native-control:focus~.mdc-checkbox__background::before{background-color:rgba(0,0,0,.54);background-color:var(--mdc-checkbox-unchecked-color, rgba(0, 0, 0, 0.54))}.mdc-checkbox .mdc-checkbox__background::before{content:none}.mdc-checkbox__native-control[disabled]:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-disabled-color, rgba(0, 0, 0, 0.38));background-color:transparent}.mdc-checkbox__native-control[disabled]:checked~.mdc-checkbox__background,.mdc-checkbox__native-control[disabled]:indeterminate~.mdc-checkbox__background,.mdc-checkbox__native-control[data-indeterminate=true][disabled]~.mdc-checkbox__background{border-color:transparent;background-color:var(--mdc-checkbox-disabled-color, rgba(0, 0, 0, 0.38))}.mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unchecked-color, rgba(0, 0, 0, 0.54));background-color:transparent}.mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:#018786;border-color:var(--mdc-theme-secondary, #018786);background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}@keyframes mdc-checkbox-fade-in-background---mdc-checkbox-unchecked-colorsecondary00000000secondary{0%{border-color:var(--mdc-checkbox-unchecked-color, rgba(0, 0, 0, 0.54));background-color:transparent}50%{border-color:#018786;border-color:var(--mdc-theme-secondary, #018786);background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}}@keyframes mdc-checkbox-fade-out-background---mdc-checkbox-unchecked-colorsecondary00000000secondary{0%,80%{border-color:#018786;border-color:var(--mdc-theme-secondary, #018786);background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}100%{border-color:var(--mdc-checkbox-unchecked-color, rgba(0, 0, 0, 0.54));background-color:transparent}}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background---mdc-checkbox-unchecked-colorsecondary00000000secondary}.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background---mdc-checkbox-unchecked-colorsecondary00000000secondary}.mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:var(--mdc-checkbox-mark-color, #fff)}.mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-mark-color, #fff)}.mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:var(--mdc-checkbox-mark-color, #fff)}.mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-mark-color, #fff)}`;
/**
@license
Copyright 2018 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/let v=class extends m{};v.styles=g,v=Object(r.b)([Object(i.customElement)("mwc-checkbox")],v)},function(t,e,n){"use strict";n.r(e),n.d(e,"Formfield",(function(){return g}));var r=n(1),i=n(0),o=n(17),a={ROOT:"mdc-form-field"},s={LABEL_SELECTOR:".mdc-form-field > label"},c=function(t){function e(n){var i=t.call(this,Object(r.a)(Object(r.a)({},e.defaultAdapter),n))||this;return i.clickHandler_=function(){return i.handleClick_()},i}return Object(r.c)(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return a},enumerable:!0,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return s},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{activateInputRipple:function(){},deactivateInputRipple:function(){},deregisterInteractionHandler:function(){},registerInteractionHandler:function(){}}},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.adapter_.registerInteractionHandler("click",this.clickHandler_)},e.prototype.destroy=function(){this.adapter_.deregisterInteractionHandler("click",this.clickHandler_)},e.prototype.handleClick_=function(){var t=this;this.adapter_.activateInputRipple(),requestAnimationFrame((function(){return t.adapter_.deactivateInputRipple()}))},e}(o.a),l=n(23),u=n(21),d=n(40),h=n(45),f=n(8);
/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class p extends l.a{constructor(){super(...arguments),this.alignEnd=!1,this.spaceBetween=!1,this.nowrap=!1,this.label="",this.mdcFoundationClass=c}createAdapter(){return{registerInteractionHandler:(t,e)=>{this.labelEl.addEventListener(t,e)},deregisterInteractionHandler:(t,e)=>{this.labelEl.removeEventListener(t,e)},activateInputRipple:async()=>{const t=this.input;if(t instanceof u.a){const e=await t.ripple;e&&e.startPress()}},deactivateInputRipple:async()=>{const t=this.input;if(t instanceof u.a){const e=await t.ripple;e&&e.endPress()}}}}get input(){return Object(h.b)(this.slotEl,"*")}render(){const t={"mdc-form-field--align-end":this.alignEnd,"mdc-form-field--space-between":this.spaceBetween,"mdc-form-field--nowrap":this.nowrap};return i.html`
      <div class="mdc-form-field ${Object(f.classMap)(t)}">
        <slot></slot>
        <label class="mdc-label"
               @click="${this._labelClick}">${this.label}</label>
      </div>`}_labelClick(){const t=this.input;t&&(t.focus(),t.click())}}Object(r.b)([Object(i.property)({type:Boolean})],p.prototype,"alignEnd",void 0),Object(r.b)([Object(i.property)({type:Boolean})],p.prototype,"spaceBetween",void 0),Object(r.b)([Object(i.property)({type:Boolean})],p.prototype,"nowrap",void 0),Object(r.b)([Object(i.property)({type:String}),Object(d.a)((async function(t){const e=this.input;e&&("input"===e.localName?e.setAttribute("aria-label",t):e instanceof u.a&&(await e.updateComplete,e.setAriaLabel(t)))}))],p.prototype,"label",void 0),Object(r.b)([Object(i.query)(".mdc-form-field")],p.prototype,"mdcRoot",void 0),Object(r.b)([Object(i.query)("slot")],p.prototype,"slotEl",void 0),Object(r.b)([Object(i.query)("label")],p.prototype,"labelEl",void 0);
/**
@license
Copyright 2018 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
const m=i.css`.mdc-form-field{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-body2-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:.875rem;font-size:var(--mdc-typography-body2-font-size, 0.875rem);line-height:1.25rem;line-height:var(--mdc-typography-body2-line-height, 1.25rem);font-weight:400;font-weight:var(--mdc-typography-body2-font-weight, 400);letter-spacing:.0178571429em;letter-spacing:var(--mdc-typography-body2-letter-spacing, 0.0178571429em);text-decoration:inherit;text-decoration:var(--mdc-typography-body2-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-body2-text-transform, inherit);color:rgba(0,0,0,.87);color:var(--mdc-theme-text-primary-on-background, rgba(0, 0, 0, 0.87));display:inline-flex;align-items:center;vertical-align:middle}.mdc-form-field>label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0;order:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{margin-left:auto;margin-right:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{padding-left:0;padding-right:4px}.mdc-form-field--nowrap>label{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mdc-form-field--align-end>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px;order:-1}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{margin-left:0;margin-right:auto}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{padding-left:4px;padding-right:0}.mdc-form-field--space-between{justify-content:space-between}.mdc-form-field--space-between>label{margin:0}[dir=rtl] .mdc-form-field--space-between>label,.mdc-form-field--space-between>label[dir=rtl]{margin:0}:host{display:inline-flex}.mdc-form-field{width:100%}::slotted(*){-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-body2-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:.875rem;font-size:var(--mdc-typography-body2-font-size, 0.875rem);line-height:1.25rem;line-height:var(--mdc-typography-body2-line-height, 1.25rem);font-weight:400;font-weight:var(--mdc-typography-body2-font-weight, 400);letter-spacing:.0178571429em;letter-spacing:var(--mdc-typography-body2-letter-spacing, 0.0178571429em);text-decoration:inherit;text-decoration:var(--mdc-typography-body2-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-body2-text-transform, inherit);color:rgba(0,0,0,.87);color:var(--mdc-theme-text-primary-on-background, rgba(0, 0, 0, 0.87))}::slotted(mwc-switch){margin-right:10px}[dir=rtl] ::slotted(mwc-switch),::slotted(mwc-switch)[dir=rtl]{margin-left:10px}`;
/**
@license
Copyright 2018 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/let g=class extends p{};g.styles=m,g=Object(r.b)([Object(i.customElement)("mwc-formfield")],g)},,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n(67);const r=n(7),i=n(84),o=n(64),a=n(65),s=n(66),c=n(147);i.LAYOUTS.potato={components:{Main:[s.DatapointEditorModule,o.ClassificationModule],Data:[a.DataTableModule,c.PotatoModule]}},r.app.initialize(i.LAYOUTS)},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0}),e.PotatoModule=void 0;const i=n(13);n(5);const o=n(0),a=n(15);let s=class extends i.LitModule{render(){const t=a.styleMap({width:"100%",height:"100%"});return o.html`
      <a href="https://potato.io/">
        <img src="static/potato.svg" style=${t}>
      </a>`}static shouldDisplayModule(t,e){return!0}};s.title="Potato",s.numCols=4,s.template=()=>o.html`<potato-module></potato-module>`,s=r([o.customElement("potato-module")],s),e.PotatoModule=s}]);